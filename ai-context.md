# Project Context: grana-em-conjunto

**Generated:** 2025-12-03T21:27:16.917Z  
**Total Files:** 147  
**Total Size:** 1.15 MB

## Project Structure

```
dev-dist
â””â”€â”€ registerSW.js
public
â”œâ”€â”€ placeholder.svg
â”œâ”€â”€ robots.txt
â””â”€â”€ site.webmanifest
src
â”œâ”€â”€ components
â”‚   â”œâ”€â”€ auth
â”‚   â”‚   â””â”€â”€ ProtectedRoute.tsx
â”‚   â”œâ”€â”€ dashboard
â”‚   â”‚   â”œâ”€â”€ FixedBalanceCard.tsx
â”‚   â”‚   â”œâ”€â”€ MetricCard.tsx
â”‚   â”‚   â””â”€â”€ TransactionsList.tsx
â”‚   â”œâ”€â”€ dialogs
â”‚   â”‚   â”œâ”€â”€ AddEventDialog.tsx
â”‚   â”‚   â”œâ”€â”€ AddGoalDialog.tsx
â”‚   â”‚   â”œâ”€â”€ AddGroupDialog.tsx
â”‚   â”‚   â”œâ”€â”€ AddInvestmentDialog.tsx
â”‚   â”‚   â”œâ”€â”€ AddReminderDialog.tsx
â”‚   â”‚   â”œâ”€â”€ AddTransactionDialog.tsx
â”‚   â”‚   â”œâ”€â”€ EditGoalDialog.tsx
â”‚   â”‚   â”œâ”€â”€ EditGroupDialog.tsx
â”‚   â”‚   â”œâ”€â”€ InvestmentAdjustmentDialog.tsx
â”‚   â”‚   â”œâ”€â”€ InvestmentDetailsModal.tsx
â”‚   â”‚   â”œâ”€â”€ ManageInvestmentDialog.tsx
â”‚   â”‚   â””â”€â”€ RemoveInvestmentAmountDialog.tsx
â”‚   â”œâ”€â”€ filters
â”‚   â”‚   â””â”€â”€ DateFilter.tsx
â”‚   â”œâ”€â”€ groups
â”‚   â”‚   â””â”€â”€ GroupDetailsModal.tsx
â”‚   â”œâ”€â”€ layout
â”‚   â”‚   â”œâ”€â”€ DashboardLayout.tsx
â”‚   â”‚   â””â”€â”€ Sidebar.tsx
â”‚   â”œâ”€â”€ reminders
â”‚   â”‚   â””â”€â”€ RemindersList.tsx
â”‚   â”œâ”€â”€ transactions
â”‚   â”‚   â”œâ”€â”€ EventDetailsModal.tsx
â”‚   â”‚   â””â”€â”€ types.ts
â”‚   â”œâ”€â”€ ui
â”‚   â”‚   â”œâ”€â”€ accordion.tsx
â”‚   â”‚   â”œâ”€â”€ alert-dialog.tsx
â”‚   â”‚   â”œâ”€â”€ alert.tsx
â”‚   â”‚   â”œâ”€â”€ aspect-ratio.tsx
â”‚   â”‚   â”œâ”€â”€ avatar.tsx
â”‚   â”‚   â”œâ”€â”€ badge.tsx
â”‚   â”‚   â”œâ”€â”€ breadcrumb.tsx
â”‚   â”‚   â”œâ”€â”€ button.tsx
â”‚   â”‚   â”œâ”€â”€ calendar.tsx
â”‚   â”‚   â”œâ”€â”€ card.tsx
â”‚   â”‚   â”œâ”€â”€ carousel.tsx
â”‚   â”‚   â”œâ”€â”€ chart.tsx
â”‚   â”‚   â”œâ”€â”€ checkbox.tsx
â”‚   â”‚   â”œâ”€â”€ collapsible.tsx
â”‚   â”‚   â”œâ”€â”€ command.tsx
â”‚   â”‚   â”œâ”€â”€ context-menu.tsx
â”‚   â”‚   â”œâ”€â”€ dialog.tsx
â”‚   â”‚   â”œâ”€â”€ drawer.tsx
â”‚   â”‚   â”œâ”€â”€ dropdown-menu.tsx
â”‚   â”‚   â”œâ”€â”€ form.tsx
â”‚   â”‚   â”œâ”€â”€ hover-card.tsx
â”‚   â”‚   â”œâ”€â”€ input-otp.tsx
â”‚   â”‚   â”œâ”€â”€ input.tsx
â”‚   â”‚   â”œâ”€â”€ label.tsx
â”‚   â”‚   â”œâ”€â”€ menubar.tsx
â”‚   â”‚   â”œâ”€â”€ navigation-menu.tsx
â”‚   â”‚   â”œâ”€â”€ pagination.tsx
â”‚   â”‚   â”œâ”€â”€ popover.tsx
â”‚   â”‚   â”œâ”€â”€ progress.tsx
â”‚   â”‚   â”œâ”€â”€ radio-group.tsx
â”‚   â”‚   â”œâ”€â”€ resizable.tsx
â”‚   â”‚   â”œâ”€â”€ scroll-area.tsx
â”‚   â”‚   â”œâ”€â”€ select.tsx
â”‚   â”‚   â”œâ”€â”€ separator.tsx
â”‚   â”‚   â”œâ”€â”€ sheet.tsx
â”‚   â”‚   â”œâ”€â”€ sidebar.tsx
â”‚   â”‚   â”œâ”€â”€ skeleton.tsx
â”‚   â”‚   â”œâ”€â”€ slider.tsx
â”‚   â”‚   â”œâ”€â”€ sonner.tsx
â”‚   â”‚   â”œâ”€â”€ switch.tsx
â”‚   â”‚   â”œâ”€â”€ table.tsx
â”‚   â”‚   â”œâ”€â”€ tabs.tsx
â”‚   â”‚   â”œâ”€â”€ textarea.tsx
â”‚   â”‚   â”œâ”€â”€ toast.tsx
â”‚   â”‚   â”œâ”€â”€ toaster.tsx
â”‚   â”‚   â”œâ”€â”€ toggle-group.tsx
â”‚   â”‚   â”œâ”€â”€ toggle.tsx
â”‚   â”‚   â”œâ”€â”€ tooltip.tsx
â”‚   â”‚   â””â”€â”€ use-toast.ts
â”‚   â”œâ”€â”€ LoadingFallback.tsx
â”‚   â”œâ”€â”€ PWAPrompt.tsx
â”‚   â”œâ”€â”€ theme-provider.tsx
â”‚   â””â”€â”€ VirtualizedTransactionsList.tsx
â”œâ”€â”€ constants
â”‚   â””â”€â”€ investment-types.ts
â”œâ”€â”€ contexts
â”‚   â””â”€â”€ AuthContext.tsx
â”œâ”€â”€ hooks
â”‚   â”œâ”€â”€ use-mobile.tsx
â”‚   â”œâ”€â”€ use-toast.ts
â”‚   â”œâ”€â”€ usePWA.ts
â”‚   â”œâ”€â”€ useReminders.ts
â”‚   â””â”€â”€ useSanitizedForm.ts
â”œâ”€â”€ integrations
â”‚   â””â”€â”€ supabase
â”‚       â”œâ”€â”€ client.ts
â”‚       â””â”€â”€ types.ts
â”œâ”€â”€ lib
â”‚   â”œâ”€â”€ date.ts
â”‚   â”œâ”€â”€ icons.ts
â”‚   â””â”€â”€ utils.ts
â”œâ”€â”€ pages
â”‚   â”œâ”€â”€ Auth.tsx
â”‚   â”œâ”€â”€ Dashboard.tsx
â”‚   â”œâ”€â”€ Groups.tsx
â”‚   â”œâ”€â”€ Index.tsx
â”‚   â”œâ”€â”€ Investments.tsx
â”‚   â”œâ”€â”€ JoinGroup.tsx
â”‚   â”œâ”€â”€ NotFound.tsx
â”‚   â”œâ”€â”€ Profile.tsx
â”‚   â”œâ”€â”€ Reminders.tsx
â”‚   â””â”€â”€ Transactions.tsx
â”œâ”€â”€ utils
â”‚   â”œâ”€â”€ date
â”‚   â”‚   â””â”€â”€ dateutils.ts
â”‚   â”œâ”€â”€ investments
â”‚   â”‚   â””â”€â”€ investmentUtils.ts
â”‚   â”œâ”€â”€ security
â”‚   â”‚   â”œâ”€â”€ constants.ts
â”‚   â”‚   â”œâ”€â”€ index.ts
â”‚   â”‚   â”œâ”€â”€ permissions.ts
â”‚   â”‚   â”œâ”€â”€ rateLimiter.ts
â”‚   â”‚   â”œâ”€â”€ sanitize.ts
â”‚   â”‚   â”œâ”€â”€ types.ts
â”‚   â”‚   â””â”€â”€ validate.ts
â”‚   â”œâ”€â”€ services
â”‚   â”‚   â”œâ”€â”€ pushNotificationService.ts
â”‚   â”‚   â””â”€â”€ reminderService.ts
â”‚   â””â”€â”€ types
â”‚       â””â”€â”€ reminder.types.ts
â”œâ”€â”€ App.css
â”œâ”€â”€ App.tsx
â”œâ”€â”€ index.css
â”œâ”€â”€ main.tsx
â”œâ”€â”€ sw.ts
â””â”€â”€ vite-env.d.ts
supabase
â”œâ”€â”€ functions
â”‚   â”œâ”€â”€ check-reminders
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â””â”€â”€ send-invite-email
â”‚       â””â”€â”€ index.ts
â”œâ”€â”€ migrations
â”‚   â”œâ”€â”€ 20250101000000_add_rls_policies.sql
â”‚   â”œâ”€â”€ 20250101000001_add_constraints.sql
â”‚   â”œâ”€â”€ 20250828143646_7e8a986a-c67f-48ef-b9ee-26d0eecacbe4.sql
â”‚   â”œâ”€â”€ 20250828143805_72b78b28-1c94-4cd7-8ffd-bf20871859b1.sql
â”‚   â”œâ”€â”€ 20250829132211_c0e738ba-7e8f-48f0-9deb-ffde44a30808.sql
â”‚   â”œâ”€â”€ 20250903015953_5404a739-66c9-4a37-9263-5a31b04b7cf0.sql
â”‚   â”œâ”€â”€ 20250904021942_62909a3a-55dc-49d7-9e8c-022c6b9a7a56.sql
â”‚   â”œâ”€â”€ 20250904221115_8d927066-53cd-4d11-97ea-cc53894ac1c6.sql
â”‚   â”œâ”€â”€ add_is_admin_to_group_members.sql
â”‚   â””â”€â”€ add_recurrence_fields.sql
â””â”€â”€ config.toml
components.json
eslint.config.js
index.html
merged-output.txt
otimizar.bat
package.json
postcss.config.js
README.md
tailwind.config.ts
tsconfig.app.json
tsconfig.json
tsconfig.node.json
vercel.json
vite.config.ts
```

## Files

### components.json

**Language:** json  
**Size:** 432 Bytes  
**Last Modified:** 2025-08-28T19:03:37.237Z

```json
{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "default",
  "rsc": false,
  "tsx": true,
  "tailwind": {
    "config": "tailwind.config.ts",
    "css": "src/index.css",
    "baseColor": "slate",
    "cssVariables": true,
    "prefix": ""
  },
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  }
}
```
---

### dev-dist\registerSW.js

**Language:** javascript  
**Size:** 118 Bytes  
**Last Modified:** 2025-12-03T21:05:31.010Z

```javascript
if('serviceWorker' in navigator) navigator.serviceWorker.register('/dev-sw.js?dev-sw', { scope: '/', type: 'module' })
```
---

### eslint.config.js

**Language:** javascript  
**Size:** 789 Bytes  
**Last Modified:** 2025-10-31T20:47:44.428Z

```javascript
import js from "@eslint/js";
import globals from "globals";
import reactHooks from "eslint-plugin-react-hooks";
import reactRefresh from "eslint-plugin-react-refresh";
import tseslint from "typescript-eslint";

export default tseslint.config(
  { ignores: ["dist"] },
  {
    extends: [js.configs.recommended, ...tseslint.configs.recommended],
    files: ["**/*.{ts,tsx}"],
    languageOptions: {
      ecmaVersion: 2020,
      globals: globals.browser,
    },
    plugins: {
      "react-hooks": reactHooks,
      "react-refresh": reactRefresh,
    },
    rules: {
      ...reactHooks.configs.recommended.rules,
      "react-refresh/only-export-components": ["warn", { allowConstantExport: true }],
      "@typescript-eslint/no-unused-vars": "on",
    },
  }
);
```
---

### index.html

**Language:** html  
**Size:** 602 Bytes  
**Last Modified:** 2025-11-19T20:19:53.383Z

```html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Zeni Wallet</title>
    <meta name="description" content="Lovable Generated Project" />
    <meta name="author" content="Lovable" />

    <meta property="og:title" content="Zeni Wallet" />
    <meta property="og:type" content="website" />

    <meta name="twitter:card" content="summary_large_image" />
  </head>

  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
```
---

### merged-output.txt

**Language:** text  
**Size:** 582.41 KB  
**Last Modified:** 2025-12-03T21:27:10.856Z

```text
# Code Merge Output
Generated at: 2025-11-27T21:43:27.786Z
Source path: .
Files processed: 128
Total lines: 16157
Total characters: 566306

File types:
  - tsx: 88 files (12.198 lines)
  - ts: 30 files (3.046 lines)
  - json: 6 files (208 lines)
  - js: 3 files (35 lines)
  - md: 1 files (670 lines)

Project structure & file index:
./
  - components.json (20 lines)
  - eslint.config.js (27 lines)
  - package.json (95 lines)
  - postcss.config.js (7 lines)
  - README.md (670 lines)
  - tailwind.config.ts (128 lines)
  - tsconfig.app.json (31 lines)
  - tsconfig.json (30 lines)
  - tsconfig.node.json (23 lines)
  - vercel.json (9 lines)
  - vite.config.ts (67 lines)
  dev-dist/
    - registerSW.js (1 lines)
  src/
    - App.tsx (113 lines)
    - main.tsx (13 lines)
    - sw.ts (146 lines)
    - vite-env.d.ts (2 lines)
    components/
      - LoadingFallback.tsx (13 lines)
      - PWAPrompt.tsx (51 lines)
      - theme-provider.tsx (59 lines)
      - VirtualizedTransactionsList.tsx (102 lines)
      auth/
        - ProtectedRoute.tsx (24 lines)
      dashboard/
        - FixedBalanceCard.tsx (267 lines)
        - MetricCard.tsx (47 lines)
        - TransactionsList.tsx (168 lines)
      dialogs/
        - AddEventDialog.tsx (142 lines)
        - AddGoalDialog.tsx (235 lines)
        - AddGroupDialog.tsx (209 lines)
        - AddInvestmentDialog.tsx (317 lines)
        - AddReminderDialog.tsx (140 lines)
        - AddTransactionDialog.tsx (445 lines)
        - EditGoalDialog.tsx (247 lines)
        - EditGroupDialog.tsx (549 lines)
        - InvestmentAdjustmentDialog.tsx (209 lines)
        - InvestmentDetailsModal.tsx (204 lines)
        - ManageInvestmentDialog.tsx (207 lines)
        - RemoveInvestmentAmountDialog.tsx (190 lines)
      filters/
        - DateFilter.tsx (145 lines)
      groups/
        - GroupDetailsModal.tsx (476 lines)
      layout/
        - DashboardLayout.tsx (43 lines)
        - Sidebar.tsx (79 lines)
      reminders/
        - RemindersList.tsx (239 lines)
      transactions/
        - EventDetailsModal.tsx (198 lines)
        - types.ts (25 lines)
      ui/
        - accordion.tsx (51 lines)
        - alert-dialog.tsx (97 lines)
        - alert.tsx (60 lines)
        - aspect-ratio.tsx (6 lines)
        - avatar.tsx (49 lines)
        - badge.tsx (37 lines)
        - breadcrumb.tsx (69 lines)
        - button.tsx (57 lines)
        - calendar.tsx (54 lines)
        - card.tsx (36 lines)
        - carousel.tsx (213 lines)
        - chart.tsx (364 lines)
        - checkbox.tsx (27 lines)
        - collapsible.tsx (10 lines)
        - command.tsx (113 lines)
        - context-menu.tsx (179 lines)
        - dialog.tsx (92 lines)
        - drawer.tsx (117 lines)
        - dropdown-menu.tsx (176 lines)
        - form.tsx (177 lines)
        - hover-card.tsx (28 lines)
        - input-otp.tsx (59 lines)
        - input.tsx (23 lines)
        - label.tsx (25 lines)
        - menubar.tsx (204 lines)
        - navigation-menu.tsx (117 lines)
        - pagination.tsx (67 lines)
        - popover.tsx (30 lines)
        - progress.tsx (27 lines)
        - radio-group.tsx (37 lines)
        - resizable.tsx (38 lines)
        - scroll-area.tsx (47 lines)
        - select.tsx (135 lines)
        - separator.tsx (30 lines)
        - sheet.tsx (94 lines)
        - sidebar.tsx (599 lines)
        - skeleton.tsx (16 lines)
        - slider.tsx (27 lines)
        - sonner.tsx (30 lines)
        - switch.tsx (28 lines)
        - table.tsx (118 lines)
        - tabs.tsx (54 lines)
        - textarea.tsx (25 lines)
        - toast.tsx (108 lines)
        - toaster.tsx (34 lines)
        - toggle-group.tsx (60 lines)
        - toggle.tsx (44 lines)
        - tooltip.tsx (29 lines)
        - use-toast.ts (4 lines)
    constants/
      - investment-types.ts (15 lines)
    contexts/
      - AuthContext.tsx (279 lines)
    hooks/
      - use-mobile.tsx (20 lines)
      - use-toast.ts (192 lines)
      - usePWA.ts (50 lines)
      - useReminders.ts (208 lines)
      - useSanitizedForm.ts (169 lines)
    integrations/
      supabase/
        - client.ts (14 lines)
        - types.ts (304 lines)
    lib/
      - date.ts (17 lines)
      - icons.ts (58 lines)
      - utils.ts (7 lines)
    pages/
      - Auth.tsx (292 lines)
      - Dashboard.tsx (177 lines)
      - Groups.tsx (494 lines)
      - Index.tsx (120 lines)
      - Investments.tsx (522 lines)
      - JoinGroup.tsx (188 lines)
      - NotFound.tsx (28 lines)
      - Profile.tsx (267 lines)
      - Reminders.tsx (20 lines)
      - Transactions.tsx (543 lines)
    utils/
      date/
        - dateutils.ts (70 lines)
      investments/
        - investmentUtils.ts (24 lines)
      security/
        - constants.ts (70 lines)
        - index.ts (9 lines)
        - permissions.ts (199 lines)
        - rateLimiter.ts (147 lines)
        - sanitize.ts (184 lines)
        - types.ts (68 lines)
        - validate.ts (248 lines)
      services/
        - pushNotificationService.ts (233 lines)
        - reminderService.ts (138 lines)
      types/
        - reminder.types.ts (52 lines)
  supabase/
    functions/
      check-reminders/
        - index.ts (131 lines)
      send-invite-email/
        - index.ts (67 lines)
================================================================================

STARTOFFILE: components.json
----------------------------------------
{
  "$schema": "https://ui.shadcn.com/schema.json",
  "style": "default",
  "rsc": false,
  "tsx": true,
  "tailwind": {
    "config": "tailwind.config.ts",
    "css": "src/index.css",
    "baseColor": "slate",
    "cssVariables": true,
    "prefix": ""
  },
  "aliases": {
    "components": "@/components",
    "utils": "@/lib/utils",
    "ui": "@/components/ui",
    "lib": "@/lib",
    "hooks": "@/hooks"
  }
}
----------------------------------------
ENDOFFILE: components.json

STARTOFFILE: dev-dist\registerSW.js
----------------------------------------
if('serviceWorker' in navigator) navigator.serviceWorker.register('/dev-sw.js?dev-sw', { scope: '/', type: 'module' })
----------------------------------------
ENDOFFILE: dev-dist\registerSW.js

STARTOFFILE: eslint.config.js
----------------------------------------
import js from "@eslint/js";
import globals from "globals";
import reactHooks from "eslint-plugin-react-hooks";
import reactRefresh from "eslint-plugin-react-refresh";
import tseslint from "typescript-eslint";

export default tseslint.config(
  { ignores: ["dist"] },
  {
    extends: [js.configs.recommended, ...tseslint.configs.recommended],
    files: ["**/*.{ts,tsx}"],
    languageOptions: {
      ecmaVersion: 2020,
      globals: globals.browser,
    },
    plugins: {
      "react-hooks": reactHooks,
      "react-refresh": reactRefresh,
    },
    rules: {
      ...reactHooks.configs.recommended.rules,
      "react-refresh/only-export-components": ["warn", { allowConstantExport: true }],
      "@typescript-eslint/no-unused-vars": "on",
    },
  }
);

----------------------------------------
ENDOFFILE: eslint.config.js

STARTOFFILE: package.json
----------------------------------------
{
  "name": "vite_react_shadcn_ts",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "sideEffects": false,
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "build:dev": "vite build --mode development",
    "build:analyze": "vite build && vite-bundle-analyzer",
    "lint": "eslint .",
    "preview": "vite preview"
  },
  "dependencies": {
    "@hookform/resolvers": "^3.10.0",
    "@radix-ui/react-accordion": "^1.2.11",
    "@radix-ui/react-alert-dialog": "^1.1.14",
    "@radix-ui/react-aspect-ratio": "^1.1.7",
    "@radix-ui/react-avatar": "^1.1.10",
    "@radix-ui/react-checkbox": "^1.3.2",
    "@radix-ui/react-collapsible": "^1.1.11",
    "@radix-ui/react-context-menu": "^2.2.15",
    "@radix-ui/react-dialog": "^1.1.14",
    "@radix-ui/react-dropdown-menu": "^2.1.15",
    "@radix-ui/react-hover-card": "^1.1.14",
    "@radix-ui/react-label": "^2.1.7",
    "@radix-ui/react-menubar": "^1.1.15",
    "@radix-ui/react-navigation-menu": "^1.2.13",
    "@radix-ui/react-popover": "^1.1.14",
    "@radix-ui/react-progress": "^1.1.7",
    "@radix-ui/react-radio-group": "^1.3.7",
    "@radix-ui/react-scroll-area": "^1.2.9",
    "@radix-ui/react-select": "^2.2.5",
    "@radix-ui/react-separator": "^1.1.7",
    "@radix-ui/react-slider": "^1.3.5",
    "@radix-ui/react-slot": "^1.2.3",
    "@radix-ui/react-switch": "^1.2.5",
    "@radix-ui/react-tabs": "^1.1.12",
    "@radix-ui/react-toast": "^1.2.14",
    "@radix-ui/react-toggle": "^1.1.9",
    "@radix-ui/react-toggle-group": "^1.1.10",
    "@radix-ui/react-tooltip": "^1.2.7",
    "@supabase/supabase-js": "^2.56.0",
    "@tanstack/react-query": "^5.83.0",
    "class-variance-authority": "^0.7.1",
    "clsx": "^2.1.1",
    "cmdk": "^1.1.1",
    "date-fns": "^3.6.0",
    "dompurify": "^3.3.0",
    "embla-carousel-react": "^8.6.0",
    "input-otp": "^1.4.2",
    "lucide-react": "^0.462.0",
    "next-themes": "^0.3.0",
    "react": "^18.3.1",
    "react-day-picker": "^9.9.0",
    "react-dom": "^18.3.1",
    "react-hook-form": "^7.61.1",
    "react-resizable-panels": "^2.1.9",
    "react-router-dom": "^6.30.1",
    "react-window": "^2.2.2",
    "recharts": "^2.15.4",
    "sonner": "^1.7.4",
    "tailwind-merge": "^2.6.0",
    "tailwindcss-animate": "^1.0.7",
    "terser": "^5.44.0",
    "vaul": "^0.9.9",
    "zod": "^3.25.76"
  },
  "devDependencies": {
    "@eslint/js": "^9.32.0",
    "@tailwindcss/typography": "^0.5.16",
    "@types/dompurify": "^3.2.0",
    "@types/node": "^22.16.5",
    "@types/react": "^18.3.23",
    "@types/react-dom": "^18.3.7",
    "@types/react-window": "^2.0.0",
    "@vitejs/plugin-react-swc": "^3.11.0",
    "autoprefixer": "^10.4.21",
    "dotenv": "^17.2.3",
    "eslint": "^9.32.0",
    "eslint-plugin-react-hooks": "^5.2.0",
    "eslint-plugin-react-refresh": "^0.4.20",
    "globals": "^15.15.0",
    "lovable-tagger": "^1.1.9",
    "postcss": "^8.5.6",
    "supabase": "^2.54.11",
    "tailwindcss": "^3.4.17",
    "typescript": "^5.8.3",
    "typescript-eslint": "^8.38.0",
    "vite": "^5.4.19",
    "vite-plugin-pwa": "^1.1.0"
  }
}

----------------------------------------
ENDOFFILE: package.json

STARTOFFILE: postcss.config.js
----------------------------------------
export default {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
}

----------------------------------------
ENDOFFILE: postcss.config.js

STARTOFFILE: README.md
----------------------------------------
# ğŸ’° Zeni Wallet

**Gerenciamento Financeiro Inteligente, Pessoal e Compartilhado.**

<div align="center">
  <img src="https://img.shields.io/badge/React-18.0+-61DAFB?style=for-the-badge&logo=react" alt="React" />
  <img src="https://img.shields.io/badge/TypeScript-5.0+-3178C6?style=for-the-badge&logo=typescript" alt="TypeScript" />
  <img src="https://img.shields.io/badge/Supabase-2.0+-3ECF8E?style=for-the-badge&logo=supabase" alt="Supabase" />
  <img src="https://img.shields.io/badge/PWA-Ready-5A0FC8?style=for-the-badge&logo=pwa" alt="PWA" />
</div>

<br>

O **Zeni Wallet** Ã© uma plataforma completa para quem busca retomar o controle de suas finanÃ§as. Mais do que apenas registrar gastos, ele permite gerenciar investimentos, dividir despesas em grupo e planejar o futuro com metas claras, tudo em uma interface moderna e acessÃ­vel via navegador ou instalada como aplicativo (PWA).

---

## ğŸ‘¤ Para UsuÃ¡rios

### Por que usar o Zeni Wallet?

Cansado de planilhas complexas ou aplicativos que sÃ³ registram o passado? O Zeni Wallet foi desenhado para oferecer **clareza e previsibilidade**. Seja vocÃª um investidor iniciante, alguÃ©m organizando as contas de casa ou planejando uma viagem em grupo, esta Ã© a ferramenta ideal.

### âœ¨ Funcionalidades Atuais

#### **Dashboard Intuitivo**

- VisÃ£o geral do seu saldo, receitas, despesas e evoluÃ§Ã£o patrimonial em tempo real
- GrÃ¡ficos interativos para anÃ¡lise visual instantÃ¢nea
- Resumo mensal e anual de suas finanÃ§as

#### **GestÃ£o de TransaÃ§Ãµes**

- **CategorizaÃ§Ã£o** automÃ¡tica e personalizada
- **LanÃ§amentos Fixos**: Previsibilidade do seu saldo futuro com despesas recorrentes
- **Eventos**: Agrupe gastos de uma viagem ou reforma para saber exatamente quanto aquele projeto custou
- Filtros avanÃ§ados por data, categoria e valor

#### **Investimentos AvanÃ§ados**

- Controle de AÃ§Ãµes, FIIs, Renda Fixa e Criptomoedas
- CÃ¡lculo automÃ¡tico de rentabilidade e preÃ§o mÃ©dio
- DefiniÃ§Ã£o e acompanhamento de **Metas Financeiras** visuais
- AnÃ¡lise de performance da carteira

#### **Grupos e Compartilhamento**

- Crie grupos (ex: "Casa", "Viagem") para dividir despesas com amigos ou familiares
- Controle de quem pagou o quÃª com divisÃ£o automÃ¡tica
- RelatÃ³rios detalhados por membro do grupo
- Sistema de permissÃµes (administradores e membros)

#### **Lembretes Inteligentes**

- Receba **notificaÃ§Ãµes Push** (no celular ou PC) para nÃ£o esquecer de pagar contas
- Lembretes recorrentes para aportes e pagamentos fixos
- Funciona mesmo com o app fechado

#### **Modo Offline (PWA)**

- Instale o app no seu celular e acesse seus dados mesmo sem internet
- SincronizaÃ§Ã£o automÃ¡tica quando voltar online
- ExperiÃªncia nativa no Android e iOS

### ğŸš€ O Futuro do Zeni Wallet (Roadmap)

Estamos trabalhando constantemente para melhorar. Confira o que vem por aÃ­:

- **Open Finance**: ConexÃ£o automÃ¡tica com seus bancos para importaÃ§Ã£o de extratos
- **IA Financeira**: Insights personalizados sobre seus hÃ¡bitos de consumo e sugestÃµes de economia
- **RelatÃ³rios PDF**: ExportaÃ§Ã£o de dados para declaraÃ§Ã£o de imposto de renda
- **Marketplace de Templates**: Compartilhe e baixe templates de orÃ§amento da comunidade
- **IntegraÃ§Ã£o com CartÃµes**: Acompanhe seus gastos no cartÃ£o em tempo real

---

## ğŸ’» Para Desenvolvedores

O Zeni Wallet Ã© um projeto **Open Source** construÃ­do com as tecnologias mais modernas do ecossistema React, focando em performance, seguranÃ§a e escalabilidade.

### ğŸ› ï¸ Tecnologias e Ferramentas

#### **Frontend**

- **React 18** com Concurrent Features
- **TypeScript** para type safety
- **Vite** para build ultrarrÃ¡pido
- **Tailwind CSS** para estilizaÃ§Ã£o utility-first
- **Shadcn/ui** (baseado em Radix UI) para componentes acessÃ­veis

#### **Gerenciamento de Estado & Data**

- **TanStack Query** (React Query) para cache e sincronizaÃ§Ã£o eficiente
- **Context API** para estado global leve
- **Zod** para validaÃ§Ã£o de schemas

#### **Backend & Infraestrutura**

- **Supabase** (PostgreSQL, Authentication, Realtime, Edge Functions)
- **Row Level Security (RLS)** para seguranÃ§a em nÃ­vel de banco
- **Triggers PostgreSQL** para cÃ¡lculos automÃ¡ticos

#### **SeguranÃ§a**

- SanitizaÃ§Ã£o de inputs contra XSS/SQL Injection
- Rate Limiting no client-side
- ValidaÃ§Ã£o dupla (frontend + backend)
- PolÃ­ticas RLS para isolamento de dados

#### **PWA & Performance**

- **vite-plugin-pwa** com Service Workers customizados
- Suporte offline completo
- **Web Push API** para notificaÃ§Ãµes
- Code splitting e lazy loading
- React Window para virtualizaÃ§Ã£o de listas

#### **VisualizaÃ§Ã£o de Dados**

- **Recharts** para grÃ¡ficos interativos
- Dashboards responsivos e performÃ¡ticos

### ğŸ—‚ï¸ Arquitetura do Projeto

A estrutura de pastas segue um padrÃ£o modular e escalÃ¡vel:

```bash
src/
â”œâ”€â”€ components/        # Componentes UI (Shadcn) e funcionais
â”‚   â”œâ”€â”€ dialogs/      # Modais de criaÃ§Ã£o/ediÃ§Ã£o (TransaÃ§Ãµes, Investimentos)
â”‚   â”œâ”€â”€ dashboard/    # Cards e widgets especÃ­ficos da home
â”‚   â”œâ”€â”€ groups/       # Componentes relacionados a grupos
â”‚   â”œâ”€â”€ layout/       # Sidebar, Headers, Layouts
â”‚   â””â”€â”€ ui/          # Componentes base (Button, Input, Card)
â”œâ”€â”€ contexts/        # Context API (AuthContext)
â”œâ”€â”€ hooks/          # Custom Hooks (useAuth, useReminders, usePWA)
â”œâ”€â”€ pages/          # Rotas da aplicaÃ§Ã£o (Dashboard, Transactions, etc.)
â”œâ”€â”€ services/       # Camada de serviÃ§o (Regras de negÃ³cio e chamadas API)
â”œâ”€â”€ utils/          # UtilitÃ¡rios de data, formataÃ§Ã£o e seguranÃ§a
â”‚   â”œâ”€â”€ services/   # ServiÃ§os especÃ­ficos (push notifications, reminders)
â”‚   â””â”€â”€ types/      # TypeScript types e interfaces
â”œâ”€â”€ integrations/   # ConfiguraÃ§Ã£o do cliente Supabase
â””â”€â”€ sw.ts          # Service Worker customizado
```

### âš™ï¸ InstalaÃ§Ã£o e ConfiguraÃ§Ã£o

#### PrÃ©-requisitos

- Node.js 18+ e npm/yarn
- Conta no [Supabase](https://supabase.com)

#### 1. Clone o repositÃ³rio:

```bash
git clone https://github.com/seu-usuario/zeni-wallet.git
cd zeni-wallet
```

#### 2. Instale as dependÃªncias:

```bash
npm install
```

#### 3. VariÃ¡veis de Ambiente:

Crie um arquivo `.env` na raiz e configure suas credenciais:

```env
VITE_SUPABASE_URL=sua_url_supabase
VITE_SUPABASE_PUBLISHABLE_KEY=sua_key_anon
VITE_VAPID_PUBLIC_KEY=sua_chave_publica_webpush
```

#### 4. Execute o projeto:

```bash
npm run dev       # Desenvolvimento
npm run build     # Build de produÃ§Ã£o
npm run preview   # Preview da build
```

### ğŸ—„ï¸ ConfiguraÃ§Ã£o do Supabase

Para que o Zeni Wallet funcione corretamente, vocÃª precisa configurar seu projeto Supabase com as tabelas, polÃ­ticas RLS, triggers e funÃ§Ãµes necessÃ¡rias.

#### ğŸ“Š 1. Estrutura do Banco de Dados

Execute as seguintes queries SQL no SQL Editor do Supabase para criar as tabelas principais:

```sql
-- Tabela de perfis de usuÃ¡rios
CREATE TABLE profiles (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID UNIQUE REFERENCES auth.users ON DELETE CASCADE,
  full_name TEXT,
  avatar_url TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Tabela de grupos
CREATE TABLE groups (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name TEXT NOT NULL,
  description TEXT,
  color TEXT,
  created_by UUID REFERENCES auth.users ON DELETE CASCADE,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Tabela de membros dos grupos
CREATE TABLE group_members (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  group_id UUID REFERENCES groups ON DELETE CASCADE,
  user_id UUID REFERENCES auth.users ON DELETE CASCADE,
  is_admin BOOLEAN DEFAULT false,
  joined_at TIMESTAMPTZ DEFAULT NOW(),
  UNIQUE(group_id, user_id)
);

-- Tabela de transaÃ§Ãµes
CREATE TABLE transactions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users ON DELETE CASCADE,
  description TEXT NOT NULL,
  amount NUMERIC(10, 2) NOT NULL,
  type TEXT NOT NULL CHECK (type IN ('income', 'expense')),
  category TEXT NOT NULL,
  date DATE DEFAULT CURRENT_DATE,
  group_id UUID REFERENCES groups ON DELETE SET NULL,
  is_fixed BOOLEAN DEFAULT false,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Tabela de investimentos
CREATE TABLE investments (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users ON DELETE CASCADE,
  name TEXT NOT NULL,
  type TEXT NOT NULL,
  amount NUMERIC(10, 2) NOT NULL,
  current_value NUMERIC(10, 2) NOT NULL,
  quantity NUMERIC(10, 4),
  unit_price NUMERIC(10, 4),
  maturity_date DATE,
  group_id UUID REFERENCES groups ON DELETE SET NULL,
  goal_id UUID REFERENCES investment_goals ON DELETE SET NULL,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Tabela de metas de investimento
CREATE TABLE investment_goals (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users ON DELETE CASCADE,
  name TEXT NOT NULL,
  description TEXT,
  target_amount NUMERIC(10, 2) NOT NULL,
  current_amount NUMERIC(10, 2) DEFAULT 0,
  target_date DATE,
  color TEXT,
  priority INTEGER DEFAULT 0,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Tabela de lembretes
CREATE TABLE reminders (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users ON DELETE CASCADE,
  transaction_id UUID REFERENCES transactions ON DELETE CASCADE,
  title TEXT NOT NULL,
  description TEXT,
  reminder_date TIMESTAMPTZ NOT NULL,
  is_completed BOOLEAN DEFAULT false,
  is_notified BOOLEAN DEFAULT false,
  notification_sent_at TIMESTAMPTZ,
  repeat_type TEXT DEFAULT 'none',
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Tabela de inscriÃ§Ãµes para push notifications
CREATE TABLE push_subscriptions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users ON DELETE CASCADE,
  endpoint TEXT UNIQUE NOT NULL,
  p256dh TEXT NOT NULL,
  auth TEXT NOT NULL,
  user_agent TEXT,
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);
```

#### ğŸ”’ 2. PolÃ­ticas de SeguranÃ§a RLS (Row Level Security)

Ative o RLS em todas as tabelas e configure as polÃ­ticas:

```sql
-- Ativar RLS em todas as tabelas
ALTER TABLE profiles ENABLE ROW LEVEL SECURITY;
ALTER TABLE groups ENABLE ROW LEVEL SECURITY;
ALTER TABLE group_members ENABLE ROW LEVEL SECURITY;
ALTER TABLE transactions ENABLE ROW LEVEL SECURITY;
ALTER TABLE investments ENABLE ROW LEVEL SECURITY;
ALTER TABLE investment_goals ENABLE ROW LEVEL SECURITY;
ALTER TABLE reminders ENABLE ROW LEVEL SECURITY;
ALTER TABLE push_subscriptions ENABLE ROW LEVEL SECURITY;

-- PolÃ­ticas para profiles
CREATE POLICY "Users can view own profile" ON profiles
  FOR SELECT USING (auth.uid() = user_id);

CREATE POLICY "Users can update own profile" ON profiles
  FOR UPDATE USING (auth.uid() = user_id);

-- PolÃ­ticas para groups
CREATE POLICY "Users can view groups they belong to" ON groups
  FOR SELECT USING (
    auth.uid() = created_by OR
    EXISTS (
      SELECT 1 FROM group_members
      WHERE group_id = groups.id AND user_id = auth.uid()
    )
  );

CREATE POLICY "Users can create groups" ON groups
  FOR INSERT WITH CHECK (auth.uid() = created_by);

CREATE POLICY "Only creators can update groups" ON groups
  FOR UPDATE USING (auth.uid() = created_by);

CREATE POLICY "Only creators can delete groups" ON groups
  FOR DELETE USING (auth.uid() = created_by);

-- PolÃ­ticas para group_members
CREATE POLICY "Members can view group members" ON group_members
  FOR SELECT USING (
    EXISTS (
      SELECT 1 FROM group_members gm
      WHERE gm.group_id = group_members.group_id
      AND gm.user_id = auth.uid()
    )
  );

CREATE POLICY "Group creators can manage members" ON group_members
  FOR ALL USING (
    EXISTS (
      SELECT 1 FROM groups
      WHERE id = group_members.group_id
      AND created_by = auth.uid()
    )
  );

-- PolÃ­ticas para transactions
CREATE POLICY "Users can view own and group transactions" ON transactions
  FOR SELECT USING (
    user_id = auth.uid() OR
    (group_id IS NOT NULL AND EXISTS (
      SELECT 1 FROM group_members
      WHERE group_id = transactions.group_id
      AND user_id = auth.uid()
    ))
  );

CREATE POLICY "Users can create own transactions" ON transactions
  FOR INSERT WITH CHECK (auth.uid() = user_id);

CREATE POLICY "Users can update own transactions" ON transactions
  FOR UPDATE USING (auth.uid() = user_id);

CREATE POLICY "Users can delete own transactions" ON transactions
  FOR DELETE USING (auth.uid() = user_id);

-- PolÃ­ticas similares para as demais tabelas...
```

#### âš™ï¸ 3. FunÃ§Ãµes Auxiliares

Crie funÃ§Ãµes Ãºteis para operaÃ§Ãµes complexas:

```sql
-- FunÃ§Ã£o para verificar se usuÃ¡rio Ã© criador do grupo
CREATE OR REPLACE FUNCTION is_group_creator(_group_id UUID)
RETURNS BOOLEAN AS $$
  SELECT EXISTS (
    SELECT 1 FROM groups
    WHERE id = _group_id
    AND created_by = auth.uid()
  );
$$ LANGUAGE SQL SECURITY DEFINER;

-- FunÃ§Ã£o para verificar se usuÃ¡rio Ã© membro do grupo
CREATE OR REPLACE FUNCTION is_group_member(_group_id UUID)
RETURNS BOOLEAN AS $$
  SELECT EXISTS (
    SELECT 1 FROM group_members
    WHERE group_id = _group_id
    AND user_id = auth.uid()
  );
$$ LANGUAGE SQL SECURITY DEFINER;

-- FunÃ§Ã£o para atualizar current_amount nas metas
CREATE OR REPLACE FUNCTION update_goal_current_amount()
RETURNS TRIGGER AS $$
BEGIN
  IF TG_OP = 'INSERT' OR TG_OP = 'UPDATE' THEN
    UPDATE investment_goals
    SET current_amount = (
      SELECT COALESCE(SUM(current_value), 0)
      FROM investments
      WHERE goal_id = NEW.goal_id
    ),
    updated_at = NOW()
    WHERE id = NEW.goal_id;
  END IF;

  IF TG_OP = 'DELETE' OR TG_OP = 'UPDATE' THEN
    UPDATE investment_goals
    SET current_amount = (
      SELECT COALESCE(SUM(current_value), 0)
      FROM investments
      WHERE goal_id = OLD.goal_id
    ),
    updated_at = NOW()
    WHERE id = OLD.goal_id;
  END IF;

  RETURN NULL;
END;
$$ LANGUAGE plpgsql;
```

#### ğŸ”„ 4. Triggers

Configure triggers para automaÃ§Ãµes:

```sql
-- Trigger para criar perfil automaticamente
CREATE OR REPLACE FUNCTION handle_new_user()
RETURNS TRIGGER AS $$
BEGIN
  INSERT INTO public.profiles (user_id, full_name)
  VALUES (NEW.id, NEW.raw_user_meta_data->>'full_name');
  RETURN NEW;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

CREATE TRIGGER on_auth_user_created
  AFTER INSERT ON auth.users
  FOR EACH ROW EXECUTE FUNCTION handle_new_user();

-- Trigger para atualizar metas de investimento
CREATE TRIGGER update_goal_on_investment_change
  AFTER INSERT OR UPDATE OR DELETE ON investments
  FOR EACH ROW
  EXECUTE FUNCTION update_goal_current_amount();

-- Trigger para adicionar criador como admin do grupo
CREATE OR REPLACE FUNCTION add_creator_as_admin()
RETURNS TRIGGER AS $$
BEGIN
  INSERT INTO group_members (group_id, user_id, is_admin)
  VALUES (NEW.id, NEW.created_by, true);
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER add_creator_to_group
  AFTER INSERT ON groups
  FOR EACH ROW EXECUTE FUNCTION add_creator_as_admin();
```

#### â° 5. ConfiguraÃ§Ã£o de Edge Functions e Cron Jobs

Para notificaÃ§Ãµes push e tarefas agendadas:

##### a) Crie a Edge Function para verificar lembretes:

No diretÃ³rio `supabase/functions/check-reminders/index.ts`:

```typescript
// Veja o arquivo completo no projeto
// Esta funÃ§Ã£o verifica lembretes pendentes e envia push notifications
```

##### b) Configure o Cron Job no Supabase:

```sql
-- Ativa a extensÃ£o pg_cron se ainda nÃ£o estiver ativa
CREATE EXTENSION IF NOT EXISTS pg_cron;

-- Cria o job para verificar lembretes a cada 5 minutos
SELECT cron.schedule(
  'check-reminders', -- nome do job
  '*/5 * * * *', -- a cada 5 minutos
  $$
    SELECT net.http_post(
      url:='https://seu-projeto.supabase.co/functions/v1/check-reminders',
      headers:=jsonb_build_object(
        'Authorization', 'Bearer ' || current_setting('app.settings.service_role_key'),
        'Content-Type', 'application/json'
      ),
      body:=jsonb_build_object('time', now())
    );
  $$
);
```

#### ğŸ”‘ 6. ConfiguraÃ§Ã£o de AutenticaÃ§Ã£o

No painel do Supabase:

1. **Email/Senha**: Ative em Authentication > Providers
2. **Email Templates**: Personalize os templates em portuguÃªs
3. **URL Configuration**: Configure as URLs de redirecionamento:
   - Site URL: `https://seu-dominio.com`
   - Redirect URLs: `https://seu-dominio.com/auth/callback`

#### ğŸš€ 7. ConfiguraÃ§Ã£o para PWA e Push Notifications

1. **Gere as chaves VAPID** para push notifications:

```bash
npx web-push generate-vapid-keys
```

2. **Configure os secrets no Supabase**:

```bash
supabase secrets set VAPID_PUBLIC_KEY=sua_chave_publica
supabase secrets set VAPID_PRIVATE_KEY=sua_chave_privada
```

3. **Configure o domÃ­nio permitido** para Service Workers nas configuraÃ§Ãµes do projeto

#### ğŸ“ 8. Migrations e Versionamento

Mantenha suas migrations organizadas:

```bash
# Criar nova migration
supabase migration new nome_da_migration

# Aplicar migrations localmente
supabase db push

# Aplicar em produÃ§Ã£o
supabase db push --db-url postgresql://...
```

#### âœ… 9. Checklist de ConfiguraÃ§Ã£o

- [ ] Todas as tabelas criadas
- [ ] RLS ativado em todas as tabelas
- [ ] PolÃ­ticas RLS configuradas
- [ ] FunÃ§Ãµes auxiliares criadas
- [ ] Triggers configurados
- [ ] Edge Functions deployadas
- [ ] Cron jobs agendados
- [ ] AutenticaÃ§Ã£o configurada
- [ ] Chaves VAPID geradas e configuradas
- [ ] VariÃ¡veis de ambiente configuradas no `.env`

Com todas essas configuraÃ§Ãµes, seu Zeni Wallet estarÃ¡ pronto para funcionar com seguranÃ§a total e todas as funcionalidades habilitadas!

### ğŸ› Reportando Bugs

Encontrou um problema? Por favor, abra uma [Issue](https://github.com/seu-usuario/zeni-wallet/issues) no GitHub seguindo este modelo:

**TÃ­tulo**: DescriÃ§Ã£o concisa do erro

**InformaÃ§Ãµes**:

- **Passos para reproduzir**: Como podemos ver o erro acontecendo?
- **Comportamento esperado vs. real**
- **Screenshots**: Se possÃ­vel, adicione imagens
- **Ambiente**: (Desktop/Mobile, Navegador, VersÃ£o)
- **Console errors**: Erros do console do navegador

### ğŸ¤ Como Contribuir (Pull Requests)

Quer ajudar a evoluir o Zeni Wallet? Adoramos contribuiÃ§Ãµes!

#### Processo de ContribuiÃ§Ã£o:

1. **Fork** o projeto
2. Crie uma **Branch** para sua feature (`git checkout -b feature/nova-funcionalidade`)
3. **Commit** suas mudanÃ§as (`git commit -m 'feat: Adiciona nova funcionalidade'`)
4. **Push** para a Branch (`git push origin feature/nova-funcionalidade`)
5. Abra um **Pull Request**

#### PadrÃµes de CÃ³digo:

- **Commits**: Use [Conventional Commits](https://www.conventionalcommits.org/)

  - `feat:` Nova funcionalidade
  - `fix:` CorreÃ§Ã£o de bug
  - `docs:` DocumentaÃ§Ã£o
  - `style:` FormataÃ§Ã£o
  - `refactor:` RefatoraÃ§Ã£o
  - `test:` Testes
  - `chore:` Tarefas gerais

- **TypeScript**: Sempre tipar completamente (evite `any`)
- **Componentes**: Use functional components com hooks
- **EstilizaÃ§Ã£o**: Tailwind classes (evite CSS inline)
- **SeguranÃ§a**: Sempre sanitize inputs do usuÃ¡rio

#### Dicas para Devs:

âœ… **DO's**:

- Utilize os componentes de UI existentes em `src/components/ui`
- Use `useSanitizedForm` para formulÃ¡rios
- Implemente loading states e error handling
- Teste em mobile primeiro (mobile-first)
- Adicione comentÃ¡rios JSDoc para funÃ§Ãµes complexas

âŒ **DON'Ts**:

- NÃ£o commitar `.env` ou secrets
- NÃ£o usar `console.log` em produÃ§Ã£o
- NÃ£o fazer queries diretas sem RLS
- NÃ£o ignorar TypeScript errors

### ğŸ§ª Testes

```bash
npm run test        # Executa os testes
npm run test:watch  # Modo watch
npm run test:coverage # RelatÃ³rio de cobertura
```

### ğŸ“š DocumentaÃ§Ã£o Adicional

- [ConfiguraÃ§Ã£o do Supabase](./docs/supabase-setup.md)
- [Guia de ContribuiÃ§Ã£o Detalhado](./docs/contributing.md)
- [Arquitetura e DecisÃµes TÃ©cnicas](./docs/architecture.md)
- [SeguranÃ§a e Boas PrÃ¡ticas](./docs/security.md)

### ğŸŒŸ Showcase

Usando o Zeni Wallet em produÃ§Ã£o? Adicione seu caso de uso [aqui](https://github.com/seu-usuario/zeni-wallet/discussions/categories/showcase)!

---

## ğŸ“„ LicenÃ§a

Este projeto estÃ¡ sob a licenÃ§a **MIT**. Consulte o arquivo [LICENSE](./LICENSE) para mais detalhes.

---

<p align="center">
  Feito com ğŸ’š para organizar sua vida financeira<br>
  <sub>Contribua com o projeto e ajude milhares de pessoas a terem controle financeiro!</sub>
</p>

<div align="center">
  <a href="https://github.com/seu-usuario/zeni-wallet/stargazers">â­ DÃª uma estrela</a> â€¢
  <a href="https://github.com/seu-usuario/zeni-wallet/issues">ğŸ› Reportar Bug</a> â€¢
  <a href="https://github.com/seu-usuario/zeni-wallet/discussions">ğŸ’¬ DiscussÃµes</a>
</div>

----------------------------------------
ENDOFFILE: README.md

STARTOFFILE: src\App.tsx
----------------------------------------
import { lazy, Suspense } from "react";
import { BrowserRouter, Routes, Route } from "react-router-dom";
import { QueryClient, QueryClientProvider } from "@tanstack/react-query";
import { Toaster } from "@/components/ui/toaster";
import { Toaster as Sonner } from "@/components/ui/sonner";
import { TooltipProvider } from "@/components/ui/tooltip";
import { ThemeProvider } from "@/components/theme-provider";

import { ProtectedRoute } from "@/components/auth/ProtectedRoute";
import { LoadingFallback } from "./components/LoadingFallback";

const Index = lazy(() => import("./pages/Index"));
const Auth = lazy(() => import("./pages/Auth"));
const Dashboard = lazy(() => import("./pages/Dashboard"));
const Transactions = lazy(() => import("./pages/Transactions"));
const Investments = lazy(() => import("./pages/Investments"));
const Groups = lazy(() => import("./pages/Groups"));
const JoinGroup = lazy(() => import("./pages/JoinGroup")); // NOVA PÃGINA
const NotFound = lazy(() => import("./pages/NotFound"));
const Reminder = lazy(() => import("./pages/Reminders"));
const Profile = lazy(() => import("./pages/Profile"));

const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      staleTime: 1000 * 60 * 5,
      gcTime: 1000 * 60 * 10,
      refetchOnWindowFocus: false,
      retry: 1,
    },
  },
});

const App = () => (
  <QueryClientProvider client={queryClient}>
    <ThemeProvider defaultTheme="system" storageKey="zeni-theme">
      <TooltipProvider>
        <Toaster />
        <Sonner />
        <BrowserRouter>
          <Suspense fallback={<LoadingFallback />}>
            <Routes>
              <Route path="/" element={<Index />} />
              <Route path="/auth" element={<Auth />} />
              
              {/* ROTA DE PROTEÃ‡ÃƒO */}
              <Route
                path="/dashboard"
                element={
                  <ProtectedRoute>
                    <Dashboard />
                  </ProtectedRoute>
                }
              />
              <Route
                path="/transactions"
                element={
                  <ProtectedRoute>
                    <Transactions />
                  </ProtectedRoute>
                }
              />
              <Route
                path="/investments"
                element={
                  <ProtectedRoute>
                    <Investments />
                  </ProtectedRoute>
                }
              />
              <Route
                path="/groups"
                element={
                  <ProtectedRoute>
                    <Groups />
                  </ProtectedRoute>
                }
              />
              
              {/* NOVA ROTA PARA ENTRAR NO GRUPO VIA LINK */}
              <Route
                path="/groups/join/:inviteId"
                element={
                    <JoinGroup />
                }
              />

              <Route
                path="/reminders"
                element={
                  <ProtectedRoute>
                    <Reminder />
                  </ProtectedRoute>
                }
              />
              <Route
                path="/profile"
                element={
                  <ProtectedRoute>
                    <Profile />
                  </ProtectedRoute>
                }
              />
              <Route path="*" element={<NotFound />} />
            </Routes>
          </Suspense>
        </BrowserRouter>
      </TooltipProvider>
    </ThemeProvider>
  </QueryClientProvider>
);

export default App;
----------------------------------------
ENDOFFILE: src\App.tsx

STARTOFFILE: src\components\auth\ProtectedRoute.tsx
----------------------------------------
import { Navigate } from 'react-router-dom';
import { useAuth } from '@/contexts/AuthContext';

interface ProtectedRouteProps {
  children: React.ReactNode;
}

export const ProtectedRoute = ({ children }: ProtectedRouteProps) => {
  const { user, loading } = useAuth();

  if (loading) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
      </div>
    );
  }

  if (!user) {
    return <Navigate to="/auth" replace />;
  }

  return <>{children}</>;
};
----------------------------------------
ENDOFFILE: src\components\auth\ProtectedRoute.tsx

STARTOFFILE: src\components\dashboard\FixedBalanceCard.tsx
----------------------------------------
import { useState, useEffect } from "react";
import { DollarSign, TrendingUp, TrendingDown, ChevronLeft, ChevronRight } from "@/lib/icons";
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { Button } from "@/components/ui/button";
import { supabase } from "@/integrations/supabase/client";
import { useToast } from "@/hooks/use-toast";
import { cn } from "@/lib/utils";

interface FixedTransaction {
  id: string;
  description: string;
  amount: number;
  type: "income" | "expense";
  category: string;
  recurrence_id: string;
}

const ITEMS_PER_PAGE = 5;

export const FixedBalanceCard = () => {
  const [fixedIncome, setFixedIncome] = useState<FixedTransaction[]>([]);
  const [fixedExpenses, setFixedExpenses] = useState<FixedTransaction[]>([]);
  const [loading, setLoading] = useState(true);
  const [incomePage, setIncomePage] = useState(1);
  const [expensePage, setExpensePage] = useState(1);
  const { toast } = useToast();

  useEffect(() => {
    loadFixedTransactions();
  }, []);

  const loadFixedTransactions = async () => {
    try {
      const {
        data: { user },
      } = await supabase.auth.getUser();
      if (!user) return;

      const { data, error } = await supabase
        .from("transactions")
        .select("id, description, amount, type, category, recurrence_id")
        .eq("user_id", user.id)
        .eq("is_fixed", true)
        .order("description", { ascending: true });

      if (error) throw error;

      const uniqueTransactions = new Map<string, FixedTransaction>();
      data?.forEach((t) => {
        const amount = typeof t.amount === "number" ? t.amount : parseFloat(t.amount || "0");
        if (!uniqueTransactions.has(t.recurrence_id)) {
          uniqueTransactions.set(t.recurrence_id, {
            id: t.id,
            description: t.description,
            amount: amount,
            type: t.type as "income" | "expense",
            category: t.category,
            recurrence_id: t.recurrence_id,
          });
        }
      });

      const uniqueArray = Array.from(uniqueTransactions.values());
      const income = uniqueArray.filter((t) => t.type === "income");
      const expenses = uniqueArray.filter((t) => t.type === "expense");

      setFixedIncome(income);
      setFixedExpenses(expenses);
    } catch (error) {
      console.error("Erro ao carregar lanÃ§amentos fixos:", error);
      toast({
        title: "Erro",
        description: "Erro ao carregar balanÃ§o fixo",
        variant: "destructive",
      });
    } finally {
      setLoading(false);
    }
  };

  const totalFixedIncome = fixedIncome.reduce((sum, t) => sum + t.amount, 0);
  const totalFixedExpenses = Math.abs(fixedExpenses.reduce((sum, t) => sum + t.amount, 0));
  const fixedBalance = totalFixedIncome - totalFixedExpenses;

  const totalIncomePages = Math.ceil(fixedIncome.length / ITEMS_PER_PAGE);
  const paginatedIncome = fixedIncome.slice((incomePage - 1) * ITEMS_PER_PAGE, incomePage * ITEMS_PER_PAGE);

  const totalExpensePages = Math.ceil(fixedExpenses.length / ITEMS_PER_PAGE);
  const paginatedExpenses = fixedExpenses.slice((expensePage - 1) * ITEMS_PER_PAGE, expensePage * ITEMS_PER_PAGE);

  const handlePrevIncomePage = () => setIncomePage((prev) => Math.max(prev - 1, 1));
  const handleNextIncomePage = () => setIncomePage((prev) => Math.min(prev + 1, totalIncomePages));
  const handlePrevExpensePage = () => setExpensePage((prev) => Math.max(prev - 1, 1));
  const handleNextExpensePage = () => setExpensePage((prev) => Math.min(prev + 1, totalExpensePages));

  if (loading) {
    return (
      <Card>
        <CardHeader>
          <CardTitle>BalanÃ§o Fixo Mensal</CardTitle>
        </CardHeader>
        <CardContent>
          <div className="animate-pulse space-y-2">
            <div className="h-4 bg-muted rounded"></div>
            <div className="h-4 bg-muted rounded"></div>
            <div className="h-4 bg-muted rounded"></div>
          </div>
        </CardContent>
      </Card>
    );
  }

  return (
    <Card>
      <CardHeader>
        <CardTitle className="flex items-center gap-2">
          <DollarSign className="h-5 w-5" />
          BalanÃ§o Fixo Mensal
        </CardTitle>
        <CardDescription>Receitas e despesas fixas que se repetem todos os meses</CardDescription>
      </CardHeader>
      <CardContent className="space-y-6">
        <div className="space-y-4">
          {/* Receitas Fixas */}
          <div>
            <div className="flex items-center justify-between mb-3">
              <h4 className="text-sm font-semibold flex items-center gap-2">
                <TrendingUp className="h-4 w-4 text-success" />
                Receitas Fixas
              </h4>
              <Badge variant="outline" className="text-success">
                {totalFixedIncome.toLocaleString("pt-BR", {
                  style: "currency",
                  currency: "BRL",
                })}
              </Badge>
            </div>
            <div className="space-y-2 min-h-[180px]">
              {" "}
              {paginatedIncome.length === 0 ? (
                <p className="text-xs text-muted-foreground text-center py-2">Nenhuma receita fixa cadastrada</p>
              ) : (
                paginatedIncome.map((transaction) => (
                  <div key={transaction.recurrence_id} className="flex items-center justify-between p-2 rounded-md bg-muted/30">
                    <div className="flex-1 overflow-hidden mr-2">
                      <p className="text-sm font-medium truncate" title={transaction.description}>
                        {transaction.description}
                      </p>
                      <p className="text-xs text-muted-foreground truncate" title={transaction.category}>
                        {transaction.category}
                      </p>
                    </div>
                    <span className="text-sm font-semibold text-success whitespace-nowrap">
                      +
                      {transaction.amount.toLocaleString("pt-BR", {
                        style: "currency",
                        currency: "BRL",
                      })}
                    </span>
                  </div>
                ))
              )}
            </div>
            {totalIncomePages > 1 && (
              <div className="flex items-center justify-end gap-2 mt-3">
                <span className="text-xs text-muted-foreground">
                  PÃ¡gina {incomePage} de {totalIncomePages}
                </span>
                <Button variant="outline" size="icon" className="h-7 w-7" onClick={handlePrevIncomePage} disabled={incomePage === 1}>
                  <ChevronLeft className="h-4 w-4" />
                </Button>
                <Button
                  variant="outline"
                  size="icon"
                  className="h-7 w-7"
                  onClick={handleNextIncomePage}
                  disabled={incomePage === totalIncomePages}
                >
                  <ChevronRight className="h-4 w-4" />
                </Button>
              </div>
            )}
          </div>

          <div>
            <div className="flex items-center justify-between mb-3">
              <h4 className="text-sm font-semibold flex items-center gap-2">
                <TrendingDown className="h-4 w-4 text-destructive" />
                Despesas Fixas
              </h4>
              <Badge variant="outline" className="text-destructive">
                -
                {totalFixedExpenses.toLocaleString("pt-BR", {
                  style: "currency",
                  currency: "BRL",
                })}
              </Badge>
            </div>
            <div className="space-y-2 min-h-[180px]">
              {" "}
              {paginatedExpenses.length === 0 ? (
                <p className="text-xs text-muted-foreground text-center py-2">Nenhuma despesa fixa cadastrada</p>
              ) : (
                paginatedExpenses.map((transaction) => (
                  <div key={transaction.recurrence_id} className="flex items-center justify-between p-2 rounded-md bg-muted/30">
                    <div className="flex-1 overflow-hidden mr-2">
                      <p className="text-sm font-medium truncate" title={transaction.description}>
                        {transaction.description}
                      </p>
                      <p className="text-xs text-muted-foreground truncate" title={transaction.category}>
                        {transaction.category}
                      </p>
                    </div>
                    <span className="text-sm font-semibold text-destructive whitespace-nowrap">
                      {Math.abs(transaction.amount).toLocaleString("pt-BR", {
                        style: "currency",
                        currency: "BRL",
                      })}
                    </span>
                  </div>
                ))
              )}
            </div>
            {totalExpensePages > 1 && (
              <div className="flex items-center justify-end gap-2 mt-3">
                <span className="text-xs text-muted-foreground">
                  PÃ¡gina {expensePage} de {totalExpensePages}
                </span>
                <Button variant="outline" size="icon" className="h-7 w-7" onClick={handlePrevExpensePage} disabled={expensePage === 1}>
                  <ChevronLeft className="h-4 w-4" />
                </Button>
                <Button
                  variant="outline"
                  size="icon"
                  className="h-7 w-7"
                  onClick={handleNextExpensePage}
                  disabled={expensePage === totalExpensePages}
                >
                  <ChevronRight className="h-4 w-4" />
                </Button>
              </div>
            )}
          </div>
        </div>

        <div className="pt-4 border-t">
          <div className="flex items-center justify-between">
            <h4 className="font-semibold">BalanÃ§o Mensal Fixo</h4>
            <span className={cn("text-lg font-bold", fixedBalance >= 0 ? "text-success" : "text-destructive")}>
              {fixedBalance.toLocaleString("pt-BR", {
                style: "currency",
                currency: "BRL",
              })}
            </span>
          </div>
          <p className="text-xs text-muted-foreground mt-1">
            {fixedBalance >= 0
              ? "VocÃª terÃ¡ este valor positivo mensalmente (com base nos lanÃ§amentos fixos)"
              : "VocÃª terÃ¡ este dÃ©ficit mensalmente (com base nos lanÃ§amentos fixos)"}
          </p>
        </div>
      </CardContent>
    </Card>
  );
};

----------------------------------------
ENDOFFILE: src\components\dashboard\FixedBalanceCard.tsx

STARTOFFILE: src\components\dashboard\MetricCard.tsx
----------------------------------------
import { ReactNode } from "react";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { cn } from "@/lib/utils";

interface MetricCardProps {
  title: string;
  value: string;
  icon: ReactNode;
  change?: string;
  changeType?: "positive" | "negative" | "neutral";
  className?: string;
}

export const MetricCard = ({ 
  title, 
  value, 
  icon, 
  change, 
  changeType = "neutral",
  className 
}: MetricCardProps) => {
  return (
    <Card className={cn("relative overflow-hidden", className)}>
      <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
        <CardTitle className="text-sm font-medium text-muted-foreground">
          {title}
        </CardTitle>
        <div className="p-2 bg-primary/10 rounded-full">
          {icon}
        </div>
      </CardHeader>
      <CardContent>
        <div className="text-2xl font-bold">{value}</div>
        {change && (
          <p className={cn(
            "text-xs mt-1",
            changeType === "positive" && "text-success",
            changeType === "negative" && "text-destructive",
            changeType === "neutral" && "text-muted-foreground"
          )}>
            {change}
          </p>
        )}
      </CardContent>
    </Card>
  );
};
----------------------------------------
ENDOFFILE: src\components\dashboard\MetricCard.tsx

STARTOFFILE: src\components\dashboard\TransactionsList.tsx
----------------------------------------
import { useState, useEffect } from "react";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { ArrowUpCircle, ArrowDownCircle, Calendar } from "@/lib/icons";
import { cn } from "@/lib/utils";
import { supabase } from "@/integrations/supabase/client";
import { useToast } from "@/hooks/use-toast";

interface Transaction {
  id: string;
  description: string;
  amount: number;
  type: "income" | "expense";
  category: string;
  date: string;
  group?: {
    name: string;
  };
}

export const TransactionsList = () => {
  const [transactions, setTransactions] = useState<Transaction[]>([]);
  const [loading, setLoading] = useState(true);
  const { toast } = useToast();

  useEffect(() => {
    loadTransactions();
  }, []);

  const loadTransactions = async () => {
    try {
      const { data, error } = await supabase
        .from("transactions")
        .select(
          `
          id,
          description,
          amount,
          type,
          category,
          date,
          group_id,
          groups!left (
            name
          )
        `
        )
        .order("date", { ascending: false })
        .limit(5);

      if (error) throw error;

      const formattedTransactions =
        data?.map((transaction) => ({
          id: transaction.id,
          description: transaction.description,
          amount: Number(transaction.amount),
          type: transaction.type as "income" | "expense",
          category: transaction.category,
          date: transaction.date,
          group: transaction.groups ? { name: transaction.groups.name } : undefined,
        })) || [];

      setTransactions(formattedTransactions);
    } catch (error) {
      console.error("Erro ao carregar transaÃ§Ãµes:", error);
      toast({
        variant: "destructive",
        title: "Erro",
        description: "NÃ£o foi possÃ­vel carregar as transaÃ§Ãµes",
      });
    } finally {
      setLoading(false);
    }
  };

  if (loading) {
    return (
      <Card>
        <CardHeader>
          <CardTitle className="flex items-center gap-2">
            <Calendar className="h-5 w-5" />
            TransaÃ§Ãµes Recentes
          </CardTitle>
        </CardHeader>
        <CardContent>
          <div className="space-y-4">
            {[...Array(3)].map((_, i) => (
              <div key={i} className="flex items-center justify-between p-3 rounded-lg border border-border">
                <div className="flex items-center gap-3">
                  <div className="w-10 h-10 bg-muted rounded-full animate-pulse" />
                  <div>
                    <div className="w-32 h-4 bg-muted rounded animate-pulse mb-2" />
                    <div className="w-20 h-3 bg-muted rounded animate-pulse" />
                  </div>
                </div>
                <div className="text-right">
                  <div className="w-20 h-4 bg-muted rounded animate-pulse mb-2" />
                  <div className="w-16 h-3 bg-muted rounded animate-pulse" />
                </div>
              </div>
            ))}
          </div>
        </CardContent>
      </Card>
    );
  }

  return (
    <Card>
      <CardHeader>
        <CardTitle className="flex items-center gap-2">
          <Calendar className="h-5 w-5" />
          TransaÃ§Ãµes Recentes
        </CardTitle>
      </CardHeader>
      <CardContent>
        <div className="space-y-4">
          {transactions.length === 0 ? (
            <p className="text-center text-muted-foreground py-4">Nenhuma transaÃ§Ã£o encontrada</p>
          ) : (
            transactions.map((transaction) => (
              <div
                key={transaction.id}
                className="flex items-center justify-between p-3 rounded-lg border border-border hover:bg-muted/50 transition-colors"
              >
                <div className="flex items-center gap-3">
                  <div
                    className={cn(
                      "p-2 rounded-full",
                      transaction.type === "income" ? "bg-success/10 text-success" : "bg-destructive/10 text-destructive"
                    )}
                  >
                    {transaction.type === "income" ? <ArrowUpCircle className="h-4 w-4" /> : <ArrowDownCircle className="h-4 w-4" />}
                  </div>
                  <div>
                    <p className="font-medium">{transaction.description}</p>
                    <div className="flex items-center gap-2 mt-1">
                      <Badge variant="secondary" className="text-xs">
                        {transaction.category}
                      </Badge>
                      {transaction.group && (
                        <Badge variant="outline" className="text-xs">
                          Grupo: {transaction.group.name}
                        </Badge>
                      )}
                    </div>
                  </div>
                </div>
                <div className="text-right">
                  <p className={cn("font-semibold", transaction.type === "income" ? "text-success" : "text-destructive")}>
                    {transaction.type === "income" ? "+" : ""}
                    {transaction.amount.toLocaleString("pt-BR", {
                      style: "currency",
                      currency: "BRL",
                    })}
                  </p>
                  <p className="text-xs text-muted-foreground">{new Date(transaction.date).toLocaleDateString("pt-BR")}</p>
                </div>
              </div>
            ))
          )}
        </div>
      </CardContent>
    </Card>
  );
};

----------------------------------------
ENDOFFILE: src\components\dashboard\TransactionsList.tsx

STARTOFFILE: src\components\dialogs\AddEventDialog.tsx
----------------------------------------
import { useState } from "react";
import { Calendar as CalendarIcon } from "lucide-react";

import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Textarea } from "@/components/ui/textarea";
import { useToast } from "@/hooks/use-toast";
import { supabase } from "@/integrations/supabase/client";
import { sanitizeInput, ensureAuthenticated } from "@/utils/security";
import { formatDateForInput } from "@/utils/date/dateutils";

interface AddEventDialogProps {
  trigger?: React.ReactNode;
  onSuccess?: () => void;
}

export const AddEventDialog = ({ trigger, onSuccess }: AddEventDialogProps) => {
  const [open, setOpen] = useState(false);
  const [loading, setLoading] = useState(false);
  const [formData, setFormData] = useState({
    name: "",
    description: "",
    date: formatDateForInput(new Date()),
  });
  const { toast } = useToast();

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();

    if (!formData.name) {
      toast({
        title: "Erro",
        description: "O nome do evento Ã© obrigatÃ³rio",
        variant: "destructive",
      });
      return;
    }

    setLoading(true);

    try {
      const userId = await ensureAuthenticated();

      const { error } = await supabase.from("events" as any).insert({
        user_id: userId,
        name: sanitizeInput(formData.name),
        description: sanitizeInput(formData.description),
        date: formData.date,
      });

      if (error) throw error;

      toast({
        title: "Sucesso",
        description: "Evento criado com sucesso!",
      });

      setFormData({
        name: "",
        description: "",
        date: formatDateForInput(new Date()),
      });
      setOpen(false);
      onSuccess?.();
    } catch (error) {
      console.error("Erro ao criar evento:", error);
      toast({
        title: "Erro",
        description: "Erro ao criar o evento. Tente novamente.",
        variant: "destructive",
      });
    } finally {
      setLoading(false);
    }
  };

  return (
    <Dialog open={open} onOpenChange={setOpen}>
      <DialogTrigger asChild>
        {trigger || (
          <Button variant="outline">
            <CalendarIcon className="h-4 w-4 mr-2" />
            Novo Evento
          </Button>
        )}
      </DialogTrigger>
      <DialogContent className="sm:max-w-[425px]">
        <DialogHeader>
          <DialogTitle>Criar Novo Evento</DialogTitle>
          <DialogDescription>Crie um evento para agrupar mÃºltiplos lanÃ§amentos (ex: Viagem, Projeto).</DialogDescription>
        </DialogHeader>

        <form onSubmit={handleSubmit} className="space-y-4">
          <div className="space-y-2">
            <Label htmlFor="eventName">Nome do Evento *</Label>
            <Input
              id="eventName"
              placeholder="Ex: Viagem para Praia, Reforma da Casa"
              value={formData.name}
              onChange={(e) => setFormData((prev) => ({ ...prev, name: e.target.value }))}
              required
            />
          </div>

          <div className="space-y-2">
            <Label htmlFor="eventDate">Data de ReferÃªncia *</Label>
            <Input
              id="eventDate"
              type="date"
              value={formData.date}
              onChange={(e) => setFormData((prev) => ({ ...prev, date: e.target.value }))}
              required
            />
          </div>

          <div className="space-y-2">
            <Label htmlFor="eventDescription">DescriÃ§Ã£o</Label>
            <Textarea
              id="eventDescription"
              placeholder="Detalhes sobre este evento..."
              value={formData.description}
              onChange={(e) => setFormData((prev) => ({ ...prev, description: e.target.value }))}
              rows={3}
            />
          </div>

          <div className="flex gap-2 pt-4">
            <Button type="button" variant="outline" className="flex-1" onClick={() => setOpen(false)}>
              Cancelar
            </Button>
            <Button type="submit" className="flex-1" disabled={loading}>
              {loading ? "Criando..." : "Criar Evento"}
            </Button>
          </div>
        </form>
      </DialogContent>
    </Dialog>
  );
};

----------------------------------------
ENDOFFILE: src\components\dialogs\AddEventDialog.tsx

STARTOFFILE: src\components\dialogs\AddGoalDialog.tsx
----------------------------------------
import { useState } from "react";
import { Target } from "@/lib/icons";

import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { Textarea } from "@/components/ui/textarea";
import { useToast } from "@/hooks/use-toast";
import { supabase } from "@/integrations/supabase/client";
import { sanitizeInput, sanitizeAmount, validateTransactionData, ensureAuthenticated, checkRateLimit } from "@/utils/security";

interface AddGoalDialogProps {
  trigger?: React.ReactNode;
  onSuccess?: () => void;
}

export const AddGoalDialog = ({ trigger, onSuccess }: AddGoalDialogProps) => {
  const [open, setOpen] = useState(false);
  const [loading, setLoading] = useState(false);
  const [formData, setFormData] = useState({
    name: "",
    target_amount: "",
    current_amount: "",
    color: "blue",
    description: "",
    target_date: "",
    priority: "5",
  });
  const { toast } = useToast();

  const colors = [
    { value: "blue", label: "Azul" },
    { value: "green", label: "Verde" },
    { value: "purple", label: "Roxo" },
    { value: "orange", label: "Laranja" },
    { value: "red", label: "Vermelho" },
    { value: "pink", label: "Rosa" },
  ];

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();

    if (!formData.name || !formData.target_amount) {
      toast({
        title: "Erro",
        description: "Preencha todos os campos obrigatÃ³rios",
        variant: "destructive",
      });
      return;
    }

    setLoading(true);

    try {
      const {
        data: { user },
      } = await supabase.auth.getUser();
      if (!user) throw new Error("UsuÃ¡rio nÃ£o autenticado");

      const targetAmount = parseFloat(formData.target_amount);
      const currentAmount = formData.current_amount ? parseFloat(formData.current_amount) : 0;
      const priority = parseInt(formData.priority);

      const { error } = await supabase.from("investment_goals").insert({
        user_id: user.id,
        name: formData.name,
        target_amount: targetAmount,
        current_amount: currentAmount,
        color: formData.color,
        description: formData.description || null,
        target_date: formData.target_date || null,
        priority: priority,
      });

      if (error) throw error;

      toast({
        title: "Sucesso",
        description: "Meta de investimento criada com sucesso!",
      });

      setFormData({
        name: "",
        target_amount: "",
        current_amount: "",
        color: "blue",
        description: "",
        target_date: "",
        priority: "5",
      });
      setOpen(false);
      onSuccess?.();
    } catch (error) {
      console.error("Erro ao salvar meta:", error);
      toast({
        title: "Erro",
        description: "Erro ao criar a meta. Tente novamente.",
        variant: "destructive",
      });
    } finally {
      setLoading(false);
    }
  };

  const defaultTrigger = (
    <Button>
      <Target className="h-4 w-4 mr-2" />
      Nova Meta
    </Button>
  );

  return (
    <Dialog open={open} onOpenChange={setOpen}>
      <DialogTrigger asChild>{trigger || defaultTrigger}</DialogTrigger>
      <DialogContent className="sm:max-w-[425px]">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2">
            <Target className="h-5 w-5 text-primary" />
            Nova Meta de Investimento
          </DialogTitle>
          <DialogDescription>Defina uma meta financeira para acompanhar seu progresso.</DialogDescription>
        </DialogHeader>

        <form onSubmit={handleSubmit} className="space-y-4">
          <div className="space-y-2">
            <Label htmlFor="name">Nome da Meta *</Label>
            <Input
              id="name"
              placeholder="Ex: Casa prÃ³pria, Aposentadoria..."
              value={formData.name}
              onChange={(e) => setFormData((prev) => ({ ...prev, name: e.target.value }))}
              required
            />
          </div>

          <div className="grid grid-cols-2 gap-4">
            <div className="space-y-2">
              <Label htmlFor="target_amount">Valor Alvo *</Label>
              <Input
                id="target_amount"
                type="number"
                step="0.01"
                min="0"
                placeholder="0,00"
                value={formData.target_amount}
                onChange={(e) => setFormData((prev) => ({ ...prev, target_amount: e.target.value }))}
                required
              />
            </div>

            <div className="space-y-2">
              <Label htmlFor="current_amount">Valor Atual</Label>
              <Input
                id="current_amount"
                type="number"
                step="0.01"
                min="0"
                placeholder="0,00"
                value={formData.current_amount}
                onChange={(e) => setFormData((prev) => ({ ...prev, current_amount: e.target.value }))}
              />
            </div>
          </div>

          <div className="grid grid-cols-2 gap-4">
            <div className="space-y-2">
              <Label htmlFor="color">Cor</Label>
              <Select value={formData.color} onValueChange={(value) => setFormData((prev) => ({ ...prev, color: value }))}>
                <SelectTrigger id="color">
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  {colors.map((color) => (
                    <SelectItem key={color.value} value={color.value}>
                      {color.label}
                    </SelectItem>
                  ))}
                </SelectContent>
              </Select>
            </div>

            <div className="space-y-2">
              <Label htmlFor="priority">Prioridade *</Label>
              <Select value={formData.priority} onValueChange={(value) => setFormData((prev) => ({ ...prev, priority: value }))}>
                <SelectTrigger id="priority">
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  <SelectItem value="1">1 - Mais Alta</SelectItem>
                  <SelectItem value="2">2 - Alta</SelectItem>
                  <SelectItem value="3">3 - MÃ©dia</SelectItem>
                  <SelectItem value="4">4 - Baixa</SelectItem>
                  <SelectItem value="5">5 - Mais Baixa</SelectItem>
                </SelectContent>
              </Select>
            </div>
          </div>

          <div className="space-y-2">
            <Label htmlFor="description">DescriÃ§Ã£o (opcional)</Label>
            <Textarea
              id="description"
              placeholder="Adicione detalhes sobre esta meta..."
              value={formData.description}
              onChange={(e) => setFormData((prev) => ({ ...prev, description: e.target.value }))}
              rows={3}
            />
          </div>

          <div className="space-y-2">
            <Label htmlFor="target_date">Data Alvo (opcional)</Label>
            <Input
              id="target_date"
              type="date"
              value={formData.target_date}
              onChange={(e) => setFormData((prev) => ({ ...prev, target_date: e.target.value }))}
            />
          </div>

          <div className="flex gap-2 pt-4">
            <Button type="button" variant="outline" className="flex-1" onClick={() => setOpen(false)}>
              Cancelar
            </Button>
            <Button type="submit" className="flex-1" disabled={loading}>
              {loading ? "Salvando..." : "Salvar"}
            </Button>
          </div>
        </form>
      </DialogContent>
    </Dialog>
  );
};

----------------------------------------
ENDOFFILE: src\components\dialogs\AddGoalDialog.tsx

STARTOFFILE: src\components\dialogs\AddGroupDialog.tsx
----------------------------------------
import { useState } from "react";
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Textarea } from "@/components/ui/textarea";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { useToast } from "@/hooks/use-toast";
import { useSanitizedForm } from "@/hooks/useSanitizedForm";
import { supabase } from "@/integrations/supabase/client";
import { sanitizeInput, sanitizeColor, validateGroupData, ensureAuthenticated, withRateLimit, SECURITY_LIMITS } from "@/utils/security";
import type { GroupData } from "@/utils/security/types";

interface AddGroupDialogProps {
  trigger?: React.ReactNode;
  onGroupCreated?: () => void;
}

interface FormData extends Partial<GroupData> {
  color?: string;
}

const colors = [
  { value: "blue", label: "Azul", class: "bg-blue-500" },
  { value: "green", label: "Verde", class: "bg-green-500" },
  { value: "red", label: "Vermelho", class: "bg-red-500" },
  { value: "yellow", label: "Amarelo", class: "bg-yellow-500" },
  { value: "purple", label: "Roxo", class: "bg-purple-500" },
  { value: "pink", label: "Rosa", class: "bg-pink-500" },
  { value: "orange", label: "Laranja", class: "bg-orange-500" },
  { value: "teal", label: "Azul-verde", class: "bg-teal-500" },
];

const colorToHex: Record<string, string> = {
  blue: "#3B82F6",
  green: "#10B981",
  red: "#EF4444",
  yellow: "#F59E0B",
  purple: "#8B5CF6",
  pink: "#EC4899",
  orange: "#F97316",
  teal: "#14B8A6",
};

export const AddGroupDialog = ({ trigger, onGroupCreated }: AddGroupDialogProps) => {
  const [open, setOpen] = useState(false);
  const { toast } = useToast();

  const {
    values: formData,
    errors,
    isSubmitting,
    handleChange,
    handleSubmit,
    resetForm,
  } = useSanitizedForm<FormData>({
    initialValues: {
      name: "",
      description: "",
      color: "blue",
    },
    sanitizers: {
      name: (v) => sanitizeInput(v, SECURITY_LIMITS.MAX_NAME_LENGTH),
      description: (v) => sanitizeInput(v, SECURITY_LIMITS.MAX_DESCRIPTION_LENGTH),
      color: (v) => v,
    },
    validators: {
      name: (v) => ({
        isValid: v.length > 0 && v.length <= SECURITY_LIMITS.MAX_NAME_LENGTH,
        error: v.length === 0 ? "Nome obrigatÃ³rio" : null,
      }),
      description: (v) => ({
        isValid: v.length <= SECURITY_LIMITS.MAX_DESCRIPTION_LENGTH,
        error: v.length > SECURITY_LIMITS.MAX_DESCRIPTION_LENGTH ? "DescriÃ§Ã£o muito longa" : null,
      }),
    },
    onSubmit: async (values) => {
      await submitGroup(values);
    },
  });

  const submitGroup = async (values: FormData) => {
    try {
      const userId = await ensureAuthenticated();
      const hexColor = colorToHex[values.color || "blue"];
      const sanitizedColor = sanitizeColor(hexColor);

      if (!sanitizedColor) {
        throw new Error("Cor invÃ¡lida");
      }

      const validationResult = validateGroupData({
        name: values.name!,
        description: values.description || null,
        color: sanitizedColor,
        created_by: userId,
      });

      if (!validationResult.isValid) {
        throw new Error(validationResult.error || "Dados invÃ¡lidos");
      }

      await withRateLimit(
        `group:${userId}`,
        async () => {
          // 1. Cria o grupo
          // O Trigger 'add_creator_to_group' no banco de dados irÃ¡ automaticamente
          // adicionar este usuÃ¡rio como administrador na tabela group_members.
          const { error } = await supabase
            .from("groups")
            .insert({
              name: values.name,
              description: values.description || null,
              color: sanitizedColor,
              created_by: userId,
            });

          if (error) throw error;
          
          // REMOVIDO: O bloco que tentava fazer o upsert manual em group_members
          // Isso causava o erro de RLS 403 Forbidden.
        },
        10
      );

      toast({
        title: "Sucesso",
        description: "Grupo criado com sucesso!",
      });

      resetForm();
      setOpen(false);
      if (onGroupCreated) onGroupCreated();
    } catch (error) {
      console.error("Erro ao criar grupo:", error);
      toast({
        title: "Erro",
        description: error instanceof Error ? error.message : "Erro ao criar grupo",
        variant: "destructive",
      });
    }
  };

  return (
    <Dialog open={open} onOpenChange={setOpen}>
      <DialogTrigger asChild>{trigger || <Button>Criar Grupo</Button>}</DialogTrigger>
      <DialogContent className="sm:max-w-[425px]">
        <DialogHeader>
          <DialogTitle>Criar Novo Grupo</DialogTitle>
          <DialogDescription>Crie um grupo para compartilhar despesas com outras pessoas</DialogDescription>
        </DialogHeader>
        <form onSubmit={handleSubmit} className="space-y-4">
          <div>
            <Label htmlFor="name">Nome do Grupo *</Label>
            <Input
              id="name"
              value={formData.name}
              onChange={(e) => handleChange("name", e.target.value)}
              maxLength={SECURITY_LIMITS.MAX_NAME_LENGTH}
              placeholder="Ex: FamÃ­lia, Casa, Viagem..."
            />
            {errors.name && <p className="text-sm text-destructive mt-1">{errors.name}</p>}
          </div>

          <div>
            <Label htmlFor="description">DescriÃ§Ã£o (opcional)</Label>
            <Textarea
              id="description"
              value={formData.description}
              onChange={(e) => handleChange("description", e.target.value)}
              maxLength={SECURITY_LIMITS.MAX_DESCRIPTION_LENGTH}
              placeholder="Descreva o propÃ³sito deste grupo..."
              rows={3}
            />
            {errors.description && <p className="text-sm text-destructive mt-1">{errors.description}</p>}
          </div>

          <div>
            <Label htmlFor="color">Cor do Grupo</Label>
            <Select value={formData.color} onValueChange={(value) => handleChange("color", value)}>
              <SelectTrigger>
                <SelectValue placeholder="Selecione uma cor" />
              </SelectTrigger>
              <SelectContent>
                {colors.map((color) => (
                  <SelectItem key={color.value} value={color.value}>
                    <div className="flex items-center gap-2">
                      <div className={`w-4 h-4 rounded-full ${color.class}`}></div>
                      {color.label}
                    </div>
                  </SelectItem>
                ))}
              </SelectContent>
            </Select>
          </div>

          <div className="flex gap-2">
            <Button type="button" variant="outline" className="flex-1" onClick={() => setOpen(false)}>
              Cancelar
            </Button>
            <Button type="submit" className="flex-1" disabled={isSubmitting}>
              {isSubmitting ? "Criando..." : "Criar Grupo"}
            </Button>
          </div>
        </form>
      </DialogContent>
    </Dialog>
  );
};
----------------------------------------
ENDOFFILE: src\components\dialogs\AddGroupDialog.tsx

STARTOFFILE: src\components\dialogs\AddInvestmentDialog.tsx
----------------------------------------
import { useState, useEffect } from "react";
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { PiggyBank } from "lucide-react";
import { INVESTMENT_TYPES } from "@/constants/investment-types";
import { useToast } from "@/hooks/use-toast";
import { supabase } from "@/integrations/supabase/client";
import { recalculateGoalBalance } from "@/utils/investments/investmentUtils";

interface Group {
  id: string;
  name: string;
}

interface InvestmentGoal {
  id: string;
  name: string;
  target_amount: number;
  current_amount: number;
}

interface AddInvestmentDialogProps {
  trigger?: React.ReactNode;
  onSuccess?: () => void;
  defaultGroupId?: string; // NOVO PROP
}

export const AddInvestmentDialog = ({ trigger, onSuccess, defaultGroupId }: AddInvestmentDialogProps) => {
  const [open, setOpen] = useState(false);
  const [loading, setLoading] = useState(false);
  const [groups, setGroups] = useState<Group[]>([]);
  const [investmentGoals, setInvestmentGoals] = useState<InvestmentGoal[]>([]);
  const [formData, setFormData] = useState({
    name: "",
    type: "",
    amount: "",
    quantity: "",
    unit_price: "",
    group_id: defaultGroupId || "none", // Usa default se houver
    goal_id: "none",
    maturity_date: "",
  });
  const { toast } = useToast();

  const showQuantityPriceFields = formData.type === "AÃ§Ãµes" || formData.type === "FIIs";

  useEffect(() => {
    if (open) {
      if (!defaultGroupId) {
        loadGroups();
      }
      loadInvestmentGoals();
    }
  }, [open, defaultGroupId]);

  const loadGroups = async () => {
    try {
      const { data } = await supabase.from("groups").select("id, name").order("name");
      setGroups(data || []);
    } catch (error) {
      console.error("Erro grupos:", error);
    }
  };

  const loadInvestmentGoals = async () => {
    try {
      const { data } = await supabase.from("investment_goals").select("id, name, target_amount, current_amount").order("name");
      setInvestmentGoals(data || []);
    } catch (error) {
      console.error("Erro metas:", error);
    }
  };

  const handleNameBlur = async () => {
    if (!formData.name) return;
    try {
      const { data } = await supabase
        .from("investments")
        .select("type, group_id, goal_id")
        .ilike("name", formData.name)
        .limit(1)
        .maybeSingle();

      if (data) {
        setFormData(prev => ({
          ...prev,
          type: prev.type || data.type,
          // MantÃ©m defaultGroupId se existir, senÃ£o usa o do histÃ³rico
          group_id: defaultGroupId ? defaultGroupId : (prev.group_id === "none" && data.group_id ? data.group_id : prev.group_id),
          goal_id: prev.goal_id === "none" && data.goal_id ? data.goal_id : prev.goal_id,
        }));
      }
    } catch (error) {
      // Silently fail
    }
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setLoading(true);

    try {
      const { data: { user } } = await supabase.auth.getUser();
      if (!user) throw new Error("UsuÃ¡rio nÃ£o autenticado");

      let calculatedAmount = 0;
      let quantity = null;
      let unitPrice = null;

      if (showQuantityPriceFields) {
        if (!formData.quantity || !formData.unit_price) {
          toast({ title: "Erro", description: "Preencha quantidade e preÃ§o", variant: "destructive" });
          setLoading(false);
          return;
        }
        quantity = parseFloat(formData.quantity);
        unitPrice = parseFloat(formData.unit_price);
        calculatedAmount = quantity * unitPrice;
      } else {
        if (!formData.amount) {
          toast({ title: "Erro", description: "Preencha o valor", variant: "destructive" });
          setLoading(false);
          return;
        }
        calculatedAmount = parseFloat(formData.amount);
      }

      const investmentData: any = {
        user_id: user.id,
        name: formData.name,
        type: formData.type,
        amount: calculatedAmount,
        current_value: calculatedAmount,
        quantity,
        unit_price: unitPrice,
        group_id: formData.group_id === "none" ? null : formData.group_id,
        goal_id: formData.goal_id === "none" ? null : formData.goal_id,
        maturity_date: formData.maturity_date || null,
      };

      const { error: insertError } = await supabase.from("investments").insert(investmentData);
      if (insertError) throw insertError;

      if (investmentData.goal_id) {
        await recalculateGoalBalance(investmentData.goal_id);
      }

      toast({ title: "Sucesso", description: "Aporte realizado com sucesso!" });
      
      setFormData({
        name: "",
        type: "",
        amount: "",
        quantity: "",
        unit_price: "",
        group_id: defaultGroupId || "none", // Reseta mantendo o default
        goal_id: "none",
        maturity_date: "",
      });
      setOpen(false);
      onSuccess?.();
    } catch (error) {
      console.error("Erro:", error);
      toast({ title: "Erro", description: "Falha ao salvar", variant: "destructive" });
    } finally {
      setLoading(false);
    }
  };

  const defaultTrigger = (
    <Button variant="outline" className="h-20 flex flex-col gap-2">
      <PiggyBank className="h-6 w-6" />
      <span className="text-sm">Investir</span>
    </Button>
  );

  return (
    <Dialog open={open} onOpenChange={setOpen}>
      <DialogTrigger asChild>{trigger || defaultTrigger}</DialogTrigger>
      <DialogContent className="sm:max-w-[425px]">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2">
            <PiggyBank className="h-5 w-5 text-primary" />
            Novo Investimento
          </DialogTitle>
          <DialogDescription>Adicione um novo aporte.</DialogDescription>
        </DialogHeader>
        <form onSubmit={handleSubmit} className="space-y-4">
          <div className="space-y-2">
            <Label htmlFor="name">Nome do Ativo *</Label>
            <Input
              id="name"
              placeholder="Ex: PETR4, CDB Banco X..."
              value={formData.name}
              onChange={(e) => setFormData((prev) => ({ ...prev, name: e.target.value }))}
              onBlur={handleNameBlur}
              required
            />
          </div>

          <div className="space-y-2">
            <Label htmlFor="type">Tipo *</Label>
            <Select value={formData.type} onValueChange={(value) => setFormData((prev) => ({ ...prev, type: value }))}>
              <SelectTrigger>
                <SelectValue placeholder="Selecione o tipo" />
              </SelectTrigger>
              <SelectContent>
                {INVESTMENT_TYPES.map((type) => (
                  <SelectItem key={type} value={type}>{type}</SelectItem>
                ))}
              </SelectContent>
            </Select>
          </div>

          {showQuantityPriceFields ? (
            <>
              <div className="grid grid-cols-2 gap-4">
                <div className="space-y-2">
                  <Label htmlFor="quantity">Quantidade</Label>
                  <Input
                    id="quantity"
                    type="number"
                    step="1"
                    value={formData.quantity}
                    onChange={(e) => setFormData((prev) => ({ ...prev, quantity: e.target.value }))}
                  />
                </div>
                <div className="space-y-2">
                  <Label htmlFor="unit_price">PreÃ§o UnitÃ¡rio</Label>
                  <Input
                    id="unit_price"
                    type="number"
                    step="0.01"
                    value={formData.unit_price}
                    onChange={(e) => setFormData((prev) => ({ ...prev, unit_price: e.target.value }))}
                  />
                </div>
              </div>
              {formData.quantity && formData.unit_price && (
                <div className="text-sm text-muted-foreground text-right">
                  Total: R$ {(parseFloat(formData.quantity) * parseFloat(formData.unit_price)).toFixed(2)}
                </div>
              )}
            </>
          ) : (
            <div className="space-y-2">
              <Label htmlFor="amount">Valor do Aporte *</Label>
              <Input
                id="amount"
                type="number"
                step="0.01"
                value={formData.amount}
                onChange={(e) => setFormData((prev) => ({ ...prev, amount: e.target.value }))}
              />
            </div>
          )}

          <div className="space-y-2">
            <Label htmlFor="goal">Vincular a uma Meta</Label>
            <Select value={formData.goal_id} onValueChange={(value) => setFormData((prev) => ({ ...prev, goal_id: value }))}>
              <SelectTrigger>
                <SelectValue placeholder="Selecione..." />
              </SelectTrigger>
              <SelectContent>
                <SelectItem value="none">Nenhuma meta</SelectItem>
                {investmentGoals.map((goal) => (
                  <SelectItem key={goal.id} value={goal.id}>
                    {goal.name}
                  </SelectItem>
                ))}
              </SelectContent>
            </Select>
          </div>

          {!defaultGroupId && (
            <div className="space-y-2">
              <Label htmlFor="group">Grupo</Label>
              <Select value={formData.group_id} onValueChange={(value) => setFormData((prev) => ({ ...prev, group_id: value }))}>
                <SelectTrigger>
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  <SelectItem value="none">Pessoal</SelectItem>
                  {groups.map((group) => (
                    <SelectItem key={group.id} value={group.id}>{group.name}</SelectItem>
                  ))}
                </SelectContent>
              </Select>
            </div>
          )}

          <div className="space-y-2">
            <Label htmlFor="maturity_date">Vencimento (opcional)</Label>
            <Input
              id="maturity_date"
              type="date"
              value={formData.maturity_date}
              onChange={(e) => setFormData((prev) => ({ ...prev, maturity_date: e.target.value }))}
            />
          </div>

          <div className="flex gap-2 mt-4">
            <Button type="button" variant="outline" className="flex-1" onClick={() => setOpen(false)}>
              Cancelar
            </Button>
            <Button type="submit" className="flex-1" disabled={loading}>
              {loading ? "Salvando..." : "Adicionar Aporte"}
            </Button>
          </div>
        </form>
      </DialogContent>
    </Dialog>
  );
};
----------------------------------------
ENDOFFILE: src\components\dialogs\AddInvestmentDialog.tsx

STARTOFFILE: src\components\dialogs\AddReminderDialog.tsx
----------------------------------------
import { useState } from "react";
import { Bell } from "lucide-react";

import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { Textarea } from "@/components/ui/textarea";

import { useReminders } from "@/hooks/useReminders";

import { formatDateTimeForDatabase } from "@/utils/date/dateutils";

import type { ReminderFormData, RepeatType } from "@/utils/types/reminder.types";

interface AddReminderDialogProps {
  trigger?: React.ReactNode;
  transactionId?: string;
  defaultTitle?: string;
  onSuccess?: () => void;
}

export const AddReminderDialog = ({ trigger, transactionId, defaultTitle, onSuccess }: AddReminderDialogProps) => {
  const [open, setOpen] = useState(false);
  const [formData, setFormData] = useState<ReminderFormData>({
    title: defaultTitle || "",
    description: "",
    reminder_date: "",
    repeat_type: "none",
  });

  const { createReminder } = useReminders();

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();

    try {
      const reminderDataToSave = {
        ...formData,
        reminder_date: formatDateTimeForDatabase(formData.reminder_date),
      };

      await createReminder(reminderDataToSave, transactionId);
      setOpen(false);
      setFormData({
        title: "",
        description: "",
        reminder_date: "",
        repeat_type: "none",
      });
      if (onSuccess) onSuccess();
    } catch (error) {
      console.error("Erro ao criar lembrete:", error);
    }
  };

  return (
    <Dialog open={open} onOpenChange={setOpen}>
      <DialogTrigger asChild>
        {trigger || (
          <Button variant="outline" size="sm">
            <Bell className="h-4 w-4 mr-2" />
            Adicionar Lembrete
          </Button>
        )}
      </DialogTrigger>
      <DialogContent className="sm:max-w-[425px]">
        <DialogHeader>
          <DialogTitle>Adicionar Lembrete</DialogTitle>
          <DialogDescription>Configure um lembrete para nÃ£o esquecer compromissos financeiros</DialogDescription>
        </DialogHeader>
        <form onSubmit={handleSubmit} className="space-y-4">
          <div className="space-y-2">
            <Label htmlFor="title">TÃ­tulo *</Label>
            <Input
              id="title"
              value={formData.title}
              onChange={(e) => setFormData((prev) => ({ ...prev, title: e.target.value }))}
              placeholder="Ex: Pagar conta de luz"
              required
            />
          </div>

          <div className="space-y-2">
            <Label htmlFor="description">DescriÃ§Ã£o</Label>
            <Textarea
              id="description"
              value={formData.description}
              onChange={(e) => setFormData((prev) => ({ ...prev, description: e.target.value }))}
              placeholder="InformaÃ§Ãµes adicionais sobre o lembrete"
              rows={3}
            />
          </div>

          <div className="space-y-2">
            <Label htmlFor="reminder_date">Data e Hora do Lembrete *</Label>
            <Input
              id="reminder_date"
              type="datetime-local"
              value={formData.reminder_date}
              onChange={(e) => setFormData((prev) => ({ ...prev, reminder_date: e.target.value }))}
              required
            />
            <p className="text-xs text-muted-foreground">VocÃª pode agendar lembretes para qualquer data e horÃ¡rio</p>
          </div>

          <div className="space-y-2">
            <Label htmlFor="repeat_type">Repetir</Label>
            <Select
              value={formData.repeat_type}
              onValueChange={(value) => setFormData((prev) => ({ ...prev, repeat_type: value as RepeatType }))}
            >
              <SelectTrigger>
                <SelectValue />
              </SelectTrigger>
              <SelectContent>
                <SelectItem value="none">NÃ£o repetir</SelectItem>
                <SelectItem value="daily">Diariamente</SelectItem>
                <SelectItem value="weekly">Semanalmente</SelectItem>
                <SelectItem value="monthly">Mensalmente</SelectItem>
                <SelectItem value="yearly">Anualmente</SelectItem>
              </SelectContent>
            </Select>
          </div>

          <div className="flex gap-2 pt-4">
            <Button type="button" variant="outline" className="flex-1" onClick={() => setOpen(false)}>
              Cancelar
            </Button>
            <Button type="submit" className="flex-1">
              Criar Lembrete
            </Button>
          </div>
        </form>
      </DialogContent>
    </Dialog>
  );
};

----------------------------------------
ENDOFFILE: src\components\dialogs\AddReminderDialog.tsx

STARTOFFILE: src\components\dialogs\AddTransactionDialog.tsx
----------------------------------------
import { useState, useEffect } from "react";
import { addMonths } from "date-fns";
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { Switch } from "@/components/ui/switch";
import { Separator } from "@/components/ui/separator";
import { Checkbox } from "@/components/ui/checkbox";
import { ScrollArea } from "@/components/ui/scroll-area";
import { Avatar, AvatarFallback } from "@/components/ui/avatar";

import { useToast } from "@/hooks/use-toast";
import { useReminders } from "@/hooks/useReminders";
import { supabase } from "@/integrations/supabase/client";

import {
  sanitizeInput,
  sanitizeAmount,
  sanitizeInteger,
  sanitizeDate,
  sanitizeUUID,
  validateTransactionData,
  ensureAuthenticated,
  checkGroupMembership,
  withRateLimit,
  SECURITY_LIMITS,
  ALLOWED_CATEGORIES,
} from "@/utils/security";
import { formatDateForInput, formatDateForDatabase, formatDateTimeForDatabase } from "@/utils/date/dateutils";

import type { TransactionData } from "@/utils/security/types";
import type { RepeatType } from "@/utils/types/reminder.types";

interface AddTransactionDialogProps {
  type: "income" | "expense";
  trigger?: React.ReactNode;
  onSuccess?: () => void;
  eventId?: string;
  defaultGroupId?: string;
}

interface TransactionFormData {
  description: string;
  amount: number;
  category: string;
  date: string;
  group_id: string;
  payer_id: string; // NOVO: ID de quem pagou
  is_recurring: boolean;
  is_fixed: boolean;
  recurrence_count: number;
}

interface ReminderFormData {
  enabled: boolean;
  reminder_date: string;
  repeat_type: RepeatType;
}

export const AddTransactionDialog = ({ type, trigger, onSuccess, eventId, defaultGroupId }: AddTransactionDialogProps) => {
  const [open, setOpen] = useState(false);
  const { toast } = useToast();
  const { createReminder } = useReminders();
  const [currentUserId, setCurrentUserId] = useState<string>("");

  const [values, setValues] = useState<TransactionFormData>({
    description: "",
    amount: 0,
    category: "",
    date: formatDateForInput(new Date()),
    group_id: defaultGroupId || "personal",
    payer_id: "", // Inicialmente vazio, serÃ¡ preenchido com currentUserId
    is_recurring: false,
    is_fixed: false,
    recurrence_count: 1,
  });

  const [reminderData, setReminderData] = useState<ReminderFormData>({
    enabled: false,
    reminder_date: "",
    repeat_type: "none",
  });

  const [groups, setGroups] = useState<Array<{ id: string; name: string }>>([]);
  const [groupMembers, setGroupMembers] = useState<Array<{ id: string; full_name: string }>>([]);
  const [selectedMembers, setSelectedMembers] = useState<string[]>([]);

  const [isSubmitting, setIsSubmitting] = useState(false);

  // Inicializa o usuÃ¡rio atual
  useEffect(() => {
    supabase.auth.getUser().then(({ data }) => {
      if (data.user) {
        setCurrentUserId(data.user.id);
        setValues((prev) => ({ ...prev, payer_id: data.user.id }));
      }
    });
  }, []);

  const resetForm = () => {
    setValues({
      description: "",
      amount: 0,
      category: "",
      date: formatDateForInput(new Date()),
      group_id: defaultGroupId || "personal",
      payer_id: currentUserId,
      is_recurring: false,
      is_fixed: false,
      recurrence_count: 1,
    });
    setReminderData({ enabled: false, reminder_date: "", repeat_type: "none" });
    setSelectedMembers([]);
  };

  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement> | { target: { name: string; value: any } }) => {
    const { name, value } = e.target;
    setValues((prev) => ({ ...prev, [name]: value }));
  };

  useEffect(() => {
    if (open && !eventId && !defaultGroupId) {
      loadGroups();
    } else if (defaultGroupId && open) {
      loadGroupMembers(defaultGroupId);
    }
  }, [open, eventId, defaultGroupId]);

  useEffect(() => {
    if (values.group_id && values.group_id !== "personal") {
      loadGroupMembers(values.group_id);
    } else {
      setGroupMembers([]);
      setSelectedMembers([]);
    }
  }, [values.group_id]);

  const loadGroups = async () => {
    try {
      const userId = await ensureAuthenticated();
      const { data, error } = await supabase
        .from("groups")
        .select("id, name")
        .or(`created_by.eq.${userId},id.in.(select group_id from group_members where user_id = ${userId})`);
      if (error) throw error;
      setGroups(data || []);
    } catch (error) {
      console.error("Erro ao carregar grupos:", error);
    }
  };

  const loadGroupMembers = async (groupId: string) => {
    try {
      const userId = await ensureAuthenticated();
      const { data, error } = await supabase.from("group_members").select("user_id, profiles(id, full_name)").eq("group_id", groupId);
      if (error) throw error;

      const members = data
        ?.map((member: any) => ({
          id: member.user_id,
          full_name: member.profiles?.full_name || "Sem nome",
        }))
        .filter((member) => member.id);

      setGroupMembers(members || []);
      // Seleciona todos por padrÃ£o para dividir igualmente
      if (members) {
        setSelectedMembers(members.map((m) => m.id));
      }
    } catch (error) {
      console.error("Erro ao carregar membros do grupo:", error);
    }
  };

  const toggleMember = (memberId: string) => {
    setSelectedMembers((prev) => (prev.includes(memberId) ? prev.filter((id) => id !== memberId) : [...prev, memberId]));
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (isSubmitting) return;
    setIsSubmitting(true);

    try {
      const userId = await ensureAuthenticated();
      const amount = sanitizeAmount(values.amount);

      if (amount <= 0) throw new Error("O valor deve ser maior que zero");

      if (values.group_id !== "personal" && selectedMembers.length === 0) {
        throw new Error("Selecione pelo menos um membro para dividir.");
      }

      const sanitizedData: TransactionData = {
        description: sanitizeInput(values.description),
        amount,
        category: sanitizeInput(values.category),
        date: sanitizeDate(values.date),
        group_id: values.group_id === "personal" ? null : sanitizeUUID(values.group_id),
        is_recurring: Boolean(values.is_recurring),
        is_fixed: Boolean(values.is_fixed),
        event_id: eventId ? sanitizeUUID(eventId) : null,
      };

      const validationErrors = validateTransactionData(sanitizedData);
      if (validationErrors.length > 0) throw new Error(validationErrors.join(", "));

      await withRateLimit(
        `transaction:${userId}`,
        async () => {
          const recurrenceId = values.is_recurring || values.is_fixed ? crypto.randomUUID() : null;
          const recurrenceCount = sanitizeInteger(values.recurrence_count);
          const iterations = values.is_fixed ? 12 : recurrenceCount;

          const baseDate = new Date(values.date + "T00:00:00");

          for (let i = 0; i < iterations; i++) {
            const transactionDate = addMonths(baseDate, i);
            const formattedDate = formatDateForDatabase(transactionDate);

            // 1. Inserir a TransaÃ§Ã£o
            const { data: transData, error: transError } = await supabase
              .from("transactions")
              .insert({
                user_id: userId, // Quem criou o registro (audit)
                payer_id: values.payer_id || userId, // Quem efetivamente pagou (financeiro)
                description: sanitizedData.description,
                amount: type === "expense" ? -Math.abs(amount) : Math.abs(amount),
                type,
                category: sanitizedData.category,
                group_id: sanitizedData.group_id,
                date: formattedDate,
                is_recurring: sanitizedData.is_recurring,
                is_fixed: sanitizedData.is_fixed,
                recurrence_id: recurrenceId,
                recurrence_count: recurrenceCount,
                event_id: sanitizedData.event_id,
              })
              .select()
              .single();

            if (transError) throw transError;

            // 2. Inserir a DivisÃ£o (Splits)
            if (sanitizedData.group_id && selectedMembers.length > 0 && transData) {
              const splitAmount = amount / selectedMembers.length;

              const splitsToInsert = selectedMembers.map((memberId) => ({
                transaction_id: transData.id,
                user_id: memberId,
                amount: splitAmount, // Valor positivo (o quanto a pessoa consumiu)
              }));

              const { error: splitError } = await supabase.from("transaction_splits").insert(splitsToInsert);
              if (splitError) throw splitError;
            }

            // 3. Lembrete
            if (i === 0 && reminderData.enabled && reminderData.reminder_date && transData) {
              const reminderDateTime = formatDateTimeForDatabase(reminderData.reminder_date);
              await createReminder(
                {
                  title: `Lembrete: ${sanitizedData.description}`,
                  description: `${type === "income" ? "Receita" : "Despesa"} de ${amount.toLocaleString("pt-BR", {
                    style: "currency",
                    currency: "BRL",
                  })}`,
                  reminder_date: reminderDateTime,
                  repeat_type: reminderData.repeat_type,
                },
                transData.id
              );
            }
          }
        },
        30
      );

      toast({ title: "Sucesso", description: "TransaÃ§Ã£o salva com sucesso!" });
      resetForm();
      setOpen(false);
      if (onSuccess) onSuccess();
    } catch (error) {
      console.error("Erro ao criar transaÃ§Ã£o:", error);
      toast({ title: "Erro", description: error instanceof Error ? error.message : "Erro desconhecido", variant: "destructive" });
    } finally {
      setIsSubmitting(false);
    }
  };

  return (
    <Dialog open={open} onOpenChange={setOpen}>
      <DialogTrigger asChild>{trigger || <Button>{type === "income" ? "Adicionar Receita" : "Adicionar Despesa"}</Button>}</DialogTrigger>
      <DialogContent className="sm:max-w-[500px] max-h-[90vh] overflow-y-auto">
        <DialogHeader>
          <DialogTitle>Adicionar {type === "income" ? "Receita" : "Despesa"}</DialogTitle>
          <DialogDescription>Detalhes do lanÃ§amento.</DialogDescription>
        </DialogHeader>
        <form onSubmit={handleSubmit} className="space-y-4">
          <div className="space-y-2">
            <Label htmlFor="description">DescriÃ§Ã£o *</Label>
            <Input
              id="description"
              name="description"
              value={values.description}
              onChange={handleInputChange}
              placeholder="Ex: Jantar, Aluguel..."
              required
            />
          </div>

          <div className="grid grid-cols-2 gap-4">
            <div className="space-y-2">
              <Label htmlFor="amount">Valor Total *</Label>
              <Input
                id="amount"
                name="amount"
                type="number"
                step="0.01"
                min="0.01"
                value={values.amount || ""}
                onChange={handleInputChange}
                placeholder="0,00"
                required
              />
            </div>

            <div className="space-y-2">
              <Label htmlFor="date">Data *</Label>
              <Input id="date" name="date" type="date" value={values.date} onChange={handleInputChange} required />
            </div>
          </div>

          <div className="space-y-2">
            <Label htmlFor="category">Categoria *</Label>
            <Select
              name="category"
              value={values.category}
              onValueChange={(value) => handleInputChange({ target: { name: "category", value } } as any)}
            >
              <SelectTrigger>
                <SelectValue placeholder="Selecione a categoria" />
              </SelectTrigger>
              <SelectContent>
                {ALLOWED_CATEGORIES.map((cat) => (
                  <SelectItem key={cat} value={cat}>
                    {cat}
                  </SelectItem>
                ))}
              </SelectContent>
            </Select>
          </div>

          {!eventId && !defaultGroupId && (
            <div className="space-y-2">
              <Label htmlFor="group_id">Grupo</Label>
              <Select
                name="group_id"
                value={values.group_id}
                onValueChange={(value) => handleInputChange({ target: { name: "group_id", value } } as any)}
              >
                <SelectTrigger>
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  <SelectItem value="personal">Pessoal</SelectItem>
                  {groups.map((group) => (
                    <SelectItem key={group.id} value={group.id}>
                      {group.name}
                    </SelectItem>
                  ))}
                </SelectContent>
              </Select>
            </div>
          )}

          {/* SELEÃ‡ÃƒO DE PAGADOR (PAYER SELECT) - Apenas se for grupo */}
          {values.group_id !== "personal" && groupMembers.length > 0 && (
            <div className="space-y-2">
              <Label htmlFor="payer_id">Quem pagou?</Label>
              <Select value={values.payer_id} onValueChange={(value) => handleInputChange({ target: { name: "payer_id", value } } as any)}>
                <SelectTrigger>
                  <SelectValue placeholder="Selecione quem pagou" />
                </SelectTrigger>
                <SelectContent>
                  {groupMembers.map((member) => (
                    <SelectItem key={member.id} value={member.id}>
                      {member.id === currentUserId ? "Eu" : member.full_name}
                    </SelectItem>
                  ))}
                </SelectContent>
              </Select>
            </div>
          )}

          {/* DIVISÃƒO DE DESPESAS */}
          {values.group_id !== "personal" && !eventId && groupMembers.length > 0 && (
            <div className="space-y-2 border rounded-md p-3 bg-muted/20">
              <div className="flex justify-between items-center mb-2">
                <Label className="text-sm font-semibold">Dividir com:</Label>
                <span className="text-xs text-muted-foreground">{selectedMembers.length} selecionado(s)</span>
              </div>
              <ScrollArea className="h-[120px] w-full rounded-md border p-2 bg-background">
                <div className="space-y-2">
                  {groupMembers.map((member) => (
                    <div key={member.id} className="flex items-center space-x-2">
                      <Checkbox
                        id={`member-${member.id}`}
                        checked={selectedMembers.includes(member.id)}
                        onCheckedChange={() => toggleMember(member.id)}
                      />
                      <label htmlFor={`member-${member.id}`} className="text-sm font-medium flex-1 cursor-pointer">
                        {member.full_name}
                      </label>
                      {selectedMembers.length > 0 && selectedMembers.includes(member.id) && (
                        <span className="text-xs text-muted-foreground">
                          {(values.amount / selectedMembers.length).toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                        </span>
                      )}
                    </div>
                  ))}
                </div>
              </ScrollArea>
            </div>
          )}

          {/* ... (Resto do formulÃ¡rio de recorrÃªncia e lembretes mantido igual) ... */}
          <Separator />

          <div className="flex gap-2 pt-4">
            <Button type="button" variant="outline" className="flex-1" onClick={() => setOpen(false)} disabled={isSubmitting}>
              Cancelar
            </Button>
            <Button type="submit" className="flex-1" disabled={isSubmitting}>
              {isSubmitting ? "Salvando..." : "Salvar"}
            </Button>
          </div>
        </form>
      </DialogContent>
    </Dialog>
  );
};

----------------------------------------
ENDOFFILE: src\components\dialogs\AddTransactionDialog.tsx

STARTOFFILE: src\components\dialogs\EditGoalDialog.tsx
----------------------------------------
import { useState, useEffect } from "react";
import { Target } from "lucide-react";
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { Textarea } from "@/components/ui/textarea";
import { useToast } from "@/hooks/use-toast";
import { supabase } from "@/integrations/supabase/client";

interface InvestmentGoal {
  id: string;
  name: string;
  target_amount: number;
  current_amount: number;
  color: string;
  description?: string;
  target_date?: string;
  priority: number;
}

interface EditGoalDialogProps {
  goal: InvestmentGoal | null;
  open: boolean;
  onOpenChange: (open: boolean) => void;
  onSuccess?: () => void;
  onClose: () => void; // Adicionado para compatibilidade
}

export const EditGoalDialog = ({ goal, open, onOpenChange, onSuccess, onClose }: EditGoalDialogProps) => {
  const [loading, setLoading] = useState(false);
  const [formData, setFormData] = useState({
    name: "",
    target_amount: "",
    current_amount: "", // Permitir ediÃ§Ã£o manual do valor atual caso necessÃ¡rio, ou deixar readonly
    color: "blue",
    description: "",
    target_date: "",
    priority: "5",
  });
  const { toast } = useToast();

  const colors = [
    { value: "blue", label: "Azul" },
    { value: "green", label: "Verde" },
    { value: "purple", label: "Roxo" },
    { value: "orange", label: "Laranja" },
    { value: "red", label: "Vermelho" },
    { value: "pink", label: "Rosa" },
  ];

  // Preenche o formulÃ¡rio quando a meta selecionada muda
  useEffect(() => {
    if (goal) {
      setFormData({
        name: goal.name,
        target_amount: goal.target_amount.toString(),
        current_amount: goal.current_amount.toString(),
        color: goal.color || "blue",
        description: goal.description || "",
        target_date: goal.target_date || "",
        priority: (goal.priority || 5).toString(),
      });
    }
  }, [goal]);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!goal) return;

    if (!formData.name || !formData.target_amount) {
      toast({
        title: "Erro",
        description: "Preencha todos os campos obrigatÃ³rios",
        variant: "destructive",
      });
      return;
    }

    setLoading(true);

    try {
      const targetAmount = parseFloat(formData.target_amount);
      // Opcional: permitir editar o valor atual manualmente se houver descompasso
      const currentAmount = parseFloat(formData.current_amount);
      const priority = parseInt(formData.priority);

      const { error } = await supabase
        .from("investment_goals")
        .update({
          name: formData.name,
          target_amount: targetAmount,
          current_amount: currentAmount,
          color: formData.color,
          description: formData.description || null,
          target_date: formData.target_date || null,
          priority: priority,
        })
        .eq("id", goal.id);

      if (error) throw error;

      toast({
        title: "Sucesso",
        description: "Meta atualizada com sucesso!",
      });

      onOpenChange(false);
      onClose(); // Fecha via prop de controle do pai
      onSuccess?.(); // Recarrega dados no pai
    } catch (error) {
      console.error("Erro ao atualizar meta:", error);
      toast({
        title: "Erro",
        description: "Erro ao atualizar a meta. Tente novamente.",
        variant: "destructive",
      });
    } finally {
      setLoading(false);
    }
  };

  return (
    <Dialog open={open} onOpenChange={onOpenChange}>
      <DialogContent className="sm:max-w-[425px]">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2">
            <Target className="h-5 w-5 text-primary" />
            Editar Meta
          </DialogTitle>
          <DialogDescription>Atualize as caracterÃ­sticas da sua meta.</DialogDescription>
        </DialogHeader>

        <form onSubmit={handleSubmit} className="space-y-4">
          <div className="space-y-2">
            <Label htmlFor="edit-name">Nome da Meta *</Label>
            <Input
              id="edit-name"
              placeholder="Ex: Casa prÃ³pria..."
              value={formData.name}
              onChange={(e) => setFormData((prev) => ({ ...prev, name: e.target.value }))}
              required
            />
          </div>

          <div className="grid grid-cols-2 gap-4">
            <div className="space-y-2">
              <Label htmlFor="edit-target_amount">Valor Alvo *</Label>
              <Input
                id="edit-target_amount"
                type="number"
                step="0.01"
                min="0"
                placeholder="0,00"
                value={formData.target_amount}
                onChange={(e) => setFormData((prev) => ({ ...prev, target_amount: e.target.value }))}
                required
              />
            </div>

            <div className="space-y-2">
              <Label htmlFor="edit-current_amount">Valor Atual</Label>
              <Input
                id="edit-current_amount"
                type="number"
                step="0.01"
                min="0"
                placeholder="0,00"
                value={formData.current_amount}
                onChange={(e) => setFormData((prev) => ({ ...prev, current_amount: e.target.value }))}
                className="bg-muted"
                // Recomendado deixar readonly se a intenÃ§Ã£o Ã© que apenas investimentos alterem isso,
                // mas deixei editÃ¡vel caso precise corrigir erros manuais.
              />
            </div>
          </div>

          <div className="grid grid-cols-2 gap-4">
            <div className="space-y-2">
              <Label htmlFor="edit-color">Cor</Label>
              <Select value={formData.color} onValueChange={(value) => setFormData((prev) => ({ ...prev, color: value }))}>
                <SelectTrigger id="edit-color">
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  {colors.map((color) => (
                    <SelectItem key={color.value} value={color.value}>
                      {color.label}
                    </SelectItem>
                  ))}
                </SelectContent>
              </Select>
            </div>

            <div className="space-y-2">
              <Label htmlFor="edit-priority">Prioridade</Label>
              <Select value={formData.priority} onValueChange={(value) => setFormData((prev) => ({ ...prev, priority: value }))}>
                <SelectTrigger id="edit-priority">
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  <SelectItem value="1">1 - Alta</SelectItem>
                  <SelectItem value="2">2 - MÃ©dia-Alta</SelectItem>
                  <SelectItem value="3">3 - MÃ©dia</SelectItem>
                  <SelectItem value="4">4 - Baixa</SelectItem>
                  <SelectItem value="5">5 - MÃ­nima</SelectItem>
                </SelectContent>
              </Select>
            </div>
          </div>

          <div className="space-y-2">
            <Label htmlFor="edit-description">DescriÃ§Ã£o</Label>
            <Textarea
              id="edit-description"
              placeholder="Detalhes..."
              value={formData.description}
              onChange={(e) => setFormData((prev) => ({ ...prev, description: e.target.value }))}
              rows={3}
            />
          </div>

          <div className="space-y-2">
            <Label htmlFor="edit-target_date">Data Alvo</Label>
            <Input
              id="edit-target_date"
              type="date"
              value={formData.target_date}
              onChange={(e) => setFormData((prev) => ({ ...prev, target_date: e.target.value }))}
            />
          </div>

          <div className="flex gap-2 pt-4">
            <Button type="button" variant="outline" className="flex-1" onClick={onClose}>
              Cancelar
            </Button>
            <Button type="submit" className="flex-1" disabled={loading}>
              {loading ? "Salvando..." : "Salvar AlteraÃ§Ãµes"}
            </Button>
          </div>
        </form>
      </DialogContent>
    </Dialog>
  );
};

----------------------------------------
ENDOFFILE: src\components\dialogs\EditGoalDialog.tsx

STARTOFFILE: src\components\dialogs\EditGroupDialog.tsx
----------------------------------------
import { useState, useEffect } from "react";
import { Users, UserPlus, UserMinus, Shield, Mail, Trash2, AlertTriangle, Link as LinkIcon, Copy, Check } from "lucide-react";
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { Textarea } from "@/components/ui/textarea";
import { Badge } from "@/components/ui/badge";
import { Avatar, AvatarFallback } from "@/components/ui/avatar";
import { Switch } from "@/components/ui/switch";
import { useToast } from "@/hooks/use-toast";
import { supabase } from "@/integrations/supabase/client";
import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
} from "@/components/ui/alert-dialog";

interface GroupMember {
  id: string;
  user_id: string;
  is_admin: boolean;
  profiles?: {
    full_name: string | null;
  } | null;
}

interface Invite {
  id: string;
  email: string;
  status: string;
  created_at: string;
}

interface EditGroupDialogProps {
  groupId: string | null;
  isOpen: boolean;
  onClose: () => void;
  onSuccess?: () => void;
}

export const EditGroupDialog = ({ groupId, isOpen, onClose, onSuccess }: EditGroupDialogProps) => {
  const [loading, setLoading] = useState(false);
  const [currentUserId, setCurrentUserId] = useState<string | null>(null);
  const [groupOwnerId, setGroupOwnerId] = useState<string | null>(null);
  const [isGroupAdmin, setIsGroupAdmin] = useState(false);
  const [deleteAlertOpen, setDeleteAlertOpen] = useState(false);

  const [formData, setFormData] = useState({
    name: "",
    description: "",
    color: "blue",
  });
  const [members, setMembers] = useState<GroupMember[]>([]);
  const [pendingInvites, setPendingInvites] = useState<Invite[]>([]);
  const [newMemberEmail, setNewMemberEmail] = useState("");

  const [inviteLink, setInviteLink] = useState<string | null>(null);
  const [isCopied, setIsCopied] = useState(false);

  const { toast } = useToast();

  const colors = [
    { value: "blue", label: "Azul", class: "bg-blue-500" },
    { value: "green", label: "Verde", class: "bg-green-500" },
    { value: "purple", label: "Roxo", class: "bg-purple-500" },
    { value: "red", label: "Vermelho", class: "bg-red-500" },
    { value: "yellow", label: "Amarelo", class: "bg-yellow-500" },
    { value: "pink", label: "Rosa", class: "bg-pink-500" },
    { value: "orange", label: "Laranja", class: "bg-orange-500" },
    { value: "indigo", label: "Ãndigo", class: "bg-indigo-500" },
  ];

  useEffect(() => {
    if (groupId) {
      fetchGroupData();
      fetchMembers();
      fetchPendingInvites();
    }
  }, [groupId]);

  const fetchGroupData = async () => {
    try {
      const { data: groupData, error: groupError } = await supabase.from("groups").select("*").eq("id", groupId).single();

      if (groupError) throw groupError;

      setFormData({
        name: groupData.name,
        description: groupData.description || "",
        color: groupData.color || "blue",
      });

      setGroupOwnerId(groupData.created_by);

      const {
        data: { user },
      } = await supabase.auth.getUser();
      if (user) {
        setCurrentUserId(user.id);
        setIsGroupAdmin(groupData.created_by === user.id);
      }
    } catch (error) {
      console.error("Erro ao buscar dados do grupo:", error);
      toast({ title: "Erro", description: "NÃ£o foi possÃ­vel carregar os dados do grupo.", variant: "destructive" });
    }
  };

  const fetchMembers = async () => {
    if (!groupId) return;

    try {
      const { data, error } = await supabase
        .from("group_members")
        .select(
          `
          id,
          user_id,
          is_admin,
          profiles (
            full_name
          )
        `
        )
        .eq("group_id", groupId);

      if (error) throw error;
      setMembers(data || []);
    } catch (error) {
      console.error("Erro ao buscar membros:", error);
    }
  };

  const fetchPendingInvites = async () => {
    if (!groupId) return;

    try {
      const { data, error } = await supabase.from("group_invites").select("*").eq("group_id", groupId).eq("status", "pending");

      if (error) throw error;
      setPendingInvites(data || []);
    } catch (error) {
      console.error("Erro ao buscar convites:", error);
    }
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!groupId || !isGroupAdmin) return;

    setLoading(true);
    try {
      const { error } = await supabase
        .from("groups")
        .update({
          name: formData.name,
          description: formData.description,
          color: formData.color,
          updated_at: new Date().toISOString(),
        })
        .eq("id", groupId);

      if (error) throw error;

      toast({ title: "Sucesso", description: "Grupo atualizado com sucesso!" });
      onSuccess?.();
    } catch (error) {
      console.error("Erro ao atualizar grupo:", error);
      toast({ title: "Erro", description: "NÃ£o foi possÃ­vel atualizar o grupo.", variant: "destructive" });
    } finally {
      setLoading(false);
    }
  };

  const handleInviteMember = async () => {
    if (!newMemberEmail.trim()) return;
    setLoading(true);

    try {
      const { data: inviteData, error } = await supabase
        .from("group_invites")
        .insert({
          group_id: groupId,
          email: newMemberEmail.toLowerCase().trim(),
          status: "pending",
        })
        .select()
        .single();

      if (error) throw error;

      const baseUrl = window.location.origin;
      const link = `${baseUrl}/join-group/${inviteData.id}`;
      setInviteLink(link);

      toast({
        title: "Convite criado",
        description: "Link de convite gerado com sucesso!",
      });

      setNewMemberEmail("");
      fetchPendingInvites();
    } catch (error) {
      console.error("Erro ao enviar convite:", error);
      toast({
        title: "Erro",
        description: error.message || "NÃ£o foi possÃ­vel criar o convite.",
        variant: "destructive",
      });
    } finally {
      setLoading(false);
    }
  };

  const copyInviteLink = async () => {
    if (!inviteLink) return;

    try {
      await navigator.clipboard.writeText(inviteLink);
      setIsCopied(true);
      toast({ title: "Copiado!", description: "Link copiado para a Ã¡rea de transferÃªncia." });

      setTimeout(() => setIsCopied(false), 2000);
    } catch (error) {
      toast({
        title: "Erro",
        description: "NÃ£o foi possÃ­vel copiar o link",
        variant: "destructive",
      });
    }
  };

  const handleRemoveMember = async (memberUserId: string) => {
    if (memberUserId === groupOwnerId) {
      toast({ title: "Erro", description: "O criador do grupo nÃ£o pode ser removido.", variant: "destructive" });
      return;
    }

    setLoading(true);
    try {
      const { error } = await supabase.from("group_members").delete().eq("group_id", groupId).eq("user_id", memberUserId);

      if (error) throw error;

      toast({ title: "Membro removido", description: "O membro foi removido do grupo." });
      fetchMembers();
    } catch (error) {
      console.error("Erro ao remover membro:", error);
      toast({ title: "Erro", description: "NÃ£o foi possÃ­vel remover o membro.", variant: "destructive" });
    } finally {
      setLoading(false);
    }
  };

  const handleToggleAdmin = async (memberUserId: string, currentIsAdmin: boolean) => {
    setLoading(true);
    try {
      const { error } = await supabase
        .from("group_members")
        .update({ is_admin: !currentIsAdmin })
        .eq("group_id", groupId)
        .eq("user_id", memberUserId);

      if (error) throw error;

      toast({
        title: "Sucesso",
        description: !currentIsAdmin ? "Membro promovido a administrador." : "PrivilÃ©gios de administrador removidos.",
      });
      fetchMembers();
    } catch (error) {
      console.error("Erro ao atualizar privilÃ©gios:", error);
      toast({ title: "Erro", description: "NÃ£o foi possÃ­vel atualizar os privilÃ©gios.", variant: "destructive" });
    } finally {
      setLoading(false);
    }
  };

  const handleCancelInvite = async (inviteId: string) => {
    setLoading(true);
    try {
      const { error } = await supabase.from("group_invites").delete().eq("id", inviteId);

      if (error) throw error;

      toast({ title: "Convite cancelado", description: "O convite foi cancelado com sucesso." });
      fetchPendingInvites();
    } catch (error) {
      console.error("Erro ao cancelar convite:", error);
      toast({ title: "Erro", description: "NÃ£o foi possÃ­vel cancelar o convite.", variant: "destructive" });
    } finally {
      setLoading(false);
    }
  };

  const handleDeleteGroup = async () => {
    if (!groupId) {
      console.error("Erro: ID do grupo nÃ£o encontrado");
      toast({ title: "Erro", description: "ID do grupo nÃ£o encontrado.", variant: "destructive" });
      return;
    }

    setLoading(true);
    try {
      const { error } = await supabase.from("groups").delete().eq("id", groupId);

      if (error) throw error;

      toast({ title: "Grupo excluÃ­do", description: "O grupo e todos os seus dados foram removidos." });
      setDeleteAlertOpen(false);
      onClose();
      onSuccess?.();
    } catch (error) {
      console.error("Erro ao excluir grupo:", error);
      toast({ title: "Erro", description: "NÃ£o foi possÃ­vel excluir o grupo.", variant: "destructive" });
    } finally {
      setLoading(false);
    }
  };

  return (
    <Dialog open={isOpen} onOpenChange={onClose}>
      <DialogContent className="sm:max-w-[600px] max-h-[90vh] overflow-y-auto">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2">
            <Users className="h-5 w-5 text-primary" />
            Editar Grupo
          </DialogTitle>
          <DialogDescription>Gerencie as informaÃ§Ãµes, membros e convites do grupo.</DialogDescription>
        </DialogHeader>

        <form onSubmit={handleSubmit} className="space-y-6">
          <div className="space-y-4">
            <div className="space-y-2">
              <Label htmlFor="edit-group-name">Nome do Grupo *</Label>
              <Input
                id="edit-group-name"
                placeholder="Ex: FamÃ­lia"
                value={formData.name}
                onChange={(e) => setFormData((prev) => ({ ...prev, name: e.target.value }))}
                disabled={!isGroupAdmin}
              />
            </div>

            <div className="space-y-2">
              <Label htmlFor="edit-group-description">DescriÃ§Ã£o</Label>
              <Textarea
                id="edit-group-description"
                placeholder="Adicione uma descriÃ§Ã£o para o grupo..."
                value={formData.description}
                onChange={(e) => setFormData((prev) => ({ ...prev, description: e.target.value }))}
                disabled={!isGroupAdmin}
                className="min-h-[80px]"
              />
            </div>

            <div className="space-y-2">
              <Label htmlFor="edit-group-color">Cor do Grupo</Label>
              <Select
                value={formData.color}
                onValueChange={(value) => setFormData((prev) => ({ ...prev, color: value }))}
                disabled={!isGroupAdmin}
              >
                <SelectTrigger id="edit-group-color">
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  {colors.map((color) => (
                    <SelectItem key={color.value} value={color.value}>
                      <div className="flex items-center gap-2">
                        <div className={`w-4 h-4 rounded ${color.class}`} />
                        {color.label}
                      </div>
                    </SelectItem>
                  ))}
                </SelectContent>
              </Select>
            </div>
          </div>

          <div className="space-y-4">
            <div className="flex items-center justify-between">
              <h3 className="text-lg font-semibold flex items-center gap-2">
                <UserPlus className="h-5 w-5 text-primary" />
                Membros ({members.length})
              </h3>
            </div>

            <div className="space-y-3 max-h-[200px] overflow-y-auto">
              {members.map((member) => {
                const isOwner = member.user_id === groupOwnerId;
                return (
                  <div key={member.id} className="flex items-center justify-between p-3 rounded-lg bg-muted/50">
                    <div className="flex items-center gap-3">
                      <Avatar>
                        <AvatarFallback>{member.profiles?.full_name?.charAt(0)?.toUpperCase() || "?"}</AvatarFallback>
                      </Avatar>
                      <div>
                        <p className="font-medium">{member.profiles?.full_name || "UsuÃ¡rio sem nome"}</p>
                        <div className="flex items-center gap-2">
                          {isOwner && <Badge variant="secondary">Criador</Badge>}
                          {member.is_admin && !isOwner && <Badge variant="outline">Admin</Badge>}
                        </div>
                      </div>
                    </div>

                    {isGroupAdmin && !isOwner && (
                      <div className="flex items-center gap-2">
                        <div className="flex items-center gap-2">
                          <Label htmlFor={`admin-${member.id}`} className="text-sm">
                            Admin
                          </Label>
                          <Switch
                            id={`admin-${member.id}`}
                            checked={member.is_admin}
                            onCheckedChange={() => handleToggleAdmin(member.user_id, member.is_admin)}
                            disabled={loading}
                          />
                        </div>
                        <Button
                          type="button"
                          variant="ghost"
                          size="sm"
                          onClick={() => handleRemoveMember(member.user_id)}
                          disabled={loading}
                        >
                          <UserMinus className="h-4 w-4 text-destructive" />
                        </Button>
                      </div>
                    )}
                  </div>
                );
              })}
            </div>
          </div>

          {isGroupAdmin && (
            <div className="space-y-4">
              <h3 className="text-lg font-semibold flex items-center gap-2">
                <Mail className="h-5 w-5 text-primary" />
                Convidar Membros
              </h3>

              <div className="flex gap-2">
                <Input
                  placeholder="Email do novo membro"
                  type="email"
                  value={newMemberEmail}
                  onChange={(e) => setNewMemberEmail(e.target.value)}
                  onKeyPress={(e) => e.key === "Enter" && (e.preventDefault(), handleInviteMember())}
                />
                <Button type="button" onClick={handleInviteMember} disabled={loading || !newMemberEmail.trim()}>
                  <UserPlus className="h-4 w-4 mr-2" />
                  Gerar Link
                </Button>
              </div>

              {inviteLink && (
                <div className="p-4 bg-muted rounded-lg space-y-3">
                  <div className="flex items-center justify-between">
                    <span className="text-sm font-medium flex items-center gap-2">
                      <LinkIcon className="h-4 w-4" />
                      Link de Convite
                    </span>
                    <Button type="button" variant="outline" size="sm" onClick={copyInviteLink} className="gap-2">
                      {isCopied ? <Check className="h-4 w-4" /> : <Copy className="h-4 w-4" />}
                      {isCopied ? "Copiado!" : "Copiar"}
                    </Button>
                  </div>
                  <code className="text-xs break-all bg-background p-2 rounded block">{inviteLink}</code>
                </div>
              )}

              {pendingInvites.length > 0 && (
                <div className="space-y-2">
                  <Label className="text-sm text-muted-foreground">Convites Pendentes</Label>
                  {pendingInvites.map((invite) => (
                    <div key={invite.id} className="flex items-center justify-between p-2 rounded-md bg-muted/50">
                      <span className="text-sm">{invite.email}</span>
                      <Button type="button" variant="ghost" size="sm" onClick={() => handleCancelInvite(invite.id)} disabled={loading}>
                        Cancelar
                      </Button>
                    </div>
                  ))}
                </div>
              )}
            </div>
          )}

          <div className="flex gap-2">
            <Button type="button" variant="outline" className="flex-1" onClick={onClose}>
              Cancelar
            </Button>
            {isGroupAdmin && (
              <Button type="submit" className="flex-1" disabled={loading || !formData.name}>
                {loading ? "Salvando..." : "Salvar AlteraÃ§Ãµes"}
              </Button>
            )}
          </div>

          {isGroupAdmin && (
            <div className="mt-6 pt-6 border-t border-destructive/20">
              <div className="bg-destructive/5 p-4 rounded-md border border-destructive/20">
                <h4 className="text-destructive font-semibold flex items-center gap-2 mb-2 text-sm">
                  <AlertTriangle className="h-4 w-4" /> Zona de Perigo
                </h4>
                <p className="text-xs text-muted-foreground mb-4">
                  Excluir este grupo apagarÃ¡ permanentemente todas as transaÃ§Ãµes, investimentos e removerÃ¡ todos os membros.
                </p>
                <Button type="button" variant="destructive" size="sm" className="w-full" onClick={() => setDeleteAlertOpen(true)}>
                  <Trash2 className="h-4 w-4 mr-2" /> Excluir Grupo
                </Button>
              </div>
            </div>
          )}
        </form>

        <AlertDialog open={deleteAlertOpen} onOpenChange={setDeleteAlertOpen}>
          <AlertDialogContent>
            <AlertDialogHeader>
              <AlertDialogTitle>Tem certeza absoluta?</AlertDialogTitle>
              <AlertDialogDescription>
                Esta aÃ§Ã£o nÃ£o pode ser desfeita. Isso excluirÃ¡ permanentemente o grupo
                <strong> {formData.name} </strong> e todos os dados associados.
              </AlertDialogDescription>
            </AlertDialogHeader>
            <AlertDialogFooter>
              <AlertDialogCancel disabled={loading}>Cancelar</AlertDialogCancel>
              <AlertDialogAction
                onClick={handleDeleteGroup}
                className="bg-destructive text-destructive-foreground hover:bg-destructive/90"
                disabled={loading}
              >
                {loading ? "Excluindo..." : "Sim, excluir grupo"}
              </AlertDialogAction>
            </AlertDialogFooter>
          </AlertDialogContent>
        </AlertDialog>
      </DialogContent>
    </Dialog>
  );
};

----------------------------------------
ENDOFFILE: src\components\dialogs\EditGroupDialog.tsx

STARTOFFILE: src\components\dialogs\InvestmentAdjustmentDialog.tsx
----------------------------------------
import { useState, useEffect } from "react";
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Textarea } from "@/components/ui/textarea";
import { useToast } from "@/hooks/use-toast";
import { supabase } from "@/integrations/supabase/client";
import { Settings } from "lucide-react";

interface AggregatedInvestment {
  name: string;
  type: string;
  totalAmountInvested: number;
  totalCurrentValue: number;
  totalQuantity: number | null;
  averagePrice: number | null;
  firstInvestedAt: string;
  recordIds: string[];
}

interface InvestmentAdjustmentDialogProps {
  investment: AggregatedInvestment | null;
  open: boolean;
  onOpenChange: (open: boolean) => void;
  onSuccess?: () => void;
}

export const InvestmentAdjustmentDialog = ({ investment, open, onOpenChange, onSuccess }: InvestmentAdjustmentDialogProps) => {
  const [loading, setLoading] = useState(false);
  const [formData, setFormData] = useState({
    newCurrentValue: "",
    notes: "",
  });
  const { toast } = useToast();

  useEffect(() => {
    if (investment) {
      setFormData({
        newCurrentValue: investment.totalCurrentValue.toString(),
        notes: "",
      });
    }
  }, [investment]);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!investment) return;

    setLoading(true);
    try {
      const newValue = parseFloat(formData.newCurrentValue);

      if (isNaN(newValue) || newValue < 0) {
        toast({
          title: "Erro",
          description: "Valor invÃ¡lido",
          variant: "destructive",
        });
        return;
      }

      const lastRecordId = investment.recordIds[investment.recordIds.length - 1];

      const { error } = await supabase
        .from("investments")
        .update({
          current_value: newValue,
          quantity: null,
          unit_price: null,
        })
        .eq("id", lastRecordId);

      if (error) throw error;

      toast({
        title: "Sucesso",
        description: "Valor atualizado com sucesso!",
      });

      setFormData({
        newCurrentValue: "",
        notes: "",
      });

      onOpenChange(false);
      onSuccess?.();
    } catch (error) {
      console.error("Erro ao atualizar investimento:", error);
      toast({
        title: "Erro",
        description: "Erro ao atualizar o investimento. Tente novamente.",
        variant: "destructive",
      });
    } finally {
      setLoading(false);
    }
  };

  if (!investment) return null;

  const currentReturn =
    investment.totalAmountInvested > 0
      ? ((investment.totalCurrentValue - investment.totalAmountInvested) / investment.totalAmountInvested) * 100
      : 0;

  const newValue = parseFloat(formData.newCurrentValue) || 0;
  const newReturn =
    investment.totalAmountInvested > 0 ? ((newValue - investment.totalAmountInvested) / investment.totalAmountInvested) * 100 : 0;

  return (
    <Dialog open={open} onOpenChange={onOpenChange}>
      <DialogContent className="sm:max-w-[500px]">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2">
            <Settings className="h-5 w-5 text-primary" />
            Ajustar Investimento
          </DialogTitle>
          <DialogDescription>Atualize o valor atual de {investment.name}</DialogDescription>
        </DialogHeader>

        <form onSubmit={handleSubmit} className="space-y-4">
          <div className="space-y-4 p-4 bg-muted rounded-lg">
            <div className="flex justify-between items-center">
              <span className="text-sm text-muted-foreground">Valor Investido</span>
              <span className="font-medium">
                {new Intl.NumberFormat("pt-BR", {
                  style: "currency",
                  currency: "BRL",
                }).format(investment.totalAmountInvested)}
              </span>
            </div>
            <div className="flex justify-between items-center">
              <span className="text-sm text-muted-foreground">Valor Atual</span>
              <span className="font-medium">
                {new Intl.NumberFormat("pt-BR", {
                  style: "currency",
                  currency: "BRL",
                }).format(investment.totalCurrentValue)}
              </span>
            </div>
            <div className="flex justify-between items-center">
              <span className="text-sm text-muted-foreground">Rentabilidade Atual</span>
              <span className={`font-medium ${currentReturn >= 0 ? "text-success" : "text-destructive"}`}>
                {currentReturn >= 0 ? "+" : ""}
                {currentReturn.toFixed(2)}%
              </span>
            </div>
          </div>

          <div className="space-y-2">
            <Label htmlFor="newCurrentValue">Novo Valor Atual *</Label>
            <Input
              id="newCurrentValue"
              type="number"
              step="0.01"
              placeholder="0,00"
              value={formData.newCurrentValue}
              onChange={(e) => setFormData((prev) => ({ ...prev, newCurrentValue: e.target.value }))}
              required
            />
          </div>

          {newValue > 0 && newValue !== investment.totalCurrentValue && (
            <div className="space-y-2 p-4 bg-primary/10 rounded-lg">
              <div className="flex justify-between items-center">
                <span className="text-sm text-muted-foreground">Nova Rentabilidade</span>
                <span className={`font-medium ${newReturn >= 0 ? "text-success" : "text-destructive"}`}>
                  {newReturn >= 0 ? "+" : ""}
                  {newReturn.toFixed(2)}%
                </span>
              </div>
              <div className="flex justify-between items-center">
                <span className="text-sm text-muted-foreground">VariaÃ§Ã£o</span>
                <span className={`font-medium ${newValue - investment.totalCurrentValue >= 0 ? "text-success" : "text-destructive"}`}>
                  {new Intl.NumberFormat("pt-BR", {
                    style: "currency",
                    currency: "BRL",
                  }).format(newValue - investment.totalCurrentValue)}
                </span>
              </div>
            </div>
          )}

          <div className="space-y-2">
            <Label htmlFor="notes">ObservaÃ§Ãµes (opcional)</Label>
            <Textarea
              id="notes"
              placeholder="Adicione observaÃ§Ãµes sobre este ajuste..."
              value={formData.notes}
              onChange={(e) => setFormData((prev) => ({ ...prev, notes: e.target.value }))}
              rows={3}
            />
          </div>

          <div className="flex gap-2 pt-4">
            <Button type="button" variant="outline" className="flex-1" onClick={() => onOpenChange(false)} disabled={loading}>
              Cancelar
            </Button>
            <Button type="submit" className="flex-1" disabled={loading}>
              {loading ? "Salvando..." : "Salvar Ajuste"}
            </Button>
          </div>
        </form>
      </DialogContent>
    </Dialog>
  );
};

----------------------------------------
ENDOFFILE: src\components\dialogs\InvestmentAdjustmentDialog.tsx

STARTOFFILE: src\components\dialogs\InvestmentDetailsModal.tsx
----------------------------------------
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from "@/components/ui/dialog";
import { Badge } from "@/components/ui/badge";
import { Card, CardContent } from "@/components/ui/card";
import { TrendingUp, TrendingDown, Calendar, DollarSign } from "@/lib/icons";
import { cn } from "@/lib/utils";
import { sanitizeInput, sanitizeAmount, validateTransactionData, ensureAuthenticated, checkRateLimit } from "@/utils/security";

interface Investment {
  id: string;
  name: string;
  type: string;
  amount: number;
  current_value: number;
  maturity_date?: string;
  created_at: string;
}

interface InvestmentDetailsModalProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
  type: string;
  investments: Investment[];
}

export const InvestmentDetailsModal = ({ open, onOpenChange, type, investments }: InvestmentDetailsModalProps) => {
  const totalInvested = investments.reduce((sum, inv) => sum + inv.amount, 0);
  const totalCurrent = investments.reduce((sum, inv) => sum + inv.current_value, 0);
  const totalReturn = totalInvested > 0 ? ((totalCurrent - totalInvested) / totalInvested) * 100 : 0;
  const averageReturn = investments.length > 0 ? totalReturn / investments.length : 0;

  return (
    <Dialog open={open} onOpenChange={onOpenChange}>
      <DialogContent className="max-w-4xl max-h-[80vh] overflow-y-auto">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2">
            <TrendingUp className="h-5 w-5 text-primary" />
            Investimentos em {type}
          </DialogTitle>
          <DialogDescription>Detalhamento de todos os seus investimentos do tipo {type}</DialogDescription>
        </DialogHeader>

        <div className="space-y-6">
          {/* Summary Cards */}
          <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
            <Card>
              <CardContent className="p-4">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm font-medium text-muted-foreground">Total Investido</p>
                    <p className="text-xl font-bold">
                      {totalInvested.toLocaleString("pt-BR", {
                        style: "currency",
                        currency: "BRL",
                      })}
                    </p>
                  </div>
                  <DollarSign className="h-6 w-6 text-muted-foreground" />
                </div>
              </CardContent>
            </Card>

            <Card>
              <CardContent className="p-4">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm font-medium text-muted-foreground">Valor Atual</p>
                    <p className="text-xl font-bold text-primary">
                      {totalCurrent.toLocaleString("pt-BR", {
                        style: "currency",
                        currency: "BRL",
                      })}
                    </p>
                  </div>
                  <TrendingUp className="h-6 w-6 text-primary" />
                </div>
              </CardContent>
            </Card>

            <Card>
              <CardContent className="p-4">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm font-medium text-muted-foreground">Rentabilidade</p>
                    <p className={cn("text-xl font-bold", totalReturn >= 0 ? "text-success" : "text-destructive")}>
                      {totalReturn >= 0 ? "+" : ""}
                      {totalReturn.toFixed(2)}%
                    </p>
                  </div>
                  {totalReturn >= 0 ? (
                    <TrendingUp className="h-6 w-6 text-success" />
                  ) : (
                    <TrendingDown className="h-6 w-6 text-destructive" />
                  )}
                </div>
              </CardContent>
            </Card>

            <Card>
              <CardContent className="p-4">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm font-medium text-muted-foreground">Quantidade</p>
                    <p className="text-xl font-bold">{investments.length}</p>
                  </div>
                  <Badge variant="secondary" className="text-lg">
                    {investments.length}
                  </Badge>
                </div>
              </CardContent>
            </Card>
          </div>

          {/* Investments List */}
          <div className="space-y-4">
            <h3 className="text-lg font-semibold">Detalhamento dos Investimentos</h3>
            {investments.map((investment) => {
              const investmentReturn =
                investment.amount > 0 ? ((investment.current_value - investment.amount) / investment.amount) * 100 : 0;

              return (
                <Card key={investment.id}>
                  <CardContent className="p-4">
                    <div className="flex items-center justify-between">
                      <div className="flex items-center gap-4">
                        <div className="p-3 bg-primary/10 rounded-full">
                          <TrendingUp className="h-5 w-5 text-primary" />
                        </div>
                        <div>
                          <p className="font-medium text-foreground">{investment.name}</p>
                          <div className="flex items-center gap-2 mt-1">
                            <Badge variant="secondary" className="text-xs">
                              {investment.type}
                            </Badge>
                            {investment.maturity_date && (
                              <div className="flex items-center gap-1 text-xs text-muted-foreground">
                                <Calendar className="h-3 w-3" />
                                Venc: {new Date(investment.maturity_date).toLocaleDateString("pt-BR")}
                              </div>
                            )}
                            <div className="flex items-center gap-1 text-xs text-muted-foreground">
                              <Calendar className="h-3 w-3" />
                              Criado: {new Date(investment.created_at).toLocaleDateString("pt-BR")}
                            </div>
                          </div>
                        </div>
                      </div>

                      <div className="text-right">
                        <div className="flex items-center gap-6">
                          <div>
                            <p className="text-sm text-muted-foreground">Investido</p>
                            <p className="font-medium">
                              {investment.amount.toLocaleString("pt-BR", {
                                style: "currency",
                                currency: "BRL",
                              })}
                            </p>
                          </div>
                          <div>
                            <p className="text-sm text-muted-foreground">Atual</p>
                            <p className="font-medium">
                              {investment.current_value.toLocaleString("pt-BR", {
                                style: "currency",
                                currency: "BRL",
                              })}
                            </p>
                          </div>
                          <div>
                            <p className="text-sm text-muted-foreground">Retorno</p>
                            <p className={cn("font-semibold", investmentReturn >= 0 ? "text-success" : "text-destructive")}>
                              {investmentReturn >= 0 ? "+" : ""}
                              {investmentReturn.toFixed(2)}%
                            </p>
                          </div>
                          <div>
                            <p className="text-sm text-muted-foreground">Lucro/PrejuÃ­zo</p>
                            <p className={cn("font-semibold", investmentReturn >= 0 ? "text-success" : "text-destructive")}>
                              {(investment.current_value - investment.amount).toLocaleString("pt-BR", {
                                style: "currency",
                                currency: "BRL",
                              })}
                            </p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </CardContent>
                </Card>
              );
            })}
          </div>

          {investments.length === 0 && (
            <div className="text-center py-8 text-muted-foreground">
              <TrendingUp className="h-12 w-12 mx-auto mb-4 opacity-50" />
              <p>Nenhum investimento do tipo {type} encontrado.</p>
            </div>
          )}
        </div>
      </DialogContent>
    </Dialog>
  );
};

----------------------------------------
ENDOFFILE: src\components\dialogs\InvestmentDetailsModal.tsx

STARTOFFILE: src\components\dialogs\ManageInvestmentDialog.tsx
----------------------------------------
import { useState, useEffect } from "react";
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
} from "@/components/ui/alert-dialog";
import { useToast } from "@/hooks/use-toast";
import { supabase } from "@/integrations/supabase/client";
import { Settings, Trash2, MinusCircle } from "lucide-react";
import { format } from "@/lib/date";
import { recalculateGoalBalance } from "@/utils/investments/investmentUtils"; // Importe a funÃ§Ã£o nova

interface AggregatedInvestment {
  name: string;
  type: string;
  totalAmountInvested: number;
  totalCurrentValue: number;
  recordIds: string[];
  goalIds: (string | null)[];
}

interface ManageInvestmentDialogProps {
  investment: AggregatedInvestment | null;
  isOpen: boolean;
  onClose: () => void;
  onSuccess?: () => void;
}

export const ManageInvestmentDialog = ({ investment, isOpen, onClose, onSuccess }: ManageInvestmentDialogProps) => {
  const [loading, setLoading] = useState(false);
  const [amountToRemove, setAmountToRemove] = useState("");
  const [removalDate, setRemovalDate] = useState(format(new Date(), "yyyy-MM-dd"));
  const [deleteAlertOpen, setDeleteAlertOpen] = useState(false);
  const { toast } = useToast();

  useEffect(() => {
    if (isOpen) {
      setAmountToRemove("");
      setRemovalDate(format(new Date(), "yyyy-MM-dd"));
    }
  }, [isOpen, investment]);

  // AÃ§Ã£o 1: Retirada Parcial
  const handlePartialRemoval = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!investment || !amountToRemove) return;

    const removalVal = parseFloat(amountToRemove);
    if (isNaN(removalVal) || removalVal <= 0 || removalVal > investment.totalCurrentValue) {
      toast({ title: "Erro", description: "Valor invÃ¡lido", variant: "destructive" });
      return;
    }

    setLoading(true);
    try {
      const {
        data: { user },
      } = await supabase.auth.getUser();
      if (!user) throw new Error("UsuÃ¡rio nÃ£o logado");

      const associatedGoalId = investment.goalIds.find((id) => id !== null) || null;

      // Insere registro negativo (Retirada)
      const { error } = await supabase.from("investments").insert({
        user_id: user.id,
        name: investment.name,
        type: investment.type,
        amount: -removalVal,
        current_value: -removalVal,
        created_at: new Date(removalDate + "T00:00:00").toISOString(),
        goal_id: associatedGoalId,
      });

      if (error) throw error;

      // RECALCULA A META
      if (associatedGoalId) {
        await recalculateGoalBalance(associatedGoalId);
      }

      toast({ title: "Sucesso", description: "Resgate realizado!" });
      onClose();
      onSuccess?.();
    } catch (error) {
      toast({ title: "Erro", description: "Falha ao realizar resgate", variant: "destructive" });
    } finally {
      setLoading(false);
    }
  };

  // AÃ§Ã£o 2: ExclusÃ£o Total
  const handleTotalDeletion = async () => {
    if (!investment) return;
    setLoading(true);
    try {
      const associatedGoalId = investment.goalIds.find((id) => id !== null);

      // Deleta todos os registros
      const { error } = await supabase.from("investments").delete().in("id", investment.recordIds);
      if (error) throw error;

      // RECALCULA A META (agora que os registros sumiram, a soma serÃ¡ atualizada corretamente)
      if (associatedGoalId) {
        await recalculateGoalBalance(associatedGoalId);
      }

      toast({ title: "Sucesso", description: "Investimento excluÃ­do!" });
      setDeleteAlertOpen(false);
      onClose();
      onSuccess?.();
    } catch (error) {
      toast({ title: "Erro", description: "Falha ao excluir", variant: "destructive" });
    } finally {
      setLoading(false);
    }
  };

  if (!investment) return null;

  return (
    <Dialog open={isOpen} onOpenChange={onClose}>
      <DialogContent className="sm:max-w-[500px]">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2">
            <Settings className="h-5 w-5 text-primary" />
            Gerenciar: {investment.name}
          </DialogTitle>
          <DialogDescription>
            Saldo Atual: {investment.totalCurrentValue.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
          </DialogDescription>
        </DialogHeader>

        <Tabs defaultValue="partial" className="w-full">
          <TabsList className="grid w-full grid-cols-2">
            <TabsTrigger value="partial">Resgate Parcial</TabsTrigger>
            <TabsTrigger value="delete" className="text-destructive data-[state=active]:text-destructive">
              ExclusÃ£o Total
            </TabsTrigger>
          </TabsList>

          <TabsContent value="partial" className="space-y-4 py-4">
            <div className="space-y-4 border rounded-md p-4 bg-muted/20">
              <div className="flex items-start gap-3">
                <MinusCircle className="h-5 w-5 text-orange-500 mt-1" />
                <div className="text-sm text-muted-foreground">Registrar saque ou venda parcial.</div>
              </div>

              <form onSubmit={handlePartialRemoval} className="space-y-3">
                <div className="space-y-2">
                  <Label>Valor do Resgate</Label>
                  <Input type="number" step="0.01" value={amountToRemove} onChange={(e) => setAmountToRemove(e.target.value)} required />
                </div>
                <div className="space-y-2">
                  <Label>Data</Label>
                  <Input type="date" value={removalDate} onChange={(e) => setRemovalDate(e.target.value)} required />
                </div>
                <Button type="submit" className="w-full" disabled={loading}>
                  {loading ? "Processando..." : "Confirmar Resgate"}
                </Button>
              </form>
            </div>
          </TabsContent>

          <TabsContent value="delete" className="space-y-4 py-4">
            <div className="space-y-4 border border-destructive/30 rounded-md p-4 bg-destructive/5">
              <div className="flex items-start gap-3">
                <Trash2 className="h-5 w-5 text-destructive mt-1" />
                <div className="text-sm text-destructive">
                  Isso apagarÃ¡ <strong>todo o histÃ³rico</strong> deste investimento.
                </div>
              </div>
              <Button variant="destructive" className="w-full" onClick={() => setDeleteAlertOpen(true)} disabled={loading}>
                Excluir Investimento Permanentemente
              </Button>
            </div>
          </TabsContent>
        </Tabs>

        <AlertDialog open={deleteAlertOpen} onOpenChange={setDeleteAlertOpen}>
          <AlertDialogContent>
            <AlertDialogHeader>
              <AlertDialogTitle>Tem certeza absoluta?</AlertDialogTitle>
              <AlertDialogDescription>AÃ§Ã£o irreversÃ­vel. O saldo da meta serÃ¡ ajustado.</AlertDialogDescription>
            </AlertDialogHeader>
            <AlertDialogFooter>
              <AlertDialogCancel disabled={loading}>Cancelar</AlertDialogCancel>
              <AlertDialogAction onClick={handleTotalDeletion} className="bg-destructive hover:bg-destructive/90" disabled={loading}>
                {loading ? "Excluindo..." : "Sim, excluir tudo"}
              </AlertDialogAction>
            </AlertDialogFooter>
          </AlertDialogContent>
        </AlertDialog>
      </DialogContent>
    </Dialog>
  );
};

----------------------------------------
ENDOFFILE: src\components\dialogs\ManageInvestmentDialog.tsx

STARTOFFILE: src\components\dialogs\RemoveInvestmentAmountDialog.tsx
----------------------------------------
import { useState, useEffect } from "react";
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { useToast } from "@/hooks/use-toast";
import { supabase } from "@/integrations/supabase/client";
import { MinusCircle } from "@/lib/icons";
import { format } from "@/lib/date";

// Usaremos a interface AggregatedInvestment para tipar o investimento alvo
interface AggregatedInvestment {
  name: string;
  type: string;
  totalAmountInvested: number;
  totalCurrentValue: number;
  totalQuantity: number | null;
  averagePrice: number | null;
  firstInvestedAt: string;
  recordIds: string[];
  goalIds: (string | null)[]; // Adicionado para saber quais metas estÃ£o vinculadas
}

interface RemoveInvestmentAmountDialogProps {
  investment: AggregatedInvestment | null;
  isOpen: boolean;
  onClose: () => void;
  onSuccess?: () => void;
}

export const RemoveInvestmentAmountDialog = ({ investment, isOpen, onClose, onSuccess }: RemoveInvestmentAmountDialogProps) => {
  const [loading, setLoading] = useState(false);
  const [amountToRemove, setAmountToRemove] = useState("");
  const [removalDate, setRemovalDate] = useState(format(new Date(), "yyyy-MM-dd"));
  const { toast } = useToast();

  useEffect(() => {
    if (isOpen) {
      setAmountToRemove("");
      setRemovalDate(format(new Date(), "yyyy-MM-dd"));
    }
  }, [isOpen, investment]);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();

    if (!investment || !amountToRemove) {
      toast({
        title: "Erro",
        description: "Informe o valor a ser removido",
        variant: "destructive",
      });
      return;
    }

    const removalAmount = parseFloat(amountToRemove);
    if (isNaN(removalAmount) || removalAmount <= 0) {
      toast({
        title: "Erro",
        description: "O valor a ser removido deve ser positivo",
        variant: "destructive",
      });
      return;
    }

    if (removalAmount > investment.totalCurrentValue) {
      toast({
        title: "AtenÃ§Ã£o",
        description: "O valor a remover Ã© maior que o valor atual do investimento.",
        variant: "destructive",
      });
      return;
    }

    setLoading(true);

    try {
      const {
        data: { user },
      } = await supabase.auth.getUser();

      if (!user) throw new Error("UsuÃ¡rio nÃ£o autenticado");

      // Tenta encontrar o goal_id mais recente associado a este grupo de investimentos
      // Assume-se que a retirada afeta a meta associada ao Ãºltimo aporte, ou a mais comum
      const associatedGoalId = investment.goalIds.find((id) => id !== null) || null;

      // Criar um NOVO registro com valor NEGATIVO
      const { error } = await supabase.from("investments").insert({
        user_id: user.id,
        name: investment.name,
        type: investment.type,
        amount: -removalAmount, // Valor negativo
        current_value: -removalAmount, // Valor atual negativo tambÃ©m
        quantity: null,
        unit_price: null,
        created_at: new Date(removalDate + "T00:00:00").toISOString(),
        goal_id: associatedGoalId, // MantÃ©m o vÃ­nculo com a meta para histÃ³rico
      });

      if (error) throw error;

      // Atualizar a Meta (subtrair valor)
      if (associatedGoalId) {
        const { data: goalData } = await supabase.from("investment_goals").select("current_amount").eq("id", associatedGoalId).single();

        if (goalData) {
          const newGoalAmount = (goalData.current_amount || 0) - removalAmount;
          await supabase.from("investment_goals").update({ current_amount: newGoalAmount }).eq("id", associatedGoalId);
        }
      }

      toast({
        title: "Sucesso",
        description: `Valor de ${removalAmount.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })} removido de ${
          investment.name
        }!`,
      });

      onClose();
      onSuccess?.();
    } catch (error) {
      console.error("Erro ao remover valor do investimento:", error);
      toast({
        title: "Erro",
        description: "Erro ao remover valor. Tente novamente.",
        variant: "destructive",
      });
    } finally {
      setLoading(false);
    }
  };

  if (!investment) return null;

  return (
    <Dialog open={isOpen} onOpenChange={onClose}>
      <DialogContent className="sm:max-w-[425px]">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2">
            <MinusCircle className="h-5 w-5 text-destructive" />
            Remover Valor do Investimento
          </DialogTitle>
          <DialogDescription>Remova um valor especÃ­fico de "{investment.name}". Isso criarÃ¡ um registro de saÃ­da.</DialogDescription>
        </DialogHeader>

        <form onSubmit={handleSubmit} className="space-y-4">
          <div className="space-y-1">
            <p className="text-sm font-medium">Investimento:</p>
            <p className="text-sm text-muted-foreground">
              {investment.name} ({investment.type})
            </p>
            <p className="text-sm text-muted-foreground">
              Valor Atual: {investment.totalCurrentValue.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
            </p>
          </div>

          <div className="space-y-2">
            <Label htmlFor="amountToRemove">Valor a Remover *</Label>
            <Input
              id="amountToRemove"
              type="number"
              step="0.01"
              min="0.01"
              placeholder="0,00"
              value={amountToRemove}
              onChange={(e) => setAmountToRemove(e.target.value)}
              required
            />
          </div>

          <div className="space-y-2">
            <Label htmlFor="removalDate">Data da RemoÃ§Ã£o *</Label>
            <Input id="removalDate" type="date" value={removalDate} onChange={(e) => setRemovalDate(e.target.value)} required />
          </div>

          <div className="flex gap-2 pt-4">
            <Button type="button" variant="outline" className="flex-1" onClick={onClose}>
              Cancelar
            </Button>
            <Button type="submit" variant="destructive" className="flex-1" disabled={loading}>
              {loading ? "Removendo..." : "Confirmar RemoÃ§Ã£o"}
            </Button>
          </div>
        </form>
      </DialogContent>
    </Dialog>
  );
};

----------------------------------------
ENDOFFILE: src\components\dialogs\RemoveInvestmentAmountDialog.tsx

STARTOFFILE: src\components\filters\DateFilter.tsx
----------------------------------------
import { useState } from "react";
import { format, startOfMonth, endOfMonth, startOfYear, endOfYear, subMonths, addMonths } from "@/lib/date";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";

export interface DateRange {
  from: Date;
  to: Date;
}

interface DateFilterProps {
  dateRange: DateRange;
  onDateRangeChange: (range: DateRange) => void;
}

export const DateFilter = ({ dateRange, onDateRangeChange }: DateFilterProps) => {
  const [selectedPreset, setSelectedPreset] = useState("current-month");
  const presets = [
    {
      label: "Este mÃªs",
      value: "current-month",
      getRange: () => ({
        from: startOfMonth(new Date()),
        to: endOfMonth(new Date()),
      }),
    },
    {
      label: "MÃªs passado",
      value: "last-month",
      getRange: () => {
        const lastMonth = subMonths(new Date(), 1);
        return {
          from: startOfMonth(lastMonth),
          to: endOfMonth(lastMonth),
        };
      },
    },
    {
      label: "PrÃ³ximo mÃªs",
      value: "next-month",
      getRange: () => {
        const nextMonth = addMonths(new Date(), 1);
        return {
          from: startOfMonth(nextMonth),
          to: endOfMonth(nextMonth),
        };
      },
    },
    {
      label: "Este ano",
      value: "current-year",
      getRange: () => ({
        from: startOfYear(new Date()),
        to: endOfYear(new Date()),
      }),
    },
    {
      label: "Personalizado",
      value: "custom",
      getRange: () => dateRange,
    },
  ];
  const handlePresetChange = (value: string) => {
    setSelectedPreset(value);
    if (value !== "custom") {
      const preset = presets.find((p) => p.value === value);
      if (preset) {
        onDateRangeChange(preset.getRange());
      }
    }
  };
  const handleFromDateChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    // ForÃ§a a data a ser interpretada no fuso horÃ¡rio local
    const newDate = new Date(e.target.value + "T00:00:00");
    if (!isNaN(newDate.getTime())) {
      onDateRangeChange({ from: newDate, to: dateRange.to });
      setSelectedPreset("custom");
    }
  };
  const handleToDateChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    // ForÃ§a a data a ser interpretada no fuso horÃ¡rio local
    const newDate = new Date(e.target.value + "T00:00:00");
    if (!isNaN(newDate.getTime())) {
      onDateRangeChange({ from: dateRange.from, to: newDate });
      setSelectedPreset("custom");
    }
  };
  return (
    <div className="flex flex-wrap items-end gap-4">
      <div className="w-full sm:w-auto">
        <Label htmlFor="preset" className="mb-2 block">
          PerÃ­odo
        </Label>
        <Select value={selectedPreset} onValueChange={handlePresetChange}>
          <SelectTrigger id="preset" className="w-full sm:w-[180px]">
            <SelectValue />
          </SelectTrigger>
          <SelectContent>
            {presets.map((preset) => (
              <SelectItem key={preset.value} value={preset.value}>
                {preset.label}
              </SelectItem>
            ))}
          </SelectContent>
        </Select>
      </div>

      <div className="w-full sm:w-auto">
        <Label htmlFor="date-from" className="mb-2 block">
          Data InÃ­cio
        </Label>
        <Input
          id="date-from"
          type="date"
          value={format(dateRange.from, "yyyy-MM-dd")}
          onChange={handleFromDateChange}
          className="w-full sm:w-[160px]"
        />
      </div>

      <div className="w-full sm:w-auto">
        <Label htmlFor="date-to" className="mb-2 block">
          Data Fim
        </Label>

        <Input
          id="date-to"
          type="date"
          value={format(dateRange.to, "yyyy-MM-dd")}
          onChange={handleToDateChange}
          className="w-full sm:w-[160px]"
        />
      </div>

      {selectedPreset === "custom" && (
        <Button variant="outline" size="sm" onClick={() => handlePresetChange("current-month")} className="w-full sm:w-auto">
          Resetar
        </Button>
      )}
    </div>
  );
};

----------------------------------------
ENDOFFILE: src\components\filters\DateFilter.tsx

STARTOFFILE: src\components\groups\GroupDetailsModal.tsx
----------------------------------------
import { useState, useEffect } from "react";
import { Dialog, DialogContent, DialogHeader, DialogTitle } from "@/components/ui/dialog";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import {
  DollarSign,
  TrendingUp,
  TrendingDown,
  PiggyBank,
  Calendar,
  ArrowUpCircle,
  ArrowDownCircle,
  Plus,
  User,
  Users,
  Trash2,
  Scale,
  ArrowRight,
} from "@/lib/icons";
import { supabase } from "@/integrations/supabase/client";
import { useToast } from "@/hooks/use-toast";
import { cn } from "@/lib/utils";
import { Button } from "@/components/ui/button";
import { AddTransactionDialog } from "@/components/dialogs/AddTransactionDialog";
import { AddInvestmentDialog } from "@/components/dialogs/AddInvestmentDialog";
import { Avatar, AvatarFallback } from "@/components/ui/avatar";
import { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from "@/components/ui/tooltip";
import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
} from "@/components/ui/alert-dialog";

interface GroupDetailsModalProps {
  isOpen: boolean;
  onClose: () => void;
  groupId: string;
  groupName: string;
}

interface Transaction {
  id: string;
  description: string;
  amount: number;
  type: "income" | "expense";
  category: string;
  date: string;
  user_id: string; // Criador
  payer_id: string; // Pagador
  profiles: { full_name: string | null } | null; // Perfil do criador
  payer_profile: { full_name: string | null } | null; // Perfil do pagador (Novo)
  transaction_splits: {
    user_id: string;
    amount: number;
    profiles: { full_name: string | null } | null;
  }[];
}

interface Balance {
  userId: string;
  userName: string;
  amount: number; // Positivo = A receber, Negativo = Deve
}

interface GroupMetrics {
  totalIncome: number;
  totalExpenses: number;
  totalInvestments: number;
  balance: number;
  myIncome: number;
  myExpenses: number;
  myBalance: number;
}

export const GroupDetailsModal = ({ isOpen, onClose, groupId, groupName }: GroupDetailsModalProps) => {
  const [transactions, setTransactions] = useState<Transaction[]>([]);
  const [investments, setInvestments] = useState<any[]>([]);
  const [balances, setBalances] = useState<Balance[]>([]);
  const [metrics, setMetrics] = useState<GroupMetrics>({
    totalIncome: 0,
    totalExpenses: 0,
    totalInvestments: 0,
    balance: 0,
    myIncome: 0,
    myExpenses: 0,
    myBalance: 0,
  });
  const [loading, setLoading] = useState(false);
  const [currentUser, setCurrentUser] = useState<string | null>(null);

  const [deleteAlertOpen, setDeleteAlertOpen] = useState(false);
  const [transactionToDelete, setTransactionToDelete] = useState<string | null>(null);

  const { toast } = useToast();

  useEffect(() => {
    if (isOpen && groupId) loadGroupData();
  }, [isOpen, groupId]);

  const loadGroupData = async () => {
    try {
      setLoading(true);
      const {
        data: { user },
      } = await supabase.auth.getUser();
      if (!user) return;
      setCurrentUser(user.id);

      // 1. Transactions with Payer Profile
      const { data: transactionsData, error: transError } = await supabase
        .from("transactions")
        .select(
          `
          *,
          profiles!user_id (full_name),
          payer_profile:profiles!payer_id (full_name),
          transaction_splits (
            user_id,
            amount,
            profiles (full_name)
          )
        `
        )
        .eq("group_id", groupId)
        .order("date", { ascending: false });

      if (transError) throw transError;

      // 2. Investments
      const { data: investmentsData } = await supabase.from("investments").select("*").eq("group_id", groupId);

      // Format Data
      const formattedTransactions: Transaction[] = (transactionsData || []).map((t: any) => ({
        id: t.id,
        description: t.description,
        amount: Number(t.amount),
        type: t.type,
        category: t.category,
        date: t.date,
        user_id: t.user_id,
        payer_id: t.payer_id || t.user_id, // Fallback para user_id se payer_id for null
        profiles: t.profiles,
        payer_profile: t.payer_profile || t.profiles, // Fallback
        transaction_splits: t.transaction_splits || [],
      }));

      setTransactions(formattedTransactions);
      setInvestments(investmentsData || []);

      // --- CÃLCULO DE SALDOS (NET BALANCES) ---
      const balancesMap = new Map<string, { name: string; amount: number }>();

      formattedTransactions.forEach((t) => {
        if (t.type === "expense") {
          // Focamos em despesas para dÃ­vidas
          const amount = Math.abs(t.amount);

          // 1. CrÃ©dito para quem pagou
          const payerId = t.payer_id;
          const payerName = t.payer_profile?.full_name || "Desconhecido";

          if (!balancesMap.has(payerId)) balancesMap.set(payerId, { name: payerName, amount: 0 });
          balancesMap.get(payerId)!.amount += amount;

          // 2. DÃ©bito para quem consumiu (Splits)
          t.transaction_splits.forEach((split) => {
            const consumerId = split.user_id;
            const consumerName = split.profiles?.full_name || "Desconhecido";

            if (!balancesMap.has(consumerId)) balancesMap.set(consumerId, { name: consumerName, amount: 0 });
            balancesMap.get(consumerId)!.amount -= split.amount;
          });
        }
      });

      const balancesArray = Array.from(balancesMap.entries())
        .map(([userId, data]) => ({
          userId,
          userName: data.name,
          amount: data.amount,
        }))
        .sort((a, b) => b.amount - a.amount); // Ordena quem tem mais a receber primeiro

      setBalances(balancesArray);

      // --- CÃLCULOS DE MÃ‰TRICAS ---
      const income = formattedTransactions.filter((t) => t.type === "income").reduce((sum, t) => sum + t.amount, 0);
      const expenses = formattedTransactions.filter((t) => t.type === "expense").reduce((sum, t) => sum + Math.abs(t.amount), 0);

      let myIncome = 0;
      let myExpenses = 0;

      formattedTransactions.forEach((t) => {
        const mySplit = t.transaction_splits.find((split) => split.user_id === user.id);
        if (mySplit) {
          if (t.type === "income") myIncome += mySplit.amount;
          else myExpenses += mySplit.amount;
        }
      });

      setMetrics({
        totalIncome: income,
        totalExpenses: expenses,
        totalInvestments: 0,
        balance: income - expenses,
        myIncome,
        myExpenses,
        myBalance: myIncome - myExpenses,
      });
    } catch (error) {
      console.error(error);
    } finally {
      setLoading(false);
    }
  };

  const handleDeleteConfirm = async () => {
    if (!transactionToDelete) return;
    try {
      const { error } = await supabase.from("transactions").delete().eq("id", transactionToDelete);
      if (error) throw error;
      toast({ title: "Removido", description: "LanÃ§amento removido." });
      loadGroupData();
    } catch {
      toast({ variant: "destructive", title: "Erro", description: "Erro ao remover." });
    } finally {
      setDeleteAlertOpen(false);
    }
  };

  return (
    <Dialog open={isOpen} onOpenChange={onClose}>
      <DialogContent className="max-w-4xl max-h-[90vh] overflow-y-auto">
        <DialogHeader>
          <DialogTitle>Grupo: {groupName}</DialogTitle>
        </DialogHeader>

        <div className="flex gap-2 mb-4 flex-wrap">
          <AddTransactionDialog
            type="expense"
            defaultGroupId={groupId}
            onSuccess={loadGroupData}
            trigger={
              <Button variant="destructive" size="sm">
                <Plus className="h-4 w-4 mr-2" /> Despesa
              </Button>
            }
          />
          <AddTransactionDialog
            type="income"
            defaultGroupId={groupId}
            onSuccess={loadGroupData}
            trigger={
              <Button variant="default" size="sm" className="bg-success hover:bg-success/90">
                <Plus className="h-4 w-4 mr-2" /> Receita
              </Button>
            }
          />
          <AddInvestmentDialog
            defaultGroupId={groupId}
            onSuccess={loadGroupData}
            trigger={
              <Button variant="outline" size="sm">
                <PiggyBank className="h-4 w-4 mr-2" /> Investir
              </Button>
            }
          />
        </div>

        {loading ? (
          <div className="text-center py-10">Carregando...</div>
        ) : (
          <div className="space-y-6">
            <div className="grid grid-cols-2 lg:grid-cols-4 gap-4">
              {/* Cards de MÃ©tricas (Simplificados para focar no novo recurso) */}
              <Card>
                <CardHeader className="pb-2">
                  <CardTitle className="text-sm">Total Despesas</CardTitle>
                </CardHeader>
                <CardContent>
                  <div className="text-xl font-bold text-destructive">
                    {metrics.totalExpenses.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                  </div>
                </CardContent>
              </Card>
              <Card>
                <CardHeader className="pb-2">
                  <CardTitle className="text-sm">Minha Parte</CardTitle>
                </CardHeader>
                <CardContent>
                  <div className="text-xl font-bold text-destructive">
                    {metrics.myExpenses.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                  </div>
                </CardContent>
              </Card>
            </div>

            <Tabs defaultValue="transactions" className="w-full">
              <TabsList className="grid w-full grid-cols-3">
                <TabsTrigger value="transactions">TransaÃ§Ãµes</TabsTrigger>
                <TabsTrigger value="balances">Saldos & DÃ­vidas</TabsTrigger>
                <TabsTrigger value="investments">Investimentos</TabsTrigger>
              </TabsList>

              {/* ABA TRANSAÃ‡Ã•ES */}
              <TabsContent value="transactions" className="space-y-4">
                {transactions.length === 0 ? (
                  <p className="text-center text-muted-foreground py-8">Sem lanÃ§amentos.</p>
                ) : (
                  <div className="space-y-3">
                    {transactions.map((t) => {
                      const isPayer = t.payer_id === currentUser;
                      const mySplit = t.transaction_splits.find((s) => s.user_id === currentUser);

                      return (
                        <div key={t.id} className="flex flex-col gap-2 p-4 rounded-lg border bg-card">
                          <div className="flex justify-between items-start">
                            <div className="flex gap-3">
                              <div
                                className={cn(
                                  "p-2 rounded-full h-fit",
                                  t.type === "income" ? "bg-success/10 text-success" : "bg-destructive/10 text-destructive"
                                )}
                              >
                                {t.type === "income" ? <ArrowUpCircle className="h-5 w-5" /> : <ArrowDownCircle className="h-5 w-5" />}
                              </div>
                              <div>
                                <p className="font-medium">{t.description}</p>
                                <div className="text-xs text-muted-foreground flex flex-col gap-1">
                                  <span>
                                    {new Date(t.date).toLocaleDateString("pt-BR")} â€¢ {t.category}
                                  </span>
                                  <span className="text-foreground/80">
                                    Pago por <strong>{isPayer ? "VocÃª" : t.payer_profile?.full_name?.split(" ")[0]}</strong>
                                  </span>
                                </div>
                              </div>
                            </div>
                            <div className="text-right">
                              <p className="font-bold">{t.amount.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}</p>
                              {mySplit && (
                                <p className="text-xs text-muted-foreground">
                                  Sua parte:{" "}
                                  <span className="text-destructive">
                                    {mySplit.amount.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                                  </span>
                                </p>
                              )}
                            </div>
                          </div>

                          <div className="flex justify-between items-center pt-2 border-t mt-1">
                            <div className="flex -space-x-2">
                              {t.transaction_splits.map((split, i) => (
                                <TooltipProvider key={i}>
                                  <Tooltip>
                                    <TooltipTrigger>
                                      <Avatar className="h-6 w-6 border-2 border-background">
                                        <AvatarFallback className="text-[9px] bg-primary/20">
                                          {split.profiles?.full_name?.charAt(0)}
                                        </AvatarFallback>
                                      </Avatar>
                                    </TooltipTrigger>
                                    <TooltipContent>
                                      <p className="text-xs">
                                        {split.profiles?.full_name}:{" "}
                                        {split.amount.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                                      </p>
                                    </TooltipContent>
                                  </Tooltip>
                                </TooltipProvider>
                              ))}
                            </div>
                            {(isPayer || currentUser === t.user_id) && (
                              <Button
                                variant="ghost"
                                size="icon"
                                className="h-7 w-7 text-destructive"
                                onClick={() => {
                                  setTransactionToDelete(t.id);
                                  setDeleteAlertOpen(true);
                                }}
                              >
                                <Trash2 className="h-3 w-3" />
                              </Button>
                            )}
                          </div>
                        </div>
                      );
                    })}
                  </div>
                )}
              </TabsContent>

              {/* ABA SALDOS (NET BALANCES) */}
              <TabsContent value="balances" className="space-y-4">
                <Card>
                  <CardHeader>
                    <CardTitle className="flex items-center gap-2">
                      <Scale className="h-5 w-5" /> Saldos LÃ­quidos
                    </CardTitle>
                  </CardHeader>
                  <CardContent>
                    {balances.length === 0 ? (
                      <p className="text-center text-muted-foreground">Sem dados de saldo.</p>
                    ) : (
                      <div className="space-y-4">
                        {balances.map((balance) => {
                          const isMe = balance.userId === currentUser;
                          const statusColor =
                            balance.amount > 0 ? "text-success" : balance.amount < 0 ? "text-destructive" : "text-muted-foreground";
                          const statusText = balance.amount > 0 ? "deve receber" : balance.amount < 0 ? "deve" : "estÃ¡ quite";

                          return (
                            <div key={balance.userId} className="flex items-center justify-between p-3 border-b last:border-0">
                              <div className="flex items-center gap-3">
                                <Avatar>
                                  <AvatarFallback>{balance.userName.charAt(0)}</AvatarFallback>
                                </Avatar>
                                <div>
                                  <p className="font-medium text-sm">{isMe ? "VocÃª" : balance.userName}</p>
                                  <p className={cn("text-xs font-bold", statusColor)}>
                                    {statusText}{" "}
                                    {balance.amount !== 0 &&
                                      Math.abs(balance.amount).toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                                  </p>
                                </div>
                              </div>
                              {balance.amount !== 0 && (
                                <Badge
                                  variant={balance.amount > 0 ? "outline" : "destructive"}
                                  className={balance.amount > 0 ? "text-success border-success" : ""}
                                >
                                  {balance.amount > 0 ? "+" : "-"}
                                  {Math.abs(balance.amount).toFixed(2)}
                                </Badge>
                              )}
                            </div>
                          );
                        })}
                      </div>
                    )}
                  </CardContent>
                </Card>
              </TabsContent>

              <TabsContent value="investments">
                <p className="text-center py-4">Investimentos...</p>
              </TabsContent>
            </Tabs>
          </div>
        )}

        <AlertDialog open={deleteAlertOpen} onOpenChange={setDeleteAlertOpen}>
          <AlertDialogContent>
            <AlertDialogHeader>
              <AlertDialogTitle>Excluir?</AlertDialogTitle>
              <AlertDialogDescription>AÃ§Ã£o irreversÃ­vel.</AlertDialogDescription>
            </AlertDialogHeader>
            <AlertDialogFooter>
              <AlertDialogCancel>Cancelar</AlertDialogCancel>
              <AlertDialogAction onClick={handleDeleteConfirm}>Excluir</AlertDialogAction>
            </AlertDialogFooter>
          </AlertDialogContent>
        </AlertDialog>
      </DialogContent>
    </Dialog>
  );
};

----------------------------------------
ENDOFFILE: src\components\groups\GroupDetailsModal.tsx

STARTOFFILE: src\components\layout\DashboardLayout.tsx
----------------------------------------
import { ReactNode, useState } from "react";
import { Menu } from "@/lib/icons";

import { Sidebar } from "@/components/layout/Sidebar";
import { Button } from "@/components/ui/button";
import { Sheet, SheetContent, SheetTrigger } from "@/components/ui/sheet";

interface DashboardLayoutProps {
  children: ReactNode;
}

export const DashboardLayout = ({ children }: DashboardLayoutProps) => {
  const [sidebarOpen, setSidebarOpen] = useState(false);

  return (
    <div className="flex min-h-screen w-full bg-background">
      <aside className="hidden md:flex md:w-64 md:flex-col md:fixed md:inset-y-0 md:z-50">
        <Sidebar />
      </aside>

      <div className="flex flex-col flex-1 md:pl-64">
        <header className="sticky top-0 z-40 flex h-14 items-center gap-4 border-b bg-background px-4 md:hidden">
          <Sheet open={sidebarOpen} onOpenChange={setSidebarOpen}>
            <SheetTrigger asChild>
              <Button variant="ghost" size="icon" className="md:hidden">
                <Menu className="h-5 w-5" />
              </Button>
            </SheetTrigger>
            <SheetContent side="left" className="p-0 w-64">
              <Sidebar onNavigate={() => setSidebarOpen(false)} />
            </SheetContent>
          </Sheet>
          <h1 className="text-lg font-semibold">Zeni Wallet</h1>
        </header>

        <main className="flex-1 overflow-y-auto">
          <div className="h-full">{children}</div>
        </main>
      </div>
    </div>
  );
};

----------------------------------------
ENDOFFILE: src\components\layout\DashboardLayout.tsx

STARTOFFILE: src\components\layout\Sidebar.tsx
----------------------------------------
import { NavLink, useNavigate } from "react-router-dom";
import { LayoutDashboard, ArrowUpDown, TrendingUp, Users, PlusCircle, DollarSign, LogOut, Bell, User } from "lucide-react";

import { Button } from "@/components/ui/button";
import { Separator } from "@/components/ui/separator";

import { useAuth } from "@/contexts/AuthContext";

interface SidebarProps {
  onNavigate?: () => void;
}

const navigation = [
  { name: "Dashboard", href: "/dashboard", icon: LayoutDashboard },
  { name: "TransaÃ§Ãµes", href: "/transactions", icon: ArrowUpDown },
  { name: "Investimentos", href: "/investments", icon: TrendingUp },
  { name: "Grupos", href: "/groups", icon: Users },
  { name: "Lembretes", href: "/reminders", icon: Bell },
  { name: "Meu Perfil", href: "/profile", icon: User },
  { name: "Novo LanÃ§amento", href: "/new-transaction", icon: PlusCircle },
];

export const Sidebar = ({ onNavigate }: SidebarProps) => {
  const { signOut, user } = useAuth();
  const navigate = useNavigate();

  const handleLogout = async () => {
    await signOut();
    navigate("/auth");
  };

  const handleNavClick = () => {
    if (onNavigate) {
      onNavigate();
    }
  };

  return (
    <div className="flex h-full w-full flex-col bg-card border-r border-border">
      <div className="p-6">
        <div className="flex items-center gap-2 mb-2">
          <DollarSign className="h-8 w-8 text-primary" />
          <h1 className="text-xl font-bold text-foreground">Zeni Wallet</h1>
        </div>
        {user && <p className="text-sm text-muted-foreground truncate">OlÃ¡, {user.email}</p>}
      </div>

      <Separator />

      <nav className="flex-1 overflow-y-auto p-4 space-y-2">
        {navigation.map((item) => (
          <NavLink
            key={item.href}
            to={item.href}
            onClick={handleNavClick}
            className={({ isActive }) =>
              `flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium transition-colors ${
                isActive ? "bg-primary text-primary-foreground" : "text-muted-foreground hover:bg-muted hover:text-foreground"
              }`
            }
          >
            <item.icon className="h-5 w-5" />
            <span>{item.name}</span>
          </NavLink>
        ))}
      </nav>

      <Separator />

      <div className="p-4">
        <Button variant="ghost" className="w-full justify-start gap-3" onClick={handleLogout}>
          <LogOut className="h-5 w-5" />
          <span>Sair</span>
        </Button>
      </div>
    </div>
  );
};

----------------------------------------
ENDOFFILE: src\components\layout\Sidebar.tsx

STARTOFFILE: src\components\LoadingFallback.tsx
----------------------------------------
import { Loader2 } from "lucide-react";

export const LoadingFallback = () => {
  return (
    <div className="min-h-screen flex items-center justify-center bg-background">
      <div className="flex flex-col items-center gap-4">
        <Loader2 className="h-12 w-12 animate-spin text-primary" />
        <p className="text-sm text-muted-foreground">Carregando...</p>
      </div>
    </div>
  );
};

----------------------------------------
ENDOFFILE: src\components\LoadingFallback.tsx

STARTOFFILE: src\components\PWAPrompt.tsx
----------------------------------------
import { useEffect } from "react";
import { Button } from "../components/ui/button";
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "../components/ui/card";
import { RefreshCw, X } from "lucide-react";

import { usePWA } from "../hooks/usePWA";

import type { FC } from "react";

const PWAPrompt: FC = () => {
  const { needRefresh, offlineReady, updateApp, close } = usePWA();

  useEffect(() => {
    if (offlineReady) {
      console.log("App pronta para funcionar offline");
    }
  }, [offlineReady]);

  if (!needRefresh && !offlineReady) {
    return null;
  }

  return (
    <div className="fixed bottom-4 right-4 z-50 max-w-sm">
      <Card className="border-primary">
        <CardHeader className="pb-3">
          <div className="flex items-center justify-between">
            <CardTitle className="text-base">{needRefresh ? "AtualizaÃ§Ã£o DisponÃ­vel" : "App Pronto"}</CardTitle>
            <Button variant="ghost" size="icon" className="h-6 w-6" onClick={close}>
              <X className="h-4 w-4" />
            </Button>
          </div>
          <CardDescription>
            {needRefresh ? "Uma nova versÃ£o do app estÃ¡ disponÃ­vel" : "O app estÃ¡ pronto para funcionar offline"}
          </CardDescription>
        </CardHeader>
        <CardContent className="pt-0">
          {needRefresh && (
            <Button onClick={updateApp} className="w-full" size="sm">
              <RefreshCw className="mr-2 h-4 w-4" />
              Atualizar Agora
            </Button>
          )}
        </CardContent>
      </Card>
    </div>
  );
};

export default PWAPrompt;

----------------------------------------
ENDOFFILE: src\components\PWAPrompt.tsx

STARTOFFILE: src\components\reminders\RemindersList.tsx
----------------------------------------
import { useState } from "react";
import { Bell, BellOff, Check, Trash2, Clock, RefreshCw } from "lucide-react";
import { format } from "date-fns";
import { ptBR } from "date-fns/locale";

import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import { Switch } from "@/components/ui/switch";
import { Label } from "@/components/ui/label";
import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
} from "@/components/ui/alert-dialog";

import { useReminders } from "@/hooks/useReminders";
import { AddReminderDialog } from "@/components/dialogs/AddReminderDialog";

import { cn } from "@/lib/utils";

import type { Reminder } from "@/utils/types/reminder";

const REPEAT_TYPE_LABELS = {
  none: "NÃ£o repete",
  daily: "Diariamente",
  weekly: "Semanalmente",
  monthly: "Mensalmente",
  yearly: "Anualmente",
};

export const RemindersList = () => {
  const {
    reminders,
    loading,
    isSubscribed,
    notificationPermission,
    completeReminder,
    deleteReminder,
    enableNotifications,
    disableNotifications,
  } = useReminders();

  const [reminderToDelete, setReminderToDelete] = useState<Reminder | null>(null);

  const handleComplete = async (id: string) => {
    await completeReminder(id);
  };

  const handleDelete = async () => {
    if (!reminderToDelete) return;
    await deleteReminder(reminderToDelete.id);
    setReminderToDelete(null);
  };

  const formatReminderDate = (dateString: string) => {
    const date = new Date(dateString);
    return format(date, "dd/MM/yyyy 'Ã s' HH:mm", { locale: ptBR });
  };

  const isOverdue = (dateString: string) => {
    const reminderDate = new Date(dateString);
    const now = new Date();
    return reminderDate.getTime() < now.getTime();
  };

  const sortedReminders = [...reminders].sort((a, b) => {
    if (a.is_completed !== b.is_completed) {
      return a.is_completed ? 1 : -1;
    }
    return new Date(a.reminder_date).getTime() - new Date(b.reminder_date).getTime();
  });

  return (
    <div className="space-y-6">
      <Card>
        <CardHeader>
          <div className="flex items-center justify-between">
            <div>
              <CardTitle>NotificaÃ§Ãµes Push</CardTitle>
              <CardDescription>Receba lembretes mesmo quando nÃ£o estiver usando o aplicativo</CardDescription>
            </div>
            <div className="flex items-center space-x-2">
              <Switch
                id="notifications"
                checked={isSubscribed}
                onCheckedChange={(checked) => {
                  if (checked) {
                    enableNotifications();
                  } else {
                    disableNotifications();
                  }
                }}
                disabled={notificationPermission === "denied"}
              />
              <Label htmlFor="notifications" className="cursor-pointer">
                {isSubscribed ? <Bell className="h-5 w-5" /> : <BellOff className="h-5 w-5" />}
              </Label>
            </div>
          </div>
          {notificationPermission === "denied" && (
            <p className="text-sm text-destructive mt-2">
              As notificaÃ§Ãµes foram bloqueadas. Altere as configuraÃ§Ãµes do navegador para habilitar.
            </p>
          )}
          {notificationPermission === "default" && !isSubscribed && (
            <p className="text-sm text-muted-foreground mt-2">Ative as notificaÃ§Ãµes para receber lembretes no desktop</p>
          )}
        </CardHeader>
      </Card>

      <Card>
        <CardHeader>
          <div className="flex items-center justify-between">
            <div>
              <CardTitle>Meus Lembretes</CardTitle>
              <CardDescription>
                {reminders.length === 0
                  ? "Nenhum lembrete cadastrado"
                  : `${reminders.filter((r) => !r.is_completed).length} lembretes ativos`}
              </CardDescription>
            </div>
            <AddReminderDialog />
          </div>
        </CardHeader>
        <CardContent>
          {loading ? (
            <div className="flex justify-center py-8">
              <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
            </div>
          ) : sortedReminders.length === 0 ? (
            <div className="text-center py-8 text-muted-foreground">
              <Bell className="h-12 w-12 mx-auto mb-2 opacity-20" />
              <p>Nenhum lembrete cadastrado</p>
              <p className="text-sm mt-1">Adicione lembretes para nÃ£o esquecer seus compromissos financeiros</p>
            </div>
          ) : (
            <div className="space-y-3">
              {sortedReminders.map((reminder) => {
                const overdueStatus = !reminder.is_completed && isOverdue(reminder.reminder_date);

                return (
                  <div
                    key={reminder.id}
                    className={cn(
                      "flex items-start gap-3 p-4 rounded-lg border transition-colors",
                      reminder.is_completed
                        ? "bg-muted/50 opacity-60"
                        : overdueStatus
                        ? "bg-destructive/5 border-destructive/20"
                        : "bg-card hover:bg-accent/5"
                    )}
                  >
                    <div className="flex-1 space-y-1">
                      <div className="flex items-start justify-between gap-2">
                        <h4 className={cn("font-medium", reminder.is_completed && "line-through text-muted-foreground")}>
                          {reminder.title}
                        </h4>
                        <div className="flex items-center gap-1">
                          {!reminder.is_completed && (
                            <Button
                              variant="ghost"
                              size="icon"
                              className="h-8 w-8 text-success hover:text-success hover:bg-success/10"
                              onClick={() => handleComplete(reminder.id)}
                              title="Marcar como concluÃ­do"
                            >
                              <Check className="h-4 w-4" />
                            </Button>
                          )}
                          <Button
                            variant="ghost"
                            size="icon"
                            className="h-8 w-8 text-destructive hover:text-destructive hover:bg-destructive/10"
                            onClick={() => setReminderToDelete(reminder)}
                            title="Excluir lembrete"
                          >
                            <Trash2 className="h-4 w-4" />
                          </Button>
                        </div>
                      </div>
                      {reminder.description && <p className="text-sm text-muted-foreground">{reminder.description}</p>}
                      <div className="flex items-center gap-2 flex-wrap">
                        <Badge
                          variant={reminder.is_completed ? "secondary" : overdueStatus ? "destructive" : "default"}
                          className="text-xs"
                        >
                          <Clock className="h-3 w-3 mr-1" />
                          {formatReminderDate(reminder.reminder_date)}
                        </Badge>
                        {reminder.repeat_type && reminder.repeat_type !== "none" && (
                          <Badge variant="outline" className="text-xs">
                            <RefreshCw className="h-3 w-3 mr-1" />
                            {REPEAT_TYPE_LABELS[reminder.repeat_type]}
                          </Badge>
                        )}
                        {reminder.is_completed && (
                          <Badge variant="secondary" className="text-xs">
                            ConcluÃ­do
                          </Badge>
                        )}
                        {overdueStatus && (
                          <Badge variant="destructive" className="text-xs">
                            Atrasado
                          </Badge>
                        )}
                      </div>
                    </div>
                  </div>
                );
              })}
            </div>
          )}
        </CardContent>
      </Card>

      <AlertDialog open={!!reminderToDelete} onOpenChange={() => setReminderToDelete(null)}>
        <AlertDialogContent>
          <AlertDialogHeader>
            <AlertDialogTitle>Remover Lembrete</AlertDialogTitle>
            <AlertDialogDescription>Tem certeza que deseja remover este lembrete? Esta aÃ§Ã£o nÃ£o pode ser desfeita.</AlertDialogDescription>
          </AlertDialogHeader>
          <AlertDialogFooter>
            <AlertDialogCancel>Cancelar</AlertDialogCancel>
            <AlertDialogAction onClick={handleDelete} className="bg-destructive text-destructive-foreground hover:bg-destructive/90">
              Remover
            </AlertDialogAction>
          </AlertDialogFooter>
        </AlertDialogContent>
      </AlertDialog>
    </div>
  );
};

----------------------------------------
ENDOFFILE: src\components\reminders\RemindersList.tsx

STARTOFFILE: src\components\theme-provider.tsx
----------------------------------------
import { createContext, useContext, useEffect, useState } from "react";

type Theme = "dark" | "light" | "system";

type ThemeProviderProps = {
  children: React.ReactNode;
  defaultTheme?: Theme;
  storageKey?: string;
};

type ThemeProviderState = {
  theme: Theme;
  setTheme: (theme: Theme) => void;
};

const initialState: ThemeProviderState = {
  theme: "system",
  setTheme: () => null,
};

const ThemeProviderContext = createContext<ThemeProviderState>(initialState);

export function ThemeProvider({ children, defaultTheme = "system", storageKey = "vite-ui-theme" }: ThemeProviderProps) {
  const [theme, setTheme] = useState<Theme>(() => (localStorage.getItem(storageKey) as Theme) || defaultTheme);

  useEffect(() => {
    const root = window.document.documentElement;

    root.classList.remove("light", "dark");

    if (theme === "system") {
      const systemTheme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light";

      root.classList.add(systemTheme);
      return;
    }

    root.classList.add(theme);
  }, [theme]);

  const value = {
    theme,
    setTheme: (theme: Theme) => {
      localStorage.setItem(storageKey, theme);
      setTheme(theme);
    },
  };

  return <ThemeProviderContext.Provider value={value}>{children}</ThemeProviderContext.Provider>;
}

export const useTheme = () => {
  const context = useContext(ThemeProviderContext);

  if (context === undefined) throw new Error("useTheme must be used within a ThemeProvider");

  return context;
};

----------------------------------------
ENDOFFILE: src\components\theme-provider.tsx

STARTOFFILE: src\components\transactions\EventDetailsModal.tsx
----------------------------------------
import { useState, useEffect } from "react";
import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { Card, CardContent } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { ArrowUpCircle, ArrowDownCircle, Calendar, Trash2, Plus } from "lucide-react";
import { supabase } from "@/integrations/supabase/client";
import { useToast } from "@/hooks/use-toast";
import { cn } from "@/lib/utils";
import { AddTransactionDialog } from "@/components/dialogs/AddTransactionDialog";

interface EventDetailsModalProps {
  isOpen: boolean;
  onClose: () => void;
  eventId: string;
  eventName: string;
  eventDate: string;
  onUpdate?: () => void;
}

interface Transaction {
  id: string;
  description: string;
  amount: number;
  type: "income" | "expense";
  category: string;
  date: string;
}

export const EventDetailsModal = ({ isOpen, onClose, eventId, eventName, eventDate, onUpdate }: EventDetailsModalProps) => {
  const [transactions, setTransactions] = useState<Transaction[]>([]);
  const [loading, setLoading] = useState(false);
  const { toast } = useToast();

  const loadEventTransactions = async () => {
    if (!eventId) return;
    setLoading(true);
    try {
      const { data, error } = await supabase.from("transactions").select("*").eq("event_id", eventId).order("date", { ascending: false });

      if (error) throw error;

      setTransactions(
        data?.map((t) => ({
          id: t.id,
          description: t.description,
          amount: Number(t.amount),
          type: t.type as "income" | "expense",
          category: t.category,
          date: t.date,
        })) || []
      );
    } catch (error) {
      console.error("Erro ao carregar transaÃ§Ãµes do evento:", error);
      toast({
        title: "Erro",
        description: "NÃ£o foi possÃ­vel carregar os itens do evento",
        variant: "destructive",
      });
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    if (isOpen) {
      loadEventTransactions();
    }
  }, [isOpen, eventId]);

  const handleDeleteTransaction = async (id: string) => {
    try {
      const { error } = await supabase.from("transactions").delete().eq("id", id);
      if (error) throw error;

      toast({ title: "Sucesso", description: "Item removido do evento" });
      loadEventTransactions();
      if (onUpdate) onUpdate();
    } catch (error) {
      console.error("Erro ao deletar:", error);
      toast({ title: "Erro", description: "Falha ao remover item", variant: "destructive" });
    }
  };

  const handleDeleteEvent = async () => {
    if (!confirm("Tem certeza? Isso apagarÃ¡ o evento e TODAS as transaÃ§Ãµes dentro dele.")) return;

    try {
      const { error } = await supabase
        .from("events" as any)
        .delete()
        .eq("id", eventId);
      if (error) throw error;

      toast({ title: "Sucesso", description: "Evento removido com sucesso" });
      onClose();
      if (onUpdate) onUpdate();
    } catch (error) {
      toast({ title: "Erro", description: "Falha ao remover evento", variant: "destructive" });
    }
  };

  const totalAmount = transactions.reduce((acc, t) => acc + (t.type === "income" ? t.amount : -Math.abs(t.amount)), 0);

  return (
    <Dialog open={isOpen} onOpenChange={onClose}>
      <DialogContent className="max-w-3xl max-h-[90vh] overflow-y-auto">
        <DialogHeader>
          <div className="flex items-center justify-between pr-8">
            <DialogTitle className="text-2xl">{eventName}</DialogTitle>
            <Button variant="ghost" size="icon" onClick={handleDeleteEvent} className="text-destructive">
              <Trash2 className="h-5 w-5" />
            </Button>
          </div>
          <DialogDescription>
            {new Date(eventDate).toLocaleDateString("pt-BR")} â€¢ Total:{" "}
            <span className={cn("font-bold", totalAmount >= 0 ? "text-success" : "text-destructive")}>
              {totalAmount.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
            </span>
          </DialogDescription>
        </DialogHeader>

        <div className="space-y-4 mt-4">
          <div className="flex gap-2">
            <AddTransactionDialog
              type="expense"
              eventId={eventId}
              onSuccess={() => {
                loadEventTransactions();
                if (onUpdate) onUpdate();
              }}
              trigger={
                <Button className="flex-1" variant="outline">
                  <Plus className="h-4 w-4 mr-2" /> Adicionar Despesa
                </Button>
              }
            />
            <AddTransactionDialog
              type="income"
              eventId={eventId}
              onSuccess={() => {
                loadEventTransactions();
                if (onUpdate) onUpdate();
              }}
              trigger={
                <Button className="flex-1" variant="outline">
                  <Plus className="h-4 w-4 mr-2" /> Adicionar Receita
                </Button>
              }
            />
          </div>

          <div className="space-y-2">
            {loading ? (
              <p className="text-center text-muted-foreground">Carregando...</p>
            ) : transactions.length === 0 ? (
              <p className="text-center text-muted-foreground py-8">Nenhum lanÃ§amento neste evento.</p>
            ) : (
              transactions.map((t) => (
                <Card key={t.id} className="border border-border">
                  <CardContent className="p-3 flex items-center justify-between">
                    <div className="flex items-center gap-3">
                      <div className={cn("p-2 rounded-full", t.type === "income" ? "bg-success/10" : "bg-destructive/10")}>
                        {t.type === "income" ? (
                          <ArrowUpCircle className="h-4 w-4 text-success" />
                        ) : (
                          <ArrowDownCircle className="h-4 w-4 text-destructive" />
                        )}
                      </div>
                      <div>
                        <p className="font-medium text-sm">{t.description}</p>
                        <div className="flex items-center gap-2">
                          <Badge variant="secondary" className="text-[10px]">
                            {t.category}
                          </Badge>
                          <span className="text-[10px] text-muted-foreground">{new Date(t.date).toLocaleDateString("pt-BR")}</span>
                        </div>
                      </div>
                    </div>
                    <div className="flex items-center gap-3">
                      <span className={cn("font-semibold text-sm", t.type === "income" ? "text-success" : "text-destructive")}>
                        {t.amount.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                      </span>
                      <Button variant="ghost" size="icon" className="h-6 w-6" onClick={() => handleDeleteTransaction(t.id)}>
                        <Trash2 className="h-3 w-3 text-muted-foreground" />
                      </Button>
                    </div>
                  </CardContent>
                </Card>
              ))
            )}
          </div>
        </div>
      </DialogContent>
    </Dialog>
  );
};

----------------------------------------
ENDOFFILE: src\components\transactions\EventDetailsModal.tsx

STARTOFFILE: src\components\transactions\types.ts
----------------------------------------
export type Transaction = {
  id: string;
  description: string;
  amount: number;
  type: "income" | "expense";
  category: string;
  date: string;
  group_id?: string | null;
  user_id?: string;
  created_at?: string;
  updated_at?: string;
  is_recurring?: boolean;
  is_fixed?: boolean;
  recurrence_id?: string | null;
  recurrence_count?: number | null;
  assigned_to?: string | null;
  [key: string]: any;
};

export type VirtualizedListProps<T> = {
  data: T[];
  height?: number;
  itemHeight?: number;
};

----------------------------------------
ENDOFFILE: src\components\transactions\types.ts

STARTOFFILE: src\components\ui\accordion.tsx
----------------------------------------
import * as React from "react";
import * as AccordionPrimitive from "@radix-ui/react-accordion";
import { ChevronDown } from "@/lib/icons";

import { cn } from "@/lib/utils";

const Accordion = AccordionPrimitive.Root;

const AccordionItem = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>
>(({ className, ...props }, ref) => <AccordionPrimitive.Item ref={ref} className={cn("border-b", className)} {...props} />);
AccordionItem.displayName = "AccordionItem";

const AccordionTrigger = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <AccordionPrimitive.Header className="flex">
    <AccordionPrimitive.Trigger
      ref={ref}
      className={cn(
        "flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",
        className
      )}
      {...props}
    >
      {children}
      <ChevronDown className="h-4 w-4 shrink-0 transition-transform duration-200" />
    </AccordionPrimitive.Trigger>
  </AccordionPrimitive.Header>
));
AccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName;

const AccordionContent = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <AccordionPrimitive.Content
    ref={ref}
    className="overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down"
    {...props}
  >
    <div className={cn("pb-4 pt-0", className)}>{children}</div>
  </AccordionPrimitive.Content>
));

AccordionContent.displayName = AccordionPrimitive.Content.displayName;

export { Accordion, AccordionItem, AccordionTrigger, AccordionContent };

----------------------------------------
ENDOFFILE: src\components\ui\accordion.tsx

STARTOFFILE: src\components\ui\alert-dialog.tsx
----------------------------------------
import * as React from "react";
import * as AlertDialogPrimitive from "@radix-ui/react-alert-dialog";

import { cn } from "@/lib/utils";
import { buttonVariants } from "@/components/ui/button";

const AlertDialog = AlertDialogPrimitive.Root;

const AlertDialogTrigger = AlertDialogPrimitive.Trigger;

const AlertDialogPortal = AlertDialogPrimitive.Portal;

const AlertDialogOverlay = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Overlay
    className={cn(
      "fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
      className
    )}
    {...props}
    ref={ref}
  />
));
AlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName;

const AlertDialogContent = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>
>(({ className, ...props }, ref) => (
  <AlertDialogPortal>
    <AlertDialogOverlay />
    <AlertDialogPrimitive.Content
      ref={ref}
      className={cn(
        "fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",
        className
      )}
      {...props}
    />
  </AlertDialogPortal>
));
AlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName;

const AlertDialogHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col space-y-2 text-center sm:text-left", className)} {...props} />
);
AlertDialogHeader.displayName = "AlertDialogHeader";

const AlertDialogFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2", className)} {...props} />
);
AlertDialogFooter.displayName = "AlertDialogFooter";

const AlertDialogTitle = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>
>(({ className, ...props }, ref) => <AlertDialogPrimitive.Title ref={ref} className={cn("text-lg font-semibold", className)} {...props} />);
AlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName;

const AlertDialogDescription = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Description ref={ref} className={cn("text-sm text-muted-foreground", className)} {...props} />
));
AlertDialogDescription.displayName = AlertDialogPrimitive.Description.displayName;

const AlertDialogAction = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Action>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>
>(({ className, ...props }, ref) => <AlertDialogPrimitive.Action ref={ref} className={cn(buttonVariants(), className)} {...props} />);
AlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName;

const AlertDialogCancel = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Cancel ref={ref} className={cn(buttonVariants({ variant: "outline" }), "mt-2 sm:mt-0", className)} {...props} />
));
AlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName;

export {
  AlertDialog,
  AlertDialogPortal,
  AlertDialogOverlay,
  AlertDialogTrigger,
  AlertDialogContent,
  AlertDialogHeader,
  AlertDialogFooter,
  AlertDialogTitle,
  AlertDialogDescription,
  AlertDialogAction,
  AlertDialogCancel,
};

----------------------------------------
ENDOFFILE: src\components\ui\alert-dialog.tsx

STARTOFFILE: src\components\ui\alert.tsx
----------------------------------------
import * as React from "react"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const alertVariants = cva(
  "relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",
  {
    variants: {
      variant: {
        default: "bg-background text-foreground",
        destructive:
          "border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

const Alert = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>
>(({ className, variant, ...props }, ref) => (
  <div
    ref={ref}
    role="alert"
    className={cn(alertVariants({ variant }), className)}
    {...props}
  />
))
Alert.displayName = "Alert"

const AlertTitle = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLHeadingElement>
>(({ className, ...props }, ref) => (
  <h5
    ref={ref}
    className={cn("mb-1 font-medium leading-none tracking-tight", className)}
    {...props}
  />
))
AlertTitle.displayName = "AlertTitle"

const AlertDescription = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("text-sm [&_p]:leading-relaxed", className)}
    {...props}
  />
))
AlertDescription.displayName = "AlertDescription"

export { Alert, AlertTitle, AlertDescription }

----------------------------------------
ENDOFFILE: src\components\ui\alert.tsx

STARTOFFILE: src\components\ui\aspect-ratio.tsx
----------------------------------------
import * as AspectRatioPrimitive from "@radix-ui/react-aspect-ratio"

const AspectRatio = AspectRatioPrimitive.Root

export { AspectRatio }

----------------------------------------
ENDOFFILE: src\components\ui\aspect-ratio.tsx

STARTOFFILE: src\components\ui\avatar.tsx
----------------------------------------
import * as React from "react"
import * as AvatarPrimitive from "@radix-ui/react-avatar"

import { cn } from "@/lib/utils"

const Avatar = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Root
    ref={ref}
    className={cn(
      "relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",
      className
    )}
    {...props}
  />
))
Avatar.displayName = AvatarPrimitive.Root.displayName

const AvatarImage = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Image>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Image
    ref={ref}
    className={cn("aspect-square h-full w-full", className)}
    {...props}
  />
))
AvatarImage.displayName = AvatarPrimitive.Image.displayName

const AvatarFallback = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Fallback>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Fallback
    ref={ref}
    className={cn(
      "flex h-full w-full items-center justify-center rounded-full bg-muted",
      className
    )}
    {...props}
  />
))
AvatarFallback.displayName = AvatarPrimitive.Fallback.displayName

export { Avatar, AvatarImage, AvatarFallback }

----------------------------------------
ENDOFFILE: src\components\ui\avatar.tsx

STARTOFFILE: src\components\ui\badge.tsx
----------------------------------------
import * as React from "react"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const badgeVariants = cva(
  "inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",
  {
    variants: {
      variant: {
        default:
          "border-transparent bg-primary text-primary-foreground hover:bg-primary/80",
        secondary:
          "border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",
        destructive:
          "border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",
        outline: "text-foreground",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

export interface BadgeProps
  extends React.HTMLAttributes<HTMLDivElement>,
    VariantProps<typeof badgeVariants> {}

function Badge({ className, variant, ...props }: BadgeProps) {
  return (
    <div className={cn(badgeVariants({ variant }), className)} {...props} />
  )
}

export { Badge, badgeVariants }

----------------------------------------
ENDOFFILE: src\components\ui\badge.tsx

STARTOFFILE: src\components\ui\breadcrumb.tsx
----------------------------------------
import * as React from "react";
import { Slot } from "@radix-ui/react-slot";
import { ChevronRight, MoreHorizontal } from "@/lib/icons";

import { cn } from "@/lib/utils";

const Breadcrumb = React.forwardRef<
  HTMLElement,
  React.ComponentPropsWithoutRef<"nav"> & {
    separator?: React.ReactNode;
  }
>(({ ...props }, ref) => <nav ref={ref} aria-label="breadcrumb" {...props} />);
Breadcrumb.displayName = "Breadcrumb";

const BreadcrumbList = React.forwardRef<HTMLOListElement, React.ComponentPropsWithoutRef<"ol">>(({ className, ...props }, ref) => (
  <ol
    ref={ref}
    className={cn("flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5", className)}
    {...props}
  />
));
BreadcrumbList.displayName = "BreadcrumbList";

const BreadcrumbItem = React.forwardRef<HTMLLIElement, React.ComponentPropsWithoutRef<"li">>(({ className, ...props }, ref) => (
  <li ref={ref} className={cn("inline-flex items-center gap-1.5", className)} {...props} />
));
BreadcrumbItem.displayName = "BreadcrumbItem";

const BreadcrumbLink = React.forwardRef<
  HTMLAnchorElement,
  React.ComponentPropsWithoutRef<"a"> & {
    asChild?: boolean;
  }
>(({ asChild, className, ...props }, ref) => {
  const Comp = asChild ? Slot : "a";

  return <Comp ref={ref} className={cn("transition-colors hover:text-foreground", className)} {...props} />;
});
BreadcrumbLink.displayName = "BreadcrumbLink";

const BreadcrumbPage = React.forwardRef<HTMLSpanElement, React.ComponentPropsWithoutRef<"span">>(({ className, ...props }, ref) => (
  <span
    ref={ref}
    role="link"
    aria-disabled="true"
    aria-current="page"
    className={cn("font-normal text-foreground", className)}
    {...props}
  />
));
BreadcrumbPage.displayName = "BreadcrumbPage";

const BreadcrumbSeparator = ({ children, className, ...props }: React.ComponentProps<"li">) => (
  <li role="presentation" aria-hidden="true" className={cn("[&>svg]:size-3.5", className)} {...props}>
    {children ?? <ChevronRight />}
  </li>
);
BreadcrumbSeparator.displayName = "BreadcrumbSeparator";

const BreadcrumbEllipsis = ({ className, ...props }: React.ComponentProps<"span">) => (
  <span role="presentation" aria-hidden="true" className={cn("flex h-9 w-9 items-center justify-center", className)} {...props}>
    <MoreHorizontal className="h-4 w-4" />
    <span className="sr-only">More</span>
  </span>
);
BreadcrumbEllipsis.displayName = "BreadcrumbElipssis";

export { Breadcrumb, BreadcrumbList, BreadcrumbItem, BreadcrumbLink, BreadcrumbPage, BreadcrumbSeparator, BreadcrumbEllipsis };

----------------------------------------
ENDOFFILE: src\components\ui\breadcrumb.tsx

STARTOFFILE: src\components\ui\button.tsx
----------------------------------------
import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const buttonVariants = cva(
  "inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",
  {
    variants: {
      variant: {
        default: "bg-primary text-primary-foreground hover:bg-primary/90",
        destructive:
          "bg-destructive text-destructive-foreground hover:bg-destructive/90",
        outline:
          "border border-input bg-background hover:bg-accent hover:text-accent-foreground",
        secondary:
          "bg-secondary text-secondary-foreground hover:bg-secondary/80",
        ghost: "hover:bg-accent hover:text-accent-foreground",
        link: "text-primary underline-offset-4 hover:underline",
      },
      size: {
        default: "h-10 px-4 py-2",
        sm: "h-9 rounded-md px-3",
        lg: "h-11 rounded-md px-8",
        icon: "h-10 w-10",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  asChild?: boolean
}

const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant, size, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : "button"
    return (
      <Comp
        className={cn(buttonVariants({ variant, size, className }))}
        ref={ref}
        {...props}
      />
    )
  }
)
Button.displayName = "Button"

export { Button, buttonVariants }

----------------------------------------
ENDOFFILE: src\components\ui\button.tsx

STARTOFFILE: src\components\ui\calendar.tsx
----------------------------------------
import * as React from "react";
import { ChevronLeft, ChevronRight } from "@/lib/icons";
import { DayPicker } from "react-day-picker";

import { cn } from "@/lib/utils";
import { buttonVariants } from "@/components/ui/button";

export type CalendarProps = React.ComponentProps<typeof DayPicker>;

function Calendar({ className, classNames, showOutsideDays = true, ...props }: CalendarProps) {
  return (
    <DayPicker
      showOutsideDays={showOutsideDays}
      className={cn("p-3", className)}
      classNames={{
        months: "flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",
        month: "space-y-4",
        caption: "flex justify-center pt-1 relative items-center",
        caption_label: "text-sm font-medium",
        nav: "space-x-1 flex items-center",
        nav_button: cn(buttonVariants({ variant: "outline" }), "h-7 w-7 p-0 opacity-50 hover:opacity-100"),
        nav_button_previous: "absolute left-1",
        nav_button_next: "absolute right-1",
        table: "w-full border-collapse space-y-1",
        head_row: "flex",
        head_cell: "text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",
        row: "flex w-full mt-2",
        cell: "h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",
        day: cn(buttonVariants({ variant: "ghost" }), "h-9 w-9 p-0 font-normal aria-selected:opacity-100"),
        day_range_end: "day-range-end",
        day_selected:
          "bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",
        day_today: "bg-accent text-accent-foreground",
        day_outside:
          "day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",
        day_disabled: "text-muted-foreground opacity-50",
        day_range_middle: "aria-selected:bg-accent aria-selected:text-accent-foreground",
        day_hidden: "invisible",
        ...classNames,
      }}
      components={{
        Chevron: ({ orientation, ...props }) => {
          const Icon = orientation === "left" ? ChevronLeft : ChevronRight;
          return <Icon className="h-4 w-4" {...props} />;
        },
      }}
      {...props}
    />
  );
}
Calendar.displayName = "Calendar";

export { Calendar };

----------------------------------------
ENDOFFILE: src\components\ui\calendar.tsx

STARTOFFILE: src\components\ui\card.tsx
----------------------------------------
import * as React from "react";

import { cn } from "@/lib/utils";

const Card = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn("rounded-lg border bg-card text-card-foreground shadow-sm", className)} {...props} />
));
Card.displayName = "Card";

const CardHeader = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn("flex flex-col space-y-1.5 p-6", className)} {...props} />
));
CardHeader.displayName = "CardHeader";

const CardTitle = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLHeadingElement>>(({ className, ...props }, ref) => (
  <h3 ref={ref} className={cn("text-2xl font-semibold leading-none tracking-tight", className)} {...props} />
));
CardTitle.displayName = "CardTitle";

const CardDescription = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLParagraphElement>>(
  ({ className, ...props }, ref) => <p ref={ref} className={cn("text-sm text-muted-foreground", className)} {...props} />
);
CardDescription.displayName = "CardDescription";

const CardContent = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn("p-6 pt-0", className)} {...props} />
));
CardContent.displayName = "CardContent";

const CardFooter = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn("flex items-center p-6 pt-0", className)} {...props} />
));
CardFooter.displayName = "CardFooter";

export { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent };

----------------------------------------
ENDOFFILE: src\components\ui\card.tsx

STARTOFFILE: src\components\ui\carousel.tsx
----------------------------------------
import * as React from "react";
import useEmblaCarousel, { type UseEmblaCarouselType } from "embla-carousel-react";
import { ArrowLeft, ArrowRight } from "@/lib/icons";

import { cn } from "@/lib/utils";
import { Button } from "@/components/ui/button";

type CarouselApi = UseEmblaCarouselType[1];
type UseCarouselParameters = Parameters<typeof useEmblaCarousel>;
type CarouselOptions = UseCarouselParameters[0];
type CarouselPlugin = UseCarouselParameters[1];

type CarouselProps = {
  opts?: CarouselOptions;
  plugins?: CarouselPlugin;
  orientation?: "horizontal" | "vertical";
  setApi?: (api: CarouselApi) => void;
};

type CarouselContextProps = {
  carouselRef: ReturnType<typeof useEmblaCarousel>[0];
  api: ReturnType<typeof useEmblaCarousel>[1];
  scrollPrev: () => void;
  scrollNext: () => void;
  canScrollPrev: boolean;
  canScrollNext: boolean;
} & CarouselProps;

const CarouselContext = React.createContext<CarouselContextProps | null>(null);

function useCarousel() {
  const context = React.useContext(CarouselContext);

  if (!context) {
    throw new Error("useCarousel must be used within a <Carousel />");
  }

  return context;
}

const Carousel = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement> & CarouselProps>(
  ({ orientation = "horizontal", opts, setApi, plugins, className, children, ...props }, ref) => {
    const [carouselRef, api] = useEmblaCarousel(
      {
        ...opts,
        axis: orientation === "horizontal" ? "x" : "y",
      },
      plugins
    );
    const [canScrollPrev, setCanScrollPrev] = React.useState(false);
    const [canScrollNext, setCanScrollNext] = React.useState(false);

    const onSelect = React.useCallback((api: CarouselApi) => {
      if (!api) {
        return;
      }

      setCanScrollPrev(api.canScrollPrev());
      setCanScrollNext(api.canScrollNext());
    }, []);

    const scrollPrev = React.useCallback(() => {
      api?.scrollPrev();
    }, [api]);

    const scrollNext = React.useCallback(() => {
      api?.scrollNext();
    }, [api]);

    const handleKeyDown = React.useCallback(
      (event: React.KeyboardEvent<HTMLDivElement>) => {
        if (event.key === "ArrowLeft") {
          event.preventDefault();
          scrollPrev();
        } else if (event.key === "ArrowRight") {
          event.preventDefault();
          scrollNext();
        }
      },
      [scrollPrev, scrollNext]
    );

    React.useEffect(() => {
      if (!api || !setApi) {
        return;
      }

      setApi(api);
    }, [api, setApi]);

    React.useEffect(() => {
      if (!api) {
        return;
      }

      onSelect(api);
      api.on("reInit", onSelect);
      api.on("select", onSelect);

      return () => {
        api?.off("select", onSelect);
      };
    }, [api, onSelect]);

    return (
      <CarouselContext.Provider
        value={{
          carouselRef,
          api: api,
          opts,
          orientation: orientation || (opts?.axis === "y" ? "vertical" : "horizontal"),
          scrollPrev,
          scrollNext,
          canScrollPrev,
          canScrollNext,
        }}
      >
        <div
          ref={ref}
          onKeyDownCapture={handleKeyDown}
          className={cn("relative", className)}
          role="region"
          aria-roledescription="carousel"
          {...props}
        >
          {children}
        </div>
      </CarouselContext.Provider>
    );
  }
);
Carousel.displayName = "Carousel";

const CarouselContent = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(({ className, ...props }, ref) => {
  const { carouselRef, orientation } = useCarousel();

  return (
    <div ref={carouselRef} className="overflow-hidden">
      <div ref={ref} className={cn("flex", orientation === "horizontal" ? "-ml-4" : "-mt-4 flex-col", className)} {...props} />
    </div>
  );
});
CarouselContent.displayName = "CarouselContent";

const CarouselItem = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(({ className, ...props }, ref) => {
  const { orientation } = useCarousel();

  return (
    <div
      ref={ref}
      role="group"
      aria-roledescription="slide"
      className={cn("min-w-0 shrink-0 grow-0 basis-full", orientation === "horizontal" ? "pl-4" : "pt-4", className)}
      {...props}
    />
  );
});
CarouselItem.displayName = "CarouselItem";

const CarouselPrevious = React.forwardRef<HTMLButtonElement, React.ComponentProps<typeof Button>>(
  ({ className, variant = "outline", size = "icon", ...props }, ref) => {
    const { orientation, scrollPrev, canScrollPrev } = useCarousel();

    return (
      <Button
        ref={ref}
        variant={variant}
        size={size}
        className={cn(
          "absolute  h-8 w-8 rounded-full",
          orientation === "horizontal" ? "-left-12 top-1/2 -translate-y-1/2" : "-top-12 left-1/2 -translate-x-1/2 rotate-90",
          className
        )}
        disabled={!canScrollPrev}
        onClick={scrollPrev}
        {...props}
      >
        <ArrowLeft className="h-4 w-4" />
        <span className="sr-only">Previous slide</span>
      </Button>
    );
  }
);
CarouselPrevious.displayName = "CarouselPrevious";

const CarouselNext = React.forwardRef<HTMLButtonElement, React.ComponentProps<typeof Button>>(
  ({ className, variant = "outline", size = "icon", ...props }, ref) => {
    const { orientation, scrollNext, canScrollNext } = useCarousel();

    return (
      <Button
        ref={ref}
        variant={variant}
        size={size}
        className={cn(
          "absolute h-8 w-8 rounded-full",
          orientation === "horizontal" ? "-right-12 top-1/2 -translate-y-1/2" : "-bottom-12 left-1/2 -translate-x-1/2 rotate-90",
          className
        )}
        disabled={!canScrollNext}
        onClick={scrollNext}
        {...props}
      >
        <ArrowRight className="h-4 w-4" />
        <span className="sr-only">Next slide</span>
      </Button>
    );
  }
);
CarouselNext.displayName = "CarouselNext";

export { type CarouselApi, Carousel, CarouselContent, CarouselItem, CarouselPrevious, CarouselNext };

----------------------------------------
ENDOFFILE: src\components\ui\carousel.tsx

STARTOFFILE: src\components\ui\chart.tsx
----------------------------------------
import * as React from "react"
import * as RechartsPrimitive from "recharts"

import { cn } from "@/lib/utils"

// Format: { THEME_NAME: CSS_SELECTOR }
const THEMES = { light: "", dark: ".dark" } as const

export type ChartConfig = {
  [k in string]: {
    label?: React.ReactNode
    icon?: React.ComponentType
  } & (
    | { color?: string; theme?: never }
    | { color?: never; theme: Record<keyof typeof THEMES, string> }
  )
}

type ChartContextProps = {
  config: ChartConfig
}

const ChartContext = React.createContext<ChartContextProps | null>(null)

function useChart() {
  const context = React.useContext(ChartContext)

  if (!context) {
    throw new Error("useChart must be used within a <ChartContainer />")
  }

  return context
}

const ChartContainer = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & {
    config: ChartConfig
    children: React.ComponentProps<
      typeof RechartsPrimitive.ResponsiveContainer
    >["children"]
  }
>(({ id, className, children, config, ...props }, ref) => {
  const uniqueId = React.useId()
  const chartId = `chart-${id || uniqueId.replace(/:/g, "")}`

  return (
    <ChartContext.Provider value={{ config }}>
      <div
        data-chart={chartId}
        ref={ref}
        className={cn(
          "flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",
          className
        )}
        {...props}
      >
        <ChartStyle id={chartId} config={config} />
        <RechartsPrimitive.ResponsiveContainer>
          {children}
        </RechartsPrimitive.ResponsiveContainer>
      </div>
    </ChartContext.Provider>
  )
})
ChartContainer.displayName = "Chart"

const ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {
  const colorConfig = Object.entries(config).filter(
    ([_, config]) => config.theme || config.color
  )

  if (!colorConfig.length) {
    return null
  }

  return (
    <style
      dangerouslySetInnerHTML={{
        __html: Object.entries(THEMES)
          .map(
            ([theme, prefix]) => `
${prefix} [data-chart=${id}] {
${colorConfig
  .map(([key, itemConfig]) => {
    const color =
      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||
      itemConfig.color
    return color ? `  --color-${key}: ${color};` : null
  })
  .join("\n")}
}
`
          )
          .join("\n"),
      }}
    />
  )
}

const ChartTooltip = RechartsPrimitive.Tooltip

const ChartTooltipContent = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &
    React.ComponentProps<"div"> & {
      hideLabel?: boolean
      hideIndicator?: boolean
      indicator?: "line" | "dot" | "dashed"
      nameKey?: string
      labelKey?: string
    }
>(
  (
    {
      active,
      payload,
      className,
      indicator = "dot",
      hideLabel = false,
      hideIndicator = false,
      label,
      labelFormatter,
      labelClassName,
      formatter,
      color,
      nameKey,
      labelKey,
    },
    ref
  ) => {
    const { config } = useChart()

    const tooltipLabel = React.useMemo(() => {
      if (hideLabel || !payload?.length) {
        return null
      }

      const [item] = payload
      const key = `${labelKey || item.dataKey || item.name || "value"}`
      const itemConfig = getPayloadConfigFromPayload(config, item, key)
      const value =
        !labelKey && typeof label === "string"
          ? config[label as keyof typeof config]?.label || label
          : itemConfig?.label

      if (labelFormatter) {
        return (
          <div className={cn("font-medium", labelClassName)}>
            {labelFormatter(value, payload)}
          </div>
        )
      }

      if (!value) {
        return null
      }

      return <div className={cn("font-medium", labelClassName)}>{value}</div>
    }, [
      label,
      labelFormatter,
      payload,
      hideLabel,
      labelClassName,
      config,
      labelKey,
    ])

    if (!active || !payload?.length) {
      return null
    }

    const nestLabel = payload.length === 1 && indicator !== "dot"

    return (
      <div
        ref={ref}
        className={cn(
          "grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",
          className
        )}
      >
        {!nestLabel ? tooltipLabel : null}
        <div className="grid gap-1.5">
          {payload.map((item, index) => {
            const key = `${nameKey || item.name || item.dataKey || "value"}`
            const itemConfig = getPayloadConfigFromPayload(config, item, key)
            const indicatorColor = color || item.payload.fill || item.color

            return (
              <div
                key={item.dataKey}
                className={cn(
                  "flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",
                  indicator === "dot" && "items-center"
                )}
              >
                {formatter && item?.value !== undefined && item.name ? (
                  formatter(item.value, item.name, item, index, item.payload)
                ) : (
                  <>
                    {itemConfig?.icon ? (
                      <itemConfig.icon />
                    ) : (
                      !hideIndicator && (
                        <div
                          className={cn(
                            "shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",
                            {
                              "h-2.5 w-2.5": indicator === "dot",
                              "w-1": indicator === "line",
                              "w-0 border-[1.5px] border-dashed bg-transparent":
                                indicator === "dashed",
                              "my-0.5": nestLabel && indicator === "dashed",
                            }
                          )}
                          style={
                            {
                              "--color-bg": indicatorColor,
                              "--color-border": indicatorColor,
                            } as React.CSSProperties
                          }
                        />
                      )
                    )}
                    <div
                      className={cn(
                        "flex flex-1 justify-between leading-none",
                        nestLabel ? "items-end" : "items-center"
                      )}
                    >
                      <div className="grid gap-1.5">
                        {nestLabel ? tooltipLabel : null}
                        <span className="text-muted-foreground">
                          {itemConfig?.label || item.name}
                        </span>
                      </div>
                      {item.value && (
                        <span className="font-mono font-medium tabular-nums text-foreground">
                          {item.value.toLocaleString()}
                        </span>
                      )}
                    </div>
                  </>
                )}
              </div>
            )
          })}
        </div>
      </div>
    )
  }
)
ChartTooltipContent.displayName = "ChartTooltip"

const ChartLegend = RechartsPrimitive.Legend

const ChartLegendContent = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> &
    Pick<RechartsPrimitive.LegendProps, "payload" | "verticalAlign"> & {
      hideIcon?: boolean
      nameKey?: string
    }
>(
  (
    { className, hideIcon = false, payload, verticalAlign = "bottom", nameKey },
    ref
  ) => {
    const { config } = useChart()

    if (!payload?.length) {
      return null
    }

    return (
      <div
        ref={ref}
        className={cn(
          "flex items-center justify-center gap-4",
          verticalAlign === "top" ? "pb-3" : "pt-3",
          className
        )}
      >
        {payload.map((item) => {
          const key = `${nameKey || item.dataKey || "value"}`
          const itemConfig = getPayloadConfigFromPayload(config, item, key)

          return (
            <div
              key={item.value}
              className={cn(
                "flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"
              )}
            >
              {itemConfig?.icon && !hideIcon ? (
                <itemConfig.icon />
              ) : (
                <div
                  className="h-2 w-2 shrink-0 rounded-[2px]"
                  style={{
                    backgroundColor: item.color,
                  }}
                />
              )}
              {itemConfig?.label}
            </div>
          )
        })}
      </div>
    )
  }
)
ChartLegendContent.displayName = "ChartLegend"

// Helper to extract item config from a payload.
function getPayloadConfigFromPayload(
  config: ChartConfig,
  payload: unknown,
  key: string
) {
  if (typeof payload !== "object" || payload === null) {
    return undefined
  }

  const payloadPayload =
    "payload" in payload &&
    typeof payload.payload === "object" &&
    payload.payload !== null
      ? payload.payload
      : undefined

  let configLabelKey: string = key

  if (
    key in payload &&
    typeof payload[key as keyof typeof payload] === "string"
  ) {
    configLabelKey = payload[key as keyof typeof payload] as string
  } else if (
    payloadPayload &&
    key in payloadPayload &&
    typeof payloadPayload[key as keyof typeof payloadPayload] === "string"
  ) {
    configLabelKey = payloadPayload[
      key as keyof typeof payloadPayload
    ] as string
  }

  return configLabelKey in config
    ? config[configLabelKey]
    : config[key as keyof typeof config]
}

export {
  ChartContainer,
  ChartTooltip,
  ChartTooltipContent,
  ChartLegend,
  ChartLegendContent,
  ChartStyle,
}

----------------------------------------
ENDOFFILE: src\components\ui\chart.tsx

STARTOFFILE: src\components\ui\checkbox.tsx
----------------------------------------
import * as React from "react";
import * as CheckboxPrimitive from "@radix-ui/react-checkbox";
import { Check } from "@/lib/icons";

import { cn } from "@/lib/utils";

const Checkbox = React.forwardRef<
  React.ElementRef<typeof CheckboxPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>
>(({ className, ...props }, ref) => (
  <CheckboxPrimitive.Root
    ref={ref}
    className={cn(
      "peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",
      className
    )}
    {...props}
  >
    <CheckboxPrimitive.Indicator className={cn("flex items-center justify-center text-current")}>
      <Check className="h-4 w-4" />
    </CheckboxPrimitive.Indicator>
  </CheckboxPrimitive.Root>
));
Checkbox.displayName = CheckboxPrimitive.Root.displayName;

export { Checkbox };

----------------------------------------
ENDOFFILE: src\components\ui\checkbox.tsx

STARTOFFILE: src\components\ui\collapsible.tsx
----------------------------------------
import * as CollapsiblePrimitive from "@radix-ui/react-collapsible"

const Collapsible = CollapsiblePrimitive.Root

const CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger

const CollapsibleContent = CollapsiblePrimitive.CollapsibleContent

export { Collapsible, CollapsibleTrigger, CollapsibleContent }

----------------------------------------
ENDOFFILE: src\components\ui\collapsible.tsx

STARTOFFILE: src\components\ui\command.tsx
----------------------------------------
import * as React from "react";
import { type DialogProps } from "@radix-ui/react-dialog";
import { Command as CommandPrimitive } from "cmdk";
import { Search } from "@/lib/icons";

import { cn } from "@/lib/utils";
import { Dialog, DialogContent } from "@/components/ui/dialog";

const Command = React.forwardRef<React.ElementRef<typeof CommandPrimitive>, React.ComponentPropsWithoutRef<typeof CommandPrimitive>>(
  ({ className, ...props }, ref) => (
    <CommandPrimitive
      ref={ref}
      className={cn("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground", className)}
      {...props}
    />
  )
);
Command.displayName = CommandPrimitive.displayName;

interface CommandDialogProps extends DialogProps {}

const CommandDialog = ({ children, ...props }: CommandDialogProps) => {
  return (
    <Dialog {...props}>
      <DialogContent className="overflow-hidden p-0 shadow-lg">
        <Command className="[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5">
          {children}
        </Command>
      </DialogContent>
    </Dialog>
  );
};

const CommandInput = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Input>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>
>(({ className, ...props }, ref) => (
  <div className="flex items-center border-b px-3" cmdk-input-wrapper="">
    <Search className="mr-2 h-4 w-4 shrink-0 opacity-50" />
    <CommandPrimitive.Input
      ref={ref}
      className={cn(
        "flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",
        className
      )}
      {...props}
    />
  </div>
));

CommandInput.displayName = CommandPrimitive.Input.displayName;

const CommandList = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.List ref={ref} className={cn("max-h-[300px] overflow-y-auto overflow-x-hidden", className)} {...props} />
));

CommandList.displayName = CommandPrimitive.List.displayName;

const CommandEmpty = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Empty>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>
>((props, ref) => <CommandPrimitive.Empty ref={ref} className="py-6 text-center text-sm" {...props} />);

CommandEmpty.displayName = CommandPrimitive.Empty.displayName;

const CommandGroup = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Group>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.Group
    ref={ref}
    className={cn(
      "overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",
      className
    )}
    {...props}
  />
));

CommandGroup.displayName = CommandPrimitive.Group.displayName;

const CommandSeparator = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>
>(({ className, ...props }, ref) => <CommandPrimitive.Separator ref={ref} className={cn("-mx-1 h-px bg-border", className)} {...props} />);
CommandSeparator.displayName = CommandPrimitive.Separator.displayName;

const CommandItem = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",
      className
    )}
    {...props}
  />
));

CommandItem.displayName = CommandPrimitive.Item.displayName;

const CommandShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => {
  return <span className={cn("ml-auto text-xs tracking-widest text-muted-foreground", className)} {...props} />;
};
CommandShortcut.displayName = "CommandShortcut";

export { Command, CommandDialog, CommandInput, CommandList, CommandEmpty, CommandGroup, CommandItem, CommandShortcut, CommandSeparator };

----------------------------------------
ENDOFFILE: src\components\ui\command.tsx

STARTOFFILE: src\components\ui\context-menu.tsx
----------------------------------------
import * as React from "react";
import * as ContextMenuPrimitive from "@radix-ui/react-context-menu";
import { Check, ChevronRight, Circle } from "@/lib/icons";

import { cn } from "@/lib/utils";

const ContextMenu = ContextMenuPrimitive.Root;

const ContextMenuTrigger = ContextMenuPrimitive.Trigger;

const ContextMenuGroup = ContextMenuPrimitive.Group;

const ContextMenuPortal = ContextMenuPrimitive.Portal;

const ContextMenuSub = ContextMenuPrimitive.Sub;

const ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup;

const ContextMenuSubTrigger = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {
    inset?: boolean;
  }
>(({ className, inset, children, ...props }, ref) => (
  <ContextMenuPrimitive.SubTrigger
    ref={ref}
    className={cn(
      "flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",
      inset && "pl-8",
      className
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto h-4 w-4" />
  </ContextMenuPrimitive.SubTrigger>
));
ContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName;

const ContextMenuSubContent = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <ContextMenuPrimitive.SubContent
    ref={ref}
    className={cn(
      "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className
    )}
    {...props}
  />
));
ContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName;

const ContextMenuContent = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>
>(({ className, ...props }, ref) => (
  <ContextMenuPrimitive.Portal>
    <ContextMenuPrimitive.Content
      ref={ref}
      className={cn(
        "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className
      )}
      {...props}
    />
  </ContextMenuPrimitive.Portal>
));
ContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName;

const ContextMenuItem = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <ContextMenuPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      inset && "pl-8",
      className
    )}
    {...props}
  />
));
ContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName;

const ContextMenuCheckboxItem = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <ContextMenuPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <ContextMenuPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </ContextMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </ContextMenuPrimitive.CheckboxItem>
));
ContextMenuCheckboxItem.displayName = ContextMenuPrimitive.CheckboxItem.displayName;

const ContextMenuRadioItem = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <ContextMenuPrimitive.RadioItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <ContextMenuPrimitive.ItemIndicator>
        <Circle className="h-2 w-2 fill-current" />
      </ContextMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </ContextMenuPrimitive.RadioItem>
));
ContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName;

const ContextMenuLabel = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <ContextMenuPrimitive.Label
    ref={ref}
    className={cn("px-2 py-1.5 text-sm font-semibold text-foreground", inset && "pl-8", className)}
    {...props}
  />
));
ContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName;

const ContextMenuSeparator = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <ContextMenuPrimitive.Separator ref={ref} className={cn("-mx-1 my-1 h-px bg-border", className)} {...props} />
));
ContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName;

const ContextMenuShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => {
  return <span className={cn("ml-auto text-xs tracking-widest text-muted-foreground", className)} {...props} />;
};
ContextMenuShortcut.displayName = "ContextMenuShortcut";

export {
  ContextMenu,
  ContextMenuTrigger,
  ContextMenuContent,
  ContextMenuItem,
  ContextMenuCheckboxItem,
  ContextMenuRadioItem,
  ContextMenuLabel,
  ContextMenuSeparator,
  ContextMenuShortcut,
  ContextMenuGroup,
  ContextMenuPortal,
  ContextMenuSub,
  ContextMenuSubContent,
  ContextMenuSubTrigger,
  ContextMenuRadioGroup,
};

----------------------------------------
ENDOFFILE: src\components\ui\context-menu.tsx

STARTOFFILE: src\components\ui\dialog.tsx
----------------------------------------
import * as React from "react";
import * as DialogPrimitive from "@radix-ui/react-dialog";
import { X } from "@/lib/icons";

import { cn } from "@/lib/utils";

const Dialog = DialogPrimitive.Root;

const DialogTrigger = DialogPrimitive.Trigger;

const DialogPortal = DialogPrimitive.Portal;

const DialogClose = DialogPrimitive.Close;

const DialogOverlay = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Overlay
    ref={ref}
    className={cn(
      "fixed inset-0 z-50 bg-black/35 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
      className
    )}
    {...props}
  />
));
DialogOverlay.displayName = DialogPrimitive.Overlay.displayName;

const DialogContent = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <DialogPortal>
    <DialogOverlay />
    <DialogPrimitive.Content
      ref={ref}
      className={cn(
        "fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",
        className
      )}
      {...props}
    >
      {children}
      <DialogPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground">
        <X className="h-4 w-4" />
        <span className="sr-only">Close</span>
      </DialogPrimitive.Close>
    </DialogPrimitive.Content>
  </DialogPortal>
));
DialogContent.displayName = DialogPrimitive.Content.displayName;

const DialogHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col space-y-1.5 text-center sm:text-left", className)} {...props} />
);
DialogHeader.displayName = "DialogHeader";

const DialogFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2", className)} {...props} />
);
DialogFooter.displayName = "DialogFooter";

const DialogTitle = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Title ref={ref} className={cn("text-lg font-semibold leading-none tracking-tight", className)} {...props} />
));
DialogTitle.displayName = DialogPrimitive.Title.displayName;

const DialogDescription = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Description ref={ref} className={cn("text-sm text-muted-foreground", className)} {...props} />
));
DialogDescription.displayName = DialogPrimitive.Description.displayName;

export {
  Dialog,
  DialogPortal,
  DialogOverlay,
  DialogClose,
  DialogTrigger,
  DialogContent,
  DialogHeader,
  DialogFooter,
  DialogTitle,
  DialogDescription,
};

----------------------------------------
ENDOFFILE: src\components\ui\dialog.tsx

STARTOFFILE: src\components\ui\drawer.tsx
----------------------------------------
import * as React from "react"
import { Drawer as DrawerPrimitive } from "vaul"

import { cn } from "@/lib/utils"

const Drawer = ({
  shouldScaleBackground = true,
  ...props
}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (
  <DrawerPrimitive.Root
    shouldScaleBackground={shouldScaleBackground}
    {...props}
  />
)
Drawer.displayName = "Drawer"

const DrawerTrigger = DrawerPrimitive.Trigger

const DrawerPortal = DrawerPrimitive.Portal

const DrawerClose = DrawerPrimitive.Close

const DrawerOverlay = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <DrawerPrimitive.Overlay
    ref={ref}
    className={cn("fixed inset-0 z-50 bg-black/80", className)}
    {...props}
  />
))
DrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName

const DrawerContent = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <DrawerPortal>
    <DrawerOverlay />
    <DrawerPrimitive.Content
      ref={ref}
      className={cn(
        "fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",
        className
      )}
      {...props}
    >
      <div className="mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted" />
      {children}
    </DrawerPrimitive.Content>
  </DrawerPortal>
))
DrawerContent.displayName = "DrawerContent"

const DrawerHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn("grid gap-1.5 p-4 text-center sm:text-left", className)}
    {...props}
  />
)
DrawerHeader.displayName = "DrawerHeader"

const DrawerFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn("mt-auto flex flex-col gap-2 p-4", className)}
    {...props}
  />
)
DrawerFooter.displayName = "DrawerFooter"

const DrawerTitle = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>
>(({ className, ...props }, ref) => (
  <DrawerPrimitive.Title
    ref={ref}
    className={cn(
      "text-lg font-semibold leading-none tracking-tight",
      className
    )}
    {...props}
  />
))
DrawerTitle.displayName = DrawerPrimitive.Title.displayName

const DrawerDescription = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>
>(({ className, ...props }, ref) => (
  <DrawerPrimitive.Description
    ref={ref}
    className={cn("text-sm text-muted-foreground", className)}
    {...props}
  />
))
DrawerDescription.displayName = DrawerPrimitive.Description.displayName

export {
  Drawer,
  DrawerPortal,
  DrawerOverlay,
  DrawerTrigger,
  DrawerClose,
  DrawerContent,
  DrawerHeader,
  DrawerFooter,
  DrawerTitle,
  DrawerDescription,
}

----------------------------------------
ENDOFFILE: src\components\ui\drawer.tsx

STARTOFFILE: src\components\ui\dropdown-menu.tsx
----------------------------------------
import * as React from "react";
import * as DropdownMenuPrimitive from "@radix-ui/react-dropdown-menu";
import { Check, ChevronRight, Circle } from "@/lib/icons";

import { cn } from "@/lib/utils";

const DropdownMenu = DropdownMenuPrimitive.Root;

const DropdownMenuTrigger = DropdownMenuPrimitive.Trigger;

const DropdownMenuGroup = DropdownMenuPrimitive.Group;

const DropdownMenuPortal = DropdownMenuPrimitive.Portal;

const DropdownMenuSub = DropdownMenuPrimitive.Sub;

const DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup;

const DropdownMenuSubTrigger = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {
    inset?: boolean;
  }
>(({ className, inset, children, ...props }, ref) => (
  <DropdownMenuPrimitive.SubTrigger
    ref={ref}
    className={cn(
      "flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",
      inset && "pl-8",
      className
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto h-4 w-4" />
  </DropdownMenuPrimitive.SubTrigger>
));
DropdownMenuSubTrigger.displayName = DropdownMenuPrimitive.SubTrigger.displayName;

const DropdownMenuSubContent = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <DropdownMenuPrimitive.SubContent
    ref={ref}
    className={cn(
      "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className
    )}
    {...props}
  />
));
DropdownMenuSubContent.displayName = DropdownMenuPrimitive.SubContent.displayName;

const DropdownMenuContent = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>
>(({ className, sideOffset = 4, ...props }, ref) => (
  <DropdownMenuPrimitive.Portal>
    <DropdownMenuPrimitive.Content
      ref={ref}
      sideOffset={sideOffset}
      className={cn(
        "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className
      )}
      {...props}
    />
  </DropdownMenuPrimitive.Portal>
));
DropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName;

const DropdownMenuItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <DropdownMenuPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      inset && "pl-8",
      className
    )}
    {...props}
  />
));
DropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName;

const DropdownMenuCheckboxItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <DropdownMenuPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <DropdownMenuPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </DropdownMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </DropdownMenuPrimitive.CheckboxItem>
));
DropdownMenuCheckboxItem.displayName = DropdownMenuPrimitive.CheckboxItem.displayName;

const DropdownMenuRadioItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <DropdownMenuPrimitive.RadioItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <DropdownMenuPrimitive.ItemIndicator>
        <Circle className="h-2 w-2 fill-current" />
      </DropdownMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </DropdownMenuPrimitive.RadioItem>
));
DropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName;

const DropdownMenuLabel = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <DropdownMenuPrimitive.Label ref={ref} className={cn("px-2 py-1.5 text-sm font-semibold", inset && "pl-8", className)} {...props} />
));
DropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName;

const DropdownMenuSeparator = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <DropdownMenuPrimitive.Separator ref={ref} className={cn("-mx-1 my-1 h-px bg-muted", className)} {...props} />
));
DropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName;

const DropdownMenuShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => {
  return <span className={cn("ml-auto text-xs tracking-widest opacity-60", className)} {...props} />;
};
DropdownMenuShortcut.displayName = "DropdownMenuShortcut";

export {
  DropdownMenu,
  DropdownMenuTrigger,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuCheckboxItem,
  DropdownMenuRadioItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuShortcut,
  DropdownMenuGroup,
  DropdownMenuPortal,
  DropdownMenuSub,
  DropdownMenuSubContent,
  DropdownMenuSubTrigger,
  DropdownMenuRadioGroup,
};

----------------------------------------
ENDOFFILE: src\components\ui\dropdown-menu.tsx

STARTOFFILE: src\components\ui\form.tsx
----------------------------------------
import * as React from "react"
import * as LabelPrimitive from "@radix-ui/react-label"
import { Slot } from "@radix-ui/react-slot"
import {
  Controller,
  ControllerProps,
  FieldPath,
  FieldValues,
  FormProvider,
  useFormContext,
} from "react-hook-form"

import { cn } from "@/lib/utils"
import { Label } from "@/components/ui/label"

const Form = FormProvider

type FormFieldContextValue<
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>
> = {
  name: TName
}

const FormFieldContext = React.createContext<FormFieldContextValue>(
  {} as FormFieldContextValue
)

const FormField = <
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>
>({
  ...props
}: ControllerProps<TFieldValues, TName>) => {
  return (
    <FormFieldContext.Provider value={{ name: props.name }}>
      <Controller {...props} />
    </FormFieldContext.Provider>
  )
}

const useFormField = () => {
  const fieldContext = React.useContext(FormFieldContext)
  const itemContext = React.useContext(FormItemContext)
  const { getFieldState, formState } = useFormContext()

  const fieldState = getFieldState(fieldContext.name, formState)

  if (!fieldContext) {
    throw new Error("useFormField should be used within <FormField>")
  }

  const { id } = itemContext

  return {
    id,
    name: fieldContext.name,
    formItemId: `${id}-form-item`,
    formDescriptionId: `${id}-form-item-description`,
    formMessageId: `${id}-form-item-message`,
    ...fieldState,
  }
}

type FormItemContextValue = {
  id: string
}

const FormItemContext = React.createContext<FormItemContextValue>(
  {} as FormItemContextValue
)

const FormItem = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => {
  const id = React.useId()

  return (
    <FormItemContext.Provider value={{ id }}>
      <div ref={ref} className={cn("space-y-2", className)} {...props} />
    </FormItemContext.Provider>
  )
})
FormItem.displayName = "FormItem"

const FormLabel = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>
>(({ className, ...props }, ref) => {
  const { error, formItemId } = useFormField()

  return (
    <Label
      ref={ref}
      className={cn(error && "text-destructive", className)}
      htmlFor={formItemId}
      {...props}
    />
  )
})
FormLabel.displayName = "FormLabel"

const FormControl = React.forwardRef<
  React.ElementRef<typeof Slot>,
  React.ComponentPropsWithoutRef<typeof Slot>
>(({ ...props }, ref) => {
  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()

  return (
    <Slot
      ref={ref}
      id={formItemId}
      aria-describedby={
        !error
          ? `${formDescriptionId}`
          : `${formDescriptionId} ${formMessageId}`
      }
      aria-invalid={!!error}
      {...props}
    />
  )
})
FormControl.displayName = "FormControl"

const FormDescription = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, ...props }, ref) => {
  const { formDescriptionId } = useFormField()

  return (
    <p
      ref={ref}
      id={formDescriptionId}
      className={cn("text-sm text-muted-foreground", className)}
      {...props}
    />
  )
})
FormDescription.displayName = "FormDescription"

const FormMessage = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, children, ...props }, ref) => {
  const { error, formMessageId } = useFormField()
  const body = error ? String(error?.message) : children

  if (!body) {
    return null
  }

  return (
    <p
      ref={ref}
      id={formMessageId}
      className={cn("text-sm font-medium text-destructive", className)}
      {...props}
    >
      {body}
    </p>
  )
})
FormMessage.displayName = "FormMessage"

export {
  useFormField,
  Form,
  FormItem,
  FormLabel,
  FormControl,
  FormDescription,
  FormMessage,
  FormField,
}

----------------------------------------
ENDOFFILE: src\components\ui\form.tsx

STARTOFFILE: src\components\ui\hover-card.tsx
----------------------------------------
import * as React from "react"
import * as HoverCardPrimitive from "@radix-ui/react-hover-card"

import { cn } from "@/lib/utils"

const HoverCard = HoverCardPrimitive.Root

const HoverCardTrigger = HoverCardPrimitive.Trigger

const HoverCardContent = React.forwardRef<
  React.ElementRef<typeof HoverCardPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>
>(({ className, align = "center", sideOffset = 4, ...props }, ref) => (
  <HoverCardPrimitive.Content
    ref={ref}
    align={align}
    sideOffset={sideOffset}
    className={cn(
      "z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className
    )}
    {...props}
  />
))
HoverCardContent.displayName = HoverCardPrimitive.Content.displayName

export { HoverCard, HoverCardTrigger, HoverCardContent }

----------------------------------------
ENDOFFILE: src\components\ui\hover-card.tsx

STARTOFFILE: src\components\ui\input-otp.tsx
----------------------------------------
import * as React from "react";
import { OTPInput, OTPInputContext } from "input-otp";
import { Dot } from "@/lib/icons";

import { cn } from "@/lib/utils";

const InputOTP = React.forwardRef<React.ElementRef<typeof OTPInput>, React.ComponentPropsWithoutRef<typeof OTPInput>>(
  ({ className, containerClassName, ...props }, ref) => (
    <OTPInput
      ref={ref}
      containerClassName={cn("flex items-center gap-2 has-[:disabled]:opacity-50", containerClassName)}
      className={cn("disabled:cursor-not-allowed", className)}
      {...props}
    />
  )
);
InputOTP.displayName = "InputOTP";

const InputOTPGroup = React.forwardRef<React.ElementRef<"div">, React.ComponentPropsWithoutRef<"div">>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn("flex items-center", className)} {...props} />
));
InputOTPGroup.displayName = "InputOTPGroup";

const InputOTPSlot = React.forwardRef<React.ElementRef<"div">, React.ComponentPropsWithoutRef<"div"> & { index: number }>(
  ({ index, className, ...props }, ref) => {
    const inputOTPContext = React.useContext(OTPInputContext);
    const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index];

    return (
      <div
        ref={ref}
        className={cn(
          "relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",
          isActive && "z-10 ring-2 ring-ring ring-offset-background",
          className
        )}
        {...props}
      >
        {char}
        {hasFakeCaret && (
          <div className="pointer-events-none absolute inset-0 flex items-center justify-center">
            <div className="h-4 w-px animate-caret-blink bg-foreground duration-1000" />
          </div>
        )}
      </div>
    );
  }
);
InputOTPSlot.displayName = "InputOTPSlot";

const InputOTPSeparator = React.forwardRef<React.ElementRef<"div">, React.ComponentPropsWithoutRef<"div">>(({ ...props }, ref) => (
  <div ref={ref} role="separator" {...props}>
    <Dot />
  </div>
));
InputOTPSeparator.displayName = "InputOTPSeparator";

export { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator };

----------------------------------------
ENDOFFILE: src\components\ui\input-otp.tsx

STARTOFFILE: src\components\ui\input.tsx
----------------------------------------
import * as React from "react"

import { cn } from "@/lib/utils"

const Input = React.forwardRef<HTMLInputElement, React.ComponentProps<"input">>(
  ({ className, type, ...props }, ref) => {
    return (
      <input
        type={type}
        className={cn(
          "flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
          className
        )}
        ref={ref}
        {...props}
      />
    )
  }
)
Input.displayName = "Input"

export { Input }

----------------------------------------
ENDOFFILE: src\components\ui\input.tsx

STARTOFFILE: src\components\ui\label.tsx
----------------------------------------
import * as React from "react"
import * as LabelPrimitive from "@radix-ui/react-label"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const labelVariants = cva(
  "text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
)

const Label = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &
    VariantProps<typeof labelVariants>
>(({ className, ...props }, ref) => (
  <LabelPrimitive.Root
    ref={ref}
    className={cn(labelVariants(), className)}
    {...props}
  />
))
Label.displayName = LabelPrimitive.Root.displayName

export { Label }

----------------------------------------
ENDOFFILE: src\components\ui\label.tsx

STARTOFFILE: src\components\ui\menubar.tsx
----------------------------------------
import * as React from "react";
import * as MenubarPrimitive from "@radix-ui/react-menubar";
import { Check, ChevronRight, Circle } from "@/lib/icons";

import { cn } from "@/lib/utils";

const MenubarMenu = MenubarPrimitive.Menu;

const MenubarGroup = MenubarPrimitive.Group;

const MenubarPortal = MenubarPrimitive.Portal;

const MenubarSub = MenubarPrimitive.Sub;

const MenubarRadioGroup = MenubarPrimitive.RadioGroup;

const Menubar = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Root
    ref={ref}
    className={cn("flex h-10 items-center space-x-1 rounded-md border bg-background p-1", className)}
    {...props}
  />
));
Menubar.displayName = MenubarPrimitive.Root.displayName;

const MenubarTrigger = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Trigger
    ref={ref}
    className={cn(
      "flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",
      className
    )}
    {...props}
  />
));
MenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName;

const MenubarSubTrigger = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {
    inset?: boolean;
  }
>(({ className, inset, children, ...props }, ref) => (
  <MenubarPrimitive.SubTrigger
    ref={ref}
    className={cn(
      "flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",
      inset && "pl-8",
      className
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto h-4 w-4" />
  </MenubarPrimitive.SubTrigger>
));
MenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName;

const MenubarSubContent = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.SubContent
    ref={ref}
    className={cn(
      "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className
    )}
    {...props}
  />
));
MenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName;

const MenubarContent = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>
>(({ className, align = "start", alignOffset = -4, sideOffset = 8, ...props }, ref) => (
  <MenubarPrimitive.Portal>
    <MenubarPrimitive.Content
      ref={ref}
      align={align}
      alignOffset={alignOffset}
      sideOffset={sideOffset}
      className={cn(
        "z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className
      )}
      {...props}
    />
  </MenubarPrimitive.Portal>
));
MenubarContent.displayName = MenubarPrimitive.Content.displayName;

const MenubarItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <MenubarPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      inset && "pl-8",
      className
    )}
    {...props}
  />
));
MenubarItem.displayName = MenubarPrimitive.Item.displayName;

const MenubarCheckboxItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <MenubarPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <MenubarPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </MenubarPrimitive.ItemIndicator>
    </span>
    {children}
  </MenubarPrimitive.CheckboxItem>
));
MenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName;

const MenubarRadioItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <MenubarPrimitive.RadioItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <MenubarPrimitive.ItemIndicator>
        <Circle className="h-2 w-2 fill-current" />
      </MenubarPrimitive.ItemIndicator>
    </span>
    {children}
  </MenubarPrimitive.RadioItem>
));
MenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName;

const MenubarLabel = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <MenubarPrimitive.Label ref={ref} className={cn("px-2 py-1.5 text-sm font-semibold", inset && "pl-8", className)} {...props} />
));
MenubarLabel.displayName = MenubarPrimitive.Label.displayName;

const MenubarSeparator = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Separator ref={ref} className={cn("-mx-1 my-1 h-px bg-muted", className)} {...props} />
));
MenubarSeparator.displayName = MenubarPrimitive.Separator.displayName;

const MenubarShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => {
  return <span className={cn("ml-auto text-xs tracking-widest text-muted-foreground", className)} {...props} />;
};
MenubarShortcut.displayname = "MenubarShortcut";

export {
  Menubar,
  MenubarMenu,
  MenubarTrigger,
  MenubarContent,
  MenubarItem,
  MenubarSeparator,
  MenubarLabel,
  MenubarCheckboxItem,
  MenubarRadioGroup,
  MenubarRadioItem,
  MenubarPortal,
  MenubarSubContent,
  MenubarSubTrigger,
  MenubarGroup,
  MenubarSub,
  MenubarShortcut,
};

----------------------------------------
ENDOFFILE: src\components\ui\menubar.tsx

STARTOFFILE: src\components\ui\navigation-menu.tsx
----------------------------------------
import * as React from "react";
import * as NavigationMenuPrimitive from "@radix-ui/react-navigation-menu";
import { cva } from "class-variance-authority";
import { ChevronDown } from "@/lib/icons";

import { cn } from "@/lib/utils";

const NavigationMenu = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>
>(({ className, children, ...props }, ref) => (
  <NavigationMenuPrimitive.Root
    ref={ref}
    className={cn("relative z-10 flex max-w-max flex-1 items-center justify-center", className)}
    {...props}
  >
    {children}
    <NavigationMenuViewport />
  </NavigationMenuPrimitive.Root>
));
NavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName;

const NavigationMenuList = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>
>(({ className, ...props }, ref) => (
  <NavigationMenuPrimitive.List
    ref={ref}
    className={cn("group flex flex-1 list-none items-center justify-center space-x-1", className)}
    {...props}
  />
));
NavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName;

const NavigationMenuItem = NavigationMenuPrimitive.Item;

const navigationMenuTriggerStyle = cva(
  "group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50"
);

const NavigationMenuTrigger = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <NavigationMenuPrimitive.Trigger ref={ref} className={cn(navigationMenuTriggerStyle(), "group", className)} {...props}>
    {children}{" "}
    <ChevronDown
      className="relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180"
      aria-hidden="true"
    />
  </NavigationMenuPrimitive.Trigger>
));
NavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName;

const NavigationMenuContent = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>
>(({ className, ...props }, ref) => (
  <NavigationMenuPrimitive.Content
    ref={ref}
    className={cn(
      "left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto ",
      className
    )}
    {...props}
  />
));
NavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName;

const NavigationMenuLink = NavigationMenuPrimitive.Link;

const NavigationMenuViewport = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>
>(({ className, ...props }, ref) => (
  <div className={cn("absolute left-0 top-full flex justify-center")}>
    <NavigationMenuPrimitive.Viewport
      className={cn(
        "origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]",
        className
      )}
      ref={ref}
      {...props}
    />
  </div>
));
NavigationMenuViewport.displayName = NavigationMenuPrimitive.Viewport.displayName;

const NavigationMenuIndicator = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>
>(({ className, ...props }, ref) => (
  <NavigationMenuPrimitive.Indicator
    ref={ref}
    className={cn(
      "top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in",
      className
    )}
    {...props}
  >
    <div className="relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md" />
  </NavigationMenuPrimitive.Indicator>
));
NavigationMenuIndicator.displayName = NavigationMenuPrimitive.Indicator.displayName;

export {
  navigationMenuTriggerStyle,
  NavigationMenu,
  NavigationMenuList,
  NavigationMenuItem,
  NavigationMenuContent,
  NavigationMenuTrigger,
  NavigationMenuLink,
  NavigationMenuIndicator,
  NavigationMenuViewport,
};

----------------------------------------
ENDOFFILE: src\components\ui\navigation-menu.tsx

STARTOFFILE: src\components\ui\pagination.tsx
----------------------------------------
import * as React from "react";
import { ChevronLeft, ChevronRight, MoreHorizontal } from "@/lib/icons";

import { cn } from "@/lib/utils";
import { ButtonProps, buttonVariants } from "@/components/ui/button";

const Pagination = ({ className, ...props }: React.ComponentProps<"nav">) => (
  <nav role="navigation" aria-label="pagination" className={cn("mx-auto flex w-full justify-center", className)} {...props} />
);
Pagination.displayName = "Pagination";

const PaginationContent = React.forwardRef<HTMLUListElement, React.ComponentProps<"ul">>(({ className, ...props }, ref) => (
  <ul ref={ref} className={cn("flex flex-row items-center gap-1", className)} {...props} />
));
PaginationContent.displayName = "PaginationContent";

const PaginationItem = React.forwardRef<HTMLLIElement, React.ComponentProps<"li">>(({ className, ...props }, ref) => (
  <li ref={ref} className={cn("", className)} {...props} />
));
PaginationItem.displayName = "PaginationItem";

type PaginationLinkProps = {
  isActive?: boolean;
} & Pick<ButtonProps, "size"> &
  React.ComponentProps<"a">;

const PaginationLink = ({ className, isActive, size = "icon", ...props }: PaginationLinkProps) => (
  <a
    aria-current={isActive ? "page" : undefined}
    className={cn(
      buttonVariants({
        variant: isActive ? "outline" : "ghost",
        size,
      }),
      className
    )}
    {...props}
  />
);
PaginationLink.displayName = "PaginationLink";

const PaginationPrevious = ({ className, ...props }: React.ComponentProps<typeof PaginationLink>) => (
  <PaginationLink aria-label="Go to previous page" size="default" className={cn("gap-1 pl-2.5", className)} {...props}>
    <ChevronLeft className="h-4 w-4" />
    <span>Previous</span>
  </PaginationLink>
);
PaginationPrevious.displayName = "PaginationPrevious";

const PaginationNext = ({ className, ...props }: React.ComponentProps<typeof PaginationLink>) => (
  <PaginationLink aria-label="Go to next page" size="default" className={cn("gap-1 pr-2.5", className)} {...props}>
    <span>Next</span>
    <ChevronRight className="h-4 w-4" />
  </PaginationLink>
);
PaginationNext.displayName = "PaginationNext";

const PaginationEllipsis = ({ className, ...props }: React.ComponentProps<"span">) => (
  <span aria-hidden className={cn("flex h-9 w-9 items-center justify-center", className)} {...props}>
    <MoreHorizontal className="h-4 w-4" />
    <span className="sr-only">More pages</span>
  </span>
);
PaginationEllipsis.displayName = "PaginationEllipsis";

export { Pagination, PaginationContent, PaginationEllipsis, PaginationItem, PaginationLink, PaginationNext, PaginationPrevious };

----------------------------------------
ENDOFFILE: src\components\ui\pagination.tsx

STARTOFFILE: src\components\ui\popover.tsx
----------------------------------------
import * as React from "react";
import * as PopoverPrimitive from "@radix-ui/react-popover";

import { cn } from "@/lib/utils";

const Popover = PopoverPrimitive.Root;

const PopoverTrigger = PopoverPrimitive.Trigger;

const PopoverContent = React.forwardRef<
  React.ElementRef<typeof PopoverPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>
>(({ className, align = "center", sideOffset = 4, ...props }, ref) => (
  <PopoverPrimitive.Portal>
    <PopoverPrimitive.Content
      ref={ref}
      align={align}
      sideOffset={sideOffset}
      className={cn(
        "z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className
      )}
      {...props}
    />
  </PopoverPrimitive.Portal>
));
PopoverContent.displayName = PopoverPrimitive.Content.displayName;

export { Popover, PopoverTrigger, PopoverContent };

----------------------------------------
ENDOFFILE: src\components\ui\popover.tsx

STARTOFFILE: src\components\ui\progress.tsx
----------------------------------------
import * as React from "react"
import * as ProgressPrimitive from "@radix-ui/react-progress"

import { cn } from "@/lib/utils"

const Progress = React.forwardRef<
  React.ElementRef<typeof ProgressPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>
>(({ className, value, ...props }, ref) => (
  <ProgressPrimitive.Root
    ref={ref}
    className={cn(
      "relative h-4 w-full overflow-hidden rounded-full bg-secondary",
      className
    )}
    {...props}
  >
    <ProgressPrimitive.Indicator
      className="h-full w-full flex-1 bg-primary transition-all"
      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}
    />
  </ProgressPrimitive.Root>
))
Progress.displayName = ProgressPrimitive.Root.displayName

export { Progress }

----------------------------------------
ENDOFFILE: src\components\ui\progress.tsx

STARTOFFILE: src\components\ui\radio-group.tsx
----------------------------------------
import * as React from "react";
import * as RadioGroupPrimitive from "@radix-ui/react-radio-group";
import { Circle } from "@/lib/icons";

import { cn } from "@/lib/utils";

const RadioGroup = React.forwardRef<
  React.ElementRef<typeof RadioGroupPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>
>(({ className, ...props }, ref) => {
  return <RadioGroupPrimitive.Root className={cn("grid gap-2", className)} {...props} ref={ref} />;
});
RadioGroup.displayName = RadioGroupPrimitive.Root.displayName;

const RadioGroupItem = React.forwardRef<
  React.ElementRef<typeof RadioGroupPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>
>(({ className, ...props }, ref) => {
  return (
    <RadioGroupPrimitive.Item
      ref={ref}
      className={cn(
        "aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",
        className
      )}
      {...props}
    >
      <RadioGroupPrimitive.Indicator className="flex items-center justify-center">
        <Circle className="h-2.5 w-2.5 fill-current text-current" />
      </RadioGroupPrimitive.Indicator>
    </RadioGroupPrimitive.Item>
  );
});
RadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName;

export { RadioGroup, RadioGroupItem };

----------------------------------------
ENDOFFILE: src\components\ui\radio-group.tsx

STARTOFFILE: src\components\ui\resizable.tsx
----------------------------------------
import { GripVertical } from "@/lib/icons";
import * as ResizablePrimitive from "react-resizable-panels";

import { cn } from "@/lib/utils";

const ResizablePanelGroup = ({ className, ...props }: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (
  <ResizablePrimitive.PanelGroup
    className={cn("flex h-full w-full data-[panel-group-direction=vertical]:flex-col", className)}
    {...props}
  />
);

const ResizablePanel = ResizablePrimitive.Panel;

const ResizableHandle = ({
  withHandle,
  className,
  ...props
}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {
  withHandle?: boolean;
}) => (
  <ResizablePrimitive.PanelResizeHandle
    className={cn(
      "relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",
      className
    )}
    {...props}
  >
    {withHandle && (
      <div className="z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border">
        <GripVertical className="h-2.5 w-2.5" />
      </div>
    )}
  </ResizablePrimitive.PanelResizeHandle>
);

export { ResizablePanelGroup, ResizablePanel, ResizableHandle };

----------------------------------------
ENDOFFILE: src\components\ui\resizable.tsx

STARTOFFILE: src\components\ui\scroll-area.tsx
----------------------------------------
import * as React from "react"
import * as ScrollAreaPrimitive from "@radix-ui/react-scroll-area"

import { cn } from "@/lib/utils"

const ScrollArea = React.forwardRef<
  React.ElementRef<typeof ScrollAreaPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>
>(({ className, children, ...props }, ref) => (
  <ScrollAreaPrimitive.Root
    ref={ref}
    className={cn("relative overflow-hidden", className)}
    {...props}
  >
    <ScrollAreaPrimitive.Viewport className="h-full w-full rounded-[inherit]">
      {children}
    </ScrollAreaPrimitive.Viewport>
    <ScrollBar />
    <ScrollAreaPrimitive.Corner />
  </ScrollAreaPrimitive.Root>
))
ScrollArea.displayName = ScrollAreaPrimitive.Root.displayName

const ScrollBar = React.forwardRef<
  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,
  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>
>(({ className, orientation = "vertical", ...props }, ref) => (
  <ScrollAreaPrimitive.ScrollAreaScrollbar
    ref={ref}
    orientation={orientation}
    className={cn(
      "flex touch-none select-none transition-colors",
      orientation === "vertical" &&
        "h-full w-2.5 border-l border-l-transparent p-[1px]",
      orientation === "horizontal" &&
        "h-2.5 flex-col border-t border-t-transparent p-[1px]",
      className
    )}
    {...props}
  >
    <ScrollAreaPrimitive.ScrollAreaThumb className="relative flex-1 rounded-full bg-border" />
  </ScrollAreaPrimitive.ScrollAreaScrollbar>
))
ScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName

export { ScrollArea, ScrollBar }

----------------------------------------
ENDOFFILE: src\components\ui\scroll-area.tsx

STARTOFFILE: src\components\ui\select.tsx
----------------------------------------
import * as React from "react";
import * as SelectPrimitive from "@radix-ui/react-select";
import { Check, ChevronDown, ChevronUp } from "@/lib/icons";

import { cn } from "@/lib/utils";

const Select = SelectPrimitive.Root;

const SelectGroup = SelectPrimitive.Group;

const SelectValue = SelectPrimitive.Value;

const SelectTrigger = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Trigger
    ref={ref}
    className={cn(
      "flex h-10 w-full items-center justify-between rounded-md border border-input bg-popover px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",
      className
    )}
    {...props}
  >
    {children}
    <SelectPrimitive.Icon asChild>
      <ChevronDown className="h-4 w-4 opacity-50" />
    </SelectPrimitive.Icon>
  </SelectPrimitive.Trigger>
));
SelectTrigger.displayName = SelectPrimitive.Trigger.displayName;

const SelectScrollUpButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollUpButton ref={ref} className={cn("flex cursor-default items-center justify-center py-1", className)} {...props}>
    <ChevronUp className="h-4 w-4" />
  </SelectPrimitive.ScrollUpButton>
));
SelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName;

const SelectScrollDownButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollDownButton ref={ref} className={cn("flex cursor-default items-center justify-center py-1", className)} {...props}>
    <ChevronDown className="h-4 w-4" />
  </SelectPrimitive.ScrollDownButton>
));
SelectScrollDownButton.displayName = SelectPrimitive.ScrollDownButton.displayName;

const SelectContent = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>
>(({ className, children, position = "popper", ...props }, ref) => (
  <SelectPrimitive.Portal>
    <SelectPrimitive.Content
      ref={ref}
      className={cn(
        "relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-border bg-popover text-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        position === "popper" &&
          "data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",
        className
      )}
      position={position}
      {...props}
    >
      <SelectScrollUpButton />
      <SelectPrimitive.Viewport
        className={cn(
          "p-1",
          position === "popper" && "h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"
        )}
      >
        {children}
      </SelectPrimitive.Viewport>
      <SelectScrollDownButton />
    </SelectPrimitive.Content>
  </SelectPrimitive.Portal>
));
SelectContent.displayName = SelectPrimitive.Content.displayName;

const SelectLabel = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Label ref={ref} className={cn("py-1.5 pl-8 pr-2 text-sm font-semibold", className)} {...props} />
));
SelectLabel.displayName = SelectPrimitive.Label.displayName;

const SelectItem = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:",
      className
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <SelectPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </SelectPrimitive.ItemIndicator>
    </span>

    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
  </SelectPrimitive.Item>
));
SelectItem.displayName = SelectPrimitive.Item.displayName;

const SelectSeparator = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Separator ref={ref} className={cn("-mx-1 my-1 h-px bg-muted", className)} {...props} />
));
SelectSeparator.displayName = SelectPrimitive.Separator.displayName;

export {
  Select,
  SelectGroup,
  SelectValue,
  SelectTrigger,
  SelectContent,
  SelectLabel,
  SelectItem,
  SelectSeparator,
  SelectScrollUpButton,
  SelectScrollDownButton,
};

----------------------------------------
ENDOFFILE: src\components\ui\select.tsx

STARTOFFILE: src\components\ui\separator.tsx
----------------------------------------
import * as React from "react"
import * as SeparatorPrimitive from "@radix-ui/react-separator"

import { cn } from "@/lib/utils"

const Separator = React.forwardRef<
  React.ElementRef<typeof SeparatorPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>
>(
  (
    { className, orientation = "horizontal", decorative = true, ...props },
    ref
  ) => (
    <SeparatorPrimitive.Root
      ref={ref}
      decorative={decorative}
      orientation={orientation}
      className={cn(
        "shrink-0 bg-border",
        orientation === "horizontal" ? "h-[1px] w-full" : "h-full w-[1px]",
        className
      )}
      {...props}
    />
  )
)
Separator.displayName = SeparatorPrimitive.Root.displayName

export { Separator }

----------------------------------------
ENDOFFILE: src\components\ui\separator.tsx

STARTOFFILE: src\components\ui\sheet.tsx
----------------------------------------
import * as SheetPrimitive from "@radix-ui/react-dialog";
import { cva, type VariantProps } from "class-variance-authority";
import { X } from "@/lib/icons";
import * as React from "react";

import { cn } from "@/lib/utils";

const Sheet = SheetPrimitive.Root;

const SheetTrigger = SheetPrimitive.Trigger;

const SheetClose = SheetPrimitive.Close;

const SheetPortal = SheetPrimitive.Portal;

const SheetOverlay = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Overlay
    className={cn(
      "fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
      className
    )}
    {...props}
    ref={ref}
  />
));
SheetOverlay.displayName = SheetPrimitive.Overlay.displayName;

const sheetVariants = cva(
  "fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",
  {
    variants: {
      side: {
        top: "inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",
        bottom: "inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",
        left: "inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",
        right:
          "inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm",
      },
    },
    defaultVariants: {
      side: "right",
    },
  }
);

interface SheetContentProps extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>, VariantProps<typeof sheetVariants> {}

const SheetContent = React.forwardRef<React.ElementRef<typeof SheetPrimitive.Content>, SheetContentProps>(
  ({ side = "right", className, children, ...props }, ref) => (
    <SheetPortal>
      <SheetOverlay />
      <SheetPrimitive.Content ref={ref} className={cn(sheetVariants({ side }), className)} {...props}>
        {children}
        <SheetPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary">
          <X className="h-4 w-4" />
          <span className="sr-only">Close</span>
        </SheetPrimitive.Close>
      </SheetPrimitive.Content>
    </SheetPortal>
  )
);
SheetContent.displayName = SheetPrimitive.Content.displayName;

const SheetHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col space-y-2 text-center sm:text-left", className)} {...props} />
);
SheetHeader.displayName = "SheetHeader";

const SheetFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2", className)} {...props} />
);
SheetFooter.displayName = "SheetFooter";

const SheetTitle = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Title ref={ref} className={cn("text-lg font-semibold text-foreground", className)} {...props} />
));
SheetTitle.displayName = SheetPrimitive.Title.displayName;

const SheetDescription = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Description ref={ref} className={cn("text-sm text-muted-foreground", className)} {...props} />
));
SheetDescription.displayName = SheetPrimitive.Description.displayName;

export { Sheet, SheetClose, SheetContent, SheetDescription, SheetFooter, SheetHeader, SheetOverlay, SheetPortal, SheetTitle, SheetTrigger };

----------------------------------------
ENDOFFILE: src\components\ui\sheet.tsx

STARTOFFILE: src\components\ui\sidebar.tsx
----------------------------------------
import * as React from "react";
import { Slot } from "@radix-ui/react-slot";
import { VariantProps, cva } from "class-variance-authority";
import { PanelLeft } from "@/lib/icons";

import { useIsMobile } from "@/hooks/use-mobile";
import { cn } from "@/lib/utils";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Separator } from "@/components/ui/separator";
import { Sheet, SheetContent } from "@/components/ui/sheet";
import { Skeleton } from "@/components/ui/skeleton";
import { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from "@/components/ui/tooltip";

const SIDEBAR_COOKIE_NAME = "sidebar:state";
const SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7;
const SIDEBAR_WIDTH = "16rem";
const SIDEBAR_WIDTH_MOBILE = "18rem";
const SIDEBAR_WIDTH_ICON = "3rem";
const SIDEBAR_KEYBOARD_SHORTCUT = "b";

type SidebarContext = {
  state: "expanded" | "collapsed";
  open: boolean;
  setOpen: (open: boolean) => void;
  openMobile: boolean;
  setOpenMobile: (open: boolean) => void;
  isMobile: boolean;
  toggleSidebar: () => void;
};

const SidebarContext = React.createContext<SidebarContext | null>(null);

function useSidebar() {
  const context = React.useContext(SidebarContext);
  if (!context) {
    throw new Error("useSidebar must be used within a SidebarProvider.");
  }

  return context;
}

const SidebarProvider = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & {
    defaultOpen?: boolean;
    open?: boolean;
    onOpenChange?: (open: boolean) => void;
  }
>(({ defaultOpen = true, open: openProp, onOpenChange: setOpenProp, className, style, children, ...props }, ref) => {
  const isMobile = useIsMobile();
  const [openMobile, setOpenMobile] = React.useState(false);

  // This is the internal state of the sidebar.
  // We use openProp and setOpenProp for control from outside the component.
  const [_open, _setOpen] = React.useState(defaultOpen);
  const open = openProp ?? _open;
  const setOpen = React.useCallback(
    (value: boolean | ((value: boolean) => boolean)) => {
      const openState = typeof value === "function" ? value(open) : value;
      if (setOpenProp) {
        setOpenProp(openState);
      } else {
        _setOpen(openState);
      }

      // This sets the cookie to keep the sidebar state.
      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`;
    },
    [setOpenProp, open]
  );

  // Helper to toggle the sidebar.
  const toggleSidebar = React.useCallback(() => {
    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open);
  }, [isMobile, setOpen, setOpenMobile]);

  // Adds a keyboard shortcut to toggle the sidebar.
  React.useEffect(() => {
    const handleKeyDown = (event: KeyboardEvent) => {
      if (event.key === SIDEBAR_KEYBOARD_SHORTCUT && (event.metaKey || event.ctrlKey)) {
        event.preventDefault();
        toggleSidebar();
      }
    };

    window.addEventListener("keydown", handleKeyDown);
    return () => window.removeEventListener("keydown", handleKeyDown);
  }, [toggleSidebar]);

  // We add a state so that we can do data-state="expanded" or "collapsed".
  // This makes it easier to style the sidebar with Tailwind classes.
  const state = open ? "expanded" : "collapsed";

  const contextValue = React.useMemo<SidebarContext>(
    () => ({
      state,
      open,
      setOpen,
      isMobile,
      openMobile,
      setOpenMobile,
      toggleSidebar,
    }),
    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]
  );

  return (
    <SidebarContext.Provider value={contextValue}>
      <TooltipProvider delayDuration={0}>
        <div
          style={
            {
              "--sidebar-width": SIDEBAR_WIDTH,
              "--sidebar-width-icon": SIDEBAR_WIDTH_ICON,
              ...style,
            } as React.CSSProperties
          }
          className={cn("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar", className)}
          ref={ref}
          {...props}
        >
          {children}
        </div>
      </TooltipProvider>
    </SidebarContext.Provider>
  );
});
SidebarProvider.displayName = "SidebarProvider";

const Sidebar = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & {
    side?: "left" | "right";
    variant?: "sidebar" | "floating" | "inset";
    collapsible?: "offcanvas" | "icon" | "none";
  }
>(({ side = "left", variant = "sidebar", collapsible = "offcanvas", className, children, ...props }, ref) => {
  const { isMobile, state, openMobile, setOpenMobile } = useSidebar();

  if (collapsible === "none") {
    return (
      <div className={cn("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground", className)} ref={ref} {...props}>
        {children}
      </div>
    );
  }

  if (isMobile) {
    return (
      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>
        <SheetContent
          data-sidebar="sidebar"
          data-mobile="true"
          className="w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden"
          style={
            {
              "--sidebar-width": SIDEBAR_WIDTH_MOBILE,
            } as React.CSSProperties
          }
          side={side}
        >
          <div className="flex h-full w-full flex-col">{children}</div>
        </SheetContent>
      </Sheet>
    );
  }

  return (
    <div
      ref={ref}
      className="group peer hidden md:block text-sidebar-foreground"
      data-state={state}
      data-collapsible={state === "collapsed" ? collapsible : ""}
      data-variant={variant}
      data-side={side}
    >
      {/* This is what handles the sidebar gap on desktop */}
      <div
        className={cn(
          "duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear",
          "group-data-[collapsible=offcanvas]:w-0",
          "group-data-[side=right]:rotate-180",
          variant === "floating" || variant === "inset"
            ? "group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]"
            : "group-data-[collapsible=icon]:w-[--sidebar-width-icon]"
        )}
      />
      <div
        className={cn(
          "duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex",
          side === "left"
            ? "left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]"
            : "right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",
          // Adjust the padding for floating and inset variants.
          variant === "floating" || variant === "inset"
            ? "p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]"
            : "group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",
          className
        )}
        {...props}
      >
        <div
          data-sidebar="sidebar"
          className="flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow"
        >
          {children}
        </div>
      </div>
    </div>
  );
});
Sidebar.displayName = "Sidebar";

const SidebarTrigger = React.forwardRef<React.ElementRef<typeof Button>, React.ComponentProps<typeof Button>>(
  ({ className, onClick, ...props }, ref) => {
    const { toggleSidebar } = useSidebar();

    return (
      <Button
        ref={ref}
        data-sidebar="trigger"
        variant="ghost"
        size="icon"
        className={cn("h-7 w-7", className)}
        onClick={(event) => {
          onClick?.(event);
          toggleSidebar();
        }}
        {...props}
      >
        <PanelLeft />
        <span className="sr-only">Toggle Sidebar</span>
      </Button>
    );
  }
);
SidebarTrigger.displayName = "SidebarTrigger";

const SidebarRail = React.forwardRef<HTMLButtonElement, React.ComponentProps<"button">>(({ className, ...props }, ref) => {
  const { toggleSidebar } = useSidebar();

  return (
    <button
      ref={ref}
      data-sidebar="rail"
      aria-label="Toggle Sidebar"
      tabIndex={-1}
      onClick={toggleSidebar}
      title="Toggle Sidebar"
      className={cn(
        "absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex",
        "[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize",
        "[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize",
        "group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar",
        "[[data-side=left][data-collapsible=offcanvas]_&]:-right-2",
        "[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",
        className
      )}
      {...props}
    />
  );
});
SidebarRail.displayName = "SidebarRail";

const SidebarInset = React.forwardRef<HTMLDivElement, React.ComponentProps<"main">>(({ className, ...props }, ref) => {
  return (
    <main
      ref={ref}
      className={cn(
        "relative flex min-h-svh flex-1 flex-col bg-background",
        "peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",
        className
      )}
      {...props}
    />
  );
});
SidebarInset.displayName = "SidebarInset";

const SidebarInput = React.forwardRef<React.ElementRef<typeof Input>, React.ComponentProps<typeof Input>>(
  ({ className, ...props }, ref) => {
    return (
      <Input
        ref={ref}
        data-sidebar="input"
        className={cn("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring", className)}
        {...props}
      />
    );
  }
);
SidebarInput.displayName = "SidebarInput";

const SidebarHeader = React.forwardRef<HTMLDivElement, React.ComponentProps<"div">>(({ className, ...props }, ref) => {
  return <div ref={ref} data-sidebar="header" className={cn("flex flex-col gap-2 p-2", className)} {...props} />;
});
SidebarHeader.displayName = "SidebarHeader";

const SidebarFooter = React.forwardRef<HTMLDivElement, React.ComponentProps<"div">>(({ className, ...props }, ref) => {
  return <div ref={ref} data-sidebar="footer" className={cn("flex flex-col gap-2 p-2", className)} {...props} />;
});
SidebarFooter.displayName = "SidebarFooter";

const SidebarSeparator = React.forwardRef<React.ElementRef<typeof Separator>, React.ComponentProps<typeof Separator>>(
  ({ className, ...props }, ref) => {
    return <Separator ref={ref} data-sidebar="separator" className={cn("mx-2 w-auto bg-sidebar-border", className)} {...props} />;
  }
);
SidebarSeparator.displayName = "SidebarSeparator";

const SidebarContent = React.forwardRef<HTMLDivElement, React.ComponentProps<"div">>(({ className, ...props }, ref) => {
  return (
    <div
      ref={ref}
      data-sidebar="content"
      className={cn("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden", className)}
      {...props}
    />
  );
});
SidebarContent.displayName = "SidebarContent";

const SidebarGroup = React.forwardRef<HTMLDivElement, React.ComponentProps<"div">>(({ className, ...props }, ref) => {
  return <div ref={ref} data-sidebar="group" className={cn("relative flex w-full min-w-0 flex-col p-2", className)} {...props} />;
});
SidebarGroup.displayName = "SidebarGroup";

const SidebarGroupLabel = React.forwardRef<HTMLDivElement, React.ComponentProps<"div"> & { asChild?: boolean }>(
  ({ className, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : "div";

    return (
      <Comp
        ref={ref}
        data-sidebar="group-label"
        className={cn(
          "duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
          "group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",
          className
        )}
        {...props}
      />
    );
  }
);
SidebarGroupLabel.displayName = "SidebarGroupLabel";

const SidebarGroupAction = React.forwardRef<HTMLButtonElement, React.ComponentProps<"button"> & { asChild?: boolean }>(
  ({ className, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : "button";

    return (
      <Comp
        ref={ref}
        data-sidebar="group-action"
        className={cn(
          "absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
          // Increases the hit area of the button on mobile.
          "after:absolute after:-inset-2 after:md:hidden",
          "group-data-[collapsible=icon]:hidden",
          className
        )}
        {...props}
      />
    );
  }
);
SidebarGroupAction.displayName = "SidebarGroupAction";

const SidebarGroupContent = React.forwardRef<HTMLDivElement, React.ComponentProps<"div">>(({ className, ...props }, ref) => (
  <div ref={ref} data-sidebar="group-content" className={cn("w-full text-sm", className)} {...props} />
));
SidebarGroupContent.displayName = "SidebarGroupContent";

const SidebarMenu = React.forwardRef<HTMLUListElement, React.ComponentProps<"ul">>(({ className, ...props }, ref) => (
  <ul ref={ref} data-sidebar="menu" className={cn("flex w-full min-w-0 flex-col gap-1", className)} {...props} />
));
SidebarMenu.displayName = "SidebarMenu";

const SidebarMenuItem = React.forwardRef<HTMLLIElement, React.ComponentProps<"li">>(({ className, ...props }, ref) => (
  <li ref={ref} data-sidebar="menu-item" className={cn("group/menu-item relative", className)} {...props} />
));
SidebarMenuItem.displayName = "SidebarMenuItem";

const sidebarMenuButtonVariants = cva(
  "peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",
  {
    variants: {
      variant: {
        default: "hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",
        outline:
          "bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]",
      },
      size: {
        default: "h-8 text-sm",
        sm: "h-7 text-xs",
        lg: "h-12 text-sm group-data-[collapsible=icon]:!p-0",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
);

const SidebarMenuButton = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<"button"> & {
    asChild?: boolean;
    isActive?: boolean;
    tooltip?: string | React.ComponentProps<typeof TooltipContent>;
  } & VariantProps<typeof sidebarMenuButtonVariants>
>(({ asChild = false, isActive = false, variant = "default", size = "default", tooltip, className, ...props }, ref) => {
  const Comp = asChild ? Slot : "button";
  const { isMobile, state } = useSidebar();

  const button = (
    <Comp
      ref={ref}
      data-sidebar="menu-button"
      data-size={size}
      data-active={isActive}
      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}
      {...props}
    />
  );

  if (!tooltip) {
    return button;
  }

  if (typeof tooltip === "string") {
    tooltip = {
      children: tooltip,
    };
  }

  return (
    <Tooltip>
      <TooltipTrigger asChild>{button}</TooltipTrigger>
      <TooltipContent side="right" align="center" hidden={state !== "collapsed" || isMobile} {...tooltip} />
    </Tooltip>
  );
});
SidebarMenuButton.displayName = "SidebarMenuButton";

const SidebarMenuAction = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<"button"> & {
    asChild?: boolean;
    showOnHover?: boolean;
  }
>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {
  const Comp = asChild ? Slot : "button";

  return (
    <Comp
      ref={ref}
      data-sidebar="menu-action"
      className={cn(
        "absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0",
        // Increases the hit area of the button on mobile.
        "after:absolute after:-inset-2 after:md:hidden",
        "peer-data-[size=sm]/menu-button:top-1",
        "peer-data-[size=default]/menu-button:top-1.5",
        "peer-data-[size=lg]/menu-button:top-2.5",
        "group-data-[collapsible=icon]:hidden",
        showOnHover &&
          "group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",
        className
      )}
      {...props}
    />
  );
});
SidebarMenuAction.displayName = "SidebarMenuAction";

const SidebarMenuBadge = React.forwardRef<HTMLDivElement, React.ComponentProps<"div">>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    data-sidebar="menu-badge"
    className={cn(
      "absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none",
      "peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground",
      "peer-data-[size=sm]/menu-button:top-1",
      "peer-data-[size=default]/menu-button:top-1.5",
      "peer-data-[size=lg]/menu-button:top-2.5",
      "group-data-[collapsible=icon]:hidden",
      className
    )}
    {...props}
  />
));
SidebarMenuBadge.displayName = "SidebarMenuBadge";

const SidebarMenuSkeleton = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & {
    showIcon?: boolean;
  }
>(({ className, showIcon = false, ...props }, ref) => {
  // Random width between 50 to 90%.
  const width = React.useMemo(() => {
    return `${Math.floor(Math.random() * 40) + 50}%`;
  }, []);

  return (
    <div ref={ref} data-sidebar="menu-skeleton" className={cn("rounded-md h-8 flex gap-2 px-2 items-center", className)} {...props}>
      {showIcon && <Skeleton className="size-4 rounded-md" data-sidebar="menu-skeleton-icon" />}
      <Skeleton
        className="h-4 flex-1 max-w-[--skeleton-width]"
        data-sidebar="menu-skeleton-text"
        style={
          {
            "--skeleton-width": width,
          } as React.CSSProperties
        }
      />
    </div>
  );
});
SidebarMenuSkeleton.displayName = "SidebarMenuSkeleton";

const SidebarMenuSub = React.forwardRef<HTMLUListElement, React.ComponentProps<"ul">>(({ className, ...props }, ref) => (
  <ul
    ref={ref}
    data-sidebar="menu-sub"
    className={cn(
      "mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5",
      "group-data-[collapsible=icon]:hidden",
      className
    )}
    {...props}
  />
));
SidebarMenuSub.displayName = "SidebarMenuSub";

const SidebarMenuSubItem = React.forwardRef<HTMLLIElement, React.ComponentProps<"li">>(({ ...props }, ref) => <li ref={ref} {...props} />);
SidebarMenuSubItem.displayName = "SidebarMenuSubItem";

const SidebarMenuSubButton = React.forwardRef<
  HTMLAnchorElement,
  React.ComponentProps<"a"> & {
    asChild?: boolean;
    size?: "sm" | "md";
    isActive?: boolean;
  }
>(({ asChild = false, size = "md", isActive, className, ...props }, ref) => {
  const Comp = asChild ? Slot : "a";

  return (
    <Comp
      ref={ref}
      data-sidebar="menu-sub-button"
      data-size={size}
      data-active={isActive}
      className={cn(
        "flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground",
        "data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",
        size === "sm" && "text-xs",
        size === "md" && "text-sm",
        "group-data-[collapsible=icon]:hidden",
        className
      )}
      {...props}
    />
  );
});
SidebarMenuSubButton.displayName = "SidebarMenuSubButton";

export {
  Sidebar,
  SidebarContent,
  SidebarFooter,
  SidebarGroup,
  SidebarGroupAction,
  SidebarGroupContent,
  SidebarGroupLabel,
  SidebarHeader,
  SidebarInput,
  SidebarInset,
  SidebarMenu,
  SidebarMenuAction,
  SidebarMenuBadge,
  SidebarMenuButton,
  SidebarMenuItem,
  SidebarMenuSkeleton,
  SidebarMenuSub,
  SidebarMenuSubButton,
  SidebarMenuSubItem,
  SidebarProvider,
  SidebarRail,
  SidebarSeparator,
  SidebarTrigger,
  useSidebar,
};

----------------------------------------
ENDOFFILE: src\components\ui\sidebar.tsx

STARTOFFILE: src\components\ui\skeleton.tsx
----------------------------------------
import { cn } from "@/lib/utils"

function Skeleton({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) {
  return (
    <div
      className={cn("animate-pulse rounded-md bg-muted", className)}
      {...props}
    />
  )
}

export { Skeleton }

----------------------------------------
ENDOFFILE: src\components\ui\skeleton.tsx

STARTOFFILE: src\components\ui\slider.tsx
----------------------------------------
import * as React from "react"
import * as SliderPrimitive from "@radix-ui/react-slider"

import { cn } from "@/lib/utils"

const Slider = React.forwardRef<
  React.ElementRef<typeof SliderPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>
>(({ className, ...props }, ref) => (
  <SliderPrimitive.Root
    ref={ref}
    className={cn(
      "relative flex w-full touch-none select-none items-center",
      className
    )}
    {...props}
  >
    <SliderPrimitive.Track className="relative h-2 w-full grow overflow-hidden rounded-full bg-secondary">
      <SliderPrimitive.Range className="absolute h-full bg-primary" />
    </SliderPrimitive.Track>
    <SliderPrimitive.Thumb className="block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50" />
  </SliderPrimitive.Root>
))
Slider.displayName = SliderPrimitive.Root.displayName

export { Slider }

----------------------------------------
ENDOFFILE: src\components\ui\slider.tsx

STARTOFFILE: src\components\ui\sonner.tsx
----------------------------------------
import { useTheme } from "next-themes"
import { Toaster as Sonner, toast } from "sonner"

type ToasterProps = React.ComponentProps<typeof Sonner>

const Toaster = ({ ...props }: ToasterProps) => {
  const { theme = "system" } = useTheme()

  return (
    <Sonner
      theme={theme as ToasterProps["theme"]}
      className="toaster group"
      toastOptions={{
        classNames: {
          toast:
            "group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",
          description: "group-[.toast]:text-muted-foreground",
          actionButton:
            "group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",
          cancelButton:
            "group-[.toast]:bg-muted group-[.toast]:text-muted-foreground",
        },
      }}
      {...props}
    />
  )
}

export { Toaster, toast }

----------------------------------------
ENDOFFILE: src\components\ui\sonner.tsx

STARTOFFILE: src\components\ui\switch.tsx
----------------------------------------
import * as React from "react"
import * as SwitchPrimitives from "@radix-ui/react-switch"

import { cn } from "@/lib/utils"

const Switch = React.forwardRef<
  React.ElementRef<typeof SwitchPrimitives.Root>,
  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>
>(({ className, ...props }, ref) => (
  <SwitchPrimitives.Root
    className={cn(
      "peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",
      className
    )}
    {...props}
    ref={ref}
  >
    <SwitchPrimitives.Thumb
      className={cn(
        "pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0"
      )}
    />
  </SwitchPrimitives.Root>
))
Switch.displayName = SwitchPrimitives.Root.displayName

export { Switch }

----------------------------------------
ENDOFFILE: src\components\ui\switch.tsx

STARTOFFILE: src\components\ui\table.tsx
----------------------------------------
import * as React from "react"

import { cn } from "@/lib/utils"

const Table = React.forwardRef<
  HTMLTableElement,
  React.HTMLAttributes<HTMLTableElement>
>(({ className, ...props }, ref) => (
  <div className="relative w-full overflow-auto">
    <table
      ref={ref}
      className={cn("w-full caption-bottom text-sm", className)}
      {...props}
    />
  </div>
))
Table.displayName = "Table"

const TableHeader = React.forwardRef<
  HTMLTableSectionElement,
  React.HTMLAttributes<HTMLTableSectionElement>
>(({ className, ...props }, ref) => (
  <thead ref={ref} className={cn("[&_tr]:border-b", className)} {...props} />
))
TableHeader.displayName = "TableHeader"

const TableBody = React.forwardRef<
  HTMLTableSectionElement,
  React.HTMLAttributes<HTMLTableSectionElement>
>(({ className, ...props }, ref) => (
  <tbody
    ref={ref}
    className={cn("[&_tr:last-child]:border-0", className)}
    {...props}
  />
))
TableBody.displayName = "TableBody"

const TableFooter = React.forwardRef<
  HTMLTableSectionElement,
  React.HTMLAttributes<HTMLTableSectionElement>
>(({ className, ...props }, ref) => (
  <tfoot
    ref={ref}
    className={cn(
      "border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",
      className
    )}
    {...props}
  />
))
TableFooter.displayName = "TableFooter"

const TableRow = React.forwardRef<
  HTMLTableRowElement,
  React.HTMLAttributes<HTMLTableRowElement>
>(({ className, ...props }, ref) => (
  <tr
    ref={ref}
    className={cn(
      "border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",
      className
    )}
    {...props}
  />
))
TableRow.displayName = "TableRow"

const TableHead = React.forwardRef<
  HTMLTableCellElement,
  React.ThHTMLAttributes<HTMLTableCellElement>
>(({ className, ...props }, ref) => (
  <th
    ref={ref}
    className={cn(
      "h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",
      className
    )}
    {...props}
  />
))
TableHead.displayName = "TableHead"

const TableCell = React.forwardRef<
  HTMLTableCellElement,
  React.TdHTMLAttributes<HTMLTableCellElement>
>(({ className, ...props }, ref) => (
  <td
    ref={ref}
    className={cn("p-4 align-middle [&:has([role=checkbox])]:pr-0", className)}
    {...props}
  />
))
TableCell.displayName = "TableCell"

const TableCaption = React.forwardRef<
  HTMLTableCaptionElement,
  React.HTMLAttributes<HTMLTableCaptionElement>
>(({ className, ...props }, ref) => (
  <caption
    ref={ref}
    className={cn("mt-4 text-sm text-muted-foreground", className)}
    {...props}
  />
))
TableCaption.displayName = "TableCaption"

export {
  Table,
  TableHeader,
  TableBody,
  TableFooter,
  TableHead,
  TableRow,
  TableCell,
  TableCaption,
}

----------------------------------------
ENDOFFILE: src\components\ui\table.tsx

STARTOFFILE: src\components\ui\tabs.tsx
----------------------------------------
import * as React from "react"
import * as TabsPrimitive from "@radix-ui/react-tabs"

import { cn } from "@/lib/utils"

const Tabs = TabsPrimitive.Root

const TabsList = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.List
    ref={ref}
    className={cn(
      "inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",
      className
    )}
    {...props}
  />
))
TabsList.displayName = TabsPrimitive.List.displayName

const TabsTrigger = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Trigger
    ref={ref}
    className={cn(
      "inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",
      className
    )}
    {...props}
  />
))
TabsTrigger.displayName = TabsPrimitive.Trigger.displayName

const TabsContent = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Content
    ref={ref}
    className={cn(
      "mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",
      className
    )}
    {...props}
  />
))
TabsContent.displayName = TabsPrimitive.Content.displayName

export { Tabs, TabsList, TabsTrigger, TabsContent }

----------------------------------------
ENDOFFILE: src\components\ui\tabs.tsx

STARTOFFILE: src\components\ui\textarea.tsx
----------------------------------------
import * as React from "react"

import { cn } from "@/lib/utils"

export interface TextareaProps
  extends React.TextareaHTMLAttributes<HTMLTextAreaElement> {}

const Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(
  ({ className, ...props }, ref) => {
    return (
      <textarea
        className={cn(
          "flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",
          className
        )}
        ref={ref}
        {...props}
      />
    )
  }
)
Textarea.displayName = "Textarea"

export { Textarea }

----------------------------------------
ENDOFFILE: src\components\ui\textarea.tsx

STARTOFFILE: src\components\ui\toast.tsx
----------------------------------------
import * as React from "react";
import * as ToastPrimitives from "@radix-ui/react-toast";
import { cva, type VariantProps } from "class-variance-authority";
import { X } from "@/lib/icons";

import { cn } from "@/lib/utils";

const ToastProvider = ToastPrimitives.Provider;

const ToastViewport = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Viewport>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Viewport
    ref={ref}
    className={cn(
      "fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",
      className
    )}
    {...props}
  />
));
ToastViewport.displayName = ToastPrimitives.Viewport.displayName;

const toastVariants = cva(
  "group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",
  {
    variants: {
      variant: {
        default: "border bg-background text-foreground",
        destructive: "destructive group border-destructive bg-destructive text-destructive-foreground",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
);

const Toast = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Root>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> & VariantProps<typeof toastVariants>
>(({ className, variant, ...props }, ref) => {
  return <ToastPrimitives.Root ref={ref} className={cn(toastVariants({ variant }), className)} {...props} />;
});
Toast.displayName = ToastPrimitives.Root.displayName;

const ToastAction = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Action>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Action
    ref={ref}
    className={cn(
      "inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",
      className
    )}
    {...props}
  />
));
ToastAction.displayName = ToastPrimitives.Action.displayName;

const ToastClose = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Close>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Close
    ref={ref}
    className={cn(
      "absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",
      className
    )}
    toast-close=""
    {...props}
  >
    <X className="h-4 w-4" />
  </ToastPrimitives.Close>
));
ToastClose.displayName = ToastPrimitives.Close.displayName;

const ToastTitle = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Title>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>
>(({ className, ...props }, ref) => <ToastPrimitives.Title ref={ref} className={cn("text-sm font-semibold", className)} {...props} />);
ToastTitle.displayName = ToastPrimitives.Title.displayName;

const ToastDescription = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Description>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>
>(({ className, ...props }, ref) => <ToastPrimitives.Description ref={ref} className={cn("text-sm opacity-90", className)} {...props} />);
ToastDescription.displayName = ToastPrimitives.Description.displayName;

type ToastProps = React.ComponentPropsWithoutRef<typeof Toast>;

type ToastActionElement = React.ReactElement<typeof ToastAction>;

export {
  type ToastProps,
  type ToastActionElement,
  ToastProvider,
  ToastViewport,
  Toast,
  ToastTitle,
  ToastDescription,
  ToastClose,
  ToastAction,
};

----------------------------------------
ENDOFFILE: src\components\ui\toast.tsx

STARTOFFILE: src\components\ui\toaster.tsx
----------------------------------------
import { useToast } from "@/hooks/use-toast"
import {
  Toast,
  ToastClose,
  ToastDescription,
  ToastProvider,
  ToastTitle,
  ToastViewport,
} from "@/components/ui/toast"

export function Toaster() {
  const { toasts } = useToast()

  return (
    <ToastProvider>
      {toasts.map(function ({ id, title, description, action, ...props }) {
        return (
          <Toast key={id} {...props}>
            <div className="grid gap-1">
              {title && <ToastTitle>{title}</ToastTitle>}
              {description && (
                <ToastDescription>{description}</ToastDescription>
              )}
            </div>
            {action}
            <ToastClose />
          </Toast>
        )
      })}
      <ToastViewport />
    </ToastProvider>
  )
}

----------------------------------------
ENDOFFILE: src\components\ui\toaster.tsx

STARTOFFILE: src\components\ui\toggle-group.tsx
----------------------------------------
import * as React from "react"
import * as ToggleGroupPrimitive from "@radix-ui/react-toggle-group"
import { type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"
import { toggleVariants } from "@/components/ui/toggle"

const ToggleGroupContext = React.createContext<
  VariantProps<typeof toggleVariants>
>({
  size: "default",
  variant: "default",
})

const ToggleGroup = React.forwardRef<
  React.ElementRef<typeof ToggleGroupPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &
    VariantProps<typeof toggleVariants>
>(({ className, variant, size, children, ...props }, ref) => (
  <ToggleGroupPrimitive.Root
    ref={ref}
    className={cn("flex items-center justify-center gap-1", className)}
    {...props}
  >
    <ToggleGroupContext.Provider value={{ variant, size }}>
      {children}
    </ToggleGroupContext.Provider>
  </ToggleGroupPrimitive.Root>
))

ToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName

const ToggleGroupItem = React.forwardRef<
  React.ElementRef<typeof ToggleGroupPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &
    VariantProps<typeof toggleVariants>
>(({ className, children, variant, size, ...props }, ref) => {
  const context = React.useContext(ToggleGroupContext)

  return (
    <ToggleGroupPrimitive.Item
      ref={ref}
      className={cn(
        toggleVariants({
          variant: context.variant || variant,
          size: context.size || size,
        }),
        className
      )}
      {...props}
    >
      {children}
    </ToggleGroupPrimitive.Item>
  )
})

ToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName

export { ToggleGroup, ToggleGroupItem }

----------------------------------------
ENDOFFILE: src\components\ui\toggle-group.tsx

STARTOFFILE: src\components\ui\toggle.tsx
----------------------------------------
import * as React from "react"
import * as TogglePrimitive from "@radix-ui/react-toggle"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const toggleVariants = cva(
  "inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground",
  {
    variants: {
      variant: {
        default: "bg-transparent",
        outline:
          "border border-input bg-transparent hover:bg-accent hover:text-accent-foreground",
      },
      size: {
        default: "h-10 px-3",
        sm: "h-9 px-2.5",
        lg: "h-11 px-5",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

const Toggle = React.forwardRef<
  React.ElementRef<typeof TogglePrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &
    VariantProps<typeof toggleVariants>
>(({ className, variant, size, ...props }, ref) => (
  <TogglePrimitive.Root
    ref={ref}
    className={cn(toggleVariants({ variant, size, className }))}
    {...props}
  />
))

Toggle.displayName = TogglePrimitive.Root.displayName

export { Toggle, toggleVariants }

----------------------------------------
ENDOFFILE: src\components\ui\toggle.tsx

STARTOFFILE: src\components\ui\tooltip.tsx
----------------------------------------
import * as React from "react"
import * as TooltipPrimitive from "@radix-ui/react-tooltip"

import { cn } from "@/lib/utils"

const TooltipProvider = TooltipPrimitive.Provider

const Tooltip = TooltipPrimitive.Root

const TooltipTrigger = TooltipPrimitive.Trigger

const TooltipContent = React.forwardRef<
  React.ElementRef<typeof TooltipPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>
>(({ className, sideOffset = 4, ...props }, ref) => (
  <TooltipPrimitive.Content
    ref={ref}
    sideOffset={sideOffset}
    className={cn(
      "z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className
    )}
    {...props}
  />
))
TooltipContent.displayName = TooltipPrimitive.Content.displayName

export { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }

----------------------------------------
ENDOFFILE: src\components\ui\tooltip.tsx

STARTOFFILE: src\components\ui\use-toast.ts
----------------------------------------
import { useToast, toast } from "@/hooks/use-toast";

export { useToast, toast };

----------------------------------------
ENDOFFILE: src\components\ui\use-toast.ts

STARTOFFILE: src\components\VirtualizedTransactionsList.tsx
----------------------------------------
import { useMemo } from "react";
import { FixedSizeList as List } from "react-window";

import { Badge } from "@/components/ui/badge";
import { Button } from "@/components/ui/button";
import { ArrowUpCircle, ArrowDownCircle, Calendar, Trash2 } from "@/lib/icons";
import { cn } from "@/lib/utils";

import type { Transaction } from "./transactions/types";

interface VirtualizedTransactionsListProps {
  transactions: Transaction[];
  onDelete: (id: string) => void;
  height?: number;
  itemHeight?: number;
}

export const VirtualizedTransactionsList = ({
  transactions,
  onDelete,
  height = 600,
  itemHeight = 80,
}: VirtualizedTransactionsListProps) => {
  const sortedTransactions = useMemo(
    () => [...transactions].sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime()),
    [transactions]
  );

  const Row = ({ index, style }: { index: number; style: React.CSSProperties }) => {
    const transaction = sortedTransactions[index];

    return (
      <div style={style} className="px-4">
        <div className="flex items-center justify-between py-4 border-b">
          <div className="flex items-center gap-3 flex-1">
            <div className={cn("p-2 rounded-full", transaction.type === "income" ? "bg-success/10" : "bg-destructive/10")}>
              {transaction.type === "income" ? (
                <ArrowUpCircle className="h-4 w-4 text-success" />
              ) : (
                <ArrowDownCircle className="h-4 w-4 text-destructive" />
              )}
            </div>

            <div className="flex-1 min-w-0">
              <p className="font-medium truncate">{transaction.description}</p>
              <div className="flex items-center gap-2 mt-1">
                <Badge variant="secondary" className="text-xs">
                  {transaction.category}
                </Badge>
                <span className="text-xs text-muted-foreground flex items-center gap-1">
                  <Calendar className="h-3 w-3" />
                  {new Date(transaction.date).toLocaleDateString("pt-BR")}
                </span>
                {transaction.group_id && (
                  <Badge variant="outline" className="text-xs">
                    Grupo
                  </Badge>
                )}
              </div>
            </div>
          </div>

          <div className="flex items-center gap-3">
            <p
              className={cn("font-semibold text-lg whitespace-nowrap", transaction.type === "income" ? "text-success" : "text-destructive")}
            >
              {transaction.type === "income" ? "+" : "-"}
              {Math.abs(transaction.amount).toLocaleString("pt-BR", {
                style: "currency",
                currency: "BRL",
              })}
            </p>

            <Button
              variant="ghost"
              size="icon"
              onClick={() => onDelete(transaction.id)}
              className="text-destructive hover:text-destructive hover:bg-destructive/10"
            >
              <Trash2 className="h-4 w-4" />
            </Button>
          </div>
        </div>
      </div>
    );
  };

  if (sortedTransactions.length === 0) {
    return (
      <div className="text-center py-12 text-muted-foreground">
        <p>Nenhuma transaÃ§Ã£o encontrada</p>
      </div>
    );
  }

  return (
    <List height={height} itemCount={sortedTransactions.length} itemSize={itemHeight} width="100%" className="scrollbar-thin">
      {Row}
    </List>
  );
};

----------------------------------------
ENDOFFILE: src\components\VirtualizedTransactionsList.tsx

STARTOFFILE: src\constants\investment-types.ts
----------------------------------------
export const INVESTMENT_TYPES = [
  "AÃ§Ãµes",
  "FIIs",
  "Renda Fixa",
  "Tesouro Direto",
  "CDB",
  "LCI/LCA",
  "Criptomoedas",
  "Fundos",
  "PrevidÃªncia",
  "Outro",
] as const;

export type InvestmentType = (typeof INVESTMENT_TYPES)[number];

----------------------------------------
ENDOFFILE: src\constants\investment-types.ts

STARTOFFILE: src\contexts\AuthContext.tsx
----------------------------------------
import { createContext, useContext, useState, useEffect, ReactNode } from "react";
import { User, Session } from "@supabase/supabase-js";

import { supabase } from "@/integrations/supabase/client";
import { useToast } from "@/hooks/use-toast";

interface AuthContextType {
  user: User | null;
  session: Session | null;
  loading: boolean;
  signUp: (email: string, password: string, fullName?: string) => Promise<{ error: any }>;
  signIn: (email: string, password: string) => Promise<{ error: any }>;
  signOut: () => Promise<void>;
  resetPassword: (email: string) => Promise<{ error: any }>;
  updatePassword: (password: string) => Promise<{ error: any }>;
  // Atualizado para aceitar avatar_url
  updateProfile: (data: {
    full_name?: string;
    age?: number | null;
    gender?: string;
    avatar_url?: string | null;
  }) => Promise<{ error: any }>;
}

const AuthContext = createContext<AuthContextType | undefined>(undefined);

export const useAuth = () => {
  const context = useContext(AuthContext);
  if (context === undefined) {
    throw new Error("useAuth must be used within an AuthProvider");
  }
  return context;
};

interface AuthProviderProps {
  children: ReactNode;
}

export const AuthProvider = ({ children }: AuthProviderProps) => {
  const [user, setUser] = useState<User | null>(null);
  const [session, setSession] = useState<Session | null>(null);
  const [loading, setLoading] = useState(true);
  const { toast } = useToast();

  useEffect(() => {
    const {
      data: { subscription },
    } = supabase.auth.onAuthStateChange((event, session) => {
      setSession(session);
      setUser(session?.user ?? null);
      setLoading(false);

      if (event === "USER_UPDATED") {
        toast({
          title: "Perfil atualizado!",
          description: "Suas informaÃ§Ãµes foram atualizadas.",
        });
      }

      if (event === "PASSWORD_RECOVERY") {
        toast({
          title: "RecuperaÃ§Ã£o de senha",
          description: "VocÃª entrou em modo de recuperaÃ§Ã£o. VÃ¡ em 'Meu Perfil' para definir uma nova senha.",
        });
      }
    });

    supabase.auth.getSession().then(({ data: { session } }) => {
      setSession(session);
      setUser(session?.user ?? null);
      setLoading(false);
    });

    return () => subscription.unsubscribe();
  }, [toast]);

  const signUp = async (email: string, password: string, fullName?: string) => {
    try {
      const redirectUrl = `${window.location.origin}/auth`;

      const { data, error } = await supabase.auth.signUp({
        email,
        password,
        options: {
          emailRedirectTo: redirectUrl,
          data: {
            full_name: fullName,
          },
        },
      });

      if (error) {
        toast({
          title: "Erro no cadastro",
          description: error.message,
          variant: "destructive",
        });
        return { error };
      }

      if (data?.user?.identities?.length === 0) {
        toast({
          title: "Email jÃ¡ cadastrado",
          description: "Este email jÃ¡ possui uma conta. FaÃ§a login ou recupere sua senha.",
          variant: "destructive",
        });
        return { error: { message: "Email jÃ¡ cadastrado" } };
      }

      toast({
        title: "Cadastro realizado!",
        description: "Se o envio de email estiver ativo, verifique sua caixa de entrada para confirmar.",
      });

      return { error: null };
    } catch (error) {
      toast({
        title: "Erro no cadastro",
        description: "Ocorreu um erro ao processar seu cadastro. Tente novamente.",
        variant: "destructive",
      });
      return { error };
    }
  };

  const signIn = async (email: string, password: string) => {
    try {
      const { data, error } = await supabase.auth.signInWithPassword({
        email,
        password,
      });

      if (error) {
        if (error.message.includes("Email not confirmed")) {
          toast({
            title: "Email nÃ£o confirmado",
            description: "Por favor, confirme seu email antes de fazer login. Verifique sua caixa de entrada.",
            variant: "destructive",
          });
        } else if (error.message.includes("Invalid login credentials")) {
          toast({
            title: "Credenciais invÃ¡lidas",
            description: "Email ou senha incorretos. Tente novamente.",
            variant: "destructive",
          });
        } else {
          toast({
            title: "Erro no login",
            description: error.message,
            variant: "destructive",
          });
        }
        return { error };
      }

      toast({
        title: "Login realizado!",
        description: "Bem-vindo ao sistema.",
      });

      return { error: null };
    } catch (error) {
      toast({
        title: "Erro no login",
        description: "Ocorreu um erro ao fazer login. Tente novamente.",
        variant: "destructive",
      });
      return { error };
    }
  };

  const signOut = async () => {
    try {
      await supabase.auth.signOut();
      setUser(null);
      setSession(null);
      toast({
        title: "Logout realizado",
        description: "AtÃ© logo!",
      });
    } catch (error) {
      toast({
        title: "Erro no logout",
        description: "Ocorreu um erro ao fazer logout.",
        variant: "destructive",
      });
    }
  };

  const resetPassword = async (email: string) => {
    try {
      const redirectTo = `${window.location.origin}/profile`;
      const { error } = await supabase.auth.resetPasswordForEmail(email, {
        redirectTo,
      });

      if (error) throw error;

      toast({
        title: "Email enviado",
        description: "Verifique seu email para o link de recuperaÃ§Ã£o de senha.",
      });
      return { error: null };
    } catch (error: any) {
      toast({
        title: "Erro ao recuperar",
        description: error.message || "NÃ£o foi possÃ­vel enviar o email.",
        variant: "destructive",
      });
      return { error };
    }
  };

  const updatePassword = async (password: string) => {
    try {
      const { error } = await supabase.auth.updateUser({ password });
      if (error) throw error;

      toast({
        title: "Sucesso",
        description: "Sua senha foi alterada com sucesso.",
      });
      return { error: null };
    } catch (error: any) {
      toast({
        title: "Erro",
        description: error.message,
        variant: "destructive",
      });
      return { error };
    }
  };

  // FunÃ§Ã£o corrigida para usar UPSERT e garantir que o perfil seja salvo
  const updateProfile = async (data: { full_name?: string; age?: number | null; gender?: string; avatar_url?: string | null }) => {
    if (!user) return { error: "UsuÃ¡rio nÃ£o logado" };

    try {
      const updates = {
        user_id: user.id,
        ...data,
        updated_at: new Date().toISOString(),
      };

      // Upsert: Cria se nÃ£o existir, Atualiza se existir
      // A opÃ§Ã£o { onConflict: 'user_id' } instrui o Supabase a usar o campo user_id para resolver conflitos
      const { error } = await supabase.from("profiles").upsert(updates, { onConflict: "user_id" });

      if (error) throw error;

      toast({ title: "Perfil salvo", description: "Seus dados foram atualizados." });

      return { error: null };
    } catch (error: any) {
      console.error(error);
      toast({
        title: "Erro ao atualizar",
        description: "NÃ£o foi possÃ­vel salvar os dados.",
        variant: "destructive",
      });
      return { error };
    }
  };

  const value = {
    user,
    session,
    loading,
    signUp,
    signIn,
    signOut,
    resetPassword,
    updatePassword,
    updateProfile,
  };

  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;
};

----------------------------------------
ENDOFFILE: src\contexts\AuthContext.tsx

STARTOFFILE: src\hooks\use-mobile.tsx
----------------------------------------
import * as React from "react"

const MOBILE_BREAKPOINT = 768

export function useIsMobile() {
  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)

  React.useEffect(() => {
    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)
    const onChange = () => {
      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)
    }
    mql.addEventListener("change", onChange)
    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)
    return () => mql.removeEventListener("change", onChange)
  }, [])

  return !!isMobile
}

----------------------------------------
ENDOFFILE: src\hooks\use-mobile.tsx

STARTOFFILE: src\hooks\use-toast.ts
----------------------------------------
import * as React from "react"

import type {
  ToastActionElement,
  ToastProps,
} from "@/components/ui/toast"

const TOAST_LIMIT = 1
const TOAST_REMOVE_DELAY = 1000000

type ToasterToast = ToastProps & {
  id: string
  title?: React.ReactNode
  description?: React.ReactNode
  action?: ToastActionElement
}

const actionTypes = {
  ADD_TOAST: "ADD_TOAST",
  UPDATE_TOAST: "UPDATE_TOAST",
  DISMISS_TOAST: "DISMISS_TOAST",
  REMOVE_TOAST: "REMOVE_TOAST",
} as const

let count = 0

function genId() {
  count = (count + 1) % Number.MAX_SAFE_INTEGER
  return count.toString()
}

type ActionType = typeof actionTypes

type Action =
  | {
      type: ActionType["ADD_TOAST"]
      toast: ToasterToast
    }
  | {
      type: ActionType["UPDATE_TOAST"]
      toast: Partial<ToasterToast>
    }
  | {
      type: ActionType["DISMISS_TOAST"]
      toastId?: ToasterToast["id"]
    }
  | {
      type: ActionType["REMOVE_TOAST"]
      toastId?: ToasterToast["id"]
    }

interface State {
  toasts: ToasterToast[]
}

const toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()

const addToRemoveQueue = (toastId: string) => {
  if (toastTimeouts.has(toastId)) {
    return
  }

  const timeout = setTimeout(() => {
    toastTimeouts.delete(toastId)
    dispatch({
      type: "REMOVE_TOAST",
      toastId: toastId,
    })
  }, TOAST_REMOVE_DELAY)

  toastTimeouts.set(toastId, timeout)
}

export const reducer = (state: State, action: Action): State => {
  switch (action.type) {
    case "ADD_TOAST":
      return {
        ...state,
        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),
      }

    case "UPDATE_TOAST":
      return {
        ...state,
        toasts: state.toasts.map((t) =>
          t.id === action.toast.id ? { ...t, ...action.toast } : t
        ),
      }

    case "DISMISS_TOAST": {
      const { toastId } = action

      // ! Side effects ! - This could be extracted into a dismissToast() action,
      // but I'll keep it here for simplicity
      if (toastId) {
        addToRemoveQueue(toastId)
      } else {
        state.toasts.forEach((toast) => {
          addToRemoveQueue(toast.id)
        })
      }

      return {
        ...state,
        toasts: state.toasts.map((t) =>
          t.id === toastId || toastId === undefined
            ? {
                ...t,
                open: false,
              }
            : t
        ),
      }
    }
    case "REMOVE_TOAST":
      if (action.toastId === undefined) {
        return {
          ...state,
          toasts: [],
        }
      }
      return {
        ...state,
        toasts: state.toasts.filter((t) => t.id !== action.toastId),
      }
  }
}

const listeners: Array<(state: State) => void> = []

let memoryState: State = { toasts: [] }

function dispatch(action: Action) {
  memoryState = reducer(memoryState, action)
  listeners.forEach((listener) => {
    listener(memoryState)
  })
}

type Toast = Omit<ToasterToast, "id">

function toast({ ...props }: Toast) {
  const id = genId()

  const update = (props: ToasterToast) =>
    dispatch({
      type: "UPDATE_TOAST",
      toast: { ...props, id },
    })
  const dismiss = () => dispatch({ type: "DISMISS_TOAST", toastId: id })

  dispatch({
    type: "ADD_TOAST",
    toast: {
      ...props,
      id,
      open: true,
      onOpenChange: (open) => {
        if (!open) dismiss()
      },
    },
  })

  return {
    id: id,
    dismiss,
    update,
  }
}

function useToast() {
  const [state, setState] = React.useState<State>(memoryState)

  React.useEffect(() => {
    listeners.push(setState)
    return () => {
      const index = listeners.indexOf(setState)
      if (index > -1) {
        listeners.splice(index, 1)
      }
    }
  }, [state])

  return {
    ...state,
    toast,
    dismiss: (toastId?: string) => dispatch({ type: "DISMISS_TOAST", toastId }),
  }
}

export { useToast, toast }

----------------------------------------
ENDOFFILE: src\hooks\use-toast.ts

STARTOFFILE: src\hooks\usePWA.ts
----------------------------------------
import { useEffect, useState } from "react";
import { useRegisterSW } from "virtual:pwa-register/react";

import type { RegisterSWOptions } from "virtual:pwa-register/react";

export const usePWA = () => {
  const [needRefresh, setNeedRefresh] = useState(false);
  const [offlineReady, setOfflineReady] = useState(false);
  const [registration, setRegistration] = useState<ServiceWorkerRegistration | undefined>();

  const {
    offlineReady: pwaOfflineReady,
    needRefresh: pwaNeedRefresh,
    updateServiceWorker,
  } = useRegisterSW({
    onRegistered(r) {
      setRegistration(r);
      console.log("SW Registered:", r);
    },
    onRegisterError(error) {
      console.error("SW registration error", error);
    },
  } as RegisterSWOptions);

  useEffect(() => {
    setOfflineReady(pwaOfflineReady);
  }, [pwaOfflineReady]);

  useEffect(() => {
    setNeedRefresh(pwaNeedRefresh);
  }, [pwaNeedRefresh]);

  const close = () => {
    setOfflineReady(false);
    setNeedRefresh(false);
  };

  const updateApp = () => {
    updateServiceWorker(true);
  };

  return {
    needRefresh,
    offlineReady,
    registration,
    updateApp,
    close,
  };
};

----------------------------------------
ENDOFFILE: src\hooks\usePWA.ts

STARTOFFILE: src\hooks\useReminders.ts
----------------------------------------
import { useState, useEffect, useCallback } from "react";
import { useAuth } from "@/contexts/AuthContext";
import { useToast } from "@/hooks/use-toast";

import { reminderService } from "@/utils/services/reminderService";
import { pushNotificationService } from "@/utils/services/pushNotificationService";

import type { Reminder, ReminderFormData } from "@/utils/types/reminder";

export const useReminders = () => {
  const { user } = useAuth();
  const { toast } = useToast();
  const [reminders, setReminders] = useState<Reminder[]>([]);
  const [loading, setLoading] = useState(true);
  const [isSubscribed, setIsSubscribed] = useState(false);
  const [notificationPermission, setNotificationPermission] = useState<NotificationPermission>("default");

  const loadReminders = useCallback(async () => {
    if (!user) return;

    try {
      setLoading(true);
      const data = await reminderService.getUserReminders(user.id);
      setReminders(data);
    } catch (error) {
      console.error("Erro ao carregar lembretes:", error);
      toast({
        title: "Erro",
        description: "NÃ£o foi possÃ­vel carregar os lembretes",
        variant: "destructive",
      });
    } finally {
      setLoading(false);
    }
  }, [user, toast]);

  const checkNotificationStatus = useCallback(async () => {
    const permission = await pushNotificationService.getPermissionState();
    setNotificationPermission(permission);

    const subscribed = await pushNotificationService.isSubscribed();
    setIsSubscribed(subscribed);
  }, []);

  useEffect(() => {
    loadReminders();
    checkNotificationStatus();
  }, [loadReminders, checkNotificationStatus]);

  // REMOVA ESTE 'useEffect' COMPLETAMENTE.
  // A verificaÃ§Ã£o nÃ£o serÃ¡ mais feita pelo cliente.
  /*
  useEffect(() => {
    if (!user) return;

    const interval = setInterval(async () => {
      await reminderService.checkPendingReminders(user.id);
    }, 15000); 

    return () => clearInterval(interval);
  }, [user]);
  */

  const createReminder = async (data: ReminderFormData, transactionId?: string) => {
    if (!user) {
      toast({
        title: "Erro",
        description: "UsuÃ¡rio nÃ£o autenticado",
        variant: "destructive",
      });
      return;
    }

    try {
      await reminderService.createReminder(user.id, data, transactionId);
      await loadReminders();
      toast({
        title: "Sucesso",
        description: "Lembrete criado com sucesso",
      });
    } catch (error) {
      console.error("Erro ao criar lembrete:", error);
      toast({
        title: "Erro",
        description: "NÃ£o foi possÃ­vel criar o lembrete",
        variant: "destructive",
      });
      throw error;
    }
  };

  const updateReminder = async (id: string, data: Partial<ReminderFormData>) => {
    try {
      await reminderService.updateReminder(id, data);
      await loadReminders();

      toast({
        title: "Sucesso",
        description: "Lembrete atualizado com sucesso",
      });
    } catch (error) {
      console.error("Erro ao atualizar lembrete:", error);
      toast({
        title: "Erro",
        description: "NÃ£o foi possÃ­vel atualizar o lembrete",
        variant: "destructive",
      });
      throw error;
    }
  };

  const deleteReminder = async (id: string) => {
    try {
      await reminderService.deleteReminder(id);
      await loadReminders();

      toast({
        title: "Sucesso",
        description: "Lembrete removido com sucesso",
      });
    } catch (error) {
      console.error("Erro ao remover lembrete:", error);
      toast({
        title: "Erro",
        description: "NÃ£o foi possÃ­vel remover o lembrete",
        variant: "destructive",
      });
      throw error;
    }
  };

  const completeReminder = async (id: string) => {
    try {
      await reminderService.markAsCompleted(id);
      await loadReminders();

      toast({
        title: "Sucesso",
        description: "Lembrete marcado como concluÃ­do",
      });
    } catch (error) {
      console.error("Erro ao completar lembrete:", error);
      toast({
        title: "Erro",
        description: "NÃ£o foi possÃ­vel marcar o lembrete como concluÃ­do",
        variant: "destructive",
      });
      throw error;
    }
  };

  const enableNotifications = async () => {
    if (!user) return;
    try {
      await pushNotificationService.initialize();
      await pushNotificationService.subscribe(user.id);

      setIsSubscribed(true);
      setNotificationPermission("granted");
      toast({
        title: "Sucesso",
        description: "NotificaÃ§Ãµes ativadas com sucesso",
      });
    } catch (error) {
      console.error("Erro ao ativar notificaÃ§Ãµes:", error);
      toast({
        title: "Erro",
        description: "NÃ£o foi possÃ­vel ativar as notificaÃ§Ãµes",
        variant: "destructive",
      });
    }
  };

  const disableNotifications = async () => {
    if (!user) return;
    try {
      await pushNotificationService.unsubscribe(user.id);

      setIsSubscribed(false);
      toast({
        title: "Sucesso",
        description: "NotificaÃ§Ãµes desativadas com sucesso",
      });
    } catch (error) {
      console.error("Erro ao desativar notificaÃ§Ãµes:", error);
      toast({
        title: "Erro",
        description: "NÃ£o foi possÃ­vel desativar as notificaÃ§Ãµes",
        variant: "destructive",
      });
    }
  };

  return {
    reminders,
    loading,
    isSubscribed,
    notificationPermission,
    createReminder,
    updateReminder,
    deleteReminder,
    completeReminder,
    enableNotifications,
    disableNotifications,
    refreshReminders: loadReminders,
  };
};

----------------------------------------
ENDOFFILE: src\hooks\useReminders.ts

STARTOFFILE: src\hooks\useSanitizedForm.ts
----------------------------------------
import { useState, useCallback } from 'react';

import { useToast } from '@/hooks/use-toast';

import { sanitizeObject } from '@/utils/security/sanitize';

import type { SanitizerFunction, ValidatorFunction, ValidationResult } from '@/utils/security/types';

interface UseSanitizedFormOptions<T> {
  initialValues: T;
  sanitizers?: Partial<Record<keyof T, SanitizerFunction>>;
  validators?: Partial<Record<keyof T, ValidatorFunction>>;
  onSubmit: (values: T) => Promise<void> | void;
  validateOnChange?: boolean;
}

interface UseSanitizedFormReturn<T> {
  values: T;
  errors: Partial<Record<keyof T, string>>;
  isSubmitting: boolean;
  handleChange: (field: keyof T, value: any) => void;
  handleSubmit: (e?: React.FormEvent) => Promise<void>;
  setValues: (values: Partial<T>) => void;
  resetForm: () => void;
  validateField: (field: keyof T) => boolean;
  validateAll: () => boolean;
}

export const useSanitizedForm = <T extends Record<string, any>>({
  initialValues,
  sanitizers = {},
  validators = {},
  onSubmit,
  validateOnChange = true,
}: UseSanitizedFormOptions<T>): UseSanitizedFormReturn<T> => {
  const [values, setFormValues] = useState<T>(initialValues);
  const [errors, setErrors] = useState<Partial<Record<keyof T, string>>>({});
  const [isSubmitting, setIsSubmitting] = useState(false);
  const { toast } = useToast();

  const sanitizeValue = useCallback(
    (field: keyof T, value: any): any => {
      const sanitizer = sanitizers[field];
      return sanitizer ? sanitizer(value) : value;
    },
    [sanitizers]
  );

  const validateField = useCallback(
    (field: keyof T): boolean => {
      const validator = validators[field];
      
      if (!validator) {
        setErrors(prev => {
          const next = { ...prev };
          delete next[field];
          return next;
        });
        return true;
      }

      const result: ValidationResult = validator(values[field]);

      if (!result.isValid) {
        setErrors(prev => ({
          ...prev,
          [field]: result.error || 'Erro de validaÃ§Ã£o',
        }));
        return false;
      }

      setErrors(prev => {
        const next = { ...prev };
        delete next[field];
        return next;
      });
      return true;
    },
    [validators, values]
  );

  const validateAll = useCallback((): boolean => {
    const fields = Object.keys(validators) as (keyof T)[];
    const results = fields.map(field => validateField(field));
    return results.every(result => result);
  }, [validators, validateField]);

  const handleChange = useCallback(
    (field: keyof T, value: any): void => {
      const sanitizedValue = sanitizeValue(field, value);

      setFormValues(prev => ({
        ...prev,
        [field]: sanitizedValue,
      }));

      if (validateOnChange && validators[field]) {
        setTimeout(() => validateField(field), 0);
      }
    },
    [sanitizeValue, validateOnChange, validators, validateField]
  );

  const setValues = useCallback(
    (newValues: Partial<T>): void => {
      const sanitizedValues = sanitizeObject(newValues, sanitizers);
      
      setFormValues(prev => ({
        ...prev,
        ...sanitizedValues,
      }));
    },
    [sanitizers]
  );

  const resetForm = useCallback((): void => {
    setFormValues(initialValues);
    setErrors({});
    setIsSubmitting(false);
  }, [initialValues]);

  const handleSubmit = useCallback(
    async (e?: React.FormEvent): Promise<void> => {
      if (e) {
        e.preventDefault();
      }

      const isValid = validateAll();

      if (!isValid) {
        toast({
          title: 'Erro de validaÃ§Ã£o',
          description: 'Corrija os erros antes de continuar',
          variant: 'destructive',
        });
        return;
      }

      setIsSubmitting(true);

      try {
        await onSubmit(values);
      } catch (error) {
        console.error('Erro ao submeter formulÃ¡rio:', error);
        toast({
          title: 'Erro',
          description: error instanceof Error ? error.message : 'Erro ao processar formulÃ¡rio',
          variant: 'destructive',
        });
      } finally {
        setIsSubmitting(false);
      }
    },
    [validateAll, onSubmit, values, toast]
  );

  return {
    values,
    errors,
    isSubmitting,
    handleChange,
    handleSubmit,
    setValues,
    resetForm,
    validateField,
    validateAll,
  };
};

----------------------------------------
ENDOFFILE: src\hooks\useSanitizedForm.ts

STARTOFFILE: src\integrations\supabase\client.ts
----------------------------------------
import { createClient } from "@supabase/supabase-js";
import type { Database } from "./types";

const SUPABASE_URL = import.meta.env.VITE_SUPABASE_URL;
const SUPABASE_PUBLISHABLE_KEY = import.meta.env.VITE_SUPABASE_PUBLISHABLE_KEY;

export const supabase = createClient<Database>(SUPABASE_URL, SUPABASE_PUBLISHABLE_KEY, {
  auth: {
    storage: localStorage,
    persistSession: true,
    autoRefreshToken: true,
  },
});

----------------------------------------
ENDOFFILE: src\integrations\supabase\client.ts

STARTOFFILE: src\integrations\supabase\types.ts
----------------------------------------
export type Json = string | number | boolean | null | { [key: string]: Json | undefined } | Json[];

export type Database = {
  public: {
    Tables: {
      group_members: {
        Row: {
          group_id: string;
          id: string;
          is_admin: boolean;
          joined_at: string;
          user_id: string;
        };
        Insert: {
          group_id: string;
          id?: string;
          is_admin?: boolean;
          joined_at?: string;
          user_id: string;
        };
        Update: {
          group_id?: string;
          id?: string;
          is_admin?: boolean;
          joined_at?: string;
          user_id?: string;
        };
        Relationships: [
          {
            foreignKeyName: "group_members_group_id_fkey";
            columns: ["group_id"];
            isOneToOne: false;
            referencedRelation: "groups";
            referencedColumns: ["id"];
          }
        ];
      };
      group_invites: {
  Row: {
    id: string;
    group_id: string;
    email: string;
    invited_by: string;
    status: "pending" | "accepted" | "rejected";
    created_at: string;
  };
  Insert: {
    group_id: string;
    email: string;
    invited_by?: string;
    status?: "pending" | "accepted" | "rejected";
  };
  Update: {
    status?: "pending" | "accepted" | "rejected";
  };
}
      groups: {
        Row: {
          color: string | null;
          created_at: string;
          created_by: string;
          description: string | null;
          id: string;
          name: string;
          updated_at: string;
        };
        Insert: {
          color?: string | null;
          created_at?: string;
          created_by: string;
          description?: string | null;
          id?: string;
          name: string;
          updated_at?: string;
        };
        Update: {
          color?: string | null;
          created_at?: string;
          created_by?: string;
          description?: string | null;
          id?: string;
          name?: string;
          updated_at?: string;
        };
        Relationships: [];
      };
      investment_goals: {
        Row: {
          color: string | null;
          created_at: string;
          current_amount: number;
          description: string | null;
          id: string;
          name: string;
          target_amount: number;
          target_date: string | null;
          updated_at: string;
          user_id: string;
        };
        Insert: {
          color?: string | null;
          created_at?: string;
          current_amount?: number;
          description?: string | null;
          id?: string;
          name: string;
          target_amount: number;
          target_date?: string | null;
          updated_at?: string;
          user_id: string;
        };
        Update: {
          color?: string | null;
          created_at?: string;
          current_amount?: number;
          description?: string | null;
          id?: string;
          name?: string;
          target_amount?: number;
          target_date?: string | null;
          updated_at?: string;
          user_id?: string;
        };
        Relationships: [];
      };
      investments: {
        Row: {
          amount: number;
          created_at: string;
          current_value: number;
          group_id: string | null;
          id: string;
          maturity_date: string | null;
          name: string;
          type: string;
          updated_at: string;
          user_id: string;
          quantity: number | null;
          unit_price: number | null;
        };
        Insert: {
          amount: number;
          created_at?: string;
          current_value: number;
          group_id?: string | null;
          id?: string;
          maturity_date?: string | null;
          name: string;
          type: string;
          updated_at?: string;
          user_id: string;
          quantity: number | null;
          unit_price: number | null;
        };
        Update: {
          amount?: number;
          created_at?: string;
          current_value?: number;
          group_id?: string | null;
          id?: string;
          maturity_date?: string | null;
          name?: string;
          type?: string;
          updated_at?: string;
          user_id?: string;
          quantity: number | null;
          unit_price: number | null;
        };
        Relationships: [
          {
            foreignKeyName: "investments_group_id_fkey";
            columns: ["group_id"];
            isOneToOne: false;
            referencedRelation: "groups";
            referencedColumns: ["id"];
          }
        ];
      };
      profiles: {
        Row: {
          avatar_url: string | null;
          created_at: string;
          full_name: string | null;
          id: string;
          updated_at: string;
          user_id: string;
          age: number | null;
          gender: string | null;
        };
        Insert: {
          avatar_url?: string | null;
          created_at?: string;
          full_name?: string | null;
          id?: string;
          updated_at?: string;
          user_id: string;
          age?: number | null;
          gender?: string | null;
        };
        Update: {
          avatar_url?: string | null;
          created_at?: string;
          full_name?: string | null;
          id?: string;
          updated_at?: string;
          user_id?: string;
          age?: number | null;
          gender?: string | null;
        };
        Relationships: [];
      };
      transactions: {
        Row: {
          amount: number;
          category: string;
          created_at: string;
          date: string;
          description: string;
          group_id: string | null;
          id: string;
          type: string;
          updated_at: string;
          user_id: string;
          event_id: string | null;
        };
        Insert: {
          amount: number;
          category: string;
          created_at?: string;
          date?: string;
          description: string;
          group_id?: string | null;
          id?: string;
          type: string;
          updated_at?: string;
          user_id: string;
          event_id?: string | null;
        };
        Update: {
          amount?: number;
          category?: string;
          created_at?: string;
          date?: string;
          description?: string;
          group_id?: string | null;
          id?: string;
          type?: string;
          updated_at?: string;
          user_id?: string;
          event_id?: string | null;
        };
        Relationships: [
          {
            foreignKeyName: "transactions_group_id_fkey";
            columns: ["group_id"];
            isOneToOne: false;
            referencedRelation: "groups";
            referencedColumns: ["id"];
          }
        ];
      };
      events: {
        Row: {
          id: string;
          user_id: string;
          name: string;
          description: string | null;
          date: string;
          created_at: string;
        };
        Insert: {
          id?: string;
          user_id: string;
          name: string;
          description?: string | null;
          date: string;
          created_at?: string;
        };
        Update: {
          id?: string;
          user_id?: string;
          name?: string;
          description?: string | null;
          date?: string;
          created_at?: string;
        };
        Relationships: [];
      };
    };
    Views: {
      [_ in never]: never;
    };
    Functions: {
      [_ in never]: never;
    };
    Enums: {
      [_ in never]: never;
    };
    CompositeTypes: {
      [_ in never]: never;
    };
  };
};

----------------------------------------
ENDOFFILE: src\integrations\supabase\types.ts

STARTOFFILE: src\lib\date.ts
----------------------------------------
export {
  format,
  startOfMonth,
  endOfMonth,
  startOfYear,
  endOfYear,
  subMonths,
  addMonths,
  isAfter,
  isBefore,
  parseISO,
  addDays,
  subDays,
} from 'date-fns';

export { ptBR } from 'date-fns/locale';

----------------------------------------
ENDOFFILE: src\lib\date.ts

STARTOFFILE: src\lib\icons.ts
----------------------------------------
export {
  ArrowUpCircle,
  ArrowDownCircle,
  ArrowRight,
  BarChart3,
  Shield,
  TrendingUp,
  TrendingDown,
  DollarSign,
  PiggyBank,
  Calendar,
  Search,
  Filter,
  ChevronUp,
  Plus,
  PlusCircle,
  MinusCircle,
  Trash2,
  Eye,
  Edit,
  X,
  Check,
  ChevronLeft,
  ChevronRight,
  Menu,
  LogOut,
  Users,
  Settings,
  Home,
  FileText,
  Target,
  Wallet,
  AlertCircle,
  Info,
  ChevronDown,
  MoreHorizontal,
  EyeOff,
  LayoutDashboard,
  ArrowUpDown,
  PieChart,
  UserPlus,
  UserMinus,
  Bell,
  Layers,
  User,
  Moon,
  Sun,
  Laptop,
  Lock,
  Mail,
  Camera,
  AlertTriangle,
  Loader2,
  Copy,
  Link,
  Scale,
} from "lucide-react";

----------------------------------------
ENDOFFILE: src\lib\icons.ts

STARTOFFILE: src\lib\utils.ts
----------------------------------------
import { clsx, type ClassValue } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}

----------------------------------------
ENDOFFILE: src\lib\utils.ts

STARTOFFILE: src\main.tsx
----------------------------------------
import { createRoot } from 'react-dom/client'
import App from './App.tsx'
import './index.css'
import { AuthProvider } from './contexts/AuthContext'
import { Toaster } from './components/ui/toaster'

createRoot(document.getElementById("root")!).render(
  <AuthProvider>
    <App />
    <Toaster />
  </AuthProvider>
);

----------------------------------------
ENDOFFILE: src\main.tsx

STARTOFFILE: src\pages\Auth.tsx
----------------------------------------
import { useState } from "react";
import { useAuth } from "@/contexts/AuthContext";
import { Navigate } from "react-router-dom";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import { Eye, EyeOff, TrendingUp, Shield, Users, BarChart3 } from "@/lib/icons";
import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogTrigger } from "@/components/ui/dialog";

export default function Auth() {
  const { user, signIn, signUp, resetPassword, loading } = useAuth();
  const [showPassword, setShowPassword] = useState(false);
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [forgotPasswordOpen, setForgotPasswordOpen] = useState(false);
  const [resetEmail, setResetEmail] = useState("");

  const [loginData, setLoginData] = useState({
    email: "",
    password: "",
  });

  const [registerData, setRegisterData] = useState({
    fullName: "",
    email: "",
    password: "",
    confirmPassword: "",
  });

  // Redirect if already authenticated
  if (user) {
    return <Navigate to="/" replace />;
  }

  if (loading) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-gradient-primary">
        <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
      </div>
    );
  }

  const handleLogin = async (e: React.FormEvent) => {
    e.preventDefault();
    setIsSubmitting(true);

    await signIn(loginData.email, loginData.password);
    setIsSubmitting(false);
  };

  const handleRegister = async (e: React.FormEvent) => {
    e.preventDefault();

    if (registerData.password !== registerData.confirmPassword) {
      return;
    }

    setIsSubmitting(true);
    const { error } = await signUp(registerData.email, registerData.password, registerData.fullName);
    if (!error) {
      // Clear form on successful registration
      setRegisterData({ fullName: "", email: "", password: "", confirmPassword: "" });
    }
    setIsSubmitting(false);
  };

  const handleResetPassword = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!resetEmail) return;
    setIsSubmitting(true);
    await resetPassword(resetEmail);
    setIsSubmitting(false);
    setForgotPasswordOpen(false);
  };

  return (
    <div className="min-h-screen bg-gradient-primary flex items-center justify-center p-4">
      <div className="w-full max-w-6xl grid lg:grid-cols-2 gap-8 items-center">
        <div className="hidden lg:block space-y-8 text-foreground">
          <div className="space-y-4">
            <h1 className="text-4xl font-bold bg-gradient-income bg-clip-text text-transparent">Controle Financeiro Inteligente</h1>
            <p className="text-xl text-muted-foreground">Gerencie suas finanÃ§as pessoais e em grupo com facilidade e seguranÃ§a</p>
          </div>

          <div className="grid grid-cols-2 gap-6">
            <div className="space-y-2">
              <div className="flex items-center gap-2">
                <TrendingUp className="h-5 w-5 text-income" />
                <h3 className="font-semibold">Controle Completo</h3>
              </div>
              <p className="text-sm text-muted-foreground">Acompanhe receitas, despesas e investimentos</p>
            </div>

            <div className="space-y-2">
              <div className="flex items-center gap-2">
                <Users className="h-5 w-5 text-accent" />
                <h3 className="font-semibold">Grupos</h3>
              </div>
              <p className="text-sm text-muted-foreground">Compartilhe despesas com famÃ­lia e amigos</p>
            </div>

            <div className="space-y-2">
              <div className="flex items-center gap-2">
                <BarChart3 className="h-5 w-5 text-investment" />
                <h3 className="font-semibold">RelatÃ³rios</h3>
              </div>
              <p className="text-sm text-muted-foreground">Visualize seus dados financeiros</p>
            </div>

            <div className="space-y-2">
              <div className="flex items-center gap-2">
                <Shield className="h-5 w-5 text-success" />
                <h3 className="font-semibold">Seguro</h3>
              </div>
              <p className="text-sm text-muted-foreground">Seus dados protegidos e criptografados</p>
            </div>
          </div>
        </div>

        {/* Right side - Auth forms */}
        <Card className="w-full max-w-md mx-auto bg-card/95 backdrop-blur shadow-financial border-0">
          <CardHeader>
            <CardTitle className="text-2xl font-bold text-center">Bem-vindo</CardTitle>
            <CardDescription className="text-center">Entre na sua conta ou crie uma nova</CardDescription>
          </CardHeader>
          <CardContent>
            <Tabs defaultValue="login" className="w-full">
              <TabsList className="grid w-full grid-cols-2">
                <TabsTrigger value="login">Entrar</TabsTrigger>
                <TabsTrigger value="register">Cadastrar</TabsTrigger>
              </TabsList>

              <TabsContent value="login" className="space-y-4">
                <form onSubmit={handleLogin} className="space-y-4">
                  <div className="space-y-2">
                    <Label htmlFor="email">Email</Label>
                    <Input
                      id="email"
                      type="email"
                      placeholder="seu@email.com"
                      value={loginData.email}
                      onChange={(e) => setLoginData((prev) => ({ ...prev, email: e.target.value }))}
                      required
                    />
                  </div>

                  <div className="space-y-2">
                    <Label htmlFor="password">Senha</Label>
                    <div className="relative">
                      <Input
                        id="password"
                        type={showPassword ? "text" : "password"}
                        placeholder="Sua senha"
                        value={loginData.password}
                        autoComplete="off"
                        onChange={(e) => setLoginData((prev) => ({ ...prev, password: e.target.value }))}
                        required
                      />
                      <Button
                        type="button"
                        variant="ghost"
                        size="sm"
                        className="absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent"
                        onClick={() => setShowPassword(!showPassword)}
                      >
                        {showPassword ? <EyeOff className="h-4 w-4" /> : <Eye className="h-4 w-4" />}
                      </Button>
                    </div>
                  </div>

                  <div className="flex justify-end">
                    <Dialog open={forgotPasswordOpen} onOpenChange={setForgotPasswordOpen}>
                      <DialogTrigger asChild>
                        <Button variant="link" className="px-0 text-xs text-muted-foreground" type="button">
                          Esqueci minha senha
                        </Button>
                      </DialogTrigger>
                      <DialogContent>
                        <DialogHeader>
                          <DialogTitle>Recuperar Senha</DialogTitle>
                          <DialogDescription>Digite seu email para receber um link de recuperaÃ§Ã£o de senha.</DialogDescription>
                        </DialogHeader>
                        <form onSubmit={handleResetPassword} className="space-y-4 mt-4">
                          <div className="space-y-2">
                            <Label htmlFor="reset-email">Email</Label>
                            <Input
                              id="reset-email"
                              type="email"
                              placeholder="seu@email.com"
                              value={resetEmail}
                              onChange={(e) => setResetEmail(e.target.value)}
                              required
                            />
                          </div>
                          <Button type="submit" className="w-full" disabled={isSubmitting}>
                            {isSubmitting ? "Enviando..." : "Enviar Link"}
                          </Button>
                        </form>
                      </DialogContent>
                    </Dialog>
                  </div>

                  <Button type="submit" className="w-full bg-gradient-income hover:opacity-90 transition-opacity" disabled={isSubmitting}>
                    {isSubmitting ? "Entrando..." : "Entrar"}
                  </Button>
                </form>
              </TabsContent>

              <TabsContent value="register" className="space-y-4">
                <form onSubmit={handleRegister} className="space-y-4">
                  <div className="space-y-2">
                    <Label htmlFor="fullName">Nome completo</Label>
                    <Input
                      id="fullName"
                      placeholder="Seu nome completo"
                      value={registerData.fullName}
                      onChange={(e) => setRegisterData((prev) => ({ ...prev, fullName: e.target.value }))}
                      required
                    />
                  </div>

                  <div className="space-y-2">
                    <Label htmlFor="registerEmail">Email</Label>
                    <Input
                      id="registerEmail"
                      type="email"
                      placeholder="seu@email.com"
                      value={registerData.email}
                      onChange={(e) => setRegisterData((prev) => ({ ...prev, email: e.target.value }))}
                      required
                    />
                  </div>

                  <div className="space-y-2">
                    <Label htmlFor="registerPassword">Senha</Label>
                    <div className="relative">
                      <Input
                        id="registerPassword"
                        type={showPassword ? "text" : "password"}
                        placeholder="Crie uma senha"
                        value={registerData.password}
                        autoComplete="off"
                        onChange={(e) => setRegisterData((prev) => ({ ...prev, password: e.target.value }))}
                        required
                      />
                      <Button
                        type="button"
                        variant="ghost"
                        size="sm"
                        className="absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent"
                        onClick={() => setShowPassword(!showPassword)}
                      >
                        {showPassword ? <EyeOff className="h-4 w-4" /> : <Eye className="h-4 w-4" />}
                      </Button>
                    </div>
                  </div>

                  <div className="space-y-2">
                    <Label htmlFor="confirmPassword">Confirmar senha</Label>
                    <Input
                      id="confirmPassword"
                      type={showPassword ? "text" : "password"}
                      placeholder="Confirme sua senha"
                      value={registerData.confirmPassword}
                      autoComplete="off"
                      onChange={(e) => setRegisterData((prev) => ({ ...prev, confirmPassword: e.target.value }))}
                      required
                    />
                  </div>

                  <Button
                    type="submit"
                    className="w-full bg-gradient-investment hover:opacity-90 transition-opacity"
                    disabled={isSubmitting || registerData.password !== registerData.confirmPassword}
                  >
                    {isSubmitting ? "Cadastrando..." : "Cadastrar"}
                  </Button>

                  {registerData.password !== registerData.confirmPassword && registerData.confirmPassword && (
                    <p className="text-sm text-expense">As senhas nÃ£o coincidem</p>
                  )}
                </form>
              </TabsContent>
            </Tabs>
          </CardContent>
        </Card>
      </div>
    </div>
  );
}

----------------------------------------
ENDOFFILE: src\pages\Auth.tsx

STARTOFFILE: src\pages\Dashboard.tsx
----------------------------------------
import { useState, useEffect } from "react";
import { DashboardLayout } from "@/components/layout/DashboardLayout";
import { MetricCard } from "@/components/dashboard/MetricCard";
import { TransactionsList } from "@/components/dashboard/TransactionsList";
import { AddTransactionDialog } from "@/components/dialogs/AddTransactionDialog";
import { AddInvestmentDialog } from "@/components/dialogs/AddInvestmentDialog";
import { DateFilter, DateRange } from "@/components/filters/DateFilter";
import { DollarSign, TrendingUp, TrendingDown, PiggyBank, Filter } from "@/lib/icons";
import { Button } from "@/components/ui/button";
import { Card, CardContent, CardHeader, CardTitle, CardDescription } from "@/components/ui/card";
import { startOfMonth, endOfMonth, format } from "@/lib/date";
import { supabase } from "@/integrations/supabase/client";
import { useToast } from "@/hooks/use-toast";
import { FixedBalanceCard } from "@/components/dashboard/FixedBalanceCard";

const Dashboard = () => {
  const [dateRange, setDateRange] = useState<DateRange>({
    from: startOfMonth(new Date()),
    to: endOfMonth(new Date()),
  });
  const [metrics, setMetrics] = useState({
    totalBalance: 0,
    totalIncome: 0,
    totalExpenses: 0,
    totalInvestments: 0,
  });
  const [loading, setLoading] = useState(true);
  const { toast } = useToast();

  // Carrega dados iniciais e sempre que a data mudar
  useEffect(() => {
    loadMetrics();
  }, [dateRange]);

  // CONFIGURAÃ‡ÃƒO DO REALTIME (TEMPO REAL)
  useEffect(() => {
    // Inscreve-se para ouvir mudanÃ§as nas tabelas
    const channel = supabase
      .channel("dashboard-changes")
      .on("postgres_changes", { event: "*", schema: "public", table: "transactions" }, (payload) => {
        console.log("MudanÃ§a detectada em transaÃ§Ãµes:", payload);
        loadMetrics(); // Recarrega os dados quando houver mudanÃ§a
      })
      .on("postgres_changes", { event: "*", schema: "public", table: "investments" }, () => {
        loadMetrics();
      })
      .subscribe();

    // Limpeza ao sair da pÃ¡gina
    return () => {
      supabase.removeChannel(channel);
    };
  }, [dateRange]); // DependÃªncia dateRange garante que o reload use as datas certas

  const loadMetrics = async () => {
    try {
      // NÃ£o ativamos o setLoading(true) aqui para evitar "piscar" a tela em atualizaÃ§Ãµes automÃ¡ticas
      // Apenas na primeira carga ou mudanÃ§a de data manual pode ser interessante,
      // mas para realtime Ã© melhor ser silencioso.

      const { data: transactions, error: transError } = await supabase
        .from("transactions")
        .select("amount, type, date")
        .gte("date", format(dateRange.from, "yyyy-MM-dd"))
        .lte("date", format(dateRange.to, "yyyy-MM-dd"));

      if (transError) throw transError;

      const { data: investments, error: invError } = await supabase.from("investments").select("current_value, amount, created_at");

      if (invError) throw invError;

      // CÃ¡lculos
      const income = transactions?.filter((t) => t.type === "income").reduce((sum, t) => sum + Number(t.amount), 0) || 0;

      const expenses = transactions?.filter((t) => t.type === "expense").reduce((sum, t) => sum + Number(t.amount), 0) || 0;

      const totalInvestments = investments?.reduce((sum, inv) => sum + Number(inv.current_value), 0) || 0;

      // CORREÃ‡ÃƒO MATEMÃTICA AQUI:
      // Saldo = Receitas - Despesas - Investimentos (se considerar investimento como saÃ­da de caixa)
      // Se 'totalInvestments' for o valor acumulado total da carteira, ele nÃ£o deve ser subtraÃ­do do fluxo de caixa mensal,
      // mas vamos assumir Saldo LÃ­quido do mÃªs = Entradas - SaÃ­das.
      const balance = income - expenses;

      setMetrics({
        totalBalance: balance,
        totalIncome: income,
        totalExpenses: expenses,
        totalInvestments: totalInvestments,
      });
    } catch (error) {
      console.error("Erro ao carregar mÃ©tricas:", error);
    } finally {
      setLoading(false);
    }
  };

  return (
    <DashboardLayout>
      <div className="p-6 space-y-6">
        {/* Header */}
        <div className="flex justify-between items-center">
          <div>
            <h1 className="text-3xl font-bold text-foreground">Dashboard</h1>
            <p className="text-muted-foreground">
              VisÃ£o geral das suas finanÃ§as em {new Date().toLocaleDateString("pt-BR", { month: "long", year: "numeric" })}
            </p>
          </div>
          <DateFilter dateRange={dateRange} onDateRangeChange={setDateRange} />
        </div>

        {/* Metrics Cards */}
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
          {loading ? (
            [...Array(4)].map((_, i) => <div key={i} className="h-32 bg-muted rounded-lg animate-pulse" />)
          ) : (
            <>
              <MetricCard
                title="Saldo do PerÃ­odo"
                value={metrics.totalBalance.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                icon={<DollarSign className="h-5 w-5 text-primary" />}
                changeType={metrics.totalBalance >= 0 ? "positive" : "negative"}
              />
              <MetricCard
                title="Receitas"
                value={metrics.totalIncome.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                icon={<TrendingUp className="h-5 w-5 text-success" />}
                changeType="positive"
              />
              <MetricCard
                title="Despesas"
                value={metrics.totalExpenses.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                icon={<TrendingDown className="h-5 w-5 text-destructive" />}
                changeType="negative"
              />
              <MetricCard
                title="PatrimÃ´nio Investido"
                value={metrics.totalInvestments.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                icon={<PiggyBank className="h-5 w-5 text-accent" />}
                changeType="positive"
              />
            </>
          )}
        </div>

        {/* Charts and Recent Transactions */}
        <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <FixedBalanceCard />
          <TransactionsList />
        </div>

        {/* Quick Actions */}
        <Card>
          <CardHeader>
            <CardTitle>AÃ§Ãµes RÃ¡pidas</CardTitle>
            <CardDescription>Acesse rapidamente as funcionalidades mais utilizadas</CardDescription>
          </CardHeader>
          <CardContent>
            <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
              <AddTransactionDialog type="income" onSuccess={loadMetrics} />
              <AddTransactionDialog type="expense" onSuccess={loadMetrics} />
              <AddInvestmentDialog onSuccess={loadMetrics} />
              <Button variant="outline" className="h-20 flex flex-col gap-2">
                <DollarSign className="h-6 w-6" />
                <span className="text-sm">Ver RelatÃ³rios</span>
              </Button>
            </div>
          </CardContent>
        </Card>
      </div>
    </DashboardLayout>
  );
};

export default Dashboard;

----------------------------------------
ENDOFFILE: src\pages\Dashboard.tsx

STARTOFFILE: src\pages\Groups.tsx
----------------------------------------
import React, { useState, useEffect } from "react";
import { Users, Wallet, TrendingDown, TrendingUp, Clock, CheckCircle, XCircle, AlertCircle } from "lucide-react";

import { DashboardLayout } from "@/components/layout/DashboardLayout";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import { useToast } from "@/hooks/use-toast";
import { supabase } from "@/integrations/supabase/client";
import { AddGroupDialog } from "@/components/dialogs/AddGroupDialog";
import { EditGroupDialog } from "@/components/dialogs/EditGroupDialog";
import { GroupDetailsModal } from "@/components/groups/GroupDetailsModal";

interface Group {
  id: string;
  name: string;
  description: string;
  color: string;
  created_by: string;
  memberCount: number;
  members: Array<{
    user_id: string;
    joined_at: string;
    profiles: {
      full_name: string | null;
    } | null;
  }>;
  totalExpenses: number;
  totalIncome: number;
  lastActivity: string | null;
}

interface Invite {
  id: string;
  group_id: string;
  status: string;
  groups: {
    name: string;
    description: string;
    created_by: string;
  } | null;
}

const Groups = () => {
  const [groups, setGroups] = useState<Group[]>([]);
  const [invites, setInvites] = useState<Invite[]>([]);
  const [loading, setLoading] = useState(true);
  const [currentUserId, setCurrentUserId] = useState<string | null>(null);
  const [selectedGroup, setSelectedGroup] = useState<{ id: string; name: string } | null>(null);
  const [editGroupId, setEditGroupId] = useState<string | null>(null);
  const [editDialogOpen, setEditDialogOpen] = useState(false);
  const { toast } = useToast();

  // --- REALTIME: ATUALIZAÃ‡ÃƒO AUTOMÃTICA ---
  useEffect(() => {
    // Escuta mudanÃ§as em transaÃ§Ãµes, grupos e membros para atualizar a tela sem F5
    const channel = supabase
      .channel("groups-page-realtime")
      .on("postgres_changes", { event: "*", schema: "public", table: "transactions" }, () => fetchGroups())
      .on("postgres_changes", { event: "*", schema: "public", table: "groups" }, () => fetchGroups())
      .on("postgres_changes", { event: "*", schema: "public", table: "group_members" }, () => fetchGroups())
      .on("postgres_changes", { event: "*", schema: "public", table: "group_invites" }, () => fetchInvites())
      .subscribe();

    return () => {
      supabase.removeChannel(channel);
    };
  }, []);

  const fetchGroups = async () => {
    try {
      const {
        data: { user },
      } = await supabase.auth.getUser();
      if (!user) return;

      setCurrentUserId(user.id);

      const { data: createdGroups, error: createdError } = await supabase.from("groups").select("*").eq("created_by", user.id);

      if (createdError) throw createdError;

      const { data: memberGroups, error: memberError } = await supabase
        .from("group_members")
        .select(
          `
          groups (*)
        `
        )
        .eq("user_id", user.id);

      if (memberError) throw memberError;

      const allGroups = [...(createdGroups || []), ...(memberGroups?.map((mg) => mg.groups).filter(Boolean) || [])];
      const uniqueGroups = allGroups.filter((group, index, arr) => arr.findIndex((g) => g.id === group.id) === index);

      const groupsWithStats = await Promise.all(
        uniqueGroups.map(async (group) => {
          const { data: members, error: membersError } = await supabase
            .from("group_members")
            .select("user_id, joined_at")
            .eq("group_id", group.id);

          if (membersError) throw membersError;

          const membersWithProfiles = await Promise.all(
            (members || []).map(async (member) => {
              const { data: profile } = await supabase.from("profiles").select("full_name").eq("user_id", member.user_id).maybeSingle();

              return {
                ...member,
                profiles: profile,
              };
            })
          );

          const { data: transactions } = await supabase.from("transactions").select("amount, type, created_at").eq("group_id", group.id);

          let totalExpenses = 0;
          let totalIncome = 0;
          let lastActivity = null;

          if (transactions) {
            transactions.forEach((t) => {
              // CORREÃ‡ÃƒO DE SALDO AQUI:
              // Usamos Math.abs() porque no banco a despesa Ã© salva como negativo (ex: -100).
              // Queremos somar a magnitude da despesa (100) para mostrar no card de "Despesas"
              // e para subtrair corretamente do saldo depois.
              if (t.type === "expense") {
                totalExpenses += Math.abs(t.amount);
              } else {
                totalIncome += t.amount;
              }

              if (!lastActivity || new Date(t.created_at) > new Date(lastActivity)) {
                lastActivity = t.created_at;
              }
            });
          }

          if (members && members.length > 0) {
            members.forEach((m) => {
              if (!lastActivity || new Date(m.joined_at) > new Date(lastActivity)) {
                lastActivity = m.joined_at;
              }
            });
          }

          return {
            ...group,
            memberCount: members?.length || 0,
            members: membersWithProfiles,
            totalExpenses,
            totalIncome,
            lastActivity,
          };
        })
      );

      setGroups(groupsWithStats);
    } catch (error) {
      console.error("Erro ao buscar grupos:", error);
      toast({
        title: "Erro ao carregar grupos",
        description: "NÃ£o foi possÃ­vel carregar seus grupos. Tente novamente.",
        variant: "destructive",
      });
    } finally {
      setLoading(false);
    }
  };

  const fetchInvites = async () => {
    try {
      const {
        data: { user },
      } = await supabase.auth.getUser();
      if (!user) return;

      const userEmail = user.email;
      if (userEmail) {
        const { data, error } = await supabase
          .from("group_invites")
          .select(
            `
            id,
            group_id,
            status,
            groups (
              name,
              description,
              created_by
            )
          `
          )
          .eq("email", userEmail)
          .eq("status", "pending");

        if (error) throw error;

        const formattedInvites: Invite[] = (data || []).map((item) => ({
          id: item.id,
          group_id: item.group_id,
          status: item.status,
          groups: item.groups
            ? {
                name: item.groups.name,
                description: item.groups.description || "",
                created_by: item.groups.created_by,
              }
            : null,
        }));

        setInvites(formattedInvites);
      }
    } catch (error) {
      console.error("Erro ao buscar convites:", error);
    }
  };

  useEffect(() => {
    fetchGroups();
    fetchInvites();
  }, []);

  const handleInviteResponse = async (invite: Invite, accept: boolean) => {
    try {
      const {
        data: { user },
      } = await supabase.auth.getUser();
      if (!user) return;

      if (accept) {
        const { data: existingMember } = await supabase
          .from("group_members")
          .select("id")
          .eq("group_id", invite.group_id)
          .eq("user_id", user.id)
          .single();

        if (!existingMember) {
          const { error: memberError } = await supabase.from("group_members").insert({
            group_id: invite.group_id,
            user_id: user.id,
            is_admin: false,
          });
          if (memberError) throw memberError;
        }

        await supabase.from("group_invites").update({ status: "accepted" }).eq("id", invite.id);
        toast({
          title: "Sucesso",
          description: `VocÃª entrou no grupo ${invite.groups?.name || "do convite"}`,
        });
      } else {
        await supabase.from("group_invites").update({ status: "rejected" }).eq("id", invite.id);
        toast({
          title: "Convite rejeitado",
        });
      }

      fetchInvites();
      fetchGroups();
    } catch (error) {
      console.error(error);
      toast({
        title: "Erro",
        description: "Erro ao processar convite",
        variant: "destructive",
      });
    }
  };

  const handleEditGroup = (groupId: string) => {
    setEditGroupId(groupId);
    setEditDialogOpen(true);
  };

  const handleEditClose = () => {
    setEditDialogOpen(false);
    setEditGroupId(null);
  };

  if (loading) {
    return (
      <DashboardLayout>
        <div className="p-6 space-y-6">
          <div className="animate-pulse space-y-4">
            <div className="h-8 bg-muted rounded w-1/4"></div>
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
              {[1, 2, 3].map((i) => (
                <div key={i} className="h-48 bg-muted rounded"></div>
              ))}
            </div>
          </div>
        </div>
      </DashboardLayout>
    );
  }

  return (
    <DashboardLayout>
      <div className="h-full overflow-y-auto">
        <div className="container max-w-7xl mx-auto p-4 md:p-6 space-y-4 md:space-y-6">
          <div className="flex flex-col md:flex-row md:justify-between md:items-center gap-4">
            <div>
              <h1 className="text-2xl md:text-3xl font-bold text-foreground">Grupos</h1>
              <p className="text-sm md:text-base text-muted-foreground">Gerencie e compartilhe despesas com seus grupos</p>
            </div>
            <AddGroupDialog onGroupCreated={fetchGroups} />
          </div>

          {invites.length > 0 && (
            <div className="space-y-4">
              <h2 className="text-lg font-semibold flex items-center gap-2">
                <Clock className="h-5 w-5 text-yellow-500" />
                Convites Pendentes
              </h2>
              <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
                {invites.map((invite) => (
                  <Card key={invite.id} className="border-yellow-200 bg-yellow-50 dark:bg-yellow-900/20">
                    <CardHeader>
                      <CardTitle className="flex items-center justify-between">
                        <span className="text-lg">{invite.groups?.name || "Grupo IndisponÃ­vel"}</span>
                        <Badge variant="outline" className="bg-yellow-100 dark:bg-yellow-800">
                          Pendente
                        </Badge>
                      </CardTitle>
                    </CardHeader>
                    <CardContent>
                      {invite.groups ? (
                        <>
                          {invite.groups.description && <p className="text-sm text-muted-foreground mb-4">{invite.groups.description}</p>}
                          <div className="flex gap-2">
                            <Button size="sm" variant="outline" className="flex-1" onClick={() => handleInviteResponse(invite, false)}>
                              <XCircle className="h-4 w-4 mr-1" />
                              Recusar
                            </Button>
                            <Button size="sm" className="flex-1" onClick={() => handleInviteResponse(invite, true)}>
                              <CheckCircle className="h-4 w-4 mr-1" />
                              Aceitar
                            </Button>
                          </div>
                        </>
                      ) : (
                        <div className="flex flex-col gap-2">
                          <p className="text-sm text-destructive flex items-center gap-2">
                            <AlertCircle className="h-4 w-4" />
                            Detalhes do grupo nÃ£o disponÃ­veis.
                          </p>
                          <Button size="sm" variant="outline" className="w-full" onClick={() => handleInviteResponse(invite, false)}>
                            Remover Convite
                          </Button>
                        </div>
                      )}
                    </CardContent>
                  </Card>
                ))}
              </div>
            </div>
          )}

          <div className="grid gap-4 md:gap-6 md:grid-cols-2 lg:grid-cols-3">
            {groups.length === 0 ? (
              <Card className="md:col-span-2 lg:col-span-3 border-2 border-dashed">
                <CardContent className="flex flex-col items-center justify-center py-12">
                  <Users className="h-12 w-12 text-muted-foreground mb-4" />
                  <p className="text-lg font-medium text-muted-foreground mb-2">Nenhum grupo encontrado</p>
                  <p className="text-sm text-muted-foreground mb-4">Crie seu primeiro grupo para comeÃ§ar a compartilhar despesas</p>
                  <AddGroupDialog onGroupCreated={fetchGroups} />
                </CardContent>
              </Card>
            ) : (
              groups.map((group) => {
                const getColorClasses = (color: string) => {
                  const colorMap: Record<string, string> = {
                    blue: "bg-blue-500",
                    green: "bg-green-500",
                    purple: "bg-purple-500",
                    red: "bg-red-500",
                    yellow: "bg-yellow-500",
                    pink: "bg-pink-500",
                    orange: "bg-orange-500",
                    indigo: "bg-indigo-500",
                  };
                  return colorMap[color] || "bg-blue-500";
                };

                // Agora que totalExpenses Ã© positivo, a subtraÃ§Ã£o funciona como esperado (Receita - Despesa)
                const balance = group.totalIncome - group.totalExpenses;
                const isCreator = group.created_by === currentUserId;

                return (
                  <Card
                    key={group.id}
                    className="relative overflow-hidden hover:shadow-lg transition-all duration-200 cursor-pointer"
                    onClick={() => setSelectedGroup({ id: group.id, name: group.name })}
                  >
                    <div
                      className={`absolute top-0 right-0 w-32 h-32 ${getColorClasses(group.color)} opacity-10 rounded-full -mr-16 -mt-16`}
                    />
                    <CardHeader className="pb-4">
                      <div className="flex justify-between items-start">
                        <CardTitle className="text-xl">{group.name}</CardTitle>
                        <div className="flex flex-col items-end gap-1">
                          <Badge variant={isCreator ? "default" : "secondary"} className="text-xs">
                            {isCreator ? "Criador" : "Membro"}
                          </Badge>
                          <Badge variant="outline" className="text-xs">
                            <Users className="w-3 h-3 mr-1" />
                            {group.memberCount} {group.memberCount === 1 ? "membro" : "membros"}
                          </Badge>
                        </div>
                      </div>
                      {group.description && <p className="text-sm text-muted-foreground mt-2">{group.description}</p>}
                    </CardHeader>
                    <CardContent className="space-y-4">
                      <div className="grid grid-cols-2 gap-4">
                        <div>
                          <p className="text-sm text-muted-foreground">Receitas</p>
                          <p className="text-lg font-semibold text-green-600 dark:text-green-400 flex items-center gap-1">
                            <TrendingUp className="w-4 h-4" />
                            R$ {group.totalIncome.toFixed(2)}
                          </p>
                        </div>
                        <div>
                          <p className="text-sm text-muted-foreground">Despesas</p>
                          <p className="text-lg font-semibold text-red-600 dark:text-red-400 flex items-center gap-1">
                            <TrendingDown className="w-4 h-4" />
                            {/* Mostra despesas como valor positivo no card, pois jÃ¡ estÃ¡ na seÃ§Ã£o "Despesas" */}
                            R$ {group.totalExpenses.toFixed(2)}
                          </p>
                        </div>
                      </div>

                      <div>
                        <p className="text-sm text-muted-foreground">Saldo</p>
                        <div className="flex items-center justify-between">
                          <p
                            className={`text-xl font-bold flex items-center gap-1 ${
                              balance >= 0 ? "text-green-600 dark:text-green-400" : "text-red-600 dark:text-red-400"
                            }`}
                          >
                            <Wallet className="w-5 h-5" />
                            R$ {Math.abs(balance).toFixed(2)}
                            {balance < 0 && " (negativo)"}
                          </p>
                        </div>
                      </div>

                      <div className="pt-2 flex justify-between items-center">
                        <p className="text-xs text-muted-foreground">
                          {group.lastActivity
                            ? `Ãšltima atividade: ${new Date(group.lastActivity).toLocaleDateString("pt-BR")}`
                            : "Sem atividades"}
                        </p>
                        {isCreator && (
                          <Button
                            variant="ghost"
                            size="sm"
                            onClick={(e) => {
                              e.stopPropagation();
                              handleEditGroup(group.id);
                            }}
                          >
                            Editar
                          </Button>
                        )}
                      </div>
                    </CardContent>
                  </Card>
                );
              })
            )}
          </div>

          <EditGroupDialog groupId={editGroupId} isOpen={editDialogOpen} onClose={handleEditClose} onSuccess={fetchGroups} />

          {selectedGroup && (
            <GroupDetailsModal
              isOpen={!!selectedGroup}
              onClose={() => setSelectedGroup(null)}
              groupId={selectedGroup.id}
              groupName={selectedGroup.name}
            />
          )}
        </div>
      </div>
    </DashboardLayout>
  );
};

export default Groups;

----------------------------------------
ENDOFFILE: src\pages\Groups.tsx

STARTOFFILE: src\pages\Index.tsx
----------------------------------------
import { Link, Navigate } from "react-router-dom";
import { Button } from "@/components/ui/button";
import { useAuth } from "@/contexts/AuthContext";
import { DollarSign, TrendingUp, Users, Shield, BarChart3, PiggyBank, ArrowRight } from "@/lib/icons";

const Index = () => {
  const { user } = useAuth();

  // Redirect if already authenticated
  if (user) {
    return <Navigate to="/dashboard" replace />;
  }
  return (
    <div className="min-h-screen bg-gradient-to-br from-primary/5 via-background to-accent/5">
      {/* Hero Section */}
      <section className="container mx-auto px-4 py-20">
        <div className="text-center max-w-4xl mx-auto">
          <div className="flex justify-center mb-8">
            <div className="p-4 bg-primary/10 rounded-full">
              <DollarSign className="h-16 w-16 text-primary" />
            </div>
          </div>

          <h1 className="text-5xl font-bold text-foreground mb-6">
            Seu Agente Financeiro
            <span className="block text-primary mt-2">Inteligente</span>
          </h1>

          <p className="text-xl text-muted-foreground mb-8 max-w-2xl mx-auto">
            Gerencie suas finanÃ§as pessoais e em grupo com inteligÃªncia. Controle investimentos, despesas compartilhadas e alcance seus
            objetivos financeiros.
          </p>

          <div className="flex gap-4 justify-center">
            <Button asChild size="lg" className="bg-gradient-income hover:opacity-90">
              <Link to="/auth">
                ComeÃ§ar Agora
                <ArrowRight className="ml-2 h-4 w-4" />
              </Link>
            </Button>
          </div>
        </div>
      </section>

      {/* Features Section */}
      <section className="container mx-auto px-4 py-20">
        <div className="text-center mb-16">
          <h2 className="text-3xl font-bold text-foreground mb-4">Tudo que vocÃª precisa para gerenciar suas finanÃ§as</h2>
          <p className="text-muted-foreground max-w-2xl mx-auto">Uma plataforma completa para controle financeiro pessoal e em grupo</p>
        </div>

        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          <div className="text-center p-6 rounded-lg bg-card border border-border">
            <div className="p-3 bg-primary/10 rounded-full w-fit mx-auto mb-4">
              <BarChart3 className="h-8 w-8 text-primary" />
            </div>
            <h3 className="text-xl font-semibold mb-2">Dashboard Intuitivo</h3>
            <p className="text-muted-foreground">Visualize todas suas finanÃ§as em um painel claro e organizado</p>
          </div>

          <div className="text-center p-6 rounded-lg bg-card border border-border">
            <div className="p-3 bg-success/10 rounded-full w-fit mx-auto mb-4">
              <PiggyBank className="h-8 w-8 text-success" />
            </div>
            <h3 className="text-xl font-semibold mb-2">Controle de Investimentos</h3>
            <p className="text-muted-foreground">Acompanhe a performance da sua carteira e defina metas</p>
          </div>

          <div className="text-center p-6 rounded-lg bg-card border border-border">
            <div className="p-3 bg-accent/10 rounded-full w-fit mx-auto mb-4">
              <Users className="h-8 w-8 text-accent" />
            </div>
            <h3 className="text-xl font-semibold mb-2">Despesas em Grupo</h3>
            <p className="text-muted-foreground">Compartilhe gastos com famÃ­lia e amigos de forma transparente</p>
          </div>

          <div className="text-center p-6 rounded-lg bg-card border border-border">
            <div className="p-3 bg-warning/10 rounded-full w-fit mx-auto mb-4">
              <TrendingUp className="h-8 w-8 text-warning" />
            </div>
            <h3 className="text-xl font-semibold mb-2">AnÃ¡lises Detalhadas</h3>
            <p className="text-muted-foreground">RelatÃ³rios completos sobre seus hÃ¡bitos financeiros</p>
          </div>

          <div className="text-center p-6 rounded-lg bg-card border border-border">
            <div className="p-3 bg-destructive/10 rounded-full w-fit mx-auto mb-4">
              <Shield className="h-8 w-8 text-destructive" />
            </div>
            <h3 className="text-xl font-semibold mb-2">SeguranÃ§a Total</h3>
            <p className="text-muted-foreground">Seus dados financeiros protegidos com criptografia avanÃ§ada</p>
          </div>

          <div className="text-center p-6 rounded-lg bg-card border border-border">
            <div className="p-3 bg-primary/10 rounded-full w-fit mx-auto mb-4">
              <DollarSign className="h-8 w-8 text-primary" />
            </div>
            <h3 className="text-xl font-semibold mb-2">CategorizaÃ§Ã£o AutomÃ¡tica</h3>
            <p className="text-muted-foreground">IA que aprende seus padrÃµes e categoriza transaÃ§Ãµes automaticamente</p>
          </div>
        </div>
      </section>

      {/* CTA Section */}
      <section className="container mx-auto px-4 py-20">
        <div className="bg-primary/5 rounded-2xl p-12 text-center">
          <h2 className="text-3xl font-bold text-foreground mb-4">Pronto para transformar suas finanÃ§as?</h2>
          <p className="text-muted-foreground mb-8 max-w-xl mx-auto">
            Junte-se a milhares de usuÃ¡rios que jÃ¡ conquistaram o controle financeiro
          </p>
          <Button size="lg" asChild className="bg-gradient-investment hover:opacity-90">
            <Link to="/auth">Criar Conta Gratuita</Link>
          </Button>
        </div>
      </section>
    </div>
  );
};

export default Index;

----------------------------------------
ENDOFFILE: src\pages\Index.tsx

STARTOFFILE: src\pages\Investments.tsx
----------------------------------------
import { useState, useEffect, useMemo } from "react";
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Progress } from "@/components/ui/progress";
import { DashboardLayout } from "@/components/layout/DashboardLayout";
import { AddInvestmentDialog } from "@/components/dialogs/AddInvestmentDialog";
import { InvestmentDetailsModal } from "@/components/dialogs/InvestmentDetailsModal";
import { ManageInvestmentDialog } from "@/components/dialogs/ManageInvestmentDialog";
import { AddGoalDialog } from "@/components/dialogs/AddGoalDialog";
import { EditGoalDialog } from "@/components/dialogs/EditGoalDialog";
import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
} from "@/components/ui/alert-dialog";
import { supabase } from "@/integrations/supabase/client";
import { useToast } from "@/hooks/use-toast";
import { TrendingUp, Target, Plus, PieChart, Trash2, Edit, ChevronLeft, ChevronRight } from "@/lib/icons";
import { recalculateGoalBalance } from "@/utils/investments/investmentUtils"; // Importe a funÃ§Ã£o nova

// Interfaces... (mesmas de antes)
interface InvestmentRecord {
  id: string;
  name: string;
  type: string;
  amount: number;
  current_value: number;
  group_id: string | null;
  maturity_date: string | null;
  user_id: string;
  created_at: string;
  quantity: number | null;
  unit_price: number | null;
  goal_id: string | null;
}

interface AggregatedInvestment {
  name: string;
  type: string;
  totalAmountInvested: number;
  totalCurrentValue: number;
  totalQuantity: number | null;
  averagePrice: number | null;
  firstInvestedAt: string;
  recordIds: string[];
  totalAmountForAvgPrice?: number;
  goalIds: (string | null)[];
}

interface InvestmentGoal {
  id: string;
  name: string;
  target_amount: number;
  current_amount: number;
  color: string;
  description?: string;
  target_date?: string;
  priority: number;
}

const Investments = () => {
  const [allInvestments, setAllInvestments] = useState<InvestmentRecord[]>([]);
  const [goals, setGoals] = useState<InvestmentGoal[]>([]);
  const [loading, setLoading] = useState(true);

  const [modalOpen, setModalOpen] = useState(false);
  const [selectedType, setSelectedType] = useState("");

  // Estados de DiÃ¡logo
  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false);
  const [investmentToDelete, setInvestmentToDelete] = useState<string | null>(null);
  const [deleteGoalDialogOpen, setDeleteGoalDialogOpen] = useState(false);
  const [goalToDelete, setGoalToDelete] = useState<string | null>(null);
  const [editGoalDialogOpen, setEditGoalDialogOpen] = useState(false);
  const [goalToEdit, setGoalToEdit] = useState<InvestmentGoal | null>(null);
  const [manageInvestment, setManageInvestment] = useState<AggregatedInvestment | null>(null);

  // PaginaÃ§Ã£o
  const [itemsPerPage] = useState(10);
  const [currentPage, setCurrentPage] = useState(1);
  const [goalPage, setGoalPage] = useState(0);

  const { toast } = useToast();
  const GOALS_PER_PAGE = 3;

  useEffect(() => {
    loadData();
  }, []);

  const loadData = async () => {
    setLoading(true);
    await Promise.all([loadInvestments(), loadGoals()]);
    setLoading(false);
  };

  const loadInvestments = async () => {
    const { data } = await supabase.from("investments").select("*").order("name").order("created_at");
    setAllInvestments(data || []);
  };

  const loadGoals = async () => {
    const { data } = await supabase.from("investment_goals").select("*").order("priority");
    setGoals(data || []);
  };

  // AgregaÃ§Ã£o (Mantida igual)
  const aggregatedInvestments = useMemo(() => {
    const aggregationMap = new Map<string, AggregatedInvestment>();
    allInvestments.forEach((record) => {
      const existing = aggregationMap.get(record.name);
      const isStockOrFII = record.type === "AÃ§Ãµes" || record.type === "FIIs";
      if (existing) {
        existing.totalAmountInvested += record.amount;
        existing.totalCurrentValue += record.current_value;
        existing.recordIds.push(record.id);
        existing.goalIds.push(record.goal_id);
        if (isStockOrFII && record.quantity) {
          existing.totalAmountForAvgPrice = (existing.totalAmountForAvgPrice || 0) + record.amount;
          existing.totalQuantity = (existing.totalQuantity || 0) + record.quantity;
          if (existing.totalQuantity > 0) existing.averagePrice = existing.totalAmountForAvgPrice / existing.totalQuantity;
        }
      } else {
        aggregationMap.set(record.name, {
          name: record.name,
          type: record.type,
          totalAmountInvested: record.amount,
          totalCurrentValue: record.current_value,
          totalQuantity: record.quantity,
          averagePrice: record.unit_price,
          firstInvestedAt: record.created_at,
          recordIds: [record.id],
          totalAmountForAvgPrice: record.amount,
          goalIds: [record.goal_id],
        });
      }
    });
    return Array.from(aggregationMap.values());
  }, [allInvestments]);

  // --- Handlers ---

  // BotÃ£o de EdiÃ§Ã£o/Gerenciamento
  const handleManageClick = (investment: AggregatedInvestment) => {
    setManageInvestment(investment);
  };

  // ExclusÃ£o unitÃ¡ria (se houver apenas 1 registro ou botÃ£o especÃ­fico)
  const handleDeleteClick = (investmentId: string) => {
    setInvestmentToDelete(investmentId);
    setDeleteDialogOpen(true);
  };

  const handleDeleteConfirm = async () => {
    if (!investmentToDelete) return;
    try {
      const investment = allInvestments.find((inv) => inv.id === investmentToDelete);

      const { error } = await supabase.from("investments").delete().eq("id", investmentToDelete);
      if (error) throw error;

      // RECALCULA A META
      if (investment && investment.goal_id) {
        await recalculateGoalBalance(investment.goal_id);
      }

      toast({ title: "Sucesso", description: "Investimento removido!" });
      await loadData();
    } catch (error) {
      toast({ title: "Erro", description: "Falha ao remover", variant: "destructive" });
    } finally {
      setDeleteDialogOpen(false);
      setInvestmentToDelete(null);
    }
  };

  const handleDeleteGoalClick = (goalId: string) => {
    setGoalToDelete(goalId);
    setDeleteGoalDialogOpen(true);
  };

  const handleDeleteGoalConfirm = async () => {
    if (!goalToDelete) return;
    try {
      const { error } = await supabase.from("investment_goals").delete().eq("id", goalToDelete);
      if (error) throw error;
      toast({ title: "Sucesso", description: "Meta removida!" });
      await loadGoals();
      setGoalPage(0);
    } catch (error) {
      toast({ title: "Erro", description: "Falha ao remover meta", variant: "destructive" });
    } finally {
      setDeleteGoalDialogOpen(false);
      setGoalToDelete(null);
    }
  };

  const handleEditGoalClick = (goal: InvestmentGoal) => {
    setGoalToEdit(goal);
    setEditGoalDialogOpen(true);
  };

  const handleTypeClick = (type: string) => {
    setSelectedType(type);
    setModalOpen(true);
  };

  const totalInvested = allInvestments.reduce((sum, inv) => sum + inv.amount, 0);
  const totalCurrentValue = allInvestments.reduce((sum, inv) => sum + inv.current_value, 0);
  const totalReturn = totalInvested > 0 ? ((totalCurrentValue - totalInvested) / totalInvested) * 100 : 0;
  const investmentTypes = [...new Set(aggregatedInvestments.map((inv) => inv.type))];

  // PaginaÃ§Ã£o
  const paginatedAggregatedInvestments = aggregatedInvestments.slice((currentPage - 1) * itemsPerPage, currentPage * itemsPerPage);
  const totalPages = Math.ceil(aggregatedInvestments.length / itemsPerPage);
  const paginatedGoals = goals.slice(goalPage * GOALS_PER_PAGE, (goalPage + 1) * GOALS_PER_PAGE);
  const totalGoalPages = Math.ceil(goals.length / GOALS_PER_PAGE);

  const handlePreviousGoals = () => goalPage > 0 && setGoalPage(goalPage - 1);
  const handleNextGoals = () => goalPage < totalGoalPages - 1 && setGoalPage(goalPage + 1);

  if (loading) {
    return (
      <DashboardLayout>
        <div className="p-6 space-y-6">
          <div className="animate-pulse space-y-4">
            <div className="h-8 bg-muted rounded w-1/4"></div>
            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
              {[1, 2, 3].map((i) => (
                <div key={i} className="h-24 bg-muted rounded"></div>
              ))}
            </div>
          </div>
        </div>
      </DashboardLayout>
    );
  }

  return (
    <DashboardLayout>
      <div className="p-6 space-y-6">
        <div className="flex justify-between items-center">
          <div>
            <h1 className="text-3xl font-bold text-foreground">Investimentos</h1>
            <p className="text-muted-foreground">Acompanhe e gerencie seu portfÃ³lio</p>
          </div>
          <AddInvestmentDialog onSuccess={loadData} />
        </div>

        {/* Resumo */}
        <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
          <Card>
            <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
              <CardTitle className="text-sm font-medium">Total Investido</CardTitle>
              <TrendingUp className="h-4 w-4 text-muted-foreground" />
            </CardHeader>
            <CardContent>
              <div className="text-2xl font-bold">
                {new Intl.NumberFormat("pt-BR", { style: "currency", currency: "BRL" }).format(totalInvested)}
              </div>
            </CardContent>
          </Card>
          <Card>
            <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
              <CardTitle className="text-sm font-medium">Valor Atual</CardTitle>
              <TrendingUp className="h-4 w-4 text-muted-foreground" />
            </CardHeader>
            <CardContent>
              <div className="text-2xl font-bold">
                {new Intl.NumberFormat("pt-BR", { style: "currency", currency: "BRL" }).format(totalCurrentValue)}
              </div>
            </CardContent>
          </Card>
          <Card>
            <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
              <CardTitle className="text-sm font-medium">Rentabilidade</CardTitle>
              <TrendingUp className="h-4 w-4 text-muted-foreground" />
            </CardHeader>
            <CardContent>
              <div className={`text-2xl font-bold ${totalReturn >= 0 ? "text-success" : "text-destructive"}`}>
                {totalReturn >= 0 ? "+" : ""}
                {totalReturn.toFixed(2)}%
              </div>
            </CardContent>
          </Card>
        </div>

        {/* Metas */}
        {goals.length > 0 && (
          <Card>
            <CardHeader>
              <div className="flex items-center justify-between">
                <div>
                  <CardTitle className="flex items-center gap-2">
                    <Target className="h-5 w-5" /> Metas
                  </CardTitle>
                </div>
                <div className="flex items-center gap-2">
                  {totalGoalPages > 1 && (
                    <>
                      <Button variant="outline" size="icon" onClick={handlePreviousGoals} disabled={goalPage === 0}>
                        <ChevronLeft className="h-4 w-4" />
                      </Button>
                      <Button variant="outline" size="icon" onClick={handleNextGoals} disabled={goalPage >= totalGoalPages - 1}>
                        <ChevronRight className="h-4 w-4" />
                      </Button>
                    </>
                  )}
                  <AddGoalDialog onSuccess={loadGoals} />
                </div>
              </div>
            </CardHeader>
            <CardContent>
              <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                {paginatedGoals.map((goal) => {
                  const progress = goal.target_amount > 0 ? (goal.current_amount / goal.target_amount) * 100 : 0;
                  return (
                    <Card key={goal.id} className="relative group hover:shadow-md transition-shadow">
                      <div className="absolute top-4 right-4 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity">
                        <Button variant="secondary" size="icon" className="h-8 w-8" onClick={() => handleEditGoalClick(goal)}>
                          <Edit className="h-4 w-4" />
                        </Button>
                        <Button variant="destructive" size="icon" className="h-8 w-8" onClick={() => handleDeleteGoalClick(goal.id)}>
                          <Trash2 className="h-4 w-4" />
                        </Button>
                      </div>
                      <CardHeader>
                        <CardTitle className="text-lg pr-16 truncate">{goal.name}</CardTitle>
                        {goal.description && <CardDescription className="line-clamp-1">{goal.description}</CardDescription>}
                      </CardHeader>
                      <CardContent className="space-y-4">
                        <div className="space-y-2">
                          <div className="flex justify-between text-sm">
                            <span className="text-muted-foreground">Progresso</span>
                            <span className="font-medium">{Math.min(progress, 100).toFixed(1)}%</span>
                          </div>
                          <Progress value={Math.min(progress, 100)} className="h-2" />
                        </div>
                        <div className="flex justify-between text-sm">
                          <div>
                            <p className="text-muted-foreground">Atual</p>
                            <p className="font-medium">
                              {new Intl.NumberFormat("pt-BR", { style: "currency", currency: "BRL" }).format(goal.current_amount)}
                            </p>
                          </div>
                          <div className="text-right">
                            <p className="text-muted-foreground">Meta</p>
                            <p className="font-medium">
                              {new Intl.NumberFormat("pt-BR", { style: "currency", currency: "BRL" }).format(goal.target_amount)}
                            </p>
                          </div>
                        </div>
                      </CardContent>
                    </Card>
                  );
                })}
              </div>
            </CardContent>
          </Card>
        )}

        {/* Ativos Consolidados */}
        {aggregatedInvestments.length > 0 ? (
          <Card>
            <CardHeader>
              <CardTitle>Ativos Consolidados</CardTitle>
              <CardDescription>Gerencie seus ativos</CardDescription>
            </CardHeader>
            <CardContent>
              <div className="space-y-4">
                {paginatedAggregatedInvestments.map((aggInvestment) => {
                  const investmentReturn =
                    aggInvestment.totalAmountInvested > 0
                      ? ((aggInvestment.totalCurrentValue - aggInvestment.totalAmountInvested) / aggInvestment.totalAmountInvested) * 100
                      : 0;

                  return (
                    <Card key={aggInvestment.name} className="relative border hover:bg-accent/5 transition-colors">
                      <CardContent className="pt-6">
                        <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                          <div className="flex-1">
                            <div className="flex items-center gap-2 mb-2">
                              <h3 className="text-lg font-semibold">{aggInvestment.name}</h3>
                              <span className="text-xs px-2 py-1 bg-muted rounded-full">{aggInvestment.type}</span>
                            </div>
                            <div className="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                              <div>
                                <p className="text-muted-foreground">Investido</p>
                                <p className="font-medium">
                                  {new Intl.NumberFormat("pt-BR", { style: "currency", currency: "BRL" }).format(
                                    aggInvestment.totalAmountInvested
                                  )}
                                </p>
                              </div>
                              <div>
                                <p className="text-muted-foreground">Valor Atual</p>
                                <p className="font-medium">
                                  {new Intl.NumberFormat("pt-BR", { style: "currency", currency: "BRL" }).format(
                                    aggInvestment.totalCurrentValue
                                  )}
                                </p>
                              </div>
                              {aggInvestment.totalQuantity !== null && (
                                <>
                                  <div>
                                    <p className="text-muted-foreground">Quantidade</p>
                                    <p className="font-medium">{aggInvestment.totalQuantity}</p>
                                  </div>
                                  <div>
                                    <p className="text-muted-foreground">PreÃ§o MÃ©dio</p>
                                    <p className="font-medium">
                                      {new Intl.NumberFormat("pt-BR", { style: "currency", currency: "BRL" }).format(
                                        aggInvestment.averagePrice || 0
                                      )}
                                    </p>
                                  </div>
                                </>
                              )}
                              <div>
                                <p className="text-muted-foreground">Rentabilidade</p>
                                <p className={`font-medium ${investmentReturn >= 0 ? "text-success" : "text-destructive"}`}>
                                  {investmentReturn >= 0 ? "+" : ""}
                                  {investmentReturn.toFixed(2)}%
                                </p>
                              </div>
                            </div>
                          </div>

                          {/* BotÃ£o de EdiÃ§Ã£o */}
                          <div>
                            <Button
                              variant="outline"
                              size="sm"
                              className="flex items-center gap-2"
                              onClick={() => handleManageClick(aggInvestment)}
                            >
                              <Edit className="h-4 w-4" />
                              Editar
                            </Button>
                          </div>
                        </div>
                      </CardContent>
                    </Card>
                  );
                })}
              </div>

              {/* PaginaÃ§Ã£o... (mantida) */}
            </CardContent>
          </Card>
        ) : (
          <Card>
            <CardContent className="flex flex-col items-center justify-center py-12">
              <PieChart className="h-16 w-16 text-muted-foreground mb-4" />
              <h3 className="text-lg font-semibold mb-2">Nenhum investimento cadastrado</h3>
              <AddInvestmentDialog
                trigger={
                  <Button>
                    <Plus className="h-4 w-4 mr-2" /> Adicionar Investimento
                  </Button>
                }
                onSuccess={loadData}
              />
            </CardContent>
          </Card>
        )}

        {/* Modais */}
        <InvestmentDetailsModal
          open={modalOpen}
          onOpenChange={setModalOpen}
          type={selectedType}
          investments={selectedType ? allInvestments.filter((inv) => inv.type === selectedType) : []}
        />

        {manageInvestment && (
          <ManageInvestmentDialog
            isOpen={!!manageInvestment}
            onClose={() => setManageInvestment(null)}
            investment={manageInvestment}
            onSuccess={() => {
              loadData();
              setManageInvestment(null);
            }}
          />
        )}

        {goalToEdit && (
          <EditGoalDialog
            open={editGoalDialogOpen}
            onOpenChange={setEditGoalDialogOpen}
            goal={goalToEdit}
            onSuccess={loadGoals}
            onClose={() => setEditGoalDialogOpen(false)}
          />
        )}

        <AlertDialog open={deleteGoalDialogOpen} onOpenChange={setDeleteGoalDialogOpen}>
          <AlertDialogContent>
            <AlertDialogHeader>
              <AlertDialogTitle>Excluir Meta?</AlertDialogTitle>
              <AlertDialogDescription>Essa aÃ§Ã£o nÃ£o pode ser desfeita.</AlertDialogDescription>
            </AlertDialogHeader>
            <AlertDialogFooter>
              <AlertDialogCancel>Cancelar</AlertDialogCancel>
              <AlertDialogAction onClick={handleDeleteGoalConfirm} className="bg-destructive text-destructive-foreground">
                Excluir
              </AlertDialogAction>
            </AlertDialogFooter>
          </AlertDialogContent>
        </AlertDialog>
      </div>
    </DashboardLayout>
  );
};

export default Investments;

----------------------------------------
ENDOFFILE: src\pages\Investments.tsx

STARTOFFILE: src\pages\JoinGroup.tsx
----------------------------------------
import { useEffect, useState } from "react";
import { useParams, useNavigate } from "react-router-dom";
import { Loader2, Users, Check, X } from "lucide-react";

import { DashboardLayout } from "@/components/layout/DashboardLayout";
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { useToast } from "@/hooks/use-toast";
import { supabase } from "@/integrations/supabase/client";

interface InviteData {
  id: string;
  group_id: string;
  email: string;
  status: string;
  groups: {
    name: string;
    description: string | null;
    created_by: string;
  };
}

export default function JoinGroup() {
  const { inviteId } = useParams();
  const navigate = useNavigate();
  const { toast } = useToast();
  const [loading, setLoading] = useState(true);
  const [invite, setInvite] = useState<InviteData | null>(null);
  const [user, setUser] = useState<any>(null);

  useEffect(() => {
    loadInvite();
  }, [inviteId]);

  const loadInvite = async () => {
    try {
      const {
        data: { user },
      } = await supabase.auth.getUser();

      if (!user) {
        sessionStorage.setItem("redirectUrl", window.location.pathname);
        navigate("/auth");
        return;
      }
      setUser(user);

      if (!inviteId) throw new Error("Link invÃ¡lido");

      const { data, error } = await supabase
        .from("group_invites")
        .select(
          `
          *,
          groups (name, description, created_by)
        `
        )
        .eq("id", inviteId)
        .single();

      if (error) throw error;

      if (data.status !== "pending") {
        toast({
          title: "Convite invÃ¡lido",
          description: "Este convite jÃ¡ foi aceito, rejeitado ou expirou.",
          variant: "destructive",
        });
        navigate("/groups");
        return;
      }

      setInvite(data);
    } catch (error) {
      console.error(error);
      toast({
        title: "Erro",
        description: "NÃ£o foi possÃ­vel carregar o convite.",
        variant: "destructive",
      });
      navigate("/dashboard");
    } finally {
      setLoading(false);
    }
  };

  const handleRespond = async (accept: boolean) => {
    if (!user || !invite) return;
    setLoading(true);

    try {
      if (accept) {
        const { data: existingMember } = await supabase
          .from("group_members")
          .select("id")
          .eq("group_id", invite.group_id)
          .eq("user_id", user.id)
          .single();

        if (existingMember) {
          toast({
            title: "Aviso",
            description: "VocÃª jÃ¡ faz parte deste grupo.",
          });
        } else {
          const { error: joinError } = await supabase.from("group_members").insert({
            group_id: invite.group_id,
            user_id: user.id,
            is_admin: false,
          });

          if (joinError) throw joinError;
        }

        await supabase.from("group_invites").update({ status: "accepted" }).eq("id", invite.id);

        toast({
          title: "Bem-vindo!",
          description: `VocÃª entrou no grupo ${invite.groups.name}`,
        });
        navigate("/groups");
      } else {
        await supabase.from("group_invites").update({ status: "rejected" }).eq("id", invite.id);

        toast({
          title: "Convite recusado",
        });
        navigate("/dashboard");
      }
    } catch (error) {
      console.error(error);
      toast({
        title: "Erro",
        description: "Falha ao processar solicitaÃ§Ã£o",
        variant: "destructive",
      });
    } finally {
      setLoading(false);
    }
  };

  if (loading) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-background">
        <div className="flex flex-col items-center gap-4">
          <Loader2 className="h-10 w-10 animate-spin text-primary" />
          <p className="text-muted-foreground">Verificando convite...</p>
        </div>
      </div>
    );
  }

  if (!invite) return null;

  return (
    <DashboardLayout>
      <div className="flex items-center justify-center min-h-[80vh] p-4">
        <Card className="w-full max-w-md shadow-lg">
          <CardHeader className="text-center">
            <div className="mx-auto bg-primary/10 p-4 rounded-full w-fit mb-4">
              <Users className="h-8 w-8 text-primary" />
            </div>
            <CardTitle>Convite para Grupo</CardTitle>
            <CardDescription>VocÃª foi convidado para participar de um grupo financeiro.</CardDescription>
          </CardHeader>
          <CardContent className="space-y-6">
            <div className="bg-muted/30 p-6 rounded-lg text-center border border-border">
              <h3 className="font-bold text-2xl mb-2 text-foreground">{invite.groups.name}</h3>
              {invite.groups.description && <p className="text-sm text-muted-foreground">{invite.groups.description}</p>}
            </div>

            <div className="flex gap-3 pt-2">
              <Button variant="outline" className="flex-1" onClick={() => handleRespond(false)} disabled={loading}>
                <X className="mr-2 h-4 w-4" />
                Recusar
              </Button>
              <Button className="flex-1" onClick={() => handleRespond(true)} disabled={loading}>
                <Check className="mr-2 h-4 w-4" />
                Aceitar
              </Button>
            </div>
          </CardContent>
        </Card>
      </div>
    </DashboardLayout>
  );
}

----------------------------------------
ENDOFFILE: src\pages\JoinGroup.tsx

STARTOFFILE: src\pages\NotFound.tsx
----------------------------------------
import { useLocation } from "react-router-dom";
import { useEffect } from "react";

const NotFound = () => {
  const location = useLocation();

  useEffect(() => {
    console.error(
      "404 Error: User attempted to access non-existent route:",
      location.pathname
    );
  }, [location.pathname]);

  return (
    <div className="min-h-screen flex items-center justify-center bg-gray-100">
      <div className="text-center">
        <h1 className="text-4xl font-bold mb-4">404</h1>
        <p className="text-xl text-gray-600 mb-4">Oops! Page not found</p>
        <a href="/" className="text-blue-500 hover:text-blue-700 underline">
          Return to Home
        </a>
      </div>
    </div>
  );
};

export default NotFound;

----------------------------------------
ENDOFFILE: src\pages\NotFound.tsx

STARTOFFILE: src\pages\Profile.tsx
----------------------------------------
import { useState, useEffect, useRef } from "react";
import { DashboardLayout } from "@/components/layout/DashboardLayout";
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { User, Lock, Moon, Sun, Laptop, Mail, Camera } from "@/lib/icons";
import { useAuth } from "@/contexts/AuthContext";
import { useTheme } from "@/components/theme-provider";
import { supabase } from "@/integrations/supabase/client";
import { Avatar, AvatarFallback, AvatarImage } from "@/components/ui/avatar";

const Profile = () => {
  const { user, updateProfile, updatePassword } = useAuth();
  const { theme, setTheme } = useTheme();
  const fileInputRef = useRef<HTMLInputElement>(null);

  const [loading, setLoading] = useState(false);
  const [profileData, setProfileData] = useState({
    full_name: "",
    age: "",
    gender: "",
    avatar_url: "",
  });

  const [passwordData, setPasswordData] = useState({
    newPassword: "",
    confirmPassword: "",
  });

  useEffect(() => {
    if (user) {
      fetchProfile();
    }
  }, [user]);

  const fetchProfile = async () => {
    try {
      const { data, error } = await supabase.from("profiles").select("*").eq("user_id", user!.id).single();

      if (error && error.code !== "PGRST116") throw error; // Ignora erro se nÃ£o encontrar perfil (serÃ¡ criado no upsert)

      if (data) {
        setProfileData({
          full_name: data.full_name || "",
          age: data.age ? data.age.toString() : "",
          gender: data.gender || "",
          avatar_url: data.avatar_url || "",
        });
      }
    } catch (error) {
      console.error("Erro ao carregar perfil:", error);
    }
  };

  // FunÃ§Ã£o para processar a imagem e converter para Base64
  const handleFileChange = (event: React.ChangeEvent<HTMLInputElement>) => {
    const file = event.target.files?.[0];
    if (file) {
      // Verifica tamanho (exemplo: max 2MB)
      if (file.size > 2 * 1024 * 1024) {
        alert("A imagem deve ter no mÃ¡ximo 2MB.");
        return;
      }

      const reader = new FileReader();
      reader.onloadend = () => {
        const base64String = reader.result as string;
        setProfileData((prev) => ({ ...prev, avatar_url: base64String }));
      };
      reader.readAsDataURL(file);
    }
  };

  const handleProfileUpdate = async (e: React.FormEvent) => {
    e.preventDefault();
    setLoading(true);
    await updateProfile({
      full_name: profileData.full_name,
      age: profileData.age ? parseInt(profileData.age) : null,
      gender: profileData.gender,
      avatar_url: profileData.avatar_url,
    });
    setLoading(false);
  };

  const handlePasswordUpdate = async (e: React.FormEvent) => {
    e.preventDefault();
    if (passwordData.newPassword !== passwordData.confirmPassword) return;

    setLoading(true);
    await updatePassword(passwordData.newPassword);
    setPasswordData({ newPassword: "", confirmPassword: "" });
    setLoading(false);
  };

  const triggerFileInput = () => {
    fileInputRef.current?.click();
  };

  return (
    <DashboardLayout>
      <div className="p-6 space-y-6 max-w-4xl mx-auto">
        <h1 className="text-3xl font-bold">Meu Perfil</h1>
        <p className="text-muted-foreground">Gerencie suas informaÃ§Ãµes pessoais e preferÃªncias</p>

        <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
          {/* CartÃ£o de InformaÃ§Ãµes BÃ¡sicas (Esquerda) */}
          <Card className="md:col-span-1">
            <CardContent className="pt-6 flex flex-col items-center text-center">
              <div className="relative mb-4 group cursor-pointer" onClick={triggerFileInput}>
                <Avatar className="h-32 w-32 border-4 border-background shadow-xl">
                  <AvatarImage src={profileData.avatar_url} className="object-cover" />
                  <AvatarFallback className="text-4xl bg-primary/10 text-primary">
                    {profileData.full_name ? profileData.full_name.charAt(0).toUpperCase() : "U"}
                  </AvatarFallback>
                </Avatar>
                <div className="absolute inset-0 flex items-center justify-center bg-black/40 rounded-full opacity-0 group-hover:opacity-100 transition-opacity">
                  <Camera className="text-white h-8 w-8" />
                </div>
                <input type="file" ref={fileInputRef} className="hidden" accept="image/*" onChange={handleFileChange} />
              </div>

              <Button variant="ghost" size="sm" className="mb-4" onClick={triggerFileInput}>
                Alterar Foto
              </Button>

              <h2 className="text-xl font-bold">{profileData.full_name || "UsuÃ¡rio"}</h2>
              <p className="text-sm text-muted-foreground flex items-center gap-1 mt-1 justify-center">
                <Mail className="h-3 w-3" /> {user?.email}
              </p>
            </CardContent>
          </Card>

          {/* Ãrea de EdiÃ§Ã£o (Direita) */}
          <div className="md:col-span-2 space-y-6">
            {/* Dados Pessoais */}
            <Card>
              <CardHeader>
                <CardTitle className="flex items-center gap-2">
                  <User className="h-5 w-5" /> Dados Pessoais
                </CardTitle>
                <CardDescription>Atualize suas informaÃ§Ãµes de identificaÃ§Ã£o</CardDescription>
              </CardHeader>
              <CardContent>
                <form onSubmit={handleProfileUpdate} className="space-y-4">
                  <div className="space-y-2">
                    <Label htmlFor="fullName">Nome Completo</Label>
                    <Input
                      id="fullName"
                      value={profileData.full_name}
                      onChange={(e) => setProfileData({ ...profileData, full_name: e.target.value })}
                    />
                  </div>

                  <div className="grid grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label htmlFor="age">Idade</Label>
                      <Input
                        id="age"
                        type="number"
                        value={profileData.age}
                        onChange={(e) => setProfileData({ ...profileData, age: e.target.value })}
                      />
                    </div>

                    <div className="space-y-2">
                      <Label htmlFor="gender">Identidade de GÃªnero</Label>
                      <Select value={profileData.gender} onValueChange={(val) => setProfileData({ ...profileData, gender: val })}>
                        <SelectTrigger>
                          <SelectValue placeholder="Selecione" />
                        </SelectTrigger>
                        <SelectContent>
                          <SelectItem value="feminino">Feminino</SelectItem>
                          <SelectItem value="masculino">Masculino</SelectItem>
                          <SelectItem value="nao-binario">NÃ£o-binÃ¡rio</SelectItem>
                          <SelectItem value="agenero">AgÃªnero</SelectItem>
                          <SelectItem value="genero-fluido">GÃªnero Fluido</SelectItem>
                          <SelectItem value="transgenero">TransgÃªnero</SelectItem>
                          <SelectItem value="outro">Outro</SelectItem>
                          <SelectItem value="prefiro-nao-dizer">Prefiro nÃ£o dizer</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                  </div>

                  <Button type="submit" disabled={loading}>
                    {loading ? "Salvando..." : "Salvar AlteraÃ§Ãµes"}
                  </Button>
                </form>
              </CardContent>
            </Card>

            {/* AparÃªncia */}
            <Card>
              <CardHeader>
                <CardTitle className="flex items-center gap-2">
                  <Laptop className="h-5 w-5" /> AparÃªncia
                </CardTitle>
                <CardDescription>Escolha o tema da interface</CardDescription>
              </CardHeader>
              <CardContent>
                <div className="flex gap-4">
                  <Button variant={theme === "light" ? "default" : "outline"} className="flex-1" onClick={() => setTheme("light")}>
                    <Sun className="mr-2 h-4 w-4" /> Claro
                  </Button>
                  <Button variant={theme === "dark" ? "default" : "outline"} className="flex-1" onClick={() => setTheme("dark")}>
                    <Moon className="mr-2 h-4 w-4" /> Escuro
                  </Button>
                  <Button variant={theme === "system" ? "default" : "outline"} className="flex-1" onClick={() => setTheme("system")}>
                    <Laptop className="mr-2 h-4 w-4" /> Sistema
                  </Button>
                </div>
              </CardContent>
            </Card>

            {/* SeguranÃ§a */}
            <Card>
              <CardHeader>
                <CardTitle className="flex items-center gap-2">
                  <Lock className="h-5 w-5" /> SeguranÃ§a
                </CardTitle>
                <CardDescription>Alterar senha de acesso</CardDescription>
              </CardHeader>
              <CardContent>
                <form onSubmit={handlePasswordUpdate} className="space-y-4">
                  <div className="space-y-2">
                    <Label htmlFor="newPassword">Nova Senha</Label>
                    <Input
                      id="newPassword"
                      type="password"
                      value={passwordData.newPassword}
                      onChange={(e) => setPasswordData({ ...passwordData, newPassword: e.target.value })}
                    />
                  </div>
                  <div className="space-y-2">
                    <Label htmlFor="confirmPassword">Confirmar Nova Senha</Label>
                    <Input
                      id="confirmPassword"
                      type="password"
                      value={passwordData.confirmPassword}
                      onChange={(e) => setPasswordData({ ...passwordData, confirmPassword: e.target.value })}
                    />
                  </div>
                  {passwordData.newPassword && passwordData.newPassword !== passwordData.confirmPassword && (
                    <p className="text-xs text-destructive">As senhas nÃ£o coincidem</p>
                  )}
                  <Button
                    type="submit"
                    disabled={loading || !passwordData.newPassword || passwordData.newPassword !== passwordData.confirmPassword}
                    variant="secondary"
                  >
                    {loading ? "Atualizando..." : "Atualizar Senha"}
                  </Button>
                </form>
              </CardContent>
            </Card>
          </div>
        </div>
      </div>
    </DashboardLayout>
  );
};

export default Profile;

----------------------------------------
ENDOFFILE: src\pages\Profile.tsx

STARTOFFILE: src\pages\Reminders.tsx
----------------------------------------
import { DashboardLayout } from "@/components/layout/DashboardLayout";
import { RemindersList } from "@/components/reminders/RemindersList";

const Reminders = () => {
  return (
    <DashboardLayout>
      <div className="space-y-6">
        <div>
          <h1 className="text-3xl font-bold">Lembretes</h1>
          <p className="text-muted-foreground mt-2">Gerencie seus lembretes e notificaÃ§Ãµes financeiras</p>
        </div>

        <RemindersList />
      </div>
    </DashboardLayout>
  );
};

export default Reminders;

----------------------------------------
ENDOFFILE: src\pages\Reminders.tsx

STARTOFFILE: src\pages\Transactions.tsx
----------------------------------------
import { useState, useEffect, useMemo } from "react";
import { ArrowUpCircle, ArrowDownCircle, Search, Filter, Plus, Trash2, Layers } from "@/lib/icons";
import { startOfMonth, endOfMonth, format } from "@/lib/date";
import { DashboardLayout } from "@/components/layout/DashboardLayout";
import { AddTransactionDialog } from "@/components/dialogs/AddTransactionDialog";
import { AddEventDialog } from "@/components/dialogs/AddEventDialog";
import { EventDetailsModal } from "@/components/transactions/EventDetailsModal";
import { DateFilter, DateRange } from "@/components/filters/DateFilter";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { Badge } from "@/components/ui/badge";
import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
} from "@/components/ui/alert-dialog";
import { supabase } from "@/integrations/supabase/client";
import { useToast } from "@/hooks/use-toast";
import { cn } from "@/lib/utils";

// ... (Mantenha as interfaces Transaction, Event, DisplayItem iguais ao arquivo original)
interface Transaction {
  id: string;
  description: string;
  amount: number;
  type: "income" | "expense";
  category: string;
  date: string;
  group_id: string | null;
  event_id: string | null;
  group_name?: string;
  is_fixed: boolean;
  is_recurring: boolean;
  recurrence_id: string | null;
  created_by_name?: string; // Adicionado para mostrar quem criou
}

interface Event {
  id: string;
  name: string;
  description: string;
  date: string;
  totalAmount?: number;
}

type DisplayItem = { kind: "transaction"; data: Transaction } | { kind: "event"; data: Event };

const Transactions = () => {
  const [transactions, setTransactions] = useState<Transaction[]>([]);
  const [events, setEvents] = useState<Event[]>([]);
  const [loading, setLoading] = useState(true);

  // Filtros
  const [searchTerm, setSearchTerm] = useState("");
  const [filterType, setFilterType] = useState("all");
  const [filterCategory, setFilterCategory] = useState("all");
  const [filterGroup, setFilterGroup] = useState("all");
  const [dateRange, setDateRange] = useState<DateRange>({
    from: startOfMonth(new Date()),
    to: endOfMonth(new Date()),
  });

  // Modais
  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false);
  const [transactionToDelete, setTransactionToDelete] = useState<Transaction | null>(null);
  const [selectedEvent, setSelectedEvent] = useState<Event | null>(null);

  const { toast } = useToast();

  // Carregamento inicial
  useEffect(() => {
    loadData();
  }, [dateRange]);

  // --- REALTIME SUBSCRIPTION ---
  useEffect(() => {
    const channel = supabase
      .channel("transactions-page-changes")
      .on("postgres_changes", { event: "*", schema: "public", table: "transactions" }, () => {
        loadData(false); // false para nÃ£o mostrar loading spinner
      })
      .on("postgres_changes", { event: "*", schema: "public", table: "events" }, () => {
        loadData(false);
      })
      .subscribe();

    return () => {
      supabase.removeChannel(channel);
    };
  }, [dateRange]);

  const loadData = async (showLoading = true) => {
    if (showLoading) setLoading(true);
    try {
      await Promise.all([loadTransactions(), loadEvents()]);
    } finally {
      setLoading(false);
    }
  };

  const loadTransactions = async () => {
    try {
      // Adicionado profiles!user_id (full_name) para pegar o nome de quem criou
      let query = supabase
        .from("transactions")
        .select(`*, groups!left (name), profiles!user_id (full_name)`)
        .order("date", { ascending: false });

      if (dateRange.from) query = query.gte("date", format(dateRange.from, "yyyy-MM-dd"));
      if (dateRange.to) query = query.lte("date", format(dateRange.to, "yyyy-MM-dd"));

      const { data, error } = await query;

      if (error) throw error;

      const formattedData =
        data?.map((t) => ({
          id: t.id,
          description: t.description,
          amount: Number(t.amount),
          type: t.type as "income" | "expense",
          category: t.category,
          date: t.date,
          group_id: t.group_id,
          event_id: t.event_id,
          group_name: t.groups?.name,
          created_by_name: t.profiles?.full_name, // Nome do criador
          is_fixed: t.is_fixed || false,
          is_recurring: t.is_recurring || false,
          recurrence_id: t.recurrence_id,
        })) || [];

      setTransactions(formattedData);
    } catch (error) {
      console.error("Erro ao carregar transaÃ§Ãµes:", error);
    }
  };

  const loadEvents = async () => {
    try {
      let query = supabase
        .from("events" as any)
        .select("*")
        .order("date", { ascending: false });

      if (dateRange.from) query = query.gte("date", format(dateRange.from, "yyyy-MM-dd"));
      if (dateRange.to) query = query.lte("date", format(dateRange.to, "yyyy-MM-dd"));

      const { data, error } = await query;
      if (error) throw error;

      setEvents(data || []);
    } catch (error) {
      console.error("Erro ao carregar eventos:", error);
    }
  };

  // ... (Mantenha handleDeleteClick, handleDeleteConfirm e updateEventTotals iguais)
  const handleDeleteClick = (transaction: Transaction) => {
    setTransactionToDelete(transaction);
    setDeleteDialogOpen(true);
  };

  const handleDeleteConfirm = async () => {
    if (!transactionToDelete) return;
    try {
      if (transactionToDelete.is_fixed && transactionToDelete.recurrence_id) {
        await supabase.from("transactions").delete().eq("recurrence_id", transactionToDelete.recurrence_id);
      } else {
        await supabase.from("transactions").delete().eq("id", transactionToDelete.id);
      }
      toast({ title: "Sucesso", description: "TransaÃ§Ã£o removida" });
      // O realtime vai cuidar de atualizar, mas podemos forÃ§ar para feedback imediato local
      loadTransactions();
    } catch (error) {
      toast({ title: "Erro", description: "Erro ao remover", variant: "destructive" });
    } finally {
      setDeleteDialogOpen(false);
      setTransactionToDelete(null);
    }
  };

  useEffect(() => {
    if (events.length > 0) {
      updateEventTotals();
    }
  }, [events.length]);

  const updateEventTotals = async () => {
    const eventIds = events.map((e) => e.id);
    if (eventIds.length === 0) return;

    const { data } = await supabase.from("transactions").select("event_id, amount, type").in("event_id", eventIds);

    if (data) {
      setEvents((prev) =>
        prev.map((ev) => {
          const evTrans = data.filter((t) => t.event_id === ev.id);
          const total = evTrans.reduce((acc, t) => acc + (t.type === "income" ? t.amount : -Math.abs(t.amount)), 0);
          return { ...ev, totalAmount: total };
        })
      );
    }
  };

  // ... (Mantenha displayList igual)
  const displayList = useMemo(() => {
    const list: DisplayItem[] = [];
    transactions.forEach((t) => {
      if (!t.event_id) list.push({ kind: "transaction", data: t });
    });
    events.forEach((e) => list.push({ kind: "event", data: e }));

    return list
      .filter((item) => {
        if (item.kind === "transaction") {
          const matchesSearch =
            item.data.description.toLowerCase().includes(searchTerm.toLowerCase()) ||
            item.data.category.toLowerCase().includes(searchTerm.toLowerCase());
          const matchesType = filterType === "all" || item.data.type === filterType;
          const matchesCategory = filterCategory === "all" || item.data.category === filterCategory;
          const matchesGroup =
            filterGroup === "all" || (filterGroup === "none" && !item.data.group_id) || item.data.group_id === filterGroup;
          return matchesSearch && matchesType && matchesCategory && matchesGroup;
        } else {
          return item.data.name.toLowerCase().includes(searchTerm.toLowerCase());
        }
      })
      .sort((a, b) => {
        const dateA = new Date(a.kind === "transaction" ? a.data.date : a.data.date).getTime();
        const dateB = new Date(b.kind === "transaction" ? b.data.date : b.data.date).getTime();
        return dateB - dateA;
      });
  }, [transactions, events, searchTerm, filterType, filterCategory, filterGroup]);

  // --- CÃLCULO DE TOTAIS (CORRIGIDO PARA SUBTRAIR) ---
  const totalIncome = transactions.reduce((acc, t) => {
    if (t.type === "income") return acc + t.amount;
    return acc;
  }, 0);

  const totalExpense = transactions.reduce((acc, t) => {
    if (t.type === "expense") return acc + Math.abs(t.amount);
    return acc;
  }, 0);

  // Aqui estÃ¡ a correÃ§Ã£o principal do saldo da tela de TransaÃ§Ãµes
  const balance = totalIncome - totalExpense;

  const categories = Array.from(new Set(transactions.map((t) => t.category))).filter((cat) => cat && cat.trim() !== "");

  const clearFilters = () => {
    setSearchTerm("");
    setFilterType("all");
    setFilterCategory("all");
    setFilterGroup("all");
  };

  return (
    <DashboardLayout>
      <div className="p-6 space-y-6">
        {/* ... (CabeÃ§alho e Filtros mantidos iguais) ... */}
        <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
          <div>
            <h1 className="text-3xl font-bold text-foreground">TransaÃ§Ãµes</h1>
            <p className="text-muted-foreground">Gerencie suas entradas, saÃ­das e eventos</p>
          </div>
          <div className="flex flex-wrap gap-2">
            <AddEventDialog onSuccess={() => loadData()} />
            <AddTransactionDialog
              type="income"
              onSuccess={() => loadData()}
              trigger={
                <Button variant="outline">
                  <Plus className="h-4 w-4 mr-2" /> Receita
                </Button>
              }
            />
            <AddTransactionDialog
              type="expense"
              onSuccess={() => loadData()}
              trigger={
                <Button>
                  <Plus className="h-4 w-4 mr-2" /> Despesa
                </Button>
              }
            />
          </div>
        </div>

        <Card>
          <CardHeader>
            <CardTitle className="flex items-center gap-2">
              <Filter className="h-5 w-5" /> Filtros
            </CardTitle>
          </CardHeader>
          <CardContent>
            <div className="space-y-4">
              <DateFilter dateRange={dateRange} onDateRangeChange={setDateRange} />
              <div className="grid grid-cols-1 md:grid-cols-5 gap-4">
                <div className="relative">
                  <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground" />
                  <Input placeholder="Buscar..." value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} className="pl-10" />
                </div>
                <Select value={filterType} onValueChange={setFilterType}>
                  <SelectTrigger>
                    <SelectValue placeholder="Tipo" />
                  </SelectTrigger>
                  <SelectContent>
                    <SelectItem value="all">Todos</SelectItem>
                    <SelectItem value="income">Receitas</SelectItem>
                    <SelectItem value="expense">Despesas</SelectItem>
                  </SelectContent>
                </Select>
                <Select value={filterCategory} onValueChange={setFilterCategory}>
                  <SelectTrigger>
                    <SelectValue placeholder="Categoria" />
                  </SelectTrigger>
                  <SelectContent>
                    <SelectItem value="all">Todas</SelectItem>
                    {categories.map((cat) => (
                      <SelectItem key={cat} value={cat}>
                        {cat}
                      </SelectItem>
                    ))}
                  </SelectContent>
                </Select>
                <Select value={filterGroup} onValueChange={setFilterGroup}>
                  <SelectTrigger>
                    <SelectValue placeholder="Grupo" />
                  </SelectTrigger>
                  <SelectContent>
                    <SelectItem value="all">Todos</SelectItem>
                    <SelectItem value="none">Pessoal</SelectItem>
                  </SelectContent>
                </Select>
                <Button variant="outline" onClick={clearFilters}>
                  Limpar
                </Button>
              </div>
            </div>
          </CardContent>
        </Card>

        {/* Cards de Resumo */}
        <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
          <Card>
            <CardHeader className="pb-3">
              <CardTitle className="text-sm font-medium">Total Receitas</CardTitle>
            </CardHeader>
            <CardContent>
              <div className="text-2xl font-bold text-success">
                {totalIncome.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
              </div>
            </CardContent>
          </Card>
          <Card>
            <CardHeader className="pb-3">
              <CardTitle className="text-sm font-medium">Total Despesas</CardTitle>
            </CardHeader>
            <CardContent>
              <div className="text-2xl font-bold text-destructive">
                {totalExpense.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
              </div>
            </CardContent>
          </Card>
          <Card>
            <CardHeader className="pb-3">
              <CardTitle className="text-sm font-medium">Saldo</CardTitle>
            </CardHeader>
            <CardContent>
              <div className={cn("text-2xl font-bold", balance >= 0 ? "text-success" : "text-destructive")}>
                {balance.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
              </div>
            </CardContent>
          </Card>
        </div>

        {/* Lista */}
        <Card>
          <CardHeader>
            <CardTitle>LanÃ§amentos</CardTitle>
          </CardHeader>
          <CardContent>
            {loading ? (
              <div className="flex justify-center py-8">
                <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
              </div>
            ) : displayList.length === 0 ? (
              <div className="text-center py-8 text-muted-foreground">Nenhum lanÃ§amento encontrado</div>
            ) : (
              <div className="space-y-4">
                {displayList.map((item) => {
                  if (item.kind === "event") {
                    const ev = item.data;
                    const total = ev.totalAmount || 0;
                    return (
                      <div
                        key={`event-${ev.id}`}
                        onClick={() => setSelectedEvent(ev)}
                        className="flex items-center justify-between p-4 rounded-lg border bg-accent/5 hover:bg-accent/10 border-l-4 border-l-primary cursor-pointer transition-all"
                      >
                        <div className="flex items-center gap-4">
                          <div className="p-2 rounded-full bg-primary/20 text-primary">
                            <Layers className="h-5 w-5" />
                          </div>
                          <div>
                            <div className="flex items-center gap-2">
                              <p className="font-bold text-primary">{ev.name}</p>
                              <Badge className="bg-primary text-primary-foreground hover:bg-primary/90 text-[10px]">Evento</Badge>
                            </div>
                            <span className="text-xs text-muted-foreground">
                              {new Date(ev.date).toLocaleDateString("pt-BR")} â€¢ Clique para ver detalhes
                            </span>
                          </div>
                        </div>
                        <div className="flex items-center gap-2">
                          <p className={cn("font-semibold text-lg", total >= 0 ? "text-success" : "text-destructive")}>
                            {total.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                          </p>
                        </div>
                      </div>
                    );
                  } else {
                    const transaction = item.data;
                    return (
                      <div
                        key={transaction.id}
                        className="flex items-center justify-between p-4 rounded-lg border hover:bg-accent/50 transition-colors"
                      >
                        <div className="flex items-center gap-4">
                          <div
                            className={cn(
                              "p-2 rounded-full",
                              transaction.type === "income" ? "bg-success/10 text-success" : "bg-destructive/10 text-destructive"
                            )}
                          >
                            {transaction.type === "income" ? (
                              <ArrowUpCircle className="h-5 w-5" />
                            ) : (
                              <ArrowDownCircle className="h-5 w-5" />
                            )}
                          </div>
                          <div>
                            <div className="flex items-center gap-2">
                              <p className="font-medium">{transaction.description}</p>
                              {transaction.is_fixed && (
                                <Badge variant="outline" className="text-xs">
                                  Fixo
                                </Badge>
                              )}
                              {transaction.is_recurring && !transaction.is_fixed && (
                                <Badge variant="outline" className="text-xs">
                                  Recorrente
                                </Badge>
                              )}
                            </div>
                            <div className="flex items-center gap-2 mt-1">
                              <Badge variant="secondary" className="text-xs">
                                {transaction.category}
                              </Badge>
                              {transaction.group_name && (
                                <Badge variant="outline" className="text-xs">
                                  {transaction.group_name}
                                </Badge>
                              )}
                              <span className="text-xs text-muted-foreground">
                                {new Date(transaction.date).toLocaleDateString("pt-BR")}
                              </span>
                              {transaction.created_by_name && (
                                <span className="text-[10px] text-muted-foreground italic">
                                  â€¢ Por: {transaction.created_by_name.split(" ")[0]}
                                </span>
                              )}
                            </div>
                          </div>
                        </div>
                        <div className="flex items-center gap-2">
                          <p className={cn("font-semibold text-lg", transaction.type === "income" ? "text-success" : "text-destructive")}>
                            {transaction.type === "income" ? "+" : "-"}
                            {Math.abs(transaction.amount).toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                          </p>
                          <Button
                            variant="ghost"
                            size="icon"
                            onClick={() => handleDeleteClick(transaction)}
                            className="text-destructive hover:bg-destructive/10"
                          >
                            <Trash2 className="h-4 w-4" />
                          </Button>
                        </div>
                      </div>
                    );
                  }
                })}
              </div>
            )}
          </CardContent>
        </Card>

        {/* Modais (Delete e Event) mantidos iguais */}
        <AlertDialog open={deleteDialogOpen} onOpenChange={setDeleteDialogOpen}>
          <AlertDialogContent>
            <AlertDialogHeader>
              <AlertDialogTitle>Confirmar exclusÃ£o</AlertDialogTitle>
              <AlertDialogDescription>Tem certeza que deseja remover esta transaÃ§Ã£o?</AlertDialogDescription>
            </AlertDialogHeader>
            <AlertDialogFooter>
              <AlertDialogCancel>Cancelar</AlertDialogCancel>
              <AlertDialogAction onClick={handleDeleteConfirm} className="bg-destructive hover:bg-destructive/90">
                Remover
              </AlertDialogAction>
            </AlertDialogFooter>
          </AlertDialogContent>
        </AlertDialog>

        {selectedEvent && (
          <EventDetailsModal
            isOpen={!!selectedEvent}
            onClose={() => setSelectedEvent(null)}
            eventId={selectedEvent.id}
            eventName={selectedEvent.name}
            eventDate={selectedEvent.date}
            onUpdate={() => {
              loadData(false);
              updateEventTotals();
            }}
          />
        )}
      </div>
    </DashboardLayout>
  );
};

export default Transactions;

----------------------------------------
ENDOFFILE: src\pages\Transactions.tsx

STARTOFFILE: src\sw.ts
----------------------------------------
import { precacheAndRoute } from "workbox-precaching";
import { registerRoute } from "workbox-routing";
import { CacheFirst, NetworkFirst } from "workbox-strategies";
import { ExpirationPlugin } from "workbox-expiration";
import { CacheableResponsePlugin } from "workbox-cacheable-response";

declare const self: ServiceWorkerGlobalScope;

precacheAndRoute(self.__WB_MANIFEST);

registerRoute(
  ({ url }) => url.origin === "https://fonts.googleapis.com",
  new CacheFirst({
    cacheName: "google-fonts-stylesheets",
    plugins: [
      new ExpirationPlugin({
        maxEntries: 10,
        maxAgeSeconds: 60 * 60 * 24 * 365,
      }),
    ],
  })
);

registerRoute(
  ({ url }) => url.origin === "https://fonts.gstatic.com",
  new CacheFirst({
    cacheName: "google-fonts-webfonts",
    plugins: [
      new CacheableResponsePlugin({
        statuses: [0, 200],
      }),
      new ExpirationPlugin({
        maxEntries: 30,
        maxAgeSeconds: 60 * 60 * 24 * 365,
      }),
    ],
  })
);

registerRoute(
  ({ url }) => url.hostname.includes("supabase.co"),
  new NetworkFirst({
    cacheName: "supabase-api",
    networkTimeoutSeconds: 10,
    plugins: [
      new CacheableResponsePlugin({
        statuses: [0, 200],
      }),
      new ExpirationPlugin({
        maxEntries: 50,
        maxAgeSeconds: 60 * 5,
      }),
    ],
  })
);

self.addEventListener("push", (event) => {
  if (!event.data) {
    return;
  }

  let data;
  try {
    data = event.data.json();
  } catch (error) {
    data = {
      title: event.data.text(),
      body: "",
    };
  }

  const title = data.title || "Zeni Wallet";
  const options = {
    body: data.body || "",
    icon: "/icons/icon-192x192.png",
    badge: "/icons/badge-96x96.png",
    tag: data.tag || "notification",
    requireInteraction: data.requireInteraction !== false,
    actions: data.actions || [
      {
        action: "view",
        title: "Ver",
      },
      {
        action: "dismiss",
        title: "Dispensar",
      },
    ],
    data: {
      url: data.url || "/",
      ...data.data,
    },
  };

  if (data.vibrate) {
    options.vibrate = data.vibrate;
  }

  event.waitUntil(self.registration.showNotification(title, options));
});

self.addEventListener("notificationclick", (event) => {
  event.notification.close();

  const action = event.action;
  const data = event.notification.data;

  if (action === "dismiss") {
    return;
  }

  const urlToOpen = action === "view" && data.url ? data.url : "/";

  event.waitUntil(
    self.clients
      .matchAll({
        type: "window",
        includeUncontrolled: true,
      })
      .then((clientList) => {
        for (const client of clientList) {
          if (client.url === urlToOpen && "focus" in client) {
            return client.focus();
          }
        }
        if (self.clients.openWindow) {
          return self.clients.openWindow(urlToOpen);
        }
      })
  );
});

self.addEventListener("notificationclose", (event) => {
  console.log("Notification closed:", event.notification.tag);
});

self.addEventListener("install", (event) => {
  console.log("Service Worker installing...");
  self.skipWaiting();
});

self.addEventListener("activate", (event) => {
  console.log("Service Worker activating...");
  event.waitUntil(self.clients.claim());
});

----------------------------------------
ENDOFFILE: src\sw.ts

STARTOFFILE: src\utils\date\dateutils.ts
----------------------------------------
export const formatDateForInput = (date: Date | string): string => {
  const d = typeof date === "string" ? new Date(date) : date;
  const year = d.getFullYear();
  const month = String(d.getMonth() + 1).padStart(2, "0");
  const day = String(d.getDate()).padStart(2, "0");
  return `${year}-${month}-${day}`;
};

export const formatDateTimeForInput = (date: Date | string): string => {
  const d = typeof date === "string" ? new Date(date) : date;
  const year = d.getFullYear();
  const month = String(d.getMonth() + 1).padStart(2, "0");
  const day = String(d.getDate()).padStart(2, "0");
  const hours = String(d.getHours()).padStart(2, "0");
  const minutes = String(d.getMinutes()).padStart(2, "0");
  return `${year}-${month}-${day}T${hours}:${minutes}`;
};

export const parseDateFromInput = (dateString: string): Date => {
  const [year, month, day] = dateString.split("-").map(Number);
  return new Date(year, month - 1, day, 0, 0, 0, 0);
};

export const parseDateTimeFromInput = (dateTimeString: string): Date => {
  const date = new Date(dateTimeString);
  return date;
};

export const formatDateForDatabase = (date: Date | string): string => {
  if (typeof date === "string") {
    if (date.includes("T")) {
      const d = new Date(date);
      return formatDateForInput(d);
    }
    return date;
  }
  return formatDateForInput(date);
};

export const formatDateTimeForDatabase = (dateTimeString: string): string => {
  if (!dateTimeString) return "";

  const parts = dateTimeString.split("T");
  if (parts.length !== 2) return dateTimeString;

  const [datePart, timePart] = parts;
  const [year, month, day] = datePart.split("-");
  const [hours, minutes] = timePart.split(":");

  const localDate = new Date(parseInt(year), parseInt(month) - 1, parseInt(day), parseInt(hours), parseInt(minutes), 0, 0);

  return localDate.toISOString();
};

export const compareDates = (date1: Date | string, date2: Date | string): number => {
  const d1 = typeof date1 === "string" ? new Date(date1) : date1;
  const d2 = typeof date2 === "string" ? new Date(date2) : date2;
  return d1.getTime() - d2.getTime();
};

export const isDateInPast = (date: Date | string): boolean => {
  const d = typeof date === "string" ? new Date(date) : date;
  return d.getTime() < new Date().getTime();
};

export const addMinutesToDate = (date: Date | string, minutes: number): Date => {
  const d = typeof date === "string" ? new Date(date) : date;
  return new Date(d.getTime() + minutes * 60000);
};

----------------------------------------
ENDOFFILE: src\utils\date\dateutils.ts

STARTOFFILE: src\utils\investments\investmentUtils.ts
----------------------------------------
// src/utils/investmentUtils.ts
import { supabase } from "@/integrations/supabase/client";

export const recalculateGoalBalance = async (goalId: string) => {
  try {
    // 1. Busca todos os investimentos (ativos e retiradas) vinculados a esta meta
    const { data: investments, error } = await supabase.from("investments").select("current_value").eq("goal_id", goalId);

    if (error) throw error;

    // 2. Soma tudo (valores negativos de retiradas serÃ£o subtraÃ­dos automaticamente)
    const totalBalance = investments?.reduce((acc, inv) => acc + Number(inv.current_value), 0) || 0;

    // 3. Atualiza a meta com o valor real calculado
    const { error: updateError } = await supabase.from("investment_goals").update({ current_amount: totalBalance }).eq("id", goalId);

    if (updateError) throw updateError;

    return totalBalance;
  } catch (error) {
    console.error("Erro ao sincronizar saldo da meta:", error);
  }
};

----------------------------------------
ENDOFFILE: src\utils\investments\investmentUtils.ts

STARTOFFILE: src\utils\security\constants.ts
----------------------------------------
export const SECURITY_LIMITS = {
  MAX_STRING_LENGTH: 5000,
  MAX_DESCRIPTION_LENGTH: 1000,
  MAX_NAME_LENGTH: 255,
  MAX_AMOUNT: 999999999.99,
  MIN_AMOUNT: -999999999.99,
  MAX_QUANTITY: 999999999,
  MIN_QUANTITY: 0,
  MAX_RECURRENCE_COUNT: 120,
  MIN_RECURRENCE_COUNT: 1,
} as const;

export const ALLOWED_TRANSACTION_TYPES = ['income', 'expense'] as const;

export const ALLOWED_INVESTMENT_TYPES = [
  'AÃ§Ãµes',
  'FIIs',
  'Renda Fixa',
  'Tesouro Direto',
  'CDB',
  'LCI/LCA',
  'Criptomoedas',
  'Outro'
] as const;

export const ALLOWED_CATEGORIES = [
  'AlimentaÃ§Ã£o',
  'Transporte',
  'Moradia',
  'SaÃºde',
  'EducaÃ§Ã£o',
  'Lazer',
  'Compras',
  'ServiÃ§os',
  'Investimentos',
  'Outros'
] as const;

export const REGEX_PATTERNS = {
  EMAIL: /^[^\s@]+@[^\s@]+\.[^\s@]+$/,
  UUID: /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i,
  DATE: /^\d{4}-\d{2}-\d{2}$/,
  NUMERIC: /^-?\d+\.?\d*$/,
  ALPHANUMERIC: /^[a-zA-Z0-9\s\-_]+$/,
  HEX_COLOR: /^#[0-9A-Fa-f]{6}$/,
} as const;

export const SQL_INJECTION_PATTERNS = [
  /(\bSELECT\b|\bINSERT\b|\bUPDATE\b|\bDELETE\b|\bDROP\b|\bCREATE\b|\bALTER\b)/i,
  /(--|\|\|)/,
  /(\bOR\b|\bAND\b)\s+[\d'"]+=[\d'"]+/i,
  /\bEXEC\b|\bEXECUTE\b/i,
  /;.*DROP/i,
] as const;

export const XSS_PATTERNS = [
  /<script[^>]*>.*?<\/script>/gi,
  /javascript:/gi,
  /on\w+\s*=/gi,
  /<iframe/gi,
  /<object/gi,
  /<embed/gi,
] as const;

export const RATE_LIMIT_CONFIG = {
  MAX_REQUESTS_PER_MINUTE: 60,
  MAX_REQUESTS_PER_HOUR: 1000,
  WINDOW_MS: 60000,
} as const;

----------------------------------------
ENDOFFILE: src\utils\security\constants.ts

STARTOFFILE: src\utils\security\index.ts
----------------------------------------
export * from './constants';
export * from './sanitize';
export * from './validate';
export * from './permissions';
export * from './rateLimiter';
export * from './types';

export { useSanitizedForm } from '@/hooks/useSanitizedForm';

----------------------------------------
ENDOFFILE: src\utils\security\index.ts

STARTOFFILE: src\utils\security\permissions.ts
----------------------------------------
import { supabase } from '@/integrations/supabase/client';

import type { PermissionContext } from './types';

export const checkIsResourceOwner = (userId: string, resourceOwnerId: string): boolean => {
  return userId === resourceOwnerId;
};

export const checkGroupMembership = async (userId: string, groupId: string): Promise<boolean> => {
if (!groupId || groupId === "undefined" || groupId === "personal" || groupId === "none") {
    return false;
  }

  try {
    const { data, error } = await supabase
      .from('group_members')
      .select('id')
      .eq('user_id', userId)
      .eq('group_id', groupId)
      .maybeSingle(); // Use maybeSingle para nÃ£o gerar erro no console se nÃ£o encontrar

    if (error || !data) {
      return false;
    }

    return true;
  } catch {
    return false;
  }
};

export const checkGroupAdmin = async (userId: string, groupId: string): Promise<boolean> => {
  try {
    const { data: groupData, error: groupError } = await supabase
      .from('groups')
      .select('created_by')
      .eq('id', groupId)
      .single();

    if (groupError || !groupData) {
      return false;
    }

    if (groupData.created_by === userId) {
      return true;
    }

    const { data: memberData, error: memberError } = await supabase
      .from('group_members')
      .select('is_admin')
      .eq('user_id', userId)
      .eq('group_id', groupId)
      .single();

    if (memberError || !memberData) {
      return false;
    }

    return memberData.is_admin || false;
  } catch {
    return false;
  }
};

export const checkCanViewTransaction = async (context: PermissionContext): Promise<boolean> => {
  if (context.resourceOwnerId === context.userId) {
    return true;
  }

  if (context.groupId) {
    return checkGroupMembership(context.userId, context.groupId);
  }

  return false;
};

export const checkCanEditTransaction = async (context: PermissionContext): Promise<boolean> => {
  if (context.resourceOwnerId === context.userId) {
    return true;
  }

  if (context.groupId && context.isGroupAdmin !== undefined) {
    return context.isGroupAdmin;
  }

  if (context.groupId) {
    return checkGroupAdmin(context.userId, context.groupId);
  }

  return false;
};

export const checkCanDeleteTransaction = async (context: PermissionContext): Promise<boolean> => {
  return checkCanEditTransaction(context);
};

export const checkCanViewInvestment = async (context: PermissionContext): Promise<boolean> => {
  if (context.resourceOwnerId === context.userId) {
    return true;
  }

  if (context.groupId) {
    return checkGroupMembership(context.userId, context.groupId);
  }

  return false;
};

export const checkCanEditInvestment = async (context: PermissionContext): Promise<boolean> => {
  if (context.resourceOwnerId === context.userId) {
    return true;
  }

  if (context.groupId && context.isGroupAdmin !== undefined) {
    return context.isGroupAdmin;
  }

  if (context.groupId) {
    return checkGroupAdmin(context.userId, context.groupId);
  }

  return false;
};

export const checkCanDeleteInvestment = async (context: PermissionContext): Promise<boolean> => {
  return checkCanEditInvestment(context);
};

export const checkCanViewGroup = async (userId: string, groupId: string): Promise<boolean> => {
  return checkGroupMembership(userId, groupId);
};

export const checkCanEditGroup = async (userId: string, groupId: string): Promise<boolean> => {
  return checkGroupAdmin(userId, groupId);
};

export const checkCanDeleteGroup = async (userId: string, groupId: string): Promise<boolean> => {
  try {
    const { data, error } = await supabase
      .from('groups')
      .select('created_by')
      .eq('id', groupId)
      .single();

    if (error || !data) {
      return false;
    }

    return data.created_by === userId;
  } catch {
    return false;
  }
};

export const checkCanAddGroupMember = async (userId: string, groupId: string): Promise<boolean> => {
  return checkGroupAdmin(userId, groupId);
};

export const checkCanRemoveGroupMember = async (userId: string, groupId: string, targetUserId: string): Promise<boolean> => {
  if (userId === targetUserId) {
    return true;
  }

  return checkGroupAdmin(userId, groupId);
};

export const getCurrentUser = async (): Promise<string | null> => {
  try {
    const { data: { user } } = await supabase.auth.getUser();
    return user?.id || null;
  } catch {
    return null;
  }
};

export const ensureAuthenticated = async (): Promise<string> => {
  const userId = await getCurrentUser();
  
  if (!userId) {
    throw new Error('UsuÃ¡rio nÃ£o autenticado');
  }

  return userId;
};

export const withPermissionCheck = async <T>(
  permissionCheck: () => Promise<boolean>,
  action: () => Promise<T>,
  errorMessage: string = 'Sem permissÃ£o para realizar esta aÃ§Ã£o'
): Promise<T> => {
  const hasPermission = await permissionCheck();

  if (!hasPermission) {
    throw new Error(errorMessage);
  }

  return action();
};

----------------------------------------
ENDOFFILE: src\utils\security\permissions.ts

STARTOFFILE: src\utils\security\rateLimiter.ts
----------------------------------------
import { RATE_LIMIT_CONFIG } from './constants';

import type { RateLimitEntry } from './types';

class RateLimiter {
  private requests: Map<string, RateLimitEntry> = new Map();
  private cleanupInterval: NodeJS.Timeout | null = null;

  constructor() {
    this.startCleanup();
  }

  private startCleanup(): void {
    this.cleanupInterval = setInterval(() => {
      this.cleanup();
    }, RATE_LIMIT_CONFIG.WINDOW_MS);
  }

  private cleanup(): void {
    const now = Date.now();
    const expiredKeys: string[] = [];

    this.requests.forEach((entry, key) => {
      if (now - entry.lastRequest > RATE_LIMIT_CONFIG.WINDOW_MS * 2) {
        expiredKeys.push(key);
      }
    });

    expiredKeys.forEach(key => this.requests.delete(key));
  }

  public checkLimit(identifier: string, maxRequests: number = RATE_LIMIT_CONFIG.MAX_REQUESTS_PER_MINUTE): boolean {
    const now = Date.now();
    const entry = this.requests.get(identifier);

    if (!entry) {
      this.requests.set(identifier, {
        count: 1,
        firstRequest: now,
        lastRequest: now,
      });
      return true;
    }

    const timeWindow = now - entry.firstRequest;

    if (timeWindow > RATE_LIMIT_CONFIG.WINDOW_MS) {
      this.requests.set(identifier, {
        count: 1,
        firstRequest: now,
        lastRequest: now,
      });
      return true;
    }

    if (entry.count >= maxRequests) {
      return false;
    }

    entry.count += 1;
    entry.lastRequest = now;
    this.requests.set(identifier, entry);

    return true;
  }

  public getRemainingRequests(identifier: string, maxRequests: number = RATE_LIMIT_CONFIG.MAX_REQUESTS_PER_MINUTE): number {
    const entry = this.requests.get(identifier);

    if (!entry) {
      return maxRequests;
    }

    const now = Date.now();
    const timeWindow = now - entry.firstRequest;

    if (timeWindow > RATE_LIMIT_CONFIG.WINDOW_MS) {
      return maxRequests;
    }

    return Math.max(0, maxRequests - entry.count);
  }

  public getResetTime(identifier: string): number {
    const entry = this.requests.get(identifier);

    if (!entry) {
      return 0;
    }

    return entry.firstRequest + RATE_LIMIT_CONFIG.WINDOW_MS;
  }

  public reset(identifier: string): void {
    this.requests.delete(identifier);
  }

  public destroy(): void {
    if (this.cleanupInterval) {
      clearInterval(this.cleanupInterval);
      this.cleanupInterval = null;
    }
    this.requests.clear();
  }
}

export const rateLimiter = new RateLimiter();

export const checkRateLimit = (
  identifier: string,
  maxRequests?: number
): { allowed: boolean; remaining: number; resetAt: number } => {
  const allowed = rateLimiter.checkLimit(identifier, maxRequests);
  const remaining = rateLimiter.getRemainingRequests(identifier, maxRequests);
  const resetAt = rateLimiter.getResetTime(identifier);

  return { allowed, remaining, resetAt };
};

export const withRateLimit = async <T>(
  identifier: string,
  fn: () => Promise<T>,
  maxRequests?: number
): Promise<T> => {
  const { allowed, resetAt } = checkRateLimit(identifier, maxRequests);

  if (!allowed) {
    const waitTime = Math.ceil((resetAt - Date.now()) / 1000);
    throw new Error(`Limite de requisiÃ§Ãµes excedido. Tente novamente em ${waitTime} segundos.`);
  }

  return fn();
};

export const createUserRateLimiter = (userId: string) => {
  return {
    check: (action: string, maxRequests?: number) => {
      const identifier = `${userId}:${action}`;
      return checkRateLimit(identifier, maxRequests);
    },
    wrap: async <T>(action: string, fn: () => Promise<T>, maxRequests?: number): Promise<T> => {
      const identifier = `${userId}:${action}`;
      return withRateLimit(identifier, fn, maxRequests);
    },
  };
};

----------------------------------------
ENDOFFILE: src\utils\security\rateLimiter.ts

STARTOFFILE: src\utils\security\sanitize.ts
----------------------------------------
import DOMPurify from "dompurify";

import { SECURITY_LIMITS, SQL_INJECTION_PATTERNS, XSS_PATTERNS } from "./constants";

export const sanitizeString = (input: string, maxLength: number = SECURITY_LIMITS.MAX_STRING_LENGTH): string => {
  if (typeof input !== "string") {
    return "";
  }

  let sanitized = input.trim();

  sanitized = sanitized.slice(0, maxLength);

  sanitized = sanitized.replace(/[\x00-\x08\x0B-\x0C\x0E-\x1F\x7F]/g, "");

  return sanitized;
};

export const sanitizeHTML = (input: string): string => {
  if (typeof input !== "string") {
    return "";
  }

  return DOMPurify.sanitize(input, {
    ALLOWED_TAGS: [],
    ALLOWED_ATTR: [],
    KEEP_CONTENT: true,
  });
};

export const sanitizeNumber = (input: string | number): number => {
  const parsed = typeof input === "string" ? parseFloat(input) : input;

  if (isNaN(parsed) || !isFinite(parsed)) {
    return 0;
  }

  return parsed;
};

export const sanitizeAmount = (input: string | number): number => {
  const amount = sanitizeNumber(input);

  if (amount > SECURITY_LIMITS.MAX_AMOUNT) {
    return SECURITY_LIMITS.MAX_AMOUNT;
  }

  if (amount < SECURITY_LIMITS.MIN_AMOUNT) {
    return SECURITY_LIMITS.MIN_AMOUNT;
  }

  return Math.round(amount * 100) / 100;
};

export const sanitizeInteger = (input: string | number, min: number = 0, max: number = Number.MAX_SAFE_INTEGER): number => {
  const parsed = typeof input === "string" ? parseInt(input, 10) : Math.floor(input);

  if (isNaN(parsed) || !isFinite(parsed)) {
    return min;
  }

  if (parsed < min) {
    return min;
  }

  if (parsed > max) {
    return max;
  }

  return parsed;
};

export const detectSQLInjection = (input: string): boolean => {
  return SQL_INJECTION_PATTERNS.some((pattern) => pattern.test(input));
};

export const detectXSS = (input: string): boolean => {
  return XSS_PATTERNS.some((pattern) => pattern.test(input));
};

export const sanitizeInput = (input: string, maxLength?: number): string => {
  const cleaned = sanitizeString(input, maxLength);
  const htmlSafe = sanitizeHTML(cleaned);

  if (detectSQLInjection(htmlSafe) || detectXSS(htmlSafe)) {
    return "";
  }

  return htmlSafe;
};

export const sanitizeObject = <T extends Record<string, any>>(obj: T, sanitizers: Partial<Record<keyof T, (value: any) => any>>): T => {
  const sanitized = { ...obj };

  for (const key in sanitizers) {
    if (key in sanitized) {
      const sanitizer = sanitizers[key];
      if (sanitizer) {
        sanitized[key] = sanitizer(sanitized[key]);
      }
    }
  }

  return sanitized;
};

export const sanitizeArray = <T>(arr: T[], itemSanitizer: (item: T) => T, maxLength: number = 1000): T[] => {
  if (!Array.isArray(arr)) {
    return [];
  }

  return arr.slice(0, maxLength).map(itemSanitizer);
};

export const sanitizeUUID = (input: string): string | null => {
  const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;

  if (typeof input === "string" && uuidRegex.test(input.trim())) {
    return input.trim().toLowerCase();
  }

  return null;
};

export const sanitizeDate = (input: string | Date | null): string | null => {
  if (!input) return null;

  try {
    let dateStr: string;

    if (typeof input === "string") {
      if (/^\d{4}-\d{2}-\d{2}$/.test(input)) {
        return input;
      }
      dateStr = input;
    } else {
      const year = input.getFullYear();
      const month = String(input.getMonth() + 1).padStart(2, "0");
      const day = String(input.getDate()).padStart(2, "0");
      dateStr = `${year}-${month}-${day}`;
    }

    const [year, month, day] = dateStr.split("T")[0].split("-").map(Number);

    if (year < 1900 || year > 2100) {
      return null;
    }

    if (month < 1 || month > 12 || day < 1 || day > 31) {
      return null;
    }

    return `${year}-${String(month).padStart(2, "0")}-${String(day).padStart(2, "0")}`;
  } catch {
    return null;
  }
};

export const sanitizeEmail = (email: string): string | null => {
  const cleaned = sanitizeString(email, 320).toLowerCase();
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

  if (emailRegex.test(cleaned)) {
    return cleaned;
  }

  return null;
};

export const sanitizeColor = (color: string): string | null => {
  const cleaned = sanitizeString(color, 7);
  const hexRegex = /^#[0-9A-Fa-f]{6}$/;

  if (hexRegex.test(cleaned)) {
    return cleaned.toUpperCase();
  }

  return null;
};

export const escapeRegExp = (string: string): string => {
  return string.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
};

----------------------------------------
ENDOFFILE: src\utils\security\sanitize.ts

STARTOFFILE: src\utils\security\types.ts
----------------------------------------
export interface ValidationResult {
  isValid: boolean;
  error: string | null;
}

export interface TransactionData {
  description: string;
  amount: number;
  type: "income" | "expense";
  category: string;
  date: string;
  group_id?: string | null;
  user_id?: string | null;
  is_recurring?: boolean;
  is_fixed?: boolean;
  recurrence_count?: number | null;
  recurrence_id?: string | null;
  event_id?: string | null; // Adicionado
}

export interface InvestmentData {
  name: string;
  type: string;
  amount: number;
  current_value?: number;
  quantity?: number | null;
  unit_price?: number | null;
  group_id?: string | null;
  user_id?: string | null;
  maturity_date?: string | null;
}

export interface GroupData {
  name: string;
  description?: string | null;
  color?: string | null;
  created_by?: string | null;
}

export interface EventData {
  name: string;
  description?: string | null;
  date: string;
}

export interface RateLimitEntry {
  count: number;
  firstRequest: number;
  lastRequest: number;
}

export interface PermissionContext {
  userId: string;
  groupId?: string | null;
  resourceOwnerId?: string | null;
  isGroupAdmin?: boolean;
}

export interface SanitizeConfig {
  maxLength?: number;
  allowHTML?: boolean;
  trim?: boolean;
}

export type SanitizerFunction<T = any> = (value: T) => T;

export type ValidatorFunction<T = any> = (value: T) => ValidationResult;

----------------------------------------
ENDOFFILE: src\utils\security\types.ts

STARTOFFILE: src\utils\security\validate.ts
----------------------------------------
import {
  SECURITY_LIMITS,
  ALLOWED_TRANSACTION_TYPES,
  ALLOWED_INVESTMENT_TYPES,
  ALLOWED_CATEGORIES,
  REGEX_PATTERNS,
} from './constants';

import type { ValidationResult, TransactionData, InvestmentData, GroupData } from './types';

export const createValidationResult = (isValid: boolean, error?: string): ValidationResult => ({
  isValid,
  error: error || null,
});

export const validateString = (
  value: string,
  fieldName: string,
  minLength: number = 1,
  maxLength: number = SECURITY_LIMITS.MAX_STRING_LENGTH
): ValidationResult => {
  if (typeof value !== 'string') {
    return createValidationResult(false, `${fieldName} deve ser uma string`);
  }

  const trimmed = value.trim();

  if (trimmed.length < minLength) {
    return createValidationResult(false, `${fieldName} deve ter no mÃ­nimo ${minLength} caracteres`);
  }

  if (trimmed.length > maxLength) {
    return createValidationResult(false, `${fieldName} deve ter no mÃ¡ximo ${maxLength} caracteres`);
  }

  return createValidationResult(true);
};

export const validateNumber = (
  value: number,
  fieldName: string,
  min?: number,
  max?: number
): ValidationResult => {
  if (typeof value !== 'number' || isNaN(value) || !isFinite(value)) {
    return createValidationResult(false, `${fieldName} deve ser um nÃºmero vÃ¡lido`);
  }

  if (min !== undefined && value < min) {
    return createValidationResult(false, `${fieldName} deve ser no mÃ­nimo ${min}`);
  }

  if (max !== undefined && value > max) {
    return createValidationResult(false, `${fieldName} deve ser no mÃ¡ximo ${max}`);
  }

  return createValidationResult(true);
};

export const validateAmount = (amount: number): ValidationResult => {
  return validateNumber(
    amount,
    'Valor',
    SECURITY_LIMITS.MIN_AMOUNT,
    SECURITY_LIMITS.MAX_AMOUNT
  );
};

export const validateUUID = (uuid: string, fieldName: string = 'ID'): ValidationResult => {
  if (!REGEX_PATTERNS.UUID.test(uuid)) {
    return createValidationResult(false, `${fieldName} invÃ¡lido`);
  }

  return createValidationResult(true);
};

export const validateDate = (date: string, fieldName: string = 'Data'): ValidationResult => {
  if (!REGEX_PATTERNS.DATE.test(date)) {
    return createValidationResult(false, `${fieldName} deve estar no formato YYYY-MM-DD`);
  }

  const parsedDate = new Date(date);
  if (isNaN(parsedDate.getTime())) {
    return createValidationResult(false, `${fieldName} invÃ¡lida`);
  }

  const year = parsedDate.getFullYear();
  if (year < 1900 || year > 2100) {
    return createValidationResult(false, `${fieldName} fora do intervalo permitido (1900-2100)`);
  }

  return createValidationResult(true);
};

export const validateEmail = (email: string): ValidationResult => {
  if (!REGEX_PATTERNS.EMAIL.test(email)) {
    return createValidationResult(false, 'Email invÃ¡lido');
  }

  return createValidationResult(true);
};

export const validateEnum = <T extends readonly string[]>(
  value: string,
  allowedValues: T,
  fieldName: string
): ValidationResult => {
  if (!allowedValues.includes(value as T[number])) {
    return createValidationResult(false, `${fieldName} invÃ¡lido`);
  }

  return createValidationResult(true);
};

export const validateTransactionType = (type: string): ValidationResult => {
  return validateEnum(type, ALLOWED_TRANSACTION_TYPES, 'Tipo de transaÃ§Ã£o');
};

export const validateInvestmentType = (type: string): ValidationResult => {
  return validateEnum(type, ALLOWED_INVESTMENT_TYPES, 'Tipo de investimento');
};

export const validateCategory = (category: string): ValidationResult => {
  return validateEnum(category, ALLOWED_CATEGORIES, 'Categoria');
};

export const validateBoolean = (value: any, fieldName: string): ValidationResult => {
  if (typeof value !== 'boolean') {
    return createValidationResult(false, `${fieldName} deve ser verdadeiro ou falso`);
  }

  return createValidationResult(true);
};

export const validateOptionalUUID = (uuid: string | null | undefined, fieldName: string = 'ID'): ValidationResult => {
  if (!uuid) {
    return createValidationResult(true);
  }

  return validateUUID(uuid, fieldName);
};

export const validateOptionalNumber = (
  value: number | null | undefined,
  fieldName: string,
  min?: number,
  max?: number
): ValidationResult => {
  if (value === null || value === undefined) {
    return createValidationResult(true);
  }

  return validateNumber(value, fieldName, min, max);
};

export const validateTransactionData = (data: Partial<TransactionData>): ValidationResult => {
  const validations = [
    validateString(data.description || '', 'DescriÃ§Ã£o', 1, SECURITY_LIMITS.MAX_DESCRIPTION_LENGTH),
    validateAmount(data.amount || 0),
    validateTransactionType(data.type || ''),
    validateCategory(data.category || ''),
    validateDate(data.date || ''),
    validateOptionalUUID(data.group_id, 'ID do grupo'),
    validateOptionalUUID(data.user_id, 'ID do usuÃ¡rio'),
  ];

  if (data.is_recurring !== undefined) {
    validations.push(validateBoolean(data.is_recurring, 'Ã‰ recorrente'));
  }

  if (data.is_fixed !== undefined) {
    validations.push(validateBoolean(data.is_fixed, 'Ã‰ fixo'));
  }

  if (data.recurrence_count !== undefined && data.recurrence_count !== null) {
    validations.push(
      validateNumber(
        data.recurrence_count,
        'Quantidade de recorrÃªncia',
        SECURITY_LIMITS.MIN_RECURRENCE_COUNT,
        SECURITY_LIMITS.MAX_RECURRENCE_COUNT
      )
    );
  }

  const failed = validations.find(v => !v.isValid);
  return failed || createValidationResult(true);
};

export const validateInvestmentData = (data: Partial<InvestmentData>): ValidationResult => {
  const validations = [
    validateString(data.name || '', 'Nome', 1, SECURITY_LIMITS.MAX_NAME_LENGTH),
    validateInvestmentType(data.type || ''),
    validateAmount(data.amount || 0),
    validateOptionalUUID(data.group_id, 'ID do grupo'),
    validateOptionalUUID(data.user_id, 'ID do usuÃ¡rio'),
  ];

  if (data.quantity !== undefined && data.quantity !== null) {
    validations.push(
      validateNumber(
        data.quantity,
        'Quantidade',
        SECURITY_LIMITS.MIN_QUANTITY,
        SECURITY_LIMITS.MAX_QUANTITY
      )
    );
  }

  if (data.unit_price !== undefined && data.unit_price !== null) {
    validations.push(validateAmount(data.unit_price));
  }

  if (data.maturity_date !== undefined && data.maturity_date !== null) {
    validations.push(validateDate(data.maturity_date, 'Data de vencimento'));
  }

  const failed = validations.find(v => !v.isValid);
  return failed || createValidationResult(true);
};

export const validateGroupData = (data: Partial<GroupData>): ValidationResult => {
  const validations = [
    validateString(data.name || '', 'Nome', 1, SECURITY_LIMITS.MAX_NAME_LENGTH),
    validateOptionalUUID(data.created_by, 'ID do criador'),
  ];

  if (data.description !== undefined && data.description !== null && data.description !== '') {
    validations.push(
      validateString(data.description, 'DescriÃ§Ã£o', 0, SECURITY_LIMITS.MAX_DESCRIPTION_LENGTH)
    );
  }

  if (data.color !== undefined && data.color !== null) {
    if (!REGEX_PATTERNS.HEX_COLOR.test(data.color)) {
      return createValidationResult(false, 'Cor invÃ¡lida (use formato hexadecimal #RRGGBB)');
    }
  }

  const failed = validations.find(v => !v.isValid);
  return failed || createValidationResult(true);
};

export const validateBatch = (results: ValidationResult[]): ValidationResult => {
  const failed = results.find(v => !v.isValid);
  return failed || createValidationResult(true);
};

----------------------------------------
ENDOFFILE: src\utils\security\validate.ts

STARTOFFILE: src\utils\services\pushNotificationService.ts
----------------------------------------
import { supabase } from "@/integrations/supabase/client";
import type { PushSubscription } from "@/utils/types/reminder.types";

const PUBLIC_VAPID_KEY =
  import.meta.env.VITE_VAPID_PUBLIC_KEY || "BETwmgmXXkeAecI8eHXj-kCKkj_0c-qDX3znwN4oCgQUn2QAblyPI3E1Sc3xLgurcNnz12-K8AuUYyTyQLIFXT4";

export class PushNotificationService {
  private static instance: PushNotificationService;
  private registration: ServiceWorkerRegistration | null = null;

  private constructor() {}

  static getInstance(): PushNotificationService {
    if (!PushNotificationService.instance) {
      PushNotificationService.instance = new PushNotificationService();
    }
    return PushNotificationService.instance;
  }

  async initialize(): Promise<boolean> {
    if (!("serviceWorker" in navigator)) {
      console.warn("Service Workers nÃ£o suportados neste navegador");
      return false;
    }

    if (!("PushManager" in window)) {
      console.warn("Push API nÃ£o suportada neste navegador");
      return false;
    }

    try {
      // CORREÃ‡ÃƒO AQUI:
      // Em vez de tentar registrar manualmente com .register("/sw.js"),
      // nÃ³s aguardamos o registro que o VitePWA jÃ¡ fez automaticamente.
      this.registration = await navigator.serviceWorker.ready;

      console.log("Service Worker recuperado e pronto:", this.registration);
      return true;
    } catch (error) {
      console.error("Erro ao obter Service Worker:", error);
      return false;
    }
  }

  async requestPermission(): Promise<NotificationPermission> {
    if (!("Notification" in window)) {
      throw new Error("NotificaÃ§Ãµes nÃ£o suportadas");
    }

    const permission = await Notification.requestPermission();
    console.log("PermissÃ£o de notificaÃ§Ã£o:", permission);
    return permission;
  }

  async getPermissionState(): Promise<NotificationPermission> {
    if (!("Notification" in window)) {
      return "denied";
    }
    return Notification.permission;
  }

  async subscribe(userId: string): Promise<PushSubscription | null> {
    // Garante que estÃ¡ inicializado antes de prosseguir
    if (!this.registration) {
      const initialized = await this.initialize();
      if (!initialized) {
        throw new Error("Falha ao inicializar Service Worker (SW nÃ£o encontrado ou nÃ£o suportado)");
      }
    }

    // VerificaÃ§Ã£o de seguranÃ§a adicional
    if (!this.registration) {
      throw new Error("Service Worker Registration Ã© nulo apÃ³s inicializaÃ§Ã£o.");
    }

    const permission = await this.requestPermission();
    if (permission !== "granted") {
      throw new Error("PermissÃ£o de notificaÃ§Ã£o negada");
    }

    try {
      // Verifica se jÃ¡ existe uma inscriÃ§Ã£o
      let subscription = await this.registration.pushManager.getSubscription();

      // Se nÃ£o existir, cria uma nova
      if (!subscription) {
        subscription = await this.registration.pushManager.subscribe({
          userVisibleOnly: true,
          applicationServerKey: this.urlBase64ToUint8Array(PUBLIC_VAPID_KEY),
        });
      }

      const subscriptionData = {
        user_id: userId,
        endpoint: subscription.endpoint,
        p256dh: this.arrayBufferToBase64(subscription.getKey("p256dh")),
        auth: this.arrayBufferToBase64(subscription.getKey("auth")),
        user_agent: navigator.userAgent,
        is_active: true,
      };

      const { data, error } = await supabase
        .from("push_subscriptions" as any)
        .upsert(subscriptionData, { onConflict: "endpoint" })
        .select()
        .single();

      if (error) throw error;

      console.log("InscriÃ§Ã£o push criada com sucesso");

      await this.showNotification("NotificaÃ§Ãµes Ativadas!", {
        body: "VocÃª receberÃ¡ lembretes mesmo quando nÃ£o estiver usando o aplicativo.",
        icon: "/pwa-192x192.png", // Atualizei o caminho do Ã­cone para garantir que existe
        badge: "/pwa-192x192.png",
      });

      return data;
    } catch (error) {
      console.error("Erro ao criar inscriÃ§Ã£o push:", error);
      throw error;
    }
  }

  async unsubscribe(userId: string): Promise<void> {
    if (!this.registration) {
      return;
    }

    try {
      const subscription = await this.registration.pushManager.getSubscription();
      if (subscription) {
        await subscription.unsubscribe();
      }

      await supabase.from("push_subscriptions").delete().eq("user_id", userId);

      console.log("InscriÃ§Ã£o push cancelada");
    } catch (error) {
      console.error("Erro ao cancelar inscriÃ§Ã£o push:", error);
      throw error;
    }
  }

  async isSubscribed(): Promise<boolean> {
    // Tenta obter o registro sem forÃ§ar inicializaÃ§Ã£o pesada se possÃ­vel
    if (!this.registration) {
      // Tenta pegar o ready sem bloquear muito tempo se jÃ¡ estiver ativo
      const reg = await navigator.serviceWorker.getRegistration();
      if (reg) {
        this.registration = reg;
      } else {
        // Se nÃ£o encontrar, tenta o ready
        return false;
      }
    }

    if (!this.registration) {
      return false;
    }

    const subscription = await this.registration.pushManager.getSubscription();
    return subscription !== null;
  }

  async showNotification(title: string, options?: NotificationOptions): Promise<void> {
    const permission = await this.getPermissionState();
    if (permission !== "granted") {
      console.warn("PermissÃ£o de notificaÃ§Ã£o nÃ£o concedida");
      return;
    }

    if (!this.registration) {
      await this.initialize();
    }

    if (this.registration && this.registration.active) {
      try {
        this.registration.showNotification(title, {
          icon: "/pwa-192x192.png",
          badge: "/pwa-192x192.png",
          vibrate: [200, 100, 200],
          requireInteraction: false,
          ...options,
        });
      } catch (e) {
        console.error("Erro ao exibir notificaÃ§Ã£o via SW:", e);
        this.fallbackNotification(title, options);
      }
    } else {
      this.fallbackNotification(title, options);
    }
  }

  private fallbackNotification(title: string, options?: NotificationOptions) {
    try {
      new Notification(title, {
        icon: "/pwa-192x192.png",
        badge: "/pwa-192x192.png",
        ...options,
      });
    } catch (e) {
      console.error("Erro ao exibir notificaÃ§Ã£o de fallback:", e);
    }
  }

  private urlBase64ToUint8Array(base64String: string): Uint8Array {
    const padding = "=".repeat((4 - (base64String.length % 4)) % 4);
    const base64 = (base64String + padding).replace(/\-/g, "+").replace(/_/g, "/");

    const rawData = window.atob(base64);
    const outputArray = new Uint8Array(rawData.length);

    for (let i = 0; i < rawData.length; ++i) {
      outputArray[i] = rawData.charCodeAt(i);
    }

    return outputArray;
  }

  private arrayBufferToBase64(buffer: ArrayBuffer | null): string {
    if (!buffer) return "";
    const bytes = new Uint8Array(buffer);
    let binary = "";
    for (let i = 0; i < bytes.byteLength; i++) {
      binary += String.fromCharCode(bytes[i]);
    }
    return window.btoa(binary);
  }
}

export const pushNotificationService = PushNotificationService.getInstance();

----------------------------------------
ENDOFFILE: src\utils\services\pushNotificationService.ts

STARTOFFILE: src\utils\services\reminderService.ts
----------------------------------------
import { supabase } from "@/integrations/supabase/client";
import { pushNotificationService } from "@/utils/services/pushNotificationService";

import type { Reminder, ReminderFormData } from "@/utils/types/reminder";

export class ReminderService {
  async createReminder(userId: string, data: ReminderFormData, transactionId?: string): Promise<Reminder> {
    const { data: reminder, error } = await supabase
      .from("reminders")
      .insert({
        user_id: userId,
        transaction_id: transactionId,
        title: data.title,
        description: data.description,
        reminder_date: data.reminder_date,
        repeat_type: data.repeat_type,
      })
      .select()
      .single();

    if (error) throw error;

    return reminder;
  }

  async updateReminder(id: string, data: Partial<ReminderFormData>): Promise<Reminder> {
    const { data: reminder, error } = await supabase
      .from("reminders")
      .update({
        ...data,
        updated_at: new Date().toISOString(),
      })
      .eq("id", id)
      .select()
      .single();

    if (error) throw error;

    return reminder;
  }

  async deleteReminder(id: string): Promise<void> {
    const { error } = await supabase.from("reminders").delete().eq("id", id);
    if (error) throw error;
  }

  async getUserReminders(userId: string, includeCompleted = false): Promise<Reminder[]> {
    let query = supabase.from("reminders").select("*").eq("user_id", userId).order("reminder_date", { ascending: true });
    if (!includeCompleted) {
      query = query.eq("is_completed", false);
    }

    const { data, error } = await query;

    if (error) throw error;

    return data || [];
  }

  async getUpcomingReminders(userId: string, hours = 24): Promise<Reminder[]> {
    const now = new Date();
    const future = new Date(now.getTime() + hours * 60 * 60 * 1000);
    const { data, error } = await supabase
      .from("reminders")
      .select("*")
      .eq("user_id", userId)
      .eq("is_completed", false)
      .gte("reminder_date", now.toISOString())
      .lte("reminder_date", future.toISOString())
      .order("reminder_date", { ascending: true });

    if (error) throw error;

    return data || [];
  }

  async markAsCompleted(id: string): Promise<void> {
    const { error } = await supabase
      .from("reminders")
      .update({
        is_completed: true,
        updated_at: new Date().toISOString(),
      })
      .eq("id", id);
    if (error) throw error;
  }

  async markAsNotified(id: string): Promise<void> {
    const { error } = await supabase
      .from("reminders")
      .update({
        is_notified: true,
        notification_sent_at: new Date().toISOString(),
        updated_at: new Date().toISOString(),
      })
      .eq("id", id);
    if (error) throw error;
  }

  // A funÃ§Ã£o 'sendNotification' nÃ£o Ã© mais necessÃ¡ria no cliente
  // A funÃ§Ã£o 'scheduleReminder' nÃ£o Ã© mais necessÃ¡ria no cliente

  private async createRecurringReminder(reminder: Reminder): Promise<void> {
    const currentDate = new Date(reminder.reminder_date);
    let nextDate: Date;

    switch (reminder.repeat_type) {
      case "daily":
        nextDate = new Date(currentDate.setDate(currentDate.getDate() + 1));
        break;
      case "weekly":
        nextDate = new Date(currentDate.setDate(currentDate.getDate() + 7));
        break;
      case "monthly":
        nextDate = new Date(currentDate.setMonth(currentDate.getMonth() + 1));
        break;
      case "yearly":
        nextDate = new Date(currentDate.setFullYear(currentDate.getFullYear() + 1));
        break;
      default:
        return;
    }

    await this.createReminder(
      reminder.user_id,
      {
        title: reminder.title,
        description: reminder.description,
        reminder_date: nextDate.toISOString(),
        repeat_type: reminder.repeat_type,
      },
      reminder.transaction_id
    );
  }
}

export const reminderService = new ReminderService();

----------------------------------------
ENDOFFILE: src\utils\services\reminderService.ts

STARTOFFILE: src\utils\types\reminder.types.ts
----------------------------------------
export type RepeatType = "none" | "daily" | "weekly" | "monthly" | "yearly";

export interface Reminder {
  id: string;
  user_id: string;
  transaction_id?: string;
  title: string;
  description?: string;
  reminder_date: string;
  is_completed: boolean;
  is_notified: boolean;
  notification_sent_at?: string;
  repeat_type?: RepeatType;
  created_at: string;
  updated_at: string;
}

export interface ReminderFormData {
  title: string;
  description?: string;
  reminder_date: string;
  repeat_type: RepeatType;
}

export interface PushSubscription {
  id: string;
  user_id: string;
  endpoint: string;
  p256dh: string;
  auth: string;
  user_agent?: string;
  is_active: boolean;
  created_at: string;
  updated_at: string;
}

export interface NotificationPermissionState {
  granted: boolean;
  denied: boolean;
  default: boolean;
}

export interface InAppNotification {
  id: string;
  title: string;
  description?: string;
  type: "reminder" | "transaction" | "goal" | "system";
  timestamp: string;
  isRead: boolean;
  actionUrl?: string;
}

----------------------------------------
ENDOFFILE: src\utils\types\reminder.types.ts

STARTOFFILE: src\vite-env.d.ts
----------------------------------------
/// <reference types="vite/client" />

----------------------------------------
ENDOFFILE: src\vite-env.d.ts

STARTOFFILE: supabase\functions\check-reminders\index.ts
----------------------------------------
import { createClient } from "https";
import * as webpush from "web-push";

// Tipos bÃ¡sicos (melhor seria compartilhar com o 'types.ts' do seu app, mas isto funciona)
interface Reminder {
  id: string;
  user_id: string;
  title: string;
  description?: string;
  reminder_date: string;
}
interface Subscription {
  endpoint: string;
  p256dh: string;
  auth: string;
}

// Configurar o web-push com suas chaves VAPID
// IMPORTANTE: Use as mesmas chaves do seu .env (VITE_VAPID_PUBLIC_KEY e VAPID_PRIVATE_KEY)
// VocÃª deve adicionar VAPID_PRIVATE_KEY nas 'secrets' do seu projeto Supabase
// supabase secrets set VAPID_PUBLIC_KEY=SUA_CHAVE_PUBLICA
// supabase secrets set VAPID_PRIVATE_KEY=SUA_CHAVE_PRIVADA
webpush.setVapidDetails(
  "mailto:seu-email@dominio.com", // Adicione seu email
  Deno.env.get("VAPID_PUBLIC_KEY")!,
  Deno.env.get("VAPID_PRIVATE_KEY")!
);

const corsHeaders = {
  "Access-Control-Allow-Origin": "*",
  "Access-Control-Allow-Headers": "authorization, x-client-info, apikey, content-type",
};

Deno.serve(async (req) => {
  // Tratar requisiÃ§Ã£o OPTIONS (CORS)
  if (req.method === "OPTIONS") {
    return new Response("ok", { headers: corsHeaders });
  }

  try {
    const supabaseClient = createClient(
      Deno.env.get("SUPABASE_URL")!,
      Deno.env.get("SUPABASE_SERVICE_ROLE_KEY")! // Use a Service Role Key para rodar no servidor
    );

    const now = new Date().toISOString();

    // 1. Buscar lembretes pendentes
    const { data: reminders, error: remindersError } = await supabaseClient
      .from("reminders")
      .select("*")
      .eq("is_completed", false)
      .eq("is_notified", false)
      .lte("reminder_date", now);

    if (remindersError) throw remindersError;
    if (!reminders || reminders.length === 0) {
      return new Response(JSON.stringify({ message: "Nenhum lembrete pendente." }), {
        headers: { ...corsHeaders, "Content-Type": "application/json" },
        status: 200,
      });
    }

    const notificationsToSend: Promise<any>[] = [];
    const notifiedReminderIds: string[] = [];

    // 2. Para cada lembrete, buscar as inscriÃ§Ãµes (assinaturas) do usuÃ¡rio
    for (const reminder of reminders) {
      const { data: subscriptions, error: subsError } = await supabaseClient
        .from("push_subscriptions")
        .select("endpoint, p256dh, auth")
        .eq("user_id", reminder.user_id)
        .eq("is_active", true);

      if (subsError || !subscriptions) continue;

      for (const sub of subscriptions) {
        const pushSubscription = {
          endpoint: sub.endpoint,
          keys: {
            p256dh: sub.p256dh,
            auth: sub.auth,
          },
        };

        const payload = JSON.stringify({
          title: reminder.title,
          body: reminder.description || "VocÃª tem um novo lembrete.",
          tag: `reminder-${reminder.id}`,
          data: {
            url: "/reminders", // Para onde o usuÃ¡rio vai ao clicar
          },
        });

        // 3. Adicionar o envio da notificaÃ§Ã£o Ã  fila
        notificationsToSend.push(
          webpush.sendNotification(pushSubscription, payload).catch(async (err) => {
            console.error(`Erro ao enviar notificaÃ§Ã£o para ${sub.endpoint}: ${err.message}`);
            // Se a inscriÃ§Ã£o expirou (410 Gone), desativa ela no banco
            if (err.statusCode === 410) {
              await supabaseClient.from("push_subscriptions").update({ is_active: false }).eq("endpoint", sub.endpoint);
            }
          })
        );
      }
      notifiedReminderIds.push(reminder.id);
    }

    // 4. Enviar todas as notificaÃ§Ãµes
    await Promise.all(notificationsToSend);

    // 5. Marcar lembretes como notificados
    if (notifiedReminderIds.length > 0) {
      await supabaseClient
        .from("reminders")
        .update({ is_notified: true, notification_sent_at: new Date().toISOString() })
        .in("id", notifiedReminderIds);
    }

    return new Response(JSON.stringify({ message: `${notificationsToSend.length} notificaÃ§Ãµes enviadas.` }), {
      headers: { ...corsHeaders, "Content-Type": "application/json" },
      status: 200,
    });
  } catch (error) {
    return new Response(JSON.stringify({ error: error.message }), {
      headers: { ...corsHeaders, "Content-Type": "application/json" },
      status: 500,
    });
  }
});

----------------------------------------
ENDOFFILE: supabase\functions\check-reminders\index.ts

STARTOFFILE: supabase\functions\send-invite-email\index.ts
----------------------------------------
import { serve } from "https://deno.land/std@0.168.0/http/server.ts"
import { createClient } from "https://esm.sh/@supabase/supabase-js@2"

const RESEND_API_KEY = Deno.env.get('RESEND_API_KEY')

const corsHeaders = {
  'Access-Control-Allow-Origin': '*',
  'Access-Control-Allow-Headers': 'authorization, x-client-info, apikey, content-type',
}

serve(async (req) => {
  if (req.method === 'OPTIONS') {
    return new Response('ok', { headers: corsHeaders })
  }

  try {
    const supabase = createClient(
      Deno.env.get('SUPABASE_URL') ?? '',
      Deno.env.get('SUPABASE_ANON_KEY') ?? ''
    )

    // Verifica autenticaÃ§Ã£o de quem chamou a funÃ§Ã£o
    const { data: { user }, error: authError } = await supabase.auth.getUser(
      req.headers.get('Authorization')?.replace('Bearer ', '') ?? ''
    )

    if (authError || !user) {
      return new Response(JSON.stringify({ error: 'Unauthorized' }), { status: 401, headers: corsHeaders })
    }

    const { email, link, groupName } = await req.json()

    // Chama API de Email (Exemplo com Resend)
    const res = await fetch('https://api.resend.com/emails', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${RESEND_API_KEY}`
      },
      body: JSON.stringify({
        from: 'Zeni Wallet <noreply@seu-dominio.com>',
        to: [email],
        subject: `Convite para participar do grupo ${groupName}`,
        html: `
          <h1>VocÃª foi convidado!</h1>
          <p>OlÃ¡,</p>
          <p>VocÃª foi convidado para participar do grupo financeiro <strong>${groupName}</strong> no Zeni Wallet.</p>
          <p>Clique no botÃ£o abaixo para aceitar:</p>
          <a href="${link}" style="background-color: #10b981; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px;">Aceitar Convite</a>
          <p>Ou copie este link: ${link}</p>
        `
      })
    })

    const data = await res.json()

    return new Response(JSON.stringify(data), {
      headers: { ...corsHeaders, 'Content-Type': 'application/json' },
      status: 200,
    })
  } catch (error) {
    return new Response(JSON.stringify({ error: error.message }), {
      headers: { ...corsHeaders, 'Content-Type': 'application/json' },
      status: 400,
    })
  }
})
----------------------------------------
ENDOFFILE: supabase\functions\send-invite-email\index.ts

STARTOFFILE: tailwind.config.ts
----------------------------------------
import type { Config } from "tailwindcss";

export default {
	darkMode: ["class"],
	content: [
		"./pages/**/*.{ts,tsx}",
		"./components/**/*.{ts,tsx}",
		"./app/**/*.{ts,tsx}",
		"./src/**/*.{ts,tsx}",
	],
	prefix: "",
	theme: {
		container: {
			center: true,
			padding: '2rem',
			screens: {
				'2xl': '1400px'
			}
		},
		extend: {
			colors: {
				border: 'hsl(var(--border))',
				input: 'hsl(var(--input))',
				ring: 'hsl(var(--ring))',
				background: 'hsl(var(--background))',
				foreground: 'hsl(var(--foreground))',
				primary: {
					DEFAULT: 'hsl(var(--primary))',
					foreground: 'hsl(var(--primary-foreground))'
				},
				secondary: {
					DEFAULT: 'hsl(var(--secondary))',
					foreground: 'hsl(var(--secondary-foreground))'
				},
				destructive: {
					DEFAULT: 'hsl(var(--destructive))',
					foreground: 'hsl(var(--destructive-foreground))'
				},
				muted: {
					DEFAULT: 'hsl(var(--muted))',
					foreground: 'hsl(var(--muted-foreground))'
				},
				accent: {
					DEFAULT: 'hsl(var(--accent))',
					foreground: 'hsl(var(--accent-foreground))'
				},
				success: {
					DEFAULT: 'hsl(var(--success))',
					foreground: 'hsl(var(--success-foreground))'
				},
				warning: {
					DEFAULT: 'hsl(var(--warning))',
					foreground: 'hsl(var(--warning-foreground))'
				},
				/* Financial specific colors */
				income: {
					DEFAULT: 'hsl(var(--income))',
					foreground: 'hsl(var(--income-foreground))'
				},
				expense: {
					DEFAULT: 'hsl(var(--expense))',
					foreground: 'hsl(var(--expense-foreground))'
				},
				investment: {
					DEFAULT: 'hsl(var(--investment))',
					foreground: 'hsl(var(--investment-foreground))'
				},
				popover: {
					DEFAULT: 'hsl(var(--popover))',
					foreground: 'hsl(var(--popover-foreground))'
				},
				card: {
					DEFAULT: 'hsl(var(--card))',
					foreground: 'hsl(var(--card-foreground))'
				},
				sidebar: {
					DEFAULT: 'hsl(var(--sidebar-background))',
					foreground: 'hsl(var(--sidebar-foreground))',
					primary: 'hsl(var(--sidebar-primary))',
					'primary-foreground': 'hsl(var(--sidebar-primary-foreground))',
					accent: 'hsl(var(--sidebar-accent))',
					'accent-foreground': 'hsl(var(--sidebar-accent-foreground))',
					border: 'hsl(var(--sidebar-border))',
					ring: 'hsl(var(--sidebar-ring))'
				}
			},
			backgroundImage: {
				'gradient-income': 'var(--gradient-income)',
				'gradient-expense': 'var(--gradient-expense)',
				'gradient-investment': 'var(--gradient-investment)',
				'gradient-card': 'var(--gradient-card)',
				'gradient-primary': 'var(--gradient-primary)'
			},
			boxShadow: {
				'financial': 'var(--shadow-financial)'
			},
			borderRadius: {
				lg: 'var(--radius)',
				md: 'calc(var(--radius) - 2px)',
				sm: 'calc(var(--radius) - 4px)'
			},
			keyframes: {
				'accordion-down': {
					from: {
						height: '0'
					},
					to: {
						height: 'var(--radix-accordion-content-height)'
					}
				},
				'accordion-up': {
					from: {
						height: 'var(--radix-accordion-content-height)'
					},
					to: {
						height: '0'
					}
				}
			},
			animation: {
				'accordion-down': 'accordion-down 0.2s ease-out',
				'accordion-up': 'accordion-up 0.2s ease-out'
			}
		}
	},
	plugins: [require("tailwindcss-animate")],
} satisfies Config;

----------------------------------------
ENDOFFILE: tailwind.config.ts

STARTOFFILE: tsconfig.app.json
----------------------------------------
{
  "compilerOptions": {
    "target": "ES2020",
    "useDefineForClassFields": true,
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "module": "ESNext",
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "isolatedModules": true,
    "moduleDetection": "force",
    "noEmit": true,
    "jsx": "react-jsx",

    /* Linting */
    "strict": true,
    "noUnusedLocals": false,
    "noUnusedParameters": false,
    "noImplicitAny": true,
    "noFallthroughCasesInSwitch": false,

    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["src"]
}

----------------------------------------
ENDOFFILE: tsconfig.app.json

STARTOFFILE: tsconfig.json
----------------------------------------
{
  "files": [],
  "references": [{ "path": "./tsconfig.app.json" }, { "path": "./tsconfig.node.json" }],
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    },
    "noImplicitAny": true,
    "noUnusedParameters": false,
    "skipLibCheck": true,
    "allowJs": true,
    "noUnusedLocals": false,
    "strictNullChecks": true,
    "moduleResolution": "bundler",
    "module": "ESNext",
    "target": "ESNext",
    "lib": ["ESNext", "DOM", "DOM.Iterable"],
    "esModuleInterop": true,
    "isolatedModules": true,
    "resolveJsonModule": true,
    "removeComments": true,
    "declaration": false,
    "declarationMap": false,
    "sourceMap": false,
    "incremental": true,
    "tsBuildInfoFile": ".tsbuildinfo"
  }
}

----------------------------------------
ENDOFFILE: tsconfig.json

STARTOFFILE: tsconfig.node.json
----------------------------------------
{
  "compilerOptions": {
    "target": "ES2022",
    "lib": ["ES2023"],
    "module": "ESNext",
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "isolatedModules": true,
    "moduleDetection": "force",
    "noEmit": true,

    /* Linting */
    "strict": true,
    "noUnusedLocals": false,
    "noUnusedParameters": false,
    "noFallthroughCasesInSwitch": true
  },
  "include": ["vite.config.ts"]
}

----------------------------------------
ENDOFFILE: tsconfig.node.json

STARTOFFILE: vercel.json
----------------------------------------
{
  "rewrites": [
    {
      "source": "/(.*)",
      "destination": "/index.html"
    }
  ]
}

----------------------------------------
ENDOFFILE: vercel.json

STARTOFFILE: vite.config.ts
----------------------------------------
import { defineConfig } from "vite";
import react from "@vitejs/plugin-react-swc";
import path from "path";
import { VitePWA } from "vite-plugin-pwa";

export default defineConfig(() => ({
  server: {
    host: "::",
    port: 8080,
  },
  plugins: [
    react(),
    VitePWA({
      strategies: "injectManifest",
      srcDir: "src",
      filename: "sw.ts",

      registerType: "autoUpdate",
      injectRegister: "auto",

      includeAssets: ["pwa-192x192.png", "pwa-512x512.png"],

      manifest: {
        name: "Zeni Wallet - GestÃ£o Financeira Pessoal",
        short_name: "Zeni Wallet",
        description: "Gerenciamento financeiro pessoal e em grupo",
        theme_color: "#10b981",
        background_color: "#0f172a",
        display: "standalone",
        orientation: "portrait",
        scope: "/",
        start_url: "/",
        lang: "pt-BR",
        icons: [
          {
            src: "/pwa-192x192.png",
            sizes: "192x192",
            type: "image/png",
          },
          {
            src: "/pwa-512x512.png",
            sizes: "512x512",
            type: "image/png",
          },
          {
            src: "/pwa-512x512.png",
            sizes: "512x512",
            type: "image/png",
            purpose: "any maskable",
          },
        ],
      },

      devOptions: {
        enabled: true,
        type: "module",
        navigateFallback: "index.html",
      },
    }),
  ],
  resolve: {
    alias: {
      "@": path.resolve(__dirname, "./src"),
    },
  },
}));

----------------------------------------
ENDOFFILE: vite.config.ts
```
---

### otimizar.bat

**Language:** text  
**Size:** 6.44 KB  
**Last Modified:** 2025-10-31T13:39:22.981Z

```text
@echo off
echo.
echo ========================================
echo   OTIMIZACAO DE BUNDLE - ASSISTENTE
echo ========================================
echo.

:MENU
echo.
echo Escolha uma opcao:
echo.
echo 1. Criar arquivos lib/icons.ts e lib/date.ts
echo 2. Listar arquivos que precisam atualizacao
echo 3. Limpar node_modules e reinstalar
echo 4. Executar build
echo 5. Analisar tamanho do bundle
echo 6. Validar migracao (verificar imports diretos)
echo 7. Executar tudo (passos 1-6)
echo 0. Sair
echo.
set /p opcao="Digite o numero da opcao: "

if "%opcao%"=="1" goto CRIAR_ARQUIVOS
if "%opcao%"=="2" goto LISTAR_ARQUIVOS
if "%opcao%"=="3" goto LIMPAR_REINSTALAR
if "%opcao%"=="4" goto BUILD
if "%opcao%"=="5" goto ANALISAR
if "%opcao%"=="6" goto VALIDAR
if "%opcao%"=="7" goto TUDO
if "%opcao%"=="0" goto FIM
goto MENU

:CRIAR_ARQUIVOS
echo.
echo [PASSO 1/3] Criando diretorio src\lib...
if not exist "src\lib" mkdir "src\lib"

echo [PASSO 2/3] Criando src\lib\icons.ts...
(
echo export { 
echo   ArrowUpCircle,
echo   ArrowDownCircle,
echo   TrendingUp,
echo   TrendingDown,
echo   DollarSign,
echo   PiggyBank,
echo   Calendar,
echo   Search,
echo   Filter,
echo   Plus,
echo   Trash2,
echo   Eye,
echo   Edit,
echo   X,
echo   Check,
echo   ChevronLeft,
echo   ChevronRight,
echo   Menu,
echo   LogOut,
echo   Users,
echo   Settings,
echo   Home,
echo   FileText,
echo   Target,
echo   Wallet,
echo   AlertCircle,
echo   Info,
echo   ChevronDown,
echo   MoreHorizontal,
echo } from 'lucide-react';
) > "src\lib\icons.ts"

echo [PASSO 3/3] Criando src\lib\date.ts...
(
echo export {
echo   format,
echo   startOfMonth,
echo   endOfMonth,
echo   startOfYear,
echo   endOfYear,
echo   subMonths,
echo   addMonths,
echo   isAfter,
echo   isBefore,
echo   parseISO,
echo   addDays,
echo   subDays,
echo } from 'date-fns';
echo.
echo export { ptBR } from 'date-fns/locale';
) > "src\lib\date.ts"

echo.
echo Arquivos criados com sucesso!
echo.
pause
goto MENU

:LISTAR_ARQUIVOS
echo.
echo ========================================
echo   ARQUIVOS COM IMPORTS LUCIDE-REACT
echo ========================================
echo.
findstr /S /M "lucide-react" src\*.tsx src\*.ts 2>nul
echo.
echo ========================================
echo   ARQUIVOS COM IMPORTS DATE-FNS
echo ========================================
echo.
findstr /S /M "date-fns" src\*.tsx src\*.ts 2>nul
echo.
echo.
echo ATENCAO: Voce precisa atualizar MANUALMENTE estes arquivos!
echo.
echo Substitua:
echo   from 'lucide-react' - from '@/lib/icons'
echo   from 'date-fns' - from '@/lib/date'
echo   from 'date-fns/locale' - from '@/lib/date'
echo.
pause
goto MENU

:LIMPAR_REINSTALAR
echo.
echo [PASSO 1/4] Removendo node_modules...
if exist "node_modules" rmdir /S /Q "node_modules"

echo [PASSO 2/4] Removendo dist...
if exist "dist" rmdir /S /Q "dist"

echo [PASSO 3/4] Removendo package-lock.json...
if exist "package-lock.json" del /F /Q "package-lock.json"

echo [PASSO 4/4] Reinstalando dependencias...
call npm install

echo.
echo Dependencias reinstaladas!
echo.
pause
goto MENU

:BUILD
echo.
echo Executando build...
echo.
call npm run build
echo.
if %ERRORLEVEL% EQU 0 (
    echo Build concluido com sucesso!
) else (
    echo Build falhou! Verifique os erros acima.
)
echo.
pause
goto MENU

:ANALISAR
echo.
echo ========================================
echo   ANALISE DE BUNDLE SIZE
echo ========================================
echo.
if not exist "dist" (
    echo Pasta dist nao encontrada!
    echo Execute o build primeiro opcao 4
    echo.
    pause
    goto MENU
)

echo Arquivos JavaScript gerados:
echo.
dir "dist\assets\js\*.js" 2>nul
echo.
echo ----------------------------------------
echo Tamanho total da pasta dist:
echo.
dir dist /s | find "File(s)"
echo.
echo ========================================
pause
goto MENU

:VALIDAR
echo.
echo ========================================
echo   VALIDACAO DE MIGRACAO
echo ========================================
echo.
echo Procurando imports diretos de lucide-react...
findstr /S "from 'lucide-react'" src\*.tsx src\*.ts 2>nul
if %ERRORLEVEL% NEQ 0 (
    echo Nenhum import direto de lucide-react encontrado!
) else (
    echo Ainda existem imports diretos! Atualize-os manualmente.
)

echo.
echo Procurando imports diretos de date-fns...
findstr /S "from 'date-fns'" src\*.tsx src\*.ts 2>nul
if %ERRORLEVEL% NEQ 0 (
    echo Nenhum import direto de date-fns encontrado!
) else (
    echo Ainda existem imports diretos! Atualize-os manualmente.
)

echo.
echo ========================================
pause
goto MENU

:TUDO
echo.
echo ========================================
echo   EXECUTANDO TODOS OS PASSOS
echo ========================================
echo.

echo [1/6] Criando arquivos lib...
call :CRIAR_ARQUIVOS_SILENCIOSO

echo.
echo [2/6] Listando arquivos que precisam atualizacao...
echo.
echo ATENCAO: Atualize MANUALMENTE os imports nos arquivos listados!
echo.
findstr /S /M "lucide-react" src\*.tsx src\*.ts 2>nul
findstr /S /M "date-fns" src\*.tsx src\*.ts 2>nul
echo.
echo Pressione qualquer tecla APOS atualizar os imports...
pause >nul

echo.
echo [3/6] Limpando e reinstalando...
call :LIMPAR_REINSTALAR_SILENCIOSO

echo.
echo [4/6] Executando build...
call npm run build

echo.
echo [5/6] Analisando bundle...
if exist "dist" (
    dir "dist\assets\js\*.js" 2>nul
    dir dist /s | find "File(s)"
)

echo.
echo [6/6] Validando migracao...
findstr /S "from 'lucide-react'" src\*.tsx src\*.ts 2>nul
findstr /S "from 'date-fns'" src\*.tsx src\*.ts 2>nul

echo.
echo ========================================
echo   PROCESSO CONCLUIDO!
echo ========================================
echo.
pause
goto MENU

:CRIAR_ARQUIVOS_SILENCIOSO
if not exist "src\lib" mkdir "src\lib"
(
echo export { 
echo   ArrowUpCircle, ArrowDownCircle, TrendingUp, TrendingDown, DollarSign,
echo   PiggyBank, Calendar, Search, Filter, Plus, Trash2, Eye, Edit, X, Check,
echo   ChevronLeft, ChevronRight, Menu, LogOut, Users, Settings, Home, FileText,
echo   Target, Wallet, AlertCircle, Info, ChevronDown, MoreHorizontal
echo } from 'lucide-react';
) > "src\lib\icons.ts"
(
echo export { format, startOfMonth, endOfMonth, startOfYear, endOfYear,
echo   subMonths, addMonths, isAfter, isBefore, parseISO, addDays, subDays
echo } from 'date-fns';
echo export { ptBR } from 'date-fns/locale';
) > "src\lib\date.ts"
goto :eof

:LIMPAR_REINSTALAR_SILENCIOSO
if exist "node_modules" rmdir /S /Q "node_modules"
if exist "dist" rmdir /S /Q "dist"
if exist "package-lock.json" del /F /Q "package-lock.json"
call npm install
goto :eof

:FIM
echo.
echo Saindo...
echo.
exit /b 0
```
---

### package.json

**Language:** json  
**Size:** 3.1 KB  
**Last Modified:** 2025-12-03T21:27:10.883Z

```json
{
  "name": "vite_react_shadcn_ts",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "sideEffects": false,
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "build:dev": "vite build --mode development",
    "build:analyze": "vite build && vite-bundle-analyzer",
    "lint": "eslint .",
    "preview": "vite preview"
  },
  "dependencies": {
    "@hookform/resolvers": "^3.10.0",
    "@radix-ui/react-accordion": "^1.2.11",
    "@radix-ui/react-alert-dialog": "^1.1.14",
    "@radix-ui/react-aspect-ratio": "^1.1.7",
    "@radix-ui/react-avatar": "^1.1.10",
    "@radix-ui/react-checkbox": "^1.3.2",
    "@radix-ui/react-collapsible": "^1.1.11",
    "@radix-ui/react-context-menu": "^2.2.15",
    "@radix-ui/react-dialog": "^1.1.14",
    "@radix-ui/react-dropdown-menu": "^2.1.15",
    "@radix-ui/react-hover-card": "^1.1.14",
    "@radix-ui/react-label": "^2.1.7",
    "@radix-ui/react-menubar": "^1.1.15",
    "@radix-ui/react-navigation-menu": "^1.2.13",
    "@radix-ui/react-popover": "^1.1.14",
    "@radix-ui/react-progress": "^1.1.7",
    "@radix-ui/react-radio-group": "^1.3.7",
    "@radix-ui/react-scroll-area": "^1.2.9",
    "@radix-ui/react-select": "^2.2.5",
    "@radix-ui/react-separator": "^1.1.7",
    "@radix-ui/react-slider": "^1.3.5",
    "@radix-ui/react-slot": "^1.2.3",
    "@radix-ui/react-switch": "^1.2.5",
    "@radix-ui/react-tabs": "^1.1.12",
    "@radix-ui/react-toast": "^1.2.14",
    "@radix-ui/react-toggle": "^1.1.9",
    "@radix-ui/react-toggle-group": "^1.1.10",
    "@radix-ui/react-tooltip": "^1.2.7",
    "@supabase/supabase-js": "^2.56.0",
    "@tanstack/react-query": "^5.83.0",
    "class-variance-authority": "^0.7.1",
    "clsx": "^2.1.1",
    "cmdk": "^1.1.1",
    "date-fns": "^3.6.0",
    "dompurify": "^3.3.0",
    "embla-carousel-react": "^8.6.0",
    "input-otp": "^1.4.2",
    "lucide-react": "^0.462.0",
    "next-themes": "^0.3.0",
    "react": "^18.3.1",
    "react-day-picker": "^9.9.0",
    "react-dom": "^18.3.1",
    "react-hook-form": "^7.61.1",
    "react-resizable-panels": "^2.1.9",
    "react-router-dom": "^6.30.1",
    "react-window": "^2.2.2",
    "recharts": "^2.15.4",
    "sonner": "^1.7.4",
    "tailwind-merge": "^2.6.0",
    "tailwindcss-animate": "^1.0.7",
    "terser": "^5.44.0",
    "vaul": "^0.9.9",
    "zod": "^3.25.76"
  },
  "devDependencies": {
    "@eslint/js": "^9.32.0",
    "@tailwindcss/typography": "^0.5.16",
    "@types/dompurify": "^3.2.0",
    "@types/node": "^22.16.5",
    "@types/react": "^18.3.23",
    "@types/react-dom": "^18.3.7",
    "@types/react-window": "^2.0.0",
    "@vitejs/plugin-react-swc": "^3.11.0",
    "autoprefixer": "^10.4.21",
    "dotenv": "^17.2.3",
    "eslint": "^9.32.0",
    "eslint-plugin-react-hooks": "^5.2.0",
    "eslint-plugin-react-refresh": "^0.4.20",
    "globals": "^15.15.0",
    "lovable-tagger": "^1.1.9",
    "postcss": "^8.5.6",
    "supabase": "^2.54.11",
    "tailwindcss": "^3.4.17",
    "typescript": "^5.8.3",
    "typescript-eslint": "^8.38.0",
    "vite": "^5.4.19",
    "vite-plugin-pwa": "^1.1.0"
  }
}
```
---

### postcss.config.js

**Language:** javascript  
**Size:** 86 Bytes  
**Last Modified:** 2025-08-28T19:03:37.244Z

```javascript
export default {
  plugins: {
    tailwindcss: {},
    autoprefixer: {},
  },
}
```
---

### public\placeholder.svg

**Language:** text  
**Size:** 3.18 KB  
**Last Modified:** 2025-08-28T19:03:37.245Z

```text
<svg xmlns="http://www.w3.org/2000/svg" width="1200" height="1200" fill="none"><rect width="1200" height="1200" fill="#EAEAEA" rx="3"/><g opacity=".5"><g opacity=".5"><path fill="#FAFAFA" d="M600.709 736.5c-75.454 0-136.621-61.167-136.621-136.62 0-75.454 61.167-136.621 136.621-136.621 75.453 0 136.62 61.167 136.62 136.621 0 75.453-61.167 136.62-136.62 136.62Z"/><path stroke="#C9C9C9" stroke-width="2.418" d="M600.709 736.5c-75.454 0-136.621-61.167-136.621-136.62 0-75.454 61.167-136.621 136.621-136.621 75.453 0 136.62 61.167 136.62 136.621 0 75.453-61.167 136.62-136.62 136.62Z"/></g><path stroke="url(#a)" stroke-width="2.418" d="M0-1.209h553.581" transform="scale(1 -1) rotate(45 1163.11 91.165)"/><path stroke="url(#b)" stroke-width="2.418" d="M404.846 598.671h391.726"/><path stroke="url(#c)" stroke-width="2.418" d="M599.5 795.742V404.017"/><path stroke="url(#d)" stroke-width="2.418" d="m795.717 796.597-391.441-391.44"/><path fill="#fff" d="M600.709 656.704c-31.384 0-56.825-25.441-56.825-56.824 0-31.384 25.441-56.825 56.825-56.825 31.383 0 56.824 25.441 56.824 56.825 0 31.383-25.441 56.824-56.824 56.824Z"/><g clip-path="url(#e)"><path fill="#666" fill-rule="evenodd" d="M616.426 586.58h-31.434v16.176l3.553-3.554.531-.531h9.068l.074-.074 8.463-8.463h2.565l7.18 7.181V586.58Zm-15.715 14.654 3.698 3.699 1.283 1.282-2.565 2.565-1.282-1.283-5.2-5.199h-6.066l-5.514 5.514-.073.073v2.876a2.418 2.418 0 0 0 2.418 2.418h26.598a2.418 2.418 0 0 0 2.418-2.418v-8.317l-8.463-8.463-7.181 7.181-.071.072Zm-19.347 5.442v4.085a6.045 6.045 0 0 0 6.046 6.045h26.598a6.044 6.044 0 0 0 6.045-6.045v-7.108l1.356-1.355-1.282-1.283-.074-.073v-17.989h-38.689v23.43l-.146.146.146.147Z" clip-rule="evenodd"/></g><path stroke="#C9C9C9" stroke-width="2.418" d="M600.709 656.704c-31.384 0-56.825-25.441-56.825-56.824 0-31.384 25.441-56.825 56.825-56.825 31.383 0 56.824 25.441 56.824 56.825 0 31.383-25.441 56.824-56.824 56.824Z"/></g><defs><linearGradient id="a" x1="554.061" x2="-.48" y1=".083" y2=".087" gradientUnits="userSpaceOnUse"><stop stop-color="#C9C9C9" stop-opacity="0"/><stop offset=".208" stop-color="#C9C9C9"/><stop offset=".792" stop-color="#C9C9C9"/><stop offset="1" stop-color="#C9C9C9" stop-opacity="0"/></linearGradient><linearGradient id="b" x1="796.912" x2="404.507" y1="599.963" y2="599.965" gradientUnits="userSpaceOnUse"><stop stop-color="#C9C9C9" stop-opacity="0"/><stop offset=".208" stop-color="#C9C9C9"/><stop offset=".792" stop-color="#C9C9C9"/><stop offset="1" stop-color="#C9C9C9" stop-opacity="0"/></linearGradient><linearGradient id="c" x1="600.792" x2="600.794" y1="403.677" y2="796.082" gradientUnits="userSpaceOnUse"><stop stop-color="#C9C9C9" stop-opacity="0"/><stop offset=".208" stop-color="#C9C9C9"/><stop offset=".792" stop-color="#C9C9C9"/><stop offset="1" stop-color="#C9C9C9" stop-opacity="0"/></linearGradient><linearGradient id="d" x1="404.85" x2="796.972" y1="403.903" y2="796.02" gradientUnits="userSpaceOnUse"><stop stop-color="#C9C9C9" stop-opacity="0"/><stop offset=".208" stop-color="#C9C9C9"/><stop offset=".792" stop-color="#C9C9C9"/><stop offset="1" stop-color="#C9C9C9" stop-opacity="0"/></linearGradient><clipPath id="e"><path fill="#fff" d="M581.364 580.535h38.689v38.689h-38.689z"/></clipPath></defs></svg>
```
---

### public\robots.txt

**Language:** text  
**Size:** 174 Bytes  
**Last Modified:** 2025-08-28T19:03:37.246Z

```text
User-agent: Googlebot
Allow: /

User-agent: Bingbot
Allow: /

User-agent: Twitterbot
Allow: /

User-agent: facebookexternalhit
Allow: /

User-agent: *
Allow: /
```
---

### public\site.webmanifest

**Language:** text  
**Size:** 436 Bytes  
**Last Modified:** 2025-11-19T18:29:55.845Z

```text
{
  "name": "MyWebSite",
  "short_name": "MySite",
  "icons": [
    {
      "src": "/web-app-manifest-192x192.png",
      "sizes": "192x192",
      "type": "image/png",
      "purpose": "maskable"
    },
    {
      "src": "/web-app-manifest-512x512.png",
      "sizes": "512x512",
      "type": "image/png",
      "purpose": "maskable"
    }
  ],
  "theme_color": "#ffffff",
  "background_color": "#ffffff",
  "display": "standalone"
}
```
---

### README.md

**Language:** markdown  
**Size:** 21.17 KB  
**Last Modified:** 2025-11-26T14:18:45.018Z

```markdown
# ğŸ’° Zeni Wallet

**Gerenciamento Financeiro Inteligente, Pessoal e Compartilhado.**

<div align="center">
  <img src="https://img.shields.io/badge/React-18.0+-61DAFB?style=for-the-badge&logo=react" alt="React" />
  <img src="https://img.shields.io/badge/TypeScript-5.0+-3178C6?style=for-the-badge&logo=typescript" alt="TypeScript" />
  <img src="https://img.shields.io/badge/Supabase-2.0+-3ECF8E?style=for-the-badge&logo=supabase" alt="Supabase" />
  <img src="https://img.shields.io/badge/PWA-Ready-5A0FC8?style=for-the-badge&logo=pwa" alt="PWA" />
</div>

<br>

O **Zeni Wallet** Ã© uma plataforma completa para quem busca retomar o controle de suas finanÃ§as. Mais do que apenas registrar gastos, ele permite gerenciar investimentos, dividir despesas em grupo e planejar o futuro com metas claras, tudo em uma interface moderna e acessÃ­vel via navegador ou instalada como aplicativo (PWA).

---

## ğŸ‘¤ Para UsuÃ¡rios

### Por que usar o Zeni Wallet?

Cansado de planilhas complexas ou aplicativos que sÃ³ registram o passado? O Zeni Wallet foi desenhado para oferecer **clareza e previsibilidade**. Seja vocÃª um investidor iniciante, alguÃ©m organizando as contas de casa ou planejando uma viagem em grupo, esta Ã© a ferramenta ideal.

### âœ¨ Funcionalidades Atuais

#### **Dashboard Intuitivo**

- VisÃ£o geral do seu saldo, receitas, despesas e evoluÃ§Ã£o patrimonial em tempo real
- GrÃ¡ficos interativos para anÃ¡lise visual instantÃ¢nea
- Resumo mensal e anual de suas finanÃ§as

#### **GestÃ£o de TransaÃ§Ãµes**

- **CategorizaÃ§Ã£o** automÃ¡tica e personalizada
- **LanÃ§amentos Fixos**: Previsibilidade do seu saldo futuro com despesas recorrentes
- **Eventos**: Agrupe gastos de uma viagem ou reforma para saber exatamente quanto aquele projeto custou
- Filtros avanÃ§ados por data, categoria e valor

#### **Investimentos AvanÃ§ados**

- Controle de AÃ§Ãµes, FIIs, Renda Fixa e Criptomoedas
- CÃ¡lculo automÃ¡tico de rentabilidade e preÃ§o mÃ©dio
- DefiniÃ§Ã£o e acompanhamento de **Metas Financeiras** visuais
- AnÃ¡lise de performance da carteira

#### **Grupos e Compartilhamento**

- Crie grupos (ex: "Casa", "Viagem") para dividir despesas com amigos ou familiares
- Controle de quem pagou o quÃª com divisÃ£o automÃ¡tica
- RelatÃ³rios detalhados por membro do grupo
- Sistema de permissÃµes (administradores e membros)

#### **Lembretes Inteligentes**

- Receba **notificaÃ§Ãµes Push** (no celular ou PC) para nÃ£o esquecer de pagar contas
- Lembretes recorrentes para aportes e pagamentos fixos
- Funciona mesmo com o app fechado

#### **Modo Offline (PWA)**

- Instale o app no seu celular e acesse seus dados mesmo sem internet
- SincronizaÃ§Ã£o automÃ¡tica quando voltar online
- ExperiÃªncia nativa no Android e iOS

### ğŸš€ O Futuro do Zeni Wallet (Roadmap)

Estamos trabalhando constantemente para melhorar. Confira o que vem por aÃ­:

- **Open Finance**: ConexÃ£o automÃ¡tica com seus bancos para importaÃ§Ã£o de extratos
- **IA Financeira**: Insights personalizados sobre seus hÃ¡bitos de consumo e sugestÃµes de economia
- **RelatÃ³rios PDF**: ExportaÃ§Ã£o de dados para declaraÃ§Ã£o de imposto de renda
- **Marketplace de Templates**: Compartilhe e baixe templates de orÃ§amento da comunidade
- **IntegraÃ§Ã£o com CartÃµes**: Acompanhe seus gastos no cartÃ£o em tempo real

---

## ğŸ’» Para Desenvolvedores

O Zeni Wallet Ã© um projeto **Open Source** construÃ­do com as tecnologias mais modernas do ecossistema React, focando em performance, seguranÃ§a e escalabilidade.

### ğŸ› ï¸ Tecnologias e Ferramentas

#### **Frontend**

- **React 18** com Concurrent Features
- **TypeScript** para type safety
- **Vite** para build ultrarrÃ¡pido
- **Tailwind CSS** para estilizaÃ§Ã£o utility-first
- **Shadcn/ui** (baseado em Radix UI) para componentes acessÃ­veis

#### **Gerenciamento de Estado & Data**

- **TanStack Query** (React Query) para cache e sincronizaÃ§Ã£o eficiente
- **Context API** para estado global leve
- **Zod** para validaÃ§Ã£o de schemas

#### **Backend & Infraestrutura**

- **Supabase** (PostgreSQL, Authentication, Realtime, Edge Functions)
- **Row Level Security (RLS)** para seguranÃ§a em nÃ­vel de banco
- **Triggers PostgreSQL** para cÃ¡lculos automÃ¡ticos

#### **SeguranÃ§a**

- SanitizaÃ§Ã£o de inputs contra XSS/SQL Injection
- Rate Limiting no client-side
- ValidaÃ§Ã£o dupla (frontend + backend)
- PolÃ­ticas RLS para isolamento de dados

#### **PWA & Performance**

- **vite-plugin-pwa** com Service Workers customizados
- Suporte offline completo
- **Web Push API** para notificaÃ§Ãµes
- Code splitting e lazy loading
- React Window para virtualizaÃ§Ã£o de listas

#### **VisualizaÃ§Ã£o de Dados**

- **Recharts** para grÃ¡ficos interativos
- Dashboards responsivos e performÃ¡ticos

### ğŸ—‚ï¸ Arquitetura do Projeto

A estrutura de pastas segue um padrÃ£o modular e escalÃ¡vel:

```bash
src/
â”œâ”€â”€ components/        # Componentes UI (Shadcn) e funcionais
â”‚   â”œâ”€â”€ dialogs/      # Modais de criaÃ§Ã£o/ediÃ§Ã£o (TransaÃ§Ãµes, Investimentos)
â”‚   â”œâ”€â”€ dashboard/    # Cards e widgets especÃ­ficos da home
â”‚   â”œâ”€â”€ groups/       # Componentes relacionados a grupos
â”‚   â”œâ”€â”€ layout/       # Sidebar, Headers, Layouts
â”‚   â””â”€â”€ ui/          # Componentes base (Button, Input, Card)
â”œâ”€â”€ contexts/        # Context API (AuthContext)
â”œâ”€â”€ hooks/          # Custom Hooks (useAuth, useReminders, usePWA)
â”œâ”€â”€ pages/          # Rotas da aplicaÃ§Ã£o (Dashboard, Transactions, etc.)
â”œâ”€â”€ services/       # Camada de serviÃ§o (Regras de negÃ³cio e chamadas API)
â”œâ”€â”€ utils/          # UtilitÃ¡rios de data, formataÃ§Ã£o e seguranÃ§a
â”‚   â”œâ”€â”€ services/   # ServiÃ§os especÃ­ficos (push notifications, reminders)
â”‚   â””â”€â”€ types/      # TypeScript types e interfaces
â”œâ”€â”€ integrations/   # ConfiguraÃ§Ã£o do cliente Supabase
â””â”€â”€ sw.ts          # Service Worker customizado
```

### âš™ï¸ InstalaÃ§Ã£o e ConfiguraÃ§Ã£o

#### PrÃ©-requisitos

- Node.js 18+ e npm/yarn
- Conta no [Supabase](https://supabase.com)

#### 1. Clone o repositÃ³rio:

```bash
git clone https://github.com/seu-usuario/zeni-wallet.git
cd zeni-wallet
```

#### 2. Instale as dependÃªncias:

```bash
npm install
```

#### 3. VariÃ¡veis de Ambiente:

Crie um arquivo `.env` na raiz e configure suas credenciais:

```env
VITE_SUPABASE_URL=sua_url_supabase
VITE_SUPABASE_PUBLISHABLE_KEY=sua_key_anon
VITE_VAPID_PUBLIC_KEY=sua_chave_publica_webpush
```

#### 4. Execute o projeto:

```bash
npm run dev       # Desenvolvimento
npm run build     # Build de produÃ§Ã£o
npm run preview   # Preview da build
```

### ğŸ—„ï¸ ConfiguraÃ§Ã£o do Supabase

Para que o Zeni Wallet funcione corretamente, vocÃª precisa configurar seu projeto Supabase com as tabelas, polÃ­ticas RLS, triggers e funÃ§Ãµes necessÃ¡rias.

#### ğŸ“Š 1. Estrutura do Banco de Dados

Execute as seguintes queries SQL no SQL Editor do Supabase para criar as tabelas principais:

```sql
-- Tabela de perfis de usuÃ¡rios
CREATE TABLE profiles (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID UNIQUE REFERENCES auth.users ON DELETE CASCADE,
  full_name TEXT,
  avatar_url TEXT,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Tabela de grupos
CREATE TABLE groups (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name TEXT NOT NULL,
  description TEXT,
  color TEXT,
  created_by UUID REFERENCES auth.users ON DELETE CASCADE,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Tabela de membros dos grupos
CREATE TABLE group_members (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  group_id UUID REFERENCES groups ON DELETE CASCADE,
  user_id UUID REFERENCES auth.users ON DELETE CASCADE,
  is_admin BOOLEAN DEFAULT false,
  joined_at TIMESTAMPTZ DEFAULT NOW(),
  UNIQUE(group_id, user_id)
);

-- Tabela de transaÃ§Ãµes
CREATE TABLE transactions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users ON DELETE CASCADE,
  description TEXT NOT NULL,
  amount NUMERIC(10, 2) NOT NULL,
  type TEXT NOT NULL CHECK (type IN ('income', 'expense')),
  category TEXT NOT NULL,
  date DATE DEFAULT CURRENT_DATE,
  group_id UUID REFERENCES groups ON DELETE SET NULL,
  is_fixed BOOLEAN DEFAULT false,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Tabela de investimentos
CREATE TABLE investments (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users ON DELETE CASCADE,
  name TEXT NOT NULL,
  type TEXT NOT NULL,
  amount NUMERIC(10, 2) NOT NULL,
  current_value NUMERIC(10, 2) NOT NULL,
  quantity NUMERIC(10, 4),
  unit_price NUMERIC(10, 4),
  maturity_date DATE,
  group_id UUID REFERENCES groups ON DELETE SET NULL,
  goal_id UUID REFERENCES investment_goals ON DELETE SET NULL,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Tabela de metas de investimento
CREATE TABLE investment_goals (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users ON DELETE CASCADE,
  name TEXT NOT NULL,
  description TEXT,
  target_amount NUMERIC(10, 2) NOT NULL,
  current_amount NUMERIC(10, 2) DEFAULT 0,
  target_date DATE,
  color TEXT,
  priority INTEGER DEFAULT 0,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Tabela de lembretes
CREATE TABLE reminders (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users ON DELETE CASCADE,
  transaction_id UUID REFERENCES transactions ON DELETE CASCADE,
  title TEXT NOT NULL,
  description TEXT,
  reminder_date TIMESTAMPTZ NOT NULL,
  is_completed BOOLEAN DEFAULT false,
  is_notified BOOLEAN DEFAULT false,
  notification_sent_at TIMESTAMPTZ,
  repeat_type TEXT DEFAULT 'none',
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Tabela de inscriÃ§Ãµes para push notifications
CREATE TABLE push_subscriptions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users ON DELETE CASCADE,
  endpoint TEXT UNIQUE NOT NULL,
  p256dh TEXT NOT NULL,
  auth TEXT NOT NULL,
  user_agent TEXT,
  is_active BOOLEAN DEFAULT true,
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);
```

#### ğŸ”’ 2. PolÃ­ticas de SeguranÃ§a RLS (Row Level Security)

Ative o RLS em todas as tabelas e configure as polÃ­ticas:

```sql
-- Ativar RLS em todas as tabelas
ALTER TABLE profiles ENABLE ROW LEVEL SECURITY;
ALTER TABLE groups ENABLE ROW LEVEL SECURITY;
ALTER TABLE group_members ENABLE ROW LEVEL SECURITY;
ALTER TABLE transactions ENABLE ROW LEVEL SECURITY;
ALTER TABLE investments ENABLE ROW LEVEL SECURITY;
ALTER TABLE investment_goals ENABLE ROW LEVEL SECURITY;
ALTER TABLE reminders ENABLE ROW LEVEL SECURITY;
ALTER TABLE push_subscriptions ENABLE ROW LEVEL SECURITY;

-- PolÃ­ticas para profiles
CREATE POLICY "Users can view own profile" ON profiles
  FOR SELECT USING (auth.uid() = user_id);

CREATE POLICY "Users can update own profile" ON profiles
  FOR UPDATE USING (auth.uid() = user_id);

-- PolÃ­ticas para groups
CREATE POLICY "Users can view groups they belong to" ON groups
  FOR SELECT USING (
    auth.uid() = created_by OR
    EXISTS (
      SELECT 1 FROM group_members
      WHERE group_id = groups.id AND user_id = auth.uid()
    )
  );

CREATE POLICY "Users can create groups" ON groups
  FOR INSERT WITH CHECK (auth.uid() = created_by);

CREATE POLICY "Only creators can update groups" ON groups
  FOR UPDATE USING (auth.uid() = created_by);

CREATE POLICY "Only creators can delete groups" ON groups
  FOR DELETE USING (auth.uid() = created_by);

-- PolÃ­ticas para group_members
CREATE POLICY "Members can view group members" ON group_members
  FOR SELECT USING (
    EXISTS (
      SELECT 1 FROM group_members gm
      WHERE gm.group_id = group_members.group_id
      AND gm.user_id = auth.uid()
    )
  );

CREATE POLICY "Group creators can manage members" ON group_members
  FOR ALL USING (
    EXISTS (
      SELECT 1 FROM groups
      WHERE id = group_members.group_id
      AND created_by = auth.uid()
    )
  );

-- PolÃ­ticas para transactions
CREATE POLICY "Users can view own and group transactions" ON transactions
  FOR SELECT USING (
    user_id = auth.uid() OR
    (group_id IS NOT NULL AND EXISTS (
      SELECT 1 FROM group_members
      WHERE group_id = transactions.group_id
      AND user_id = auth.uid()
    ))
  );

CREATE POLICY "Users can create own transactions" ON transactions
  FOR INSERT WITH CHECK (auth.uid() = user_id);

CREATE POLICY "Users can update own transactions" ON transactions
  FOR UPDATE USING (auth.uid() = user_id);

CREATE POLICY "Users can delete own transactions" ON transactions
  FOR DELETE USING (auth.uid() = user_id);

-- PolÃ­ticas similares para as demais tabelas...
```

#### âš™ï¸ 3. FunÃ§Ãµes Auxiliares

Crie funÃ§Ãµes Ãºteis para operaÃ§Ãµes complexas:

```sql
-- FunÃ§Ã£o para verificar se usuÃ¡rio Ã© criador do grupo
CREATE OR REPLACE FUNCTION is_group_creator(_group_id UUID)
RETURNS BOOLEAN AS $$
  SELECT EXISTS (
    SELECT 1 FROM groups
    WHERE id = _group_id
    AND created_by = auth.uid()
  );
$$ LANGUAGE SQL SECURITY DEFINER;

-- FunÃ§Ã£o para verificar se usuÃ¡rio Ã© membro do grupo
CREATE OR REPLACE FUNCTION is_group_member(_group_id UUID)
RETURNS BOOLEAN AS $$
  SELECT EXISTS (
    SELECT 1 FROM group_members
    WHERE group_id = _group_id
    AND user_id = auth.uid()
  );
$$ LANGUAGE SQL SECURITY DEFINER;

-- FunÃ§Ã£o para atualizar current_amount nas metas
CREATE OR REPLACE FUNCTION update_goal_current_amount()
RETURNS TRIGGER AS $$
BEGIN
  IF TG_OP = 'INSERT' OR TG_OP = 'UPDATE' THEN
    UPDATE investment_goals
    SET current_amount = (
      SELECT COALESCE(SUM(current_value), 0)
      FROM investments
      WHERE goal_id = NEW.goal_id
    ),
    updated_at = NOW()
    WHERE id = NEW.goal_id;
  END IF;

  IF TG_OP = 'DELETE' OR TG_OP = 'UPDATE' THEN
    UPDATE investment_goals
    SET current_amount = (
      SELECT COALESCE(SUM(current_value), 0)
      FROM investments
      WHERE goal_id = OLD.goal_id
    ),
    updated_at = NOW()
    WHERE id = OLD.goal_id;
  END IF;

  RETURN NULL;
END;
$$ LANGUAGE plpgsql;
```

#### ğŸ”„ 4. Triggers

Configure triggers para automaÃ§Ãµes:

```sql
-- Trigger para criar perfil automaticamente
CREATE OR REPLACE FUNCTION handle_new_user()
RETURNS TRIGGER AS $$
BEGIN
  INSERT INTO public.profiles (user_id, full_name)
  VALUES (NEW.id, NEW.raw_user_meta_data->>'full_name');
  RETURN NEW;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

CREATE TRIGGER on_auth_user_created
  AFTER INSERT ON auth.users
  FOR EACH ROW EXECUTE FUNCTION handle_new_user();

-- Trigger para atualizar metas de investimento
CREATE TRIGGER update_goal_on_investment_change
  AFTER INSERT OR UPDATE OR DELETE ON investments
  FOR EACH ROW
  EXECUTE FUNCTION update_goal_current_amount();

-- Trigger para adicionar criador como admin do grupo
CREATE OR REPLACE FUNCTION add_creator_as_admin()
RETURNS TRIGGER AS $$
BEGIN
  INSERT INTO group_members (group_id, user_id, is_admin)
  VALUES (NEW.id, NEW.created_by, true);
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER add_creator_to_group
  AFTER INSERT ON groups
  FOR EACH ROW EXECUTE FUNCTION add_creator_as_admin();
```

#### â° 5. ConfiguraÃ§Ã£o de Edge Functions e Cron Jobs

Para notificaÃ§Ãµes push e tarefas agendadas:

##### a) Crie a Edge Function para verificar lembretes:

No diretÃ³rio `supabase/functions/check-reminders/index.ts`:

```typescript
// Veja o arquivo completo no projeto
// Esta funÃ§Ã£o verifica lembretes pendentes e envia push notifications
```

##### b) Configure o Cron Job no Supabase:

```sql
-- Ativa a extensÃ£o pg_cron se ainda nÃ£o estiver ativa
CREATE EXTENSION IF NOT EXISTS pg_cron;

-- Cria o job para verificar lembretes a cada 5 minutos
SELECT cron.schedule(
  'check-reminders', -- nome do job
  '*/5 * * * *', -- a cada 5 minutos
  $$
    SELECT net.http_post(
      url:='https://seu-projeto.supabase.co/functions/v1/check-reminders',
      headers:=jsonb_build_object(
        'Authorization', 'Bearer ' || current_setting('app.settings.service_role_key'),
        'Content-Type', 'application/json'
      ),
      body:=jsonb_build_object('time', now())
    );
  $$
);
```

#### ğŸ”‘ 6. ConfiguraÃ§Ã£o de AutenticaÃ§Ã£o

No painel do Supabase:

1. **Email/Senha**: Ative em Authentication > Providers
2. **Email Templates**: Personalize os templates em portuguÃªs
3. **URL Configuration**: Configure as URLs de redirecionamento:
   - Site URL: `https://seu-dominio.com`
   - Redirect URLs: `https://seu-dominio.com/auth/callback`

#### ğŸš€ 7. ConfiguraÃ§Ã£o para PWA e Push Notifications

1. **Gere as chaves VAPID** para push notifications:

```bash
npx web-push generate-vapid-keys
```

2. **Configure os secrets no Supabase**:

```bash
supabase secrets set VAPID_PUBLIC_KEY=sua_chave_publica
supabase secrets set VAPID_PRIVATE_KEY=sua_chave_privada
```

3. **Configure o domÃ­nio permitido** para Service Workers nas configuraÃ§Ãµes do projeto

#### ğŸ“ 8. Migrations e Versionamento

Mantenha suas migrations organizadas:

```bash
# Criar nova migration
supabase migration new nome_da_migration

# Aplicar migrations localmente
supabase db push

# Aplicar em produÃ§Ã£o
supabase db push --db-url postgresql://...
```

#### âœ… 9. Checklist de ConfiguraÃ§Ã£o

- [ ] Todas as tabelas criadas
- [ ] RLS ativado em todas as tabelas
- [ ] PolÃ­ticas RLS configuradas
- [ ] FunÃ§Ãµes auxiliares criadas
- [ ] Triggers configurados
- [ ] Edge Functions deployadas
- [ ] Cron jobs agendados
- [ ] AutenticaÃ§Ã£o configurada
- [ ] Chaves VAPID geradas e configuradas
- [ ] VariÃ¡veis de ambiente configuradas no `.env`

Com todas essas configuraÃ§Ãµes, seu Zeni Wallet estarÃ¡ pronto para funcionar com seguranÃ§a total e todas as funcionalidades habilitadas!

### ğŸ› Reportando Bugs

Encontrou um problema? Por favor, abra uma [Issue](https://github.com/seu-usuario/zeni-wallet/issues) no GitHub seguindo este modelo:

**TÃ­tulo**: DescriÃ§Ã£o concisa do erro

**InformaÃ§Ãµes**:

- **Passos para reproduzir**: Como podemos ver o erro acontecendo?
- **Comportamento esperado vs. real**
- **Screenshots**: Se possÃ­vel, adicione imagens
- **Ambiente**: (Desktop/Mobile, Navegador, VersÃ£o)
- **Console errors**: Erros do console do navegador

### ğŸ¤ Como Contribuir (Pull Requests)

Quer ajudar a evoluir o Zeni Wallet? Adoramos contribuiÃ§Ãµes!

#### Processo de ContribuiÃ§Ã£o:

1. **Fork** o projeto
2. Crie uma **Branch** para sua feature (`git checkout -b feature/nova-funcionalidade`)
3. **Commit** suas mudanÃ§as (`git commit -m 'feat: Adiciona nova funcionalidade'`)
4. **Push** para a Branch (`git push origin feature/nova-funcionalidade`)
5. Abra um **Pull Request**

#### PadrÃµes de CÃ³digo:

- **Commits**: Use [Conventional Commits](https://www.conventionalcommits.org/)

  - `feat:` Nova funcionalidade
  - `fix:` CorreÃ§Ã£o de bug
  - `docs:` DocumentaÃ§Ã£o
  - `style:` FormataÃ§Ã£o
  - `refactor:` RefatoraÃ§Ã£o
  - `test:` Testes
  - `chore:` Tarefas gerais

- **TypeScript**: Sempre tipar completamente (evite `any`)
- **Componentes**: Use functional components com hooks
- **EstilizaÃ§Ã£o**: Tailwind classes (evite CSS inline)
- **SeguranÃ§a**: Sempre sanitize inputs do usuÃ¡rio

#### Dicas para Devs:

âœ… **DO's**:

- Utilize os componentes de UI existentes em `src/components/ui`
- Use `useSanitizedForm` para formulÃ¡rios
- Implemente loading states e error handling
- Teste em mobile primeiro (mobile-first)
- Adicione comentÃ¡rios JSDoc para funÃ§Ãµes complexas

âŒ **DON'Ts**:

- NÃ£o commitar `.env` ou secrets
- NÃ£o usar `console.log` em produÃ§Ã£o
- NÃ£o fazer queries diretas sem RLS
- NÃ£o ignorar TypeScript errors

### ğŸ§ª Testes

```bash
npm run test        # Executa os testes
npm run test:watch  # Modo watch
npm run test:coverage # RelatÃ³rio de cobertura
```

### ğŸ“š DocumentaÃ§Ã£o Adicional

- [ConfiguraÃ§Ã£o do Supabase](./docs/supabase-setup.md)
- [Guia de ContribuiÃ§Ã£o Detalhado](./docs/contributing.md)
- [Arquitetura e DecisÃµes TÃ©cnicas](./docs/architecture.md)
- [SeguranÃ§a e Boas PrÃ¡ticas](./docs/security.md)

### ğŸŒŸ Showcase

Usando o Zeni Wallet em produÃ§Ã£o? Adicione seu caso de uso [aqui](https://github.com/seu-usuario/zeni-wallet/discussions/categories/showcase)!

---

## ğŸ“„ LicenÃ§a

Este projeto estÃ¡ sob a licenÃ§a **MIT**. Consulte o arquivo [LICENSE](./LICENSE) para mais detalhes.

---

<p align="center">
  Feito com ğŸ’š para organizar sua vida financeira<br>
  <sub>Contribua com o projeto e ajude milhares de pessoas a terem controle financeiro!</sub>
</p>

<div align="center">
  <a href="https://github.com/seu-usuario/zeni-wallet/stargazers">â­ DÃª uma estrela</a> â€¢
  <a href="https://github.com/seu-usuario/zeni-wallet/issues">ğŸ› Reportar Bug</a> â€¢
  <a href="https://github.com/seu-usuario/zeni-wallet/discussions">ğŸ’¬ DiscussÃµes</a>
</div>
```
---

### src\App.css

**Language:** css  
**Size:** 648 Bytes  
**Last Modified:** 2025-08-28T19:03:37.247Z

```css
#root {
  max-width: 1280px;
  margin: 0 auto;
  padding: 2rem;
  text-align: center;
}

.logo {
  height: 6em;
  padding: 1.5em;
  will-change: filter;
  transition: filter 300ms;
}
.logo:hover {
  filter: drop-shadow(0 0 2em #646cffaa);
}
.logo.react:hover {
  filter: drop-shadow(0 0 2em #61dafbaa);
}

@keyframes logo-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@media (prefers-reduced-motion: no-preference) {
  a:nth-of-type(2) .logo {
    animation: logo-spin infinite 20s linear;
  }
}

.card {
  padding: 2em;
}

.read-the-docs {
  color: #888;
}
```
---

### src\App.tsx

**Language:** typescript  
**Size:** 3.6 KB  
**Last Modified:** 2025-11-27T13:08:55.260Z

```typescript
import { lazy, Suspense } from "react";
import { BrowserRouter, Routes, Route } from "react-router-dom";
import { QueryClient, QueryClientProvider } from "@tanstack/react-query";
import { Toaster } from "@/components/ui/toaster";
import { Toaster as Sonner } from "@/components/ui/sonner";
import { TooltipProvider } from "@/components/ui/tooltip";
import { ThemeProvider } from "@/components/theme-provider";

import { ProtectedRoute } from "@/components/auth/ProtectedRoute";
import { LoadingFallback } from "./components/LoadingFallback";

const Index = lazy(() => import("./pages/Index"));
const Auth = lazy(() => import("./pages/Auth"));
const Dashboard = lazy(() => import("./pages/Dashboard"));
const Transactions = lazy(() => import("./pages/Transactions"));
const Investments = lazy(() => import("./pages/Investments"));
const Groups = lazy(() => import("./pages/Groups"));
const JoinGroup = lazy(() => import("./pages/JoinGroup")); // NOVA PÃGINA
const NotFound = lazy(() => import("./pages/NotFound"));
const Reminder = lazy(() => import("./pages/Reminders"));
const Profile = lazy(() => import("./pages/Profile"));

const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      staleTime: 1000 * 60 * 5,
      gcTime: 1000 * 60 * 10,
      refetchOnWindowFocus: false,
      retry: 1,
    },
  },
});

const App = () => (
  <QueryClientProvider client={queryClient}>
    <ThemeProvider defaultTheme="system" storageKey="zeni-theme">
      <TooltipProvider>
        <Toaster />
        <Sonner />
        <BrowserRouter>
          <Suspense fallback={<LoadingFallback />}>
            <Routes>
              <Route path="/" element={<Index />} />
              <Route path="/auth" element={<Auth />} />
              
              {/* ROTA DE PROTEÃ‡ÃƒO */}
              <Route
                path="/dashboard"
                element={
                  <ProtectedRoute>
                    <Dashboard />
                  </ProtectedRoute>
                }
              />
              <Route
                path="/transactions"
                element={
                  <ProtectedRoute>
                    <Transactions />
                  </ProtectedRoute>
                }
              />
              <Route
                path="/investments"
                element={
                  <ProtectedRoute>
                    <Investments />
                  </ProtectedRoute>
                }
              />
              <Route
                path="/groups"
                element={
                  <ProtectedRoute>
                    <Groups />
                  </ProtectedRoute>
                }
              />
              
              {/* NOVA ROTA PARA ENTRAR NO GRUPO VIA LINK */}
              <Route
                path="/groups/join/:inviteId"
                element={
                    <JoinGroup />
                }
              />

              <Route
                path="/reminders"
                element={
                  <ProtectedRoute>
                    <Reminder />
                  </ProtectedRoute>
                }
              />
              <Route
                path="/profile"
                element={
                  <ProtectedRoute>
                    <Profile />
                  </ProtectedRoute>
                }
              />
              <Route path="*" element={<NotFound />} />
            </Routes>
          </Suspense>
        </BrowserRouter>
      </TooltipProvider>
    </ThemeProvider>
  </QueryClientProvider>
);

export default App;
```
---

### src\components\auth\ProtectedRoute.tsx

**Language:** typescript  
**Size:** 603 Bytes  
**Last Modified:** 2025-09-02T14:20:28.287Z

```typescript
import { Navigate } from 'react-router-dom';
import { useAuth } from '@/contexts/AuthContext';

interface ProtectedRouteProps {
  children: React.ReactNode;
}

export const ProtectedRoute = ({ children }: ProtectedRouteProps) => {
  const { user, loading } = useAuth();

  if (loading) {
    return (
      <div className="min-h-screen flex items-center justify-center">
        <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
      </div>
    );
  }

  if (!user) {
    return <Navigate to="/auth" replace />;
  }

  return <>{children}</>;
};
```
---

### src\components\dashboard\FixedBalanceCard.tsx

**Language:** typescript  
**Size:** 10.77 KB  
**Last Modified:** 2025-11-26T13:22:11.755Z

```typescript
import { useState, useEffect } from "react";
import { DollarSign, TrendingUp, TrendingDown, ChevronLeft, ChevronRight } from "@/lib/icons";
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { Button } from "@/components/ui/button";
import { supabase } from "@/integrations/supabase/client";
import { useToast } from "@/hooks/use-toast";
import { cn } from "@/lib/utils";

interface FixedTransaction {
  id: string;
  description: string;
  amount: number;
  type: "income" | "expense";
  category: string;
  recurrence_id: string;
}

const ITEMS_PER_PAGE = 5;

export const FixedBalanceCard = () => {
  const [fixedIncome, setFixedIncome] = useState<FixedTransaction[]>([]);
  const [fixedExpenses, setFixedExpenses] = useState<FixedTransaction[]>([]);
  const [loading, setLoading] = useState(true);
  const [incomePage, setIncomePage] = useState(1);
  const [expensePage, setExpensePage] = useState(1);
  const { toast } = useToast();

  useEffect(() => {
    loadFixedTransactions();
  }, []);

  const loadFixedTransactions = async () => {
    try {
      const {
        data: { user },
      } = await supabase.auth.getUser();
      if (!user) return;

      const { data, error } = await supabase
        .from("transactions")
        .select("id, description, amount, type, category, recurrence_id")
        .eq("user_id", user.id)
        .eq("is_fixed", true)
        .order("description", { ascending: true });

      if (error) throw error;

      const uniqueTransactions = new Map<string, FixedTransaction>();
      data?.forEach((t) => {
        const amount = typeof t.amount === "number" ? t.amount : parseFloat(t.amount || "0");
        if (!uniqueTransactions.has(t.recurrence_id)) {
          uniqueTransactions.set(t.recurrence_id, {
            id: t.id,
            description: t.description,
            amount: amount,
            type: t.type as "income" | "expense",
            category: t.category,
            recurrence_id: t.recurrence_id,
          });
        }
      });

      const uniqueArray = Array.from(uniqueTransactions.values());
      const income = uniqueArray.filter((t) => t.type === "income");
      const expenses = uniqueArray.filter((t) => t.type === "expense");

      setFixedIncome(income);
      setFixedExpenses(expenses);
    } catch (error) {
      console.error("Erro ao carregar lanÃ§amentos fixos:", error);
      toast({
        title: "Erro",
        description: "Erro ao carregar balanÃ§o fixo",
        variant: "destructive",
      });
    } finally {
      setLoading(false);
    }
  };

  const totalFixedIncome = fixedIncome.reduce((sum, t) => sum + t.amount, 0);
  const totalFixedExpenses = Math.abs(fixedExpenses.reduce((sum, t) => sum + t.amount, 0));
  const fixedBalance = totalFixedIncome - totalFixedExpenses;

  const totalIncomePages = Math.ceil(fixedIncome.length / ITEMS_PER_PAGE);
  const paginatedIncome = fixedIncome.slice((incomePage - 1) * ITEMS_PER_PAGE, incomePage * ITEMS_PER_PAGE);

  const totalExpensePages = Math.ceil(fixedExpenses.length / ITEMS_PER_PAGE);
  const paginatedExpenses = fixedExpenses.slice((expensePage - 1) * ITEMS_PER_PAGE, expensePage * ITEMS_PER_PAGE);

  const handlePrevIncomePage = () => setIncomePage((prev) => Math.max(prev - 1, 1));
  const handleNextIncomePage = () => setIncomePage((prev) => Math.min(prev + 1, totalIncomePages));
  const handlePrevExpensePage = () => setExpensePage((prev) => Math.max(prev - 1, 1));
  const handleNextExpensePage = () => setExpensePage((prev) => Math.min(prev + 1, totalExpensePages));

  if (loading) {
    return (
      <Card>
        <CardHeader>
          <CardTitle>BalanÃ§o Fixo Mensal</CardTitle>
        </CardHeader>
        <CardContent>
          <div className="animate-pulse space-y-2">
            <div className="h-4 bg-muted rounded"></div>
            <div className="h-4 bg-muted rounded"></div>
            <div className="h-4 bg-muted rounded"></div>
          </div>
        </CardContent>
      </Card>
    );
  }

  return (
    <Card>
      <CardHeader>
        <CardTitle className="flex items-center gap-2">
          <DollarSign className="h-5 w-5" />
          BalanÃ§o Fixo Mensal
        </CardTitle>
        <CardDescription>Receitas e despesas fixas que se repetem todos os meses</CardDescription>
      </CardHeader>
      <CardContent className="space-y-6">
        <div className="space-y-4">
          {/* Receitas Fixas */}
          <div>
            <div className="flex items-center justify-between mb-3">
              <h4 className="text-sm font-semibold flex items-center gap-2">
                <TrendingUp className="h-4 w-4 text-success" />
                Receitas Fixas
              </h4>
              <Badge variant="outline" className="text-success">
                {totalFixedIncome.toLocaleString("pt-BR", {
                  style: "currency",
                  currency: "BRL",
                })}
              </Badge>
            </div>
            <div className="space-y-2 min-h-[180px]">
              {" "}
              {paginatedIncome.length === 0 ? (
                <p className="text-xs text-muted-foreground text-center py-2">Nenhuma receita fixa cadastrada</p>
              ) : (
                paginatedIncome.map((transaction) => (
                  <div key={transaction.recurrence_id} className="flex items-center justify-between p-2 rounded-md bg-muted/30">
                    <div className="flex-1 overflow-hidden mr-2">
                      <p className="text-sm font-medium truncate" title={transaction.description}>
                        {transaction.description}
                      </p>
                      <p className="text-xs text-muted-foreground truncate" title={transaction.category}>
                        {transaction.category}
                      </p>
                    </div>
                    <span className="text-sm font-semibold text-success whitespace-nowrap">
                      +
                      {transaction.amount.toLocaleString("pt-BR", {
                        style: "currency",
                        currency: "BRL",
                      })}
                    </span>
                  </div>
                ))
              )}
            </div>
            {totalIncomePages > 1 && (
              <div className="flex items-center justify-end gap-2 mt-3">
                <span className="text-xs text-muted-foreground">
                  PÃ¡gina {incomePage} de {totalIncomePages}
                </span>
                <Button variant="outline" size="icon" className="h-7 w-7" onClick={handlePrevIncomePage} disabled={incomePage === 1}>
                  <ChevronLeft className="h-4 w-4" />
                </Button>
                <Button
                  variant="outline"
                  size="icon"
                  className="h-7 w-7"
                  onClick={handleNextIncomePage}
                  disabled={incomePage === totalIncomePages}
                >
                  <ChevronRight className="h-4 w-4" />
                </Button>
              </div>
            )}
          </div>

          <div>
            <div className="flex items-center justify-between mb-3">
              <h4 className="text-sm font-semibold flex items-center gap-2">
                <TrendingDown className="h-4 w-4 text-destructive" />
                Despesas Fixas
              </h4>
              <Badge variant="outline" className="text-destructive">
                -
                {totalFixedExpenses.toLocaleString("pt-BR", {
                  style: "currency",
                  currency: "BRL",
                })}
              </Badge>
            </div>
            <div className="space-y-2 min-h-[180px]">
              {" "}
              {paginatedExpenses.length === 0 ? (
                <p className="text-xs text-muted-foreground text-center py-2">Nenhuma despesa fixa cadastrada</p>
              ) : (
                paginatedExpenses.map((transaction) => (
                  <div key={transaction.recurrence_id} className="flex items-center justify-between p-2 rounded-md bg-muted/30">
                    <div className="flex-1 overflow-hidden mr-2">
                      <p className="text-sm font-medium truncate" title={transaction.description}>
                        {transaction.description}
                      </p>
                      <p className="text-xs text-muted-foreground truncate" title={transaction.category}>
                        {transaction.category}
                      </p>
                    </div>
                    <span className="text-sm font-semibold text-destructive whitespace-nowrap">
                      {Math.abs(transaction.amount).toLocaleString("pt-BR", {
                        style: "currency",
                        currency: "BRL",
                      })}
                    </span>
                  </div>
                ))
              )}
            </div>
            {totalExpensePages > 1 && (
              <div className="flex items-center justify-end gap-2 mt-3">
                <span className="text-xs text-muted-foreground">
                  PÃ¡gina {expensePage} de {totalExpensePages}
                </span>
                <Button variant="outline" size="icon" className="h-7 w-7" onClick={handlePrevExpensePage} disabled={expensePage === 1}>
                  <ChevronLeft className="h-4 w-4" />
                </Button>
                <Button
                  variant="outline"
                  size="icon"
                  className="h-7 w-7"
                  onClick={handleNextExpensePage}
                  disabled={expensePage === totalExpensePages}
                >
                  <ChevronRight className="h-4 w-4" />
                </Button>
              </div>
            )}
          </div>
        </div>

        <div className="pt-4 border-t">
          <div className="flex items-center justify-between">
            <h4 className="font-semibold">BalanÃ§o Mensal Fixo</h4>
            <span className={cn("text-lg font-bold", fixedBalance >= 0 ? "text-success" : "text-destructive")}>
              {fixedBalance.toLocaleString("pt-BR", {
                style: "currency",
                currency: "BRL",
              })}
            </span>
          </div>
          <p className="text-xs text-muted-foreground mt-1">
            {fixedBalance >= 0
              ? "VocÃª terÃ¡ este valor positivo mensalmente (com base nos lanÃ§amentos fixos)"
              : "VocÃª terÃ¡ este dÃ©ficit mensalmente (com base nos lanÃ§amentos fixos)"}
          </p>
        </div>
      </CardContent>
    </Card>
  );
};
```
---

### src\components\dashboard\MetricCard.tsx

**Language:** typescript  
**Size:** 1.3 KB  
**Last Modified:** 2025-08-28T19:03:37.250Z

```typescript
import { ReactNode } from "react";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { cn } from "@/lib/utils";

interface MetricCardProps {
  title: string;
  value: string;
  icon: ReactNode;
  change?: string;
  changeType?: "positive" | "negative" | "neutral";
  className?: string;
}

export const MetricCard = ({ 
  title, 
  value, 
  icon, 
  change, 
  changeType = "neutral",
  className 
}: MetricCardProps) => {
  return (
    <Card className={cn("relative overflow-hidden", className)}>
      <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
        <CardTitle className="text-sm font-medium text-muted-foreground">
          {title}
        </CardTitle>
        <div className="p-2 bg-primary/10 rounded-full">
          {icon}
        </div>
      </CardHeader>
      <CardContent>
        <div className="text-2xl font-bold">{value}</div>
        {change && (
          <p className={cn(
            "text-xs mt-1",
            changeType === "positive" && "text-success",
            changeType === "negative" && "text-destructive",
            changeType === "neutral" && "text-muted-foreground"
          )}>
            {change}
          </p>
        )}
      </CardContent>
    </Card>
  );
};
```
---

### src\components\dashboard\TransactionsList.tsx

**Language:** typescript  
**Size:** 5.7 KB  
**Last Modified:** 2025-10-31T13:45:28.306Z

```typescript
import { useState, useEffect } from "react";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { ArrowUpCircle, ArrowDownCircle, Calendar } from "@/lib/icons";
import { cn } from "@/lib/utils";
import { supabase } from "@/integrations/supabase/client";
import { useToast } from "@/hooks/use-toast";

interface Transaction {
  id: string;
  description: string;
  amount: number;
  type: "income" | "expense";
  category: string;
  date: string;
  group?: {
    name: string;
  };
}

export const TransactionsList = () => {
  const [transactions, setTransactions] = useState<Transaction[]>([]);
  const [loading, setLoading] = useState(true);
  const { toast } = useToast();

  useEffect(() => {
    loadTransactions();
  }, []);

  const loadTransactions = async () => {
    try {
      const { data, error } = await supabase
        .from("transactions")
        .select(
          `
          id,
          description,
          amount,
          type,
          category,
          date,
          group_id,
          groups!left (
            name
          )
        `
        )
        .order("date", { ascending: false })
        .limit(5);

      if (error) throw error;

      const formattedTransactions =
        data?.map((transaction) => ({
          id: transaction.id,
          description: transaction.description,
          amount: Number(transaction.amount),
          type: transaction.type as "income" | "expense",
          category: transaction.category,
          date: transaction.date,
          group: transaction.groups ? { name: transaction.groups.name } : undefined,
        })) || [];

      setTransactions(formattedTransactions);
    } catch (error) {
      console.error("Erro ao carregar transaÃ§Ãµes:", error);
      toast({
        variant: "destructive",
        title: "Erro",
        description: "NÃ£o foi possÃ­vel carregar as transaÃ§Ãµes",
      });
    } finally {
      setLoading(false);
    }
  };

  if (loading) {
    return (
      <Card>
        <CardHeader>
          <CardTitle className="flex items-center gap-2">
            <Calendar className="h-5 w-5" />
            TransaÃ§Ãµes Recentes
          </CardTitle>
        </CardHeader>
        <CardContent>
          <div className="space-y-4">
            {[...Array(3)].map((_, i) => (
              <div key={i} className="flex items-center justify-between p-3 rounded-lg border border-border">
                <div className="flex items-center gap-3">
                  <div className="w-10 h-10 bg-muted rounded-full animate-pulse" />
                  <div>
                    <div className="w-32 h-4 bg-muted rounded animate-pulse mb-2" />
                    <div className="w-20 h-3 bg-muted rounded animate-pulse" />
                  </div>
                </div>
                <div className="text-right">
                  <div className="w-20 h-4 bg-muted rounded animate-pulse mb-2" />
                  <div className="w-16 h-3 bg-muted rounded animate-pulse" />
                </div>
              </div>
            ))}
          </div>
        </CardContent>
      </Card>
    );
  }

  return (
    <Card>
      <CardHeader>
        <CardTitle className="flex items-center gap-2">
          <Calendar className="h-5 w-5" />
          TransaÃ§Ãµes Recentes
        </CardTitle>
      </CardHeader>
      <CardContent>
        <div className="space-y-4">
          {transactions.length === 0 ? (
            <p className="text-center text-muted-foreground py-4">Nenhuma transaÃ§Ã£o encontrada</p>
          ) : (
            transactions.map((transaction) => (
              <div
                key={transaction.id}
                className="flex items-center justify-between p-3 rounded-lg border border-border hover:bg-muted/50 transition-colors"
              >
                <div className="flex items-center gap-3">
                  <div
                    className={cn(
                      "p-2 rounded-full",
                      transaction.type === "income" ? "bg-success/10 text-success" : "bg-destructive/10 text-destructive"
                    )}
                  >
                    {transaction.type === "income" ? <ArrowUpCircle className="h-4 w-4" /> : <ArrowDownCircle className="h-4 w-4" />}
                  </div>
                  <div>
                    <p className="font-medium">{transaction.description}</p>
                    <div className="flex items-center gap-2 mt-1">
                      <Badge variant="secondary" className="text-xs">
                        {transaction.category}
                      </Badge>
                      {transaction.group && (
                        <Badge variant="outline" className="text-xs">
                          Grupo: {transaction.group.name}
                        </Badge>
                      )}
                    </div>
                  </div>
                </div>
                <div className="text-right">
                  <p className={cn("font-semibold", transaction.type === "income" ? "text-success" : "text-destructive")}>
                    {transaction.type === "income" ? "+" : ""}
                    {transaction.amount.toLocaleString("pt-BR", {
                      style: "currency",
                      currency: "BRL",
                    })}
                  </p>
                  <p className="text-xs text-muted-foreground">{new Date(transaction.date).toLocaleDateString("pt-BR")}</p>
                </div>
              </div>
            ))
          )}
        </div>
      </CardContent>
    </Card>
  );
};
```
---

### src\components\dialogs\AddEventDialog.tsx

**Language:** typescript  
**Size:** 4.69 KB  
**Last Modified:** 2025-11-28T20:00:24.271Z

```typescript
import { useState } from "react";
import { Calendar as CalendarIcon } from "lucide-react";

import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Textarea } from "@/components/ui/textarea";
import { useToast } from "@/hooks/use-toast";
import { supabase } from "@/integrations/supabase/client";
import { sanitizeInput, ensureAuthenticated } from "@/utils/security";
import { formatDateForInput } from "@/utils/date/dateutils";

interface AddEventDialogProps {
  trigger?: React.ReactNode;
  onSuccess?: () => void;
  defaultGroupId?: string; // NOVO PROP
}

export const AddEventDialog = ({ trigger, onSuccess, defaultGroupId }: AddEventDialogProps) => {
  const [open, setOpen] = useState(false);
  const [loading, setLoading] = useState(false);
  const [formData, setFormData] = useState({
    name: "",
    description: "",
    date: formatDateForInput(new Date()),
  });
  const { toast } = useToast();

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!formData.name) {
      toast({
        title: "Erro",
        description: "O nome do evento Ã© obrigatÃ³rio",
        variant: "destructive",
      });
      return;
    }

    setLoading(true);

    try {
      const userId = await ensureAuthenticated();

      const { error } = await supabase.from("events" as any).insert({
        user_id: userId,
        name: sanitizeInput(formData.name),
        description: sanitizeInput(formData.description),
        date: formData.date,
        group_id: defaultGroupId || null, // Salva o ID do grupo se existir
      });

      if (error) throw error;

      toast({
        title: "Sucesso",
        description: defaultGroupId ? "Evento de grupo criado!" : "Evento criado com sucesso!",
      });

      setFormData({
        name: "",
        description: "",
        date: formatDateForInput(new Date()),
      });
      setOpen(false);
      onSuccess?.();
    } catch (error) {
      console.error("Erro ao criar evento:", error);
      toast({
        title: "Erro",
        description: "Erro ao criar o evento. Tente novamente.",
        variant: "destructive",
      });
    } finally {
      setLoading(false);
    }
  };

  return (
    <Dialog open={open} onOpenChange={setOpen}>
      <DialogTrigger asChild>
        {trigger || (
          <Button variant="outline">
            <CalendarIcon className="h-4 w-4 mr-2" />
            Novo Evento
          </Button>
        )}
      </DialogTrigger>
      <DialogContent className="sm:max-w-[425px]">
        <DialogHeader>
          <DialogTitle>Criar Novo Evento {defaultGroupId ? "do Grupo" : ""}</DialogTitle>
          <DialogDescription>Crie um evento para agrupar mÃºltiplos lanÃ§amentos (ex: Viagem, Projeto).</DialogDescription>
        </DialogHeader>

        <form onSubmit={handleSubmit} className="space-y-4">
          <div className="space-y-2">
            <Label htmlFor="eventName">Nome do Evento *</Label>
            <Input
              id="eventName"
              placeholder="Ex: Viagem para Praia, Reforma da Casa"
              value={formData.name}
              onChange={(e) => setFormData((prev) => ({ ...prev, name: e.target.value }))}
              required
            />
          </div>

          <div className="space-y-2">
            <Label htmlFor="eventDate">Data de ReferÃªncia *</Label>
            <Input
              id="eventDate"
              type="date"
              value={formData.date}
              onChange={(e) => setFormData((prev) => ({ ...prev, date: e.target.value }))}
              required
            />
          </div>

          <div className="space-y-2">
            <Label htmlFor="eventDescription">DescriÃ§Ã£o</Label>
            <Textarea
              id="eventDescription"
              placeholder="Detalhes sobre este evento..."
              value={formData.description}
              onChange={(e) => setFormData((prev) => ({ ...prev, description: e.target.value }))}
              rows={3}
            />
          </div>

          <div className="flex gap-2 pt-4">
            <Button type="button" variant="outline" className="flex-1" onClick={() => setOpen(false)}>
              Cancelar
            </Button>
            <Button type="submit" className="flex-1" disabled={loading}>
              {loading ? "Criando..." : "Criar Evento"}
            </Button>
          </div>
        </form>
      </DialogContent>
    </Dialog>
  );
};
```
---

### src\components\dialogs\AddGoalDialog.tsx

**Language:** typescript  
**Size:** 8.03 KB  
**Last Modified:** 2025-10-31T15:17:33.334Z

```typescript
import { useState } from "react";
import { Target } from "@/lib/icons";

import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { Textarea } from "@/components/ui/textarea";
import { useToast } from "@/hooks/use-toast";
import { supabase } from "@/integrations/supabase/client";
import { sanitizeInput, sanitizeAmount, validateTransactionData, ensureAuthenticated, checkRateLimit } from "@/utils/security";

interface AddGoalDialogProps {
  trigger?: React.ReactNode;
  onSuccess?: () => void;
}

export const AddGoalDialog = ({ trigger, onSuccess }: AddGoalDialogProps) => {
  const [open, setOpen] = useState(false);
  const [loading, setLoading] = useState(false);
  const [formData, setFormData] = useState({
    name: "",
    target_amount: "",
    current_amount: "",
    color: "blue",
    description: "",
    target_date: "",
    priority: "5",
  });
  const { toast } = useToast();

  const colors = [
    { value: "blue", label: "Azul" },
    { value: "green", label: "Verde" },
    { value: "purple", label: "Roxo" },
    { value: "orange", label: "Laranja" },
    { value: "red", label: "Vermelho" },
    { value: "pink", label: "Rosa" },
  ];

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();

    if (!formData.name || !formData.target_amount) {
      toast({
        title: "Erro",
        description: "Preencha todos os campos obrigatÃ³rios",
        variant: "destructive",
      });
      return;
    }

    setLoading(true);

    try {
      const {
        data: { user },
      } = await supabase.auth.getUser();
      if (!user) throw new Error("UsuÃ¡rio nÃ£o autenticado");

      const targetAmount = parseFloat(formData.target_amount);
      const currentAmount = formData.current_amount ? parseFloat(formData.current_amount) : 0;
      const priority = parseInt(formData.priority);

      const { error } = await supabase.from("investment_goals").insert({
        user_id: user.id,
        name: formData.name,
        target_amount: targetAmount,
        current_amount: currentAmount,
        color: formData.color,
        description: formData.description || null,
        target_date: formData.target_date || null,
        priority: priority,
      });

      if (error) throw error;

      toast({
        title: "Sucesso",
        description: "Meta de investimento criada com sucesso!",
      });

      setFormData({
        name: "",
        target_amount: "",
        current_amount: "",
        color: "blue",
        description: "",
        target_date: "",
        priority: "5",
      });
      setOpen(false);
      onSuccess?.();
    } catch (error) {
      console.error("Erro ao salvar meta:", error);
      toast({
        title: "Erro",
        description: "Erro ao criar a meta. Tente novamente.",
        variant: "destructive",
      });
    } finally {
      setLoading(false);
    }
  };

  const defaultTrigger = (
    <Button>
      <Target className="h-4 w-4 mr-2" />
      Nova Meta
    </Button>
  );

  return (
    <Dialog open={open} onOpenChange={setOpen}>
      <DialogTrigger asChild>{trigger || defaultTrigger}</DialogTrigger>
      <DialogContent className="sm:max-w-[425px]">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2">
            <Target className="h-5 w-5 text-primary" />
            Nova Meta de Investimento
          </DialogTitle>
          <DialogDescription>Defina uma meta financeira para acompanhar seu progresso.</DialogDescription>
        </DialogHeader>

        <form onSubmit={handleSubmit} className="space-y-4">
          <div className="space-y-2">
            <Label htmlFor="name">Nome da Meta *</Label>
            <Input
              id="name"
              placeholder="Ex: Casa prÃ³pria, Aposentadoria..."
              value={formData.name}
              onChange={(e) => setFormData((prev) => ({ ...prev, name: e.target.value }))}
              required
            />
          </div>

          <div className="grid grid-cols-2 gap-4">
            <div className="space-y-2">
              <Label htmlFor="target_amount">Valor Alvo *</Label>
              <Input
                id="target_amount"
                type="number"
                step="0.01"
                min="0"
                placeholder="0,00"
                value={formData.target_amount}
                onChange={(e) => setFormData((prev) => ({ ...prev, target_amount: e.target.value }))}
                required
              />
            </div>

            <div className="space-y-2">
              <Label htmlFor="current_amount">Valor Atual</Label>
              <Input
                id="current_amount"
                type="number"
                step="0.01"
                min="0"
                placeholder="0,00"
                value={formData.current_amount}
                onChange={(e) => setFormData((prev) => ({ ...prev, current_amount: e.target.value }))}
              />
            </div>
          </div>

          <div className="grid grid-cols-2 gap-4">
            <div className="space-y-2">
              <Label htmlFor="color">Cor</Label>
              <Select value={formData.color} onValueChange={(value) => setFormData((prev) => ({ ...prev, color: value }))}>
                <SelectTrigger id="color">
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  {colors.map((color) => (
                    <SelectItem key={color.value} value={color.value}>
                      {color.label}
                    </SelectItem>
                  ))}
                </SelectContent>
              </Select>
            </div>

            <div className="space-y-2">
              <Label htmlFor="priority">Prioridade *</Label>
              <Select value={formData.priority} onValueChange={(value) => setFormData((prev) => ({ ...prev, priority: value }))}>
                <SelectTrigger id="priority">
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  <SelectItem value="1">1 - Mais Alta</SelectItem>
                  <SelectItem value="2">2 - Alta</SelectItem>
                  <SelectItem value="3">3 - MÃ©dia</SelectItem>
                  <SelectItem value="4">4 - Baixa</SelectItem>
                  <SelectItem value="5">5 - Mais Baixa</SelectItem>
                </SelectContent>
              </Select>
            </div>
          </div>

          <div className="space-y-2">
            <Label htmlFor="description">DescriÃ§Ã£o (opcional)</Label>
            <Textarea
              id="description"
              placeholder="Adicione detalhes sobre esta meta..."
              value={formData.description}
              onChange={(e) => setFormData((prev) => ({ ...prev, description: e.target.value }))}
              rows={3}
            />
          </div>

          <div className="space-y-2">
            <Label htmlFor="target_date">Data Alvo (opcional)</Label>
            <Input
              id="target_date"
              type="date"
              value={formData.target_date}
              onChange={(e) => setFormData((prev) => ({ ...prev, target_date: e.target.value }))}
            />
          </div>

          <div className="flex gap-2 pt-4">
            <Button type="button" variant="outline" className="flex-1" onClick={() => setOpen(false)}>
              Cancelar
            </Button>
            <Button type="submit" className="flex-1" disabled={loading}>
              {loading ? "Salvando..." : "Salvar"}
            </Button>
          </div>
        </form>
      </DialogContent>
    </Dialog>
  );
};
```
---

### src\components\dialogs\AddGroupDialog.tsx

**Language:** typescript  
**Size:** 7.31 KB  
**Last Modified:** 2025-11-27T13:08:55.271Z

```typescript
import { useState } from "react";
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Textarea } from "@/components/ui/textarea";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { useToast } from "@/hooks/use-toast";
import { useSanitizedForm } from "@/hooks/useSanitizedForm";
import { supabase } from "@/integrations/supabase/client";
import { sanitizeInput, sanitizeColor, validateGroupData, ensureAuthenticated, withRateLimit, SECURITY_LIMITS } from "@/utils/security";
import type { GroupData } from "@/utils/security/types";

interface AddGroupDialogProps {
  trigger?: React.ReactNode;
  onGroupCreated?: () => void;
}

interface FormData extends Partial<GroupData> {
  color?: string;
}

const colors = [
  { value: "blue", label: "Azul", class: "bg-blue-500" },
  { value: "green", label: "Verde", class: "bg-green-500" },
  { value: "red", label: "Vermelho", class: "bg-red-500" },
  { value: "yellow", label: "Amarelo", class: "bg-yellow-500" },
  { value: "purple", label: "Roxo", class: "bg-purple-500" },
  { value: "pink", label: "Rosa", class: "bg-pink-500" },
  { value: "orange", label: "Laranja", class: "bg-orange-500" },
  { value: "teal", label: "Azul-verde", class: "bg-teal-500" },
];

const colorToHex: Record<string, string> = {
  blue: "#3B82F6",
  green: "#10B981",
  red: "#EF4444",
  yellow: "#F59E0B",
  purple: "#8B5CF6",
  pink: "#EC4899",
  orange: "#F97316",
  teal: "#14B8A6",
};

export const AddGroupDialog = ({ trigger, onGroupCreated }: AddGroupDialogProps) => {
  const [open, setOpen] = useState(false);
  const { toast } = useToast();

  const {
    values: formData,
    errors,
    isSubmitting,
    handleChange,
    handleSubmit,
    resetForm,
  } = useSanitizedForm<FormData>({
    initialValues: {
      name: "",
      description: "",
      color: "blue",
    },
    sanitizers: {
      name: (v) => sanitizeInput(v, SECURITY_LIMITS.MAX_NAME_LENGTH),
      description: (v) => sanitizeInput(v, SECURITY_LIMITS.MAX_DESCRIPTION_LENGTH),
      color: (v) => v,
    },
    validators: {
      name: (v) => ({
        isValid: v.length > 0 && v.length <= SECURITY_LIMITS.MAX_NAME_LENGTH,
        error: v.length === 0 ? "Nome obrigatÃ³rio" : null,
      }),
      description: (v) => ({
        isValid: v.length <= SECURITY_LIMITS.MAX_DESCRIPTION_LENGTH,
        error: v.length > SECURITY_LIMITS.MAX_DESCRIPTION_LENGTH ? "DescriÃ§Ã£o muito longa" : null,
      }),
    },
    onSubmit: async (values) => {
      await submitGroup(values);
    },
  });

  const submitGroup = async (values: FormData) => {
    try {
      const userId = await ensureAuthenticated();
      const hexColor = colorToHex[values.color || "blue"];
      const sanitizedColor = sanitizeColor(hexColor);

      if (!sanitizedColor) {
        throw new Error("Cor invÃ¡lida");
      }

      const validationResult = validateGroupData({
        name: values.name!,
        description: values.description || null,
        color: sanitizedColor,
        created_by: userId,
      });

      if (!validationResult.isValid) {
        throw new Error(validationResult.error || "Dados invÃ¡lidos");
      }

      await withRateLimit(
        `group:${userId}`,
        async () => {
          // 1. Cria o grupo
          // O Trigger 'add_creator_to_group' no banco de dados irÃ¡ automaticamente
          // adicionar este usuÃ¡rio como administrador na tabela group_members.
          const { error } = await supabase
            .from("groups")
            .insert({
              name: values.name,
              description: values.description || null,
              color: sanitizedColor,
              created_by: userId,
            });

          if (error) throw error;
          
          // REMOVIDO: O bloco que tentava fazer o upsert manual em group_members
          // Isso causava o erro de RLS 403 Forbidden.
        },
        10
      );

      toast({
        title: "Sucesso",
        description: "Grupo criado com sucesso!",
      });

      resetForm();
      setOpen(false);
      if (onGroupCreated) onGroupCreated();
    } catch (error) {
      console.error("Erro ao criar grupo:", error);
      toast({
        title: "Erro",
        description: error instanceof Error ? error.message : "Erro ao criar grupo",
        variant: "destructive",
      });
    }
  };

  return (
    <Dialog open={open} onOpenChange={setOpen}>
      <DialogTrigger asChild>{trigger || <Button>Criar Grupo</Button>}</DialogTrigger>
      <DialogContent className="sm:max-w-[425px]">
        <DialogHeader>
          <DialogTitle>Criar Novo Grupo</DialogTitle>
          <DialogDescription>Crie um grupo para compartilhar despesas com outras pessoas</DialogDescription>
        </DialogHeader>
        <form onSubmit={handleSubmit} className="space-y-4">
          <div>
            <Label htmlFor="name">Nome do Grupo *</Label>
            <Input
              id="name"
              value={formData.name}
              onChange={(e) => handleChange("name", e.target.value)}
              maxLength={SECURITY_LIMITS.MAX_NAME_LENGTH}
              placeholder="Ex: FamÃ­lia, Casa, Viagem..."
            />
            {errors.name && <p className="text-sm text-destructive mt-1">{errors.name}</p>}
          </div>

          <div>
            <Label htmlFor="description">DescriÃ§Ã£o (opcional)</Label>
            <Textarea
              id="description"
              value={formData.description}
              onChange={(e) => handleChange("description", e.target.value)}
              maxLength={SECURITY_LIMITS.MAX_DESCRIPTION_LENGTH}
              placeholder="Descreva o propÃ³sito deste grupo..."
              rows={3}
            />
            {errors.description && <p className="text-sm text-destructive mt-1">{errors.description}</p>}
          </div>

          <div>
            <Label htmlFor="color">Cor do Grupo</Label>
            <Select value={formData.color} onValueChange={(value) => handleChange("color", value)}>
              <SelectTrigger>
                <SelectValue placeholder="Selecione uma cor" />
              </SelectTrigger>
              <SelectContent>
                {colors.map((color) => (
                  <SelectItem key={color.value} value={color.value}>
                    <div className="flex items-center gap-2">
                      <div className={`w-4 h-4 rounded-full ${color.class}`}></div>
                      {color.label}
                    </div>
                  </SelectItem>
                ))}
              </SelectContent>
            </Select>
          </div>

          <div className="flex gap-2">
            <Button type="button" variant="outline" className="flex-1" onClick={() => setOpen(false)}>
              Cancelar
            </Button>
            <Button type="submit" className="flex-1" disabled={isSubmitting}>
              {isSubmitting ? "Criando..." : "Criar Grupo"}
            </Button>
          </div>
        </form>
      </DialogContent>
    </Dialog>
  );
};
```
---

### src\components\dialogs\AddInvestmentDialog.tsx

**Language:** typescript  
**Size:** 11.12 KB  
**Last Modified:** 2025-11-27T13:08:55.285Z

```typescript
import { useState, useEffect } from "react";
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { PiggyBank } from "lucide-react";
import { INVESTMENT_TYPES } from "@/constants/investment-types";
import { useToast } from "@/hooks/use-toast";
import { supabase } from "@/integrations/supabase/client";
import { recalculateGoalBalance } from "@/utils/investments/investmentUtils";

interface Group {
  id: string;
  name: string;
}

interface InvestmentGoal {
  id: string;
  name: string;
  target_amount: number;
  current_amount: number;
}

interface AddInvestmentDialogProps {
  trigger?: React.ReactNode;
  onSuccess?: () => void;
  defaultGroupId?: string; // NOVO PROP
}

export const AddInvestmentDialog = ({ trigger, onSuccess, defaultGroupId }: AddInvestmentDialogProps) => {
  const [open, setOpen] = useState(false);
  const [loading, setLoading] = useState(false);
  const [groups, setGroups] = useState<Group[]>([]);
  const [investmentGoals, setInvestmentGoals] = useState<InvestmentGoal[]>([]);
  const [formData, setFormData] = useState({
    name: "",
    type: "",
    amount: "",
    quantity: "",
    unit_price: "",
    group_id: defaultGroupId || "none", // Usa default se houver
    goal_id: "none",
    maturity_date: "",
  });
  const { toast } = useToast();

  const showQuantityPriceFields = formData.type === "AÃ§Ãµes" || formData.type === "FIIs";

  useEffect(() => {
    if (open) {
      if (!defaultGroupId) {
        loadGroups();
      }
      loadInvestmentGoals();
    }
  }, [open, defaultGroupId]);

  const loadGroups = async () => {
    try {
      const { data } = await supabase.from("groups").select("id, name").order("name");
      setGroups(data || []);
    } catch (error) {
      console.error("Erro grupos:", error);
    }
  };

  const loadInvestmentGoals = async () => {
    try {
      const { data } = await supabase.from("investment_goals").select("id, name, target_amount, current_amount").order("name");
      setInvestmentGoals(data || []);
    } catch (error) {
      console.error("Erro metas:", error);
    }
  };

  const handleNameBlur = async () => {
    if (!formData.name) return;
    try {
      const { data } = await supabase
        .from("investments")
        .select("type, group_id, goal_id")
        .ilike("name", formData.name)
        .limit(1)
        .maybeSingle();

      if (data) {
        setFormData(prev => ({
          ...prev,
          type: prev.type || data.type,
          // MantÃ©m defaultGroupId se existir, senÃ£o usa o do histÃ³rico
          group_id: defaultGroupId ? defaultGroupId : (prev.group_id === "none" && data.group_id ? data.group_id : prev.group_id),
          goal_id: prev.goal_id === "none" && data.goal_id ? data.goal_id : prev.goal_id,
        }));
      }
    } catch (error) {
      // Silently fail
    }
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setLoading(true);

    try {
      const { data: { user } } = await supabase.auth.getUser();
      if (!user) throw new Error("UsuÃ¡rio nÃ£o autenticado");

      let calculatedAmount = 0;
      let quantity = null;
      let unitPrice = null;

      if (showQuantityPriceFields) {
        if (!formData.quantity || !formData.unit_price) {
          toast({ title: "Erro", description: "Preencha quantidade e preÃ§o", variant: "destructive" });
          setLoading(false);
          return;
        }
        quantity = parseFloat(formData.quantity);
        unitPrice = parseFloat(formData.unit_price);
        calculatedAmount = quantity * unitPrice;
      } else {
        if (!formData.amount) {
          toast({ title: "Erro", description: "Preencha o valor", variant: "destructive" });
          setLoading(false);
          return;
        }
        calculatedAmount = parseFloat(formData.amount);
      }

      const investmentData: any = {
        user_id: user.id,
        name: formData.name,
        type: formData.type,
        amount: calculatedAmount,
        current_value: calculatedAmount,
        quantity,
        unit_price: unitPrice,
        group_id: formData.group_id === "none" ? null : formData.group_id,
        goal_id: formData.goal_id === "none" ? null : formData.goal_id,
        maturity_date: formData.maturity_date || null,
      };

      const { error: insertError } = await supabase.from("investments").insert(investmentData);
      if (insertError) throw insertError;

      if (investmentData.goal_id) {
        await recalculateGoalBalance(investmentData.goal_id);
      }

      toast({ title: "Sucesso", description: "Aporte realizado com sucesso!" });
      
      setFormData({
        name: "",
        type: "",
        amount: "",
        quantity: "",
        unit_price: "",
        group_id: defaultGroupId || "none", // Reseta mantendo o default
        goal_id: "none",
        maturity_date: "",
      });
      setOpen(false);
      onSuccess?.();
    } catch (error) {
      console.error("Erro:", error);
      toast({ title: "Erro", description: "Falha ao salvar", variant: "destructive" });
    } finally {
      setLoading(false);
    }
  };

  const defaultTrigger = (
    <Button variant="outline" className="h-20 flex flex-col gap-2">
      <PiggyBank className="h-6 w-6" />
      <span className="text-sm">Investir</span>
    </Button>
  );

  return (
    <Dialog open={open} onOpenChange={setOpen}>
      <DialogTrigger asChild>{trigger || defaultTrigger}</DialogTrigger>
      <DialogContent className="sm:max-w-[425px]">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2">
            <PiggyBank className="h-5 w-5 text-primary" />
            Novo Investimento
          </DialogTitle>
          <DialogDescription>Adicione um novo aporte.</DialogDescription>
        </DialogHeader>
        <form onSubmit={handleSubmit} className="space-y-4">
          <div className="space-y-2">
            <Label htmlFor="name">Nome do Ativo *</Label>
            <Input
              id="name"
              placeholder="Ex: PETR4, CDB Banco X..."
              value={formData.name}
              onChange={(e) => setFormData((prev) => ({ ...prev, name: e.target.value }))}
              onBlur={handleNameBlur}
              required
            />
          </div>

          <div className="space-y-2">
            <Label htmlFor="type">Tipo *</Label>
            <Select value={formData.type} onValueChange={(value) => setFormData((prev) => ({ ...prev, type: value }))}>
              <SelectTrigger>
                <SelectValue placeholder="Selecione o tipo" />
              </SelectTrigger>
              <SelectContent>
                {INVESTMENT_TYPES.map((type) => (
                  <SelectItem key={type} value={type}>{type}</SelectItem>
                ))}
              </SelectContent>
            </Select>
          </div>

          {showQuantityPriceFields ? (
            <>
              <div className="grid grid-cols-2 gap-4">
                <div className="space-y-2">
                  <Label htmlFor="quantity">Quantidade</Label>
                  <Input
                    id="quantity"
                    type="number"
                    step="1"
                    value={formData.quantity}
                    onChange={(e) => setFormData((prev) => ({ ...prev, quantity: e.target.value }))}
                  />
                </div>
                <div className="space-y-2">
                  <Label htmlFor="unit_price">PreÃ§o UnitÃ¡rio</Label>
                  <Input
                    id="unit_price"
                    type="number"
                    step="0.01"
                    value={formData.unit_price}
                    onChange={(e) => setFormData((prev) => ({ ...prev, unit_price: e.target.value }))}
                  />
                </div>
              </div>
              {formData.quantity && formData.unit_price && (
                <div className="text-sm text-muted-foreground text-right">
                  Total: R$ {(parseFloat(formData.quantity) * parseFloat(formData.unit_price)).toFixed(2)}
                </div>
              )}
            </>
          ) : (
            <div className="space-y-2">
              <Label htmlFor="amount">Valor do Aporte *</Label>
              <Input
                id="amount"
                type="number"
                step="0.01"
                value={formData.amount}
                onChange={(e) => setFormData((prev) => ({ ...prev, amount: e.target.value }))}
              />
            </div>
          )}

          <div className="space-y-2">
            <Label htmlFor="goal">Vincular a uma Meta</Label>
            <Select value={formData.goal_id} onValueChange={(value) => setFormData((prev) => ({ ...prev, goal_id: value }))}>
              <SelectTrigger>
                <SelectValue placeholder="Selecione..." />
              </SelectTrigger>
              <SelectContent>
                <SelectItem value="none">Nenhuma meta</SelectItem>
                {investmentGoals.map((goal) => (
                  <SelectItem key={goal.id} value={goal.id}>
                    {goal.name}
                  </SelectItem>
                ))}
              </SelectContent>
            </Select>
          </div>

          {!defaultGroupId && (
            <div className="space-y-2">
              <Label htmlFor="group">Grupo</Label>
              <Select value={formData.group_id} onValueChange={(value) => setFormData((prev) => ({ ...prev, group_id: value }))}>
                <SelectTrigger>
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  <SelectItem value="none">Pessoal</SelectItem>
                  {groups.map((group) => (
                    <SelectItem key={group.id} value={group.id}>{group.name}</SelectItem>
                  ))}
                </SelectContent>
              </Select>
            </div>
          )}

          <div className="space-y-2">
            <Label htmlFor="maturity_date">Vencimento (opcional)</Label>
            <Input
              id="maturity_date"
              type="date"
              value={formData.maturity_date}
              onChange={(e) => setFormData((prev) => ({ ...prev, maturity_date: e.target.value }))}
            />
          </div>

          <div className="flex gap-2 mt-4">
            <Button type="button" variant="outline" className="flex-1" onClick={() => setOpen(false)}>
              Cancelar
            </Button>
            <Button type="submit" className="flex-1" disabled={loading}>
              {loading ? "Salvando..." : "Adicionar Aporte"}
            </Button>
          </div>
        </form>
      </DialogContent>
    </Dialog>
  );
};
```
---

### src\components\dialogs\AddReminderDialog.tsx

**Language:** typescript  
**Size:** 4.94 KB  
**Last Modified:** 2025-11-06T16:58:44.138Z

```typescript
import { useState } from "react";
import { Bell } from "lucide-react";

import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { Textarea } from "@/components/ui/textarea";

import { useReminders } from "@/hooks/useReminders";

import { formatDateTimeForDatabase } from "@/utils/date/dateutils";

import type { ReminderFormData, RepeatType } from "@/utils/types/reminder.types";

interface AddReminderDialogProps {
  trigger?: React.ReactNode;
  transactionId?: string;
  defaultTitle?: string;
  onSuccess?: () => void;
}

export const AddReminderDialog = ({ trigger, transactionId, defaultTitle, onSuccess }: AddReminderDialogProps) => {
  const [open, setOpen] = useState(false);
  const [formData, setFormData] = useState<ReminderFormData>({
    title: defaultTitle || "",
    description: "",
    reminder_date: "",
    repeat_type: "none",
  });

  const { createReminder } = useReminders();

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();

    try {
      const reminderDataToSave = {
        ...formData,
        reminder_date: formatDateTimeForDatabase(formData.reminder_date),
      };

      await createReminder(reminderDataToSave, transactionId);
      setOpen(false);
      setFormData({
        title: "",
        description: "",
        reminder_date: "",
        repeat_type: "none",
      });
      if (onSuccess) onSuccess();
    } catch (error) {
      console.error("Erro ao criar lembrete:", error);
    }
  };

  return (
    <Dialog open={open} onOpenChange={setOpen}>
      <DialogTrigger asChild>
        {trigger || (
          <Button variant="outline" size="sm">
            <Bell className="h-4 w-4 mr-2" />
            Adicionar Lembrete
          </Button>
        )}
      </DialogTrigger>
      <DialogContent className="sm:max-w-[425px]">
        <DialogHeader>
          <DialogTitle>Adicionar Lembrete</DialogTitle>
          <DialogDescription>Configure um lembrete para nÃ£o esquecer compromissos financeiros</DialogDescription>
        </DialogHeader>
        <form onSubmit={handleSubmit} className="space-y-4">
          <div className="space-y-2">
            <Label htmlFor="title">TÃ­tulo *</Label>
            <Input
              id="title"
              value={formData.title}
              onChange={(e) => setFormData((prev) => ({ ...prev, title: e.target.value }))}
              placeholder="Ex: Pagar conta de luz"
              required
            />
          </div>

          <div className="space-y-2">
            <Label htmlFor="description">DescriÃ§Ã£o</Label>
            <Textarea
              id="description"
              value={formData.description}
              onChange={(e) => setFormData((prev) => ({ ...prev, description: e.target.value }))}
              placeholder="InformaÃ§Ãµes adicionais sobre o lembrete"
              rows={3}
            />
          </div>

          <div className="space-y-2">
            <Label htmlFor="reminder_date">Data e Hora do Lembrete *</Label>
            <Input
              id="reminder_date"
              type="datetime-local"
              value={formData.reminder_date}
              onChange={(e) => setFormData((prev) => ({ ...prev, reminder_date: e.target.value }))}
              required
            />
            <p className="text-xs text-muted-foreground">VocÃª pode agendar lembretes para qualquer data e horÃ¡rio</p>
          </div>

          <div className="space-y-2">
            <Label htmlFor="repeat_type">Repetir</Label>
            <Select
              value={formData.repeat_type}
              onValueChange={(value) => setFormData((prev) => ({ ...prev, repeat_type: value as RepeatType }))}
            >
              <SelectTrigger>
                <SelectValue />
              </SelectTrigger>
              <SelectContent>
                <SelectItem value="none">NÃ£o repetir</SelectItem>
                <SelectItem value="daily">Diariamente</SelectItem>
                <SelectItem value="weekly">Semanalmente</SelectItem>
                <SelectItem value="monthly">Mensalmente</SelectItem>
                <SelectItem value="yearly">Anualmente</SelectItem>
              </SelectContent>
            </Select>
          </div>

          <div className="flex gap-2 pt-4">
            <Button type="button" variant="outline" className="flex-1" onClick={() => setOpen(false)}>
              Cancelar
            </Button>
            <Button type="submit" className="flex-1">
              Criar Lembrete
            </Button>
          </div>
        </form>
      </DialogContent>
    </Dialog>
  );
};
```
---

### src\components\dialogs\AddTransactionDialog.tsx

**Language:** typescript  
**Size:** 19.87 KB  
**Last Modified:** 2025-12-03T21:27:10.885Z

```typescript
import { useState, useEffect } from "react";
import { addMonths } from "date-fns";
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { Switch } from "@/components/ui/switch";
import { Separator } from "@/components/ui/separator";
import { Checkbox } from "@/components/ui/checkbox"; // Importando Checkbox
import { ScrollArea } from "@/components/ui/scroll-area"; // Para lista de membros

import { useToast } from "@/hooks/use-toast";
import { useReminders } from "@/hooks/useReminders";
import { supabase } from "@/integrations/supabase/client";

import {
  sanitizeInput,
  sanitizeAmount,
  sanitizeInteger,
  sanitizeDate,
  sanitizeUUID,
  validateTransactionData,
  ensureAuthenticated,
  checkGroupMembership,
  withRateLimit,
  SECURITY_LIMITS,
  ALLOWED_CATEGORIES,
} from "@/utils/security";
import { formatDateForInput, formatDateForDatabase, formatDateTimeForDatabase } from "@/utils/date/dateutils";

import type { TransactionData } from "@/utils/security/types";
import type { RepeatType } from "@/utils/types/reminder.types";

interface AddTransactionDialogProps {
  type: "income" | "expense";
  trigger?: React.ReactNode;
  onSuccess?: () => void;
  eventId?: string;
  defaultGroupId?: string;
}

interface TransactionFormData {
  description: string;
  amount: number;
  category: string;
  date: string;
  group_id: string;
  is_recurring: boolean;
  is_fixed: boolean;
  recurrence_count: number;
  // assigned_to removido em favor de split_with
}

interface ReminderFormData {
  enabled: boolean;
  reminder_date: string;
  repeat_type: RepeatType;
}

export const AddTransactionDialog = ({ type, trigger, onSuccess, eventId, defaultGroupId }: AddTransactionDialogProps) => {
  const [open, setOpen] = useState(false);
  const { toast } = useToast();
  const { createReminder } = useReminders();

  const [values, setValues] = useState<TransactionFormData>({
    description: "",
    amount: 0,
    category: "",
    date: formatDateForInput(new Date()),
    group_id: defaultGroupId || "personal",
    is_recurring: false,
    is_fixed: false,
    recurrence_count: 1,
  });

  // Estado para controlar quem estÃ¡ envolvido na transaÃ§Ã£o (Lista de IDs)
  // Inicializado vazio (false) conforme solicitado
  const [splitWith, setSplitWith] = useState<string[]>([]);

  const [reminderData, setReminderData] = useState<ReminderFormData>({
    enabled: false,
    reminder_date: "",
    repeat_type: "none",
  });

  const [groups, setGroups] = useState<Array<{ id: string; name: string }>>([]);
  const [groupMembers, setGroupMembers] = useState<Array<{ id: string; full_name: string }>>([]);
  const [isSubmitting, setIsSubmitting] = useState(false);

  const resetForm = () => {
    setValues({
      description: "",
      amount: 0,
      category: "",
      date: formatDateForInput(new Date()),
      group_id: defaultGroupId || "personal",
      is_recurring: false,
      is_fixed: false,
      recurrence_count: 1,
    });
    setSplitWith([]); // Reseta para vazio
    setReminderData({
      enabled: false,
      reminder_date: "",
      repeat_type: "none",
    });
  };

  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement> | { target: { name: string; value: any } }) => {
    const { name, value } = e.target;
    setValues((prev) => ({ ...prev, [name]: value }));
  };

  useEffect(() => {
    if (open) {
      if (!defaultGroupId && !eventId) {
        loadGroups();
      }
      if (defaultGroupId) {
        loadGroupMembers(defaultGroupId);
      }
    }
  }, [open, eventId, defaultGroupId]);

  useEffect(() => {
    if (values.group_id && values.group_id !== "personal" && values.group_id !== "none") {
      loadGroupMembers(values.group_id);
    } else {
      setGroupMembers([]);
      setSplitWith([]);
    }
  }, [values.group_id]);

  const loadGroups = async () => {
    try {
      const userId = await ensureAuthenticated();
      const { data, error } = await supabase
        .from("groups")
        .select("id, name")
        .or(`created_by.eq.${userId},id.in.(select group_id from group_members where user_id = ${userId})`);
      if (error) throw error;
      setGroups(data || []);
    } catch (error) {
      console.error("Erro ao carregar grupos:", error);
    }
  };

  const loadGroupMembers = async (groupId: string) => {
    try {
      // 1. Busca os IDs dos membros
      const { data: members, error: membersError } = await supabase.from("group_members").select("user_id").eq("group_id", groupId);

      if (membersError) throw membersError;

      if (!members || members.length === 0) {
        setGroupMembers([]);
        return;
      }

      // 2. Busca os perfis
      const userIds = members.map((m) => m.user_id);
      const { data: profiles, error: profilesError } = await supabase
        .from("profiles")
        .select("id, full_name, user_id") // user_id para mapeamento correto
        .in("user_id", userIds);

      if (profilesError) throw profilesError;

      const formattedMembers =
        profiles?.map((profile) => ({
          id: profile.user_id,
          full_name: profile.full_name || "Sem nome",
        })) || [];

      setGroupMembers(formattedMembers);

      // IMPORTANTE: Inicializamos vazio conforme solicitado ("normalmente false")
      setSplitWith([]);
    } catch (error) {
      console.error("Erro ao carregar membros do grupo:", error);
    }
  };

  // FunÃ§Ã£o para alternar seleÃ§Ã£o de membros
  const toggleMemberSelection = (memberId: string) => {
    setSplitWith(
      (prev) =>
        prev.includes(memberId)
          ? prev.filter((id) => id !== memberId) // Desmarcar
          : [...prev, memberId] // Marcar
    );
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();

    if (isSubmitting) return;
    setIsSubmitting(true);
    try {
      const userId = await ensureAuthenticated();
      const amount = sanitizeAmount(values.amount);
      if (amount <= 0) {
        throw new Error("O valor deve ser maior que zero");
      }

      // ValidaÃ§Ã£o de grupo
      if (values.group_id && values.group_id !== "personal" && values.group_id !== "none") {
        if (splitWith.length === 0) {
          throw new Error("Selecione pelo menos um membro envolvido na transaÃ§Ã£o.");
        }
      }

      const sanitizedData: TransactionData = {
        description: sanitizeInput(values.description),
        amount,
        category: sanitizeInput(values.category),
        date: sanitizeDate(values.date),
        group_id: values.group_id && values.group_id !== "personal" && values.group_id !== "none" ? sanitizeUUID(values.group_id) : null,
        is_recurring: Boolean(values.is_recurring),
        is_fixed: Boolean(values.is_fixed),
        event_id: eventId ? sanitizeUUID(eventId) : null,
      };

      const validationErrors = validateTransactionData(sanitizedData);
      if (validationErrors.length > 0) {
        throw new Error(validationErrors.join(", "));
      }

      if (sanitizedData.group_id) {
        const isMember = await checkGroupMembership(userId, sanitizedData.group_id);
        if (!isMember) {
          throw new Error("VocÃª nÃ£o tem permissÃ£o para adicionar transaÃ§Ãµes a este grupo");
        }
      }

      await withRateLimit(
        `transaction:${userId}`,
        async () => {
          const recurrenceId = values.is_recurring || values.is_fixed ? crypto.randomUUID() : null;
          const recurrenceCount = sanitizeInteger(values.recurrence_count);
          const iterations = values.is_fixed ? 12 : recurrenceCount;
          const transactionsToInsert = [];

          const baseDate = new Date(values.date + "T00:00:00");

          // LÃ³gica de DivisÃ£o (Simplificada para criaÃ§Ã£o de registros)
          // Se for grupo, cria a transaÃ§Ã£o principal.
          // Nota: Como o banco atual nÃ£o tem tabela de "splits", vamos atribuir ao criador (userId)
          // mas idealmente salvarÃ­amos os IDs de 'splitWith' em algum lugar.
          // Para este exemplo, manteremos o fluxo padrÃ£o de criaÃ§Ã£o.

          for (let i = 0; i < iterations; i++) {
            const transactionDate = addMonths(baseDate, i);

            transactionsToInsert.push({
              user_id: userId, // Criador da transaÃ§Ã£o
              description: sanitizedData.description,
              amount: type === "expense" ? -Math.abs(amount) : Math.abs(amount),
              type,
              category: sanitizedData.category,
              group_id: sanitizedData.group_id,
              date: formatDateForDatabase(transactionDate),
              is_recurring: sanitizedData.is_recurring,
              is_fixed: sanitizedData.is_fixed,
              recurrence_id: recurrenceId,
              recurrence_count: recurrenceCount,
              event_id: sanitizedData.event_id,
              // Futuramente: salvar splitWith em uma coluna metadata ou tabela relacionada
            });
          }

          const { data: insertedTransactions, error } = await supabase.from("transactions").insert(transactionsToInsert).select();
          if (error) throw error;

          if (reminderData.enabled && reminderData.reminder_date && insertedTransactions?.[0]) {
            const reminderDateTime = formatDateTimeForDatabase(reminderData.reminder_date);
            await createReminder(
              {
                title: `Lembrete: ${sanitizedData.description}`,
                description: `${type === "income" ? "Receita" : "Despesa"} de ${amount.toLocaleString("pt-BR", {
                  style: "currency",
                  currency: "BRL",
                })}`,
                reminder_date: reminderDateTime,
                repeat_type: reminderData.repeat_type,
              },
              insertedTransactions[0].id
            );
          }
        },
        30
      );
      toast({
        title: "Sucesso",
        description: "TransaÃ§Ã£o adicionada com sucesso!",
      });
      resetForm();
      setOpen(false);
      if (onSuccess) onSuccess();
    } catch (error) {
      console.error("Erro ao criar transaÃ§Ã£o:", error);
      toast({
        title: "Erro",
        description: error instanceof Error ? error.message : "Erro ao criar transaÃ§Ã£o",
        variant: "destructive",
      });
    } finally {
      setIsSubmitting(false);
    }
  };

  return (
    <Dialog open={open} onOpenChange={setOpen}>
      <DialogTrigger asChild>{trigger || <Button>{type === "income" ? "Adicionar Receita" : "Adicionar Despesa"}</Button>}</DialogTrigger>
      <DialogContent className="sm:max-w-[500px] max-h-[90vh] overflow-y-auto">
        <DialogHeader>
          <DialogTitle>Adicionar {type === "income" ? "Receita" : "Despesa"}</DialogTitle>
          <DialogDescription>
            Preencha os dados {eventId ? "do item do evento" : `da ${type === "income" ? "receita" : "despesa"}`}
          </DialogDescription>
        </DialogHeader>
        <form onSubmit={handleSubmit} className="space-y-4">
          <div className="space-y-2">
            <Label htmlFor="description">DescriÃ§Ã£o *</Label>
            <Input
              id="description"
              name="description"
              value={values.description}
              onChange={handleInputChange}
              placeholder="Ex: Passagem aÃ©rea, Jantar..."
              required
            />
          </div>

          <div className="grid grid-cols-2 gap-4">
            <div className="space-y-2">
              <Label htmlFor="amount">Valor *</Label>
              <Input
                id="amount"
                name="amount"
                type="number"
                step="0.01"
                min="0.01"
                value={values.amount || ""}
                onChange={handleInputChange}
                placeholder="0,00"
                required
              />
            </div>

            <div className="space-y-2">
              <Label htmlFor="date">Data *</Label>
              <Input id="date" name="date" type="date" value={values.date} onChange={handleInputChange} required />
            </div>
          </div>

          <div className="space-y-2">
            <Label htmlFor="category">Categoria *</Label>
            <Select
              name="category"
              value={values.category}
              onValueChange={(value) => handleInputChange({ target: { name: "category", value } } as any)}
            >
              <SelectTrigger>
                <SelectValue placeholder="Selecione a categoria" />
              </SelectTrigger>
              <SelectContent>
                {ALLOWED_CATEGORIES.map((cat) => (
                  <SelectItem key={cat} value={cat}>
                    {cat}
                  </SelectItem>
                ))}
              </SelectContent>
            </Select>
          </div>

          {!eventId && !defaultGroupId && (
            <div className="space-y-2">
              <Label htmlFor="group_id">Grupo</Label>
              <Select
                name="group_id"
                value={values.group_id}
                onValueChange={(value) => handleInputChange({ target: { name: "group_id", value } } as any)}
              >
                <SelectTrigger>
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  <SelectItem value="personal">Pessoal</SelectItem>
                  {groups.map((group) => (
                    <SelectItem key={group.id} value={group.id}>
                      {group.name}
                    </SelectItem>
                  ))}
                </SelectContent>
              </Select>
            </div>
          )}

          {/* NOVA ÃREA DE SELEÃ‡ÃƒO MÃšLTIPLA DE MEMBROS */}
          {values.group_id !== "personal" && values.group_id !== "none" && groupMembers.length > 0 && (
            <div className="space-y-2">
              <Label>Quem estÃ¡ envolvido? (Dividir com)</Label>
              <ScrollArea className="h-32 rounded-md border p-2">
                <div className="space-y-2">
                  {groupMembers.map((member) => (
                    <div key={member.id} className="flex items-center space-x-2">
                      <Checkbox
                        id={`member-${member.id}`}
                        checked={splitWith.includes(member.id)}
                        onCheckedChange={() => toggleMemberSelection(member.id)}
                      />
                      <label
                        htmlFor={`member-${member.id}`}
                        className="text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer"
                      >
                        {member.full_name}
                      </label>
                    </div>
                  ))}
                </div>
              </ScrollArea>
              <p className="text-xs text-muted-foreground">Selecione quem participa desta despesa.</p>
            </div>
          )}

          <Separator />

          {!eventId && (
            <>
              <div className="flex items-center justify-between">
                <div className="space-y-0.5">
                  <Label htmlFor="is_recurring">TransaÃ§Ã£o Recorrente</Label>
                  <p className="text-sm text-muted-foreground">Repetir por um nÃºmero especÃ­fico de vezes</p>
                </div>
                <Switch
                  id="is_recurring"
                  name="is_recurring"
                  checked={values.is_recurring}
                  onCheckedChange={(checked) => handleInputChange({ target: { name: "is_recurring", value: checked } } as any)}
                />
              </div>

              {values.is_recurring && (
                <div className="space-y-2">
                  <Label htmlFor="recurrence_count">NÃºmero de RepetiÃ§Ãµes</Label>
                  <Input
                    id="recurrence_count"
                    name="recurrence_count"
                    type="number"
                    min="1"
                    max={SECURITY_LIMITS.MAX_RECURRENCE_COUNT}
                    value={values.recurrence_count}
                    onChange={handleInputChange}
                  />
                </div>
              )}

              <div className="flex items-center justify-between">
                <div className="space-y-0.5">
                  <Label htmlFor="is_fixed">LanÃ§amento Fixo</Label>
                  <p className="text-sm text-muted-foreground">Repetir mensalmente por 12 meses</p>
                </div>
                <Switch
                  id="is_fixed"
                  name="is_fixed"
                  checked={values.is_fixed}
                  onCheckedChange={(checked) => handleInputChange({ target: { name: "is_fixed", value: checked } } as any)}
                />
              </div>
              <Separator />
            </>
          )}

          <div className="space-y-4">
            <div className="flex items-center justify-between">
              <div className="space-y-0.5">
                <Label htmlFor="reminder_enabled">Adicionar Lembrete</Label>
                <p className="text-sm text-muted-foreground">Receber notificaÃ§Ã£o sobre esta transaÃ§Ã£o</p>
              </div>
              <Switch
                id="reminder_enabled"
                checked={reminderData.enabled}
                onCheckedChange={(checked) => setReminderData((prev) => ({ ...prev, enabled: checked }))}
              />
            </div>

            {reminderData.enabled && (
              <>
                <div className="space-y-2">
                  <Label htmlFor="reminder_date">Data e Hora do Lembrete</Label>
                  <Input
                    id="reminder_date"
                    type="datetime-local"
                    value={reminderData.reminder_date}
                    onChange={(e) => setReminderData((prev) => ({ ...prev, reminder_date: e.target.value }))}
                  />
                </div>

                <div className="space-y-2">
                  <Label htmlFor="reminder_repeat">Repetir Lembrete</Label>
                  <Select
                    value={reminderData.repeat_type}
                    onValueChange={(value) => setReminderData((prev) => ({ ...prev, repeat_type: value as RepeatType }))}
                  >
                    <SelectTrigger>
                      <SelectValue />
                    </SelectTrigger>
                    <SelectContent>
                      <SelectItem value="none">NÃ£o repetir</SelectItem>
                      <SelectItem value="daily">Diariamente</SelectItem>
                      <SelectItem value="weekly">Semanalmente</SelectItem>
                      <SelectItem value="monthly">Mensalmente</SelectItem>
                      <SelectItem value="yearly">Anualmente</SelectItem>
                    </SelectContent>
                  </Select>
                </div>
              </>
            )}
          </div>

          <div className="flex gap-2 pt-4">
            <Button type="button" variant="outline" className="flex-1" onClick={() => setOpen(false)} disabled={isSubmitting}>
              Cancelar
            </Button>
            <Button type="submit" className="flex-1" disabled={isSubmitting}>
              {isSubmitting ? "Salvando..." : "Salvar"}
            </Button>
          </div>
        </form>
      </DialogContent>
    </Dialog>
  );
};
```
---

### src\components\dialogs\EditGoalDialog.tsx

**Language:** typescript  
**Size:** 8.59 KB  
**Last Modified:** 2025-11-25T21:08:56.804Z

```typescript
import { useState, useEffect } from "react";
import { Target } from "lucide-react";
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { Textarea } from "@/components/ui/textarea";
import { useToast } from "@/hooks/use-toast";
import { supabase } from "@/integrations/supabase/client";

interface InvestmentGoal {
  id: string;
  name: string;
  target_amount: number;
  current_amount: number;
  color: string;
  description?: string;
  target_date?: string;
  priority: number;
}

interface EditGoalDialogProps {
  goal: InvestmentGoal | null;
  open: boolean;
  onOpenChange: (open: boolean) => void;
  onSuccess?: () => void;
  onClose: () => void; // Adicionado para compatibilidade
}

export const EditGoalDialog = ({ goal, open, onOpenChange, onSuccess, onClose }: EditGoalDialogProps) => {
  const [loading, setLoading] = useState(false);
  const [formData, setFormData] = useState({
    name: "",
    target_amount: "",
    current_amount: "", // Permitir ediÃ§Ã£o manual do valor atual caso necessÃ¡rio, ou deixar readonly
    color: "blue",
    description: "",
    target_date: "",
    priority: "5",
  });
  const { toast } = useToast();

  const colors = [
    { value: "blue", label: "Azul" },
    { value: "green", label: "Verde" },
    { value: "purple", label: "Roxo" },
    { value: "orange", label: "Laranja" },
    { value: "red", label: "Vermelho" },
    { value: "pink", label: "Rosa" },
  ];

  // Preenche o formulÃ¡rio quando a meta selecionada muda
  useEffect(() => {
    if (goal) {
      setFormData({
        name: goal.name,
        target_amount: goal.target_amount.toString(),
        current_amount: goal.current_amount.toString(),
        color: goal.color || "blue",
        description: goal.description || "",
        target_date: goal.target_date || "",
        priority: (goal.priority || 5).toString(),
      });
    }
  }, [goal]);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!goal) return;

    if (!formData.name || !formData.target_amount) {
      toast({
        title: "Erro",
        description: "Preencha todos os campos obrigatÃ³rios",
        variant: "destructive",
      });
      return;
    }

    setLoading(true);

    try {
      const targetAmount = parseFloat(formData.target_amount);
      // Opcional: permitir editar o valor atual manualmente se houver descompasso
      const currentAmount = parseFloat(formData.current_amount);
      const priority = parseInt(formData.priority);

      const { error } = await supabase
        .from("investment_goals")
        .update({
          name: formData.name,
          target_amount: targetAmount,
          current_amount: currentAmount,
          color: formData.color,
          description: formData.description || null,
          target_date: formData.target_date || null,
          priority: priority,
        })
        .eq("id", goal.id);

      if (error) throw error;

      toast({
        title: "Sucesso",
        description: "Meta atualizada com sucesso!",
      });

      onOpenChange(false);
      onClose(); // Fecha via prop de controle do pai
      onSuccess?.(); // Recarrega dados no pai
    } catch (error) {
      console.error("Erro ao atualizar meta:", error);
      toast({
        title: "Erro",
        description: "Erro ao atualizar a meta. Tente novamente.",
        variant: "destructive",
      });
    } finally {
      setLoading(false);
    }
  };

  return (
    <Dialog open={open} onOpenChange={onOpenChange}>
      <DialogContent className="sm:max-w-[425px]">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2">
            <Target className="h-5 w-5 text-primary" />
            Editar Meta
          </DialogTitle>
          <DialogDescription>Atualize as caracterÃ­sticas da sua meta.</DialogDescription>
        </DialogHeader>

        <form onSubmit={handleSubmit} className="space-y-4">
          <div className="space-y-2">
            <Label htmlFor="edit-name">Nome da Meta *</Label>
            <Input
              id="edit-name"
              placeholder="Ex: Casa prÃ³pria..."
              value={formData.name}
              onChange={(e) => setFormData((prev) => ({ ...prev, name: e.target.value }))}
              required
            />
          </div>

          <div className="grid grid-cols-2 gap-4">
            <div className="space-y-2">
              <Label htmlFor="edit-target_amount">Valor Alvo *</Label>
              <Input
                id="edit-target_amount"
                type="number"
                step="0.01"
                min="0"
                placeholder="0,00"
                value={formData.target_amount}
                onChange={(e) => setFormData((prev) => ({ ...prev, target_amount: e.target.value }))}
                required
              />
            </div>

            <div className="space-y-2">
              <Label htmlFor="edit-current_amount">Valor Atual</Label>
              <Input
                id="edit-current_amount"
                type="number"
                step="0.01"
                min="0"
                placeholder="0,00"
                value={formData.current_amount}
                onChange={(e) => setFormData((prev) => ({ ...prev, current_amount: e.target.value }))}
                className="bg-muted"
                // Recomendado deixar readonly se a intenÃ§Ã£o Ã© que apenas investimentos alterem isso,
                // mas deixei editÃ¡vel caso precise corrigir erros manuais.
              />
            </div>
          </div>

          <div className="grid grid-cols-2 gap-4">
            <div className="space-y-2">
              <Label htmlFor="edit-color">Cor</Label>
              <Select value={formData.color} onValueChange={(value) => setFormData((prev) => ({ ...prev, color: value }))}>
                <SelectTrigger id="edit-color">
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  {colors.map((color) => (
                    <SelectItem key={color.value} value={color.value}>
                      {color.label}
                    </SelectItem>
                  ))}
                </SelectContent>
              </Select>
            </div>

            <div className="space-y-2">
              <Label htmlFor="edit-priority">Prioridade</Label>
              <Select value={formData.priority} onValueChange={(value) => setFormData((prev) => ({ ...prev, priority: value }))}>
                <SelectTrigger id="edit-priority">
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  <SelectItem value="1">1 - Alta</SelectItem>
                  <SelectItem value="2">2 - MÃ©dia-Alta</SelectItem>
                  <SelectItem value="3">3 - MÃ©dia</SelectItem>
                  <SelectItem value="4">4 - Baixa</SelectItem>
                  <SelectItem value="5">5 - MÃ­nima</SelectItem>
                </SelectContent>
              </Select>
            </div>
          </div>

          <div className="space-y-2">
            <Label htmlFor="edit-description">DescriÃ§Ã£o</Label>
            <Textarea
              id="edit-description"
              placeholder="Detalhes..."
              value={formData.description}
              onChange={(e) => setFormData((prev) => ({ ...prev, description: e.target.value }))}
              rows={3}
            />
          </div>

          <div className="space-y-2">
            <Label htmlFor="edit-target_date">Data Alvo</Label>
            <Input
              id="edit-target_date"
              type="date"
              value={formData.target_date}
              onChange={(e) => setFormData((prev) => ({ ...prev, target_date: e.target.value }))}
            />
          </div>

          <div className="flex gap-2 pt-4">
            <Button type="button" variant="outline" className="flex-1" onClick={onClose}>
              Cancelar
            </Button>
            <Button type="submit" className="flex-1" disabled={loading}>
              {loading ? "Salvando..." : "Salvar AlteraÃ§Ãµes"}
            </Button>
          </div>
        </form>
      </DialogContent>
    </Dialog>
  );
};
```
---

### src\components\dialogs\EditGroupDialog.tsx

**Language:** typescript  
**Size:** 19.89 KB  
**Last Modified:** 2025-11-27T17:53:44.867Z

```typescript
import { useState, useEffect } from "react";
import { Users, UserPlus, UserMinus, Shield, Mail, Trash2, AlertTriangle, Link as LinkIcon, Copy, Check } from "lucide-react";
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle, DialogTrigger } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { Textarea } from "@/components/ui/textarea";
import { Badge } from "@/components/ui/badge";
import { Avatar, AvatarFallback } from "@/components/ui/avatar";
import { Switch } from "@/components/ui/switch";
import { useToast } from "@/hooks/use-toast";
import { supabase } from "@/integrations/supabase/client";
import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
} from "@/components/ui/alert-dialog";

interface GroupMember {
  id: string;
  user_id: string;
  is_admin: boolean;
  profiles?: {
    full_name: string | null;
  } | null;
}

interface Invite {
  id: string;
  email: string;
  status: string;
  created_at: string;
}

interface EditGroupDialogProps {
  groupId: string | null;
  isOpen: boolean;
  onClose: () => void;
  onSuccess?: () => void;
}

export const EditGroupDialog = ({ groupId, isOpen, onClose, onSuccess }: EditGroupDialogProps) => {
  const [loading, setLoading] = useState(false);
  const [currentUserId, setCurrentUserId] = useState<string | null>(null);
  const [groupOwnerId, setGroupOwnerId] = useState<string | null>(null);
  const [isGroupAdmin, setIsGroupAdmin] = useState(false);
  const [deleteAlertOpen, setDeleteAlertOpen] = useState(false);

  const [formData, setFormData] = useState({
    name: "",
    description: "",
    color: "blue",
  });
  const [members, setMembers] = useState<GroupMember[]>([]);
  const [pendingInvites, setPendingInvites] = useState<Invite[]>([]);
  const [newMemberEmail, setNewMemberEmail] = useState("");

  const [inviteLink, setInviteLink] = useState<string | null>(null);
  const [isCopied, setIsCopied] = useState(false);

  const { toast } = useToast();

  const colors = [
    { value: "blue", label: "Azul", class: "bg-blue-500" },
    { value: "green", label: "Verde", class: "bg-green-500" },
    { value: "purple", label: "Roxo", class: "bg-purple-500" },
    { value: "red", label: "Vermelho", class: "bg-red-500" },
    { value: "yellow", label: "Amarelo", class: "bg-yellow-500" },
    { value: "pink", label: "Rosa", class: "bg-pink-500" },
    { value: "orange", label: "Laranja", class: "bg-orange-500" },
    { value: "indigo", label: "Ãndigo", class: "bg-indigo-500" },
  ];

  useEffect(() => {
    if (groupId) {
      fetchGroupData();
      fetchMembers();
      fetchPendingInvites();
    }
  }, [groupId]);

  const fetchGroupData = async () => {
    try {
      const { data: groupData, error: groupError } = await supabase.from("groups").select("*").eq("id", groupId).single();

      if (groupError) throw groupError;

      setFormData({
        name: groupData.name,
        description: groupData.description || "",
        color: groupData.color || "blue",
      });

      setGroupOwnerId(groupData.created_by);

      const {
        data: { user },
      } = await supabase.auth.getUser();
      if (user) {
        setCurrentUserId(user.id);
        setIsGroupAdmin(groupData.created_by === user.id);
      }
    } catch (error) {
      console.error("Erro ao buscar dados do grupo:", error);
      toast({ title: "Erro", description: "NÃ£o foi possÃ­vel carregar os dados do grupo.", variant: "destructive" });
    }
  };

  const fetchMembers = async () => {
    if (!groupId) return;

    try {
      const { data, error } = await supabase
        .from("group_members")
        .select(
          `
          id,
          user_id,
          is_admin,
          profiles (
            full_name
          )
        `
        )
        .eq("group_id", groupId);

      if (error) throw error;
      setMembers(data || []);
    } catch (error) {
      console.error("Erro ao buscar membros:", error);
    }
  };

  const fetchPendingInvites = async () => {
    if (!groupId) return;

    try {
      const { data, error } = await supabase.from("group_invites").select("*").eq("group_id", groupId).eq("status", "pending");

      if (error) throw error;
      setPendingInvites(data || []);
    } catch (error) {
      console.error("Erro ao buscar convites:", error);
    }
  };

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!groupId || !isGroupAdmin) return;

    setLoading(true);
    try {
      const { error } = await supabase
        .from("groups")
        .update({
          name: formData.name,
          description: formData.description,
          color: formData.color,
          updated_at: new Date().toISOString(),
        })
        .eq("id", groupId);

      if (error) throw error;

      toast({ title: "Sucesso", description: "Grupo atualizado com sucesso!" });
      onSuccess?.();
    } catch (error) {
      console.error("Erro ao atualizar grupo:", error);
      toast({ title: "Erro", description: "NÃ£o foi possÃ­vel atualizar o grupo.", variant: "destructive" });
    } finally {
      setLoading(false);
    }
  };

  const handleInviteMember = async () => {
    if (!newMemberEmail.trim()) return;
    setLoading(true);

    try {
      const { data: inviteData, error } = await supabase
        .from("group_invites")
        .insert({
          group_id: groupId,
          email: newMemberEmail.toLowerCase().trim(),
          status: "pending",
        })
        .select()
        .single();

      if (error) throw error;

      const baseUrl = window.location.origin;
      const link = `${baseUrl}/join-group/${inviteData.id}`;
      setInviteLink(link);

      toast({
        title: "Convite criado",
        description: "Link de convite gerado com sucesso!",
      });

      setNewMemberEmail("");
      fetchPendingInvites();
    } catch (error) {
      console.error("Erro ao enviar convite:", error);
      toast({
        title: "Erro",
        description: error.message || "NÃ£o foi possÃ­vel criar o convite.",
        variant: "destructive",
      });
    } finally {
      setLoading(false);
    }
  };

  const copyInviteLink = async () => {
    if (!inviteLink) return;

    try {
      await navigator.clipboard.writeText(inviteLink);
      setIsCopied(true);
      toast({ title: "Copiado!", description: "Link copiado para a Ã¡rea de transferÃªncia." });

      setTimeout(() => setIsCopied(false), 2000);
    } catch (error) {
      toast({
        title: "Erro",
        description: "NÃ£o foi possÃ­vel copiar o link",
        variant: "destructive",
      });
    }
  };

  const handleRemoveMember = async (memberUserId: string) => {
    if (memberUserId === groupOwnerId) {
      toast({ title: "Erro", description: "O criador do grupo nÃ£o pode ser removido.", variant: "destructive" });
      return;
    }

    setLoading(true);
    try {
      const { error } = await supabase.from("group_members").delete().eq("group_id", groupId).eq("user_id", memberUserId);

      if (error) throw error;

      toast({ title: "Membro removido", description: "O membro foi removido do grupo." });
      fetchMembers();
    } catch (error) {
      console.error("Erro ao remover membro:", error);
      toast({ title: "Erro", description: "NÃ£o foi possÃ­vel remover o membro.", variant: "destructive" });
    } finally {
      setLoading(false);
    }
  };

  const handleToggleAdmin = async (memberUserId: string, currentIsAdmin: boolean) => {
    setLoading(true);
    try {
      const { error } = await supabase
        .from("group_members")
        .update({ is_admin: !currentIsAdmin })
        .eq("group_id", groupId)
        .eq("user_id", memberUserId);

      if (error) throw error;

      toast({
        title: "Sucesso",
        description: !currentIsAdmin ? "Membro promovido a administrador." : "PrivilÃ©gios de administrador removidos.",
      });
      fetchMembers();
    } catch (error) {
      console.error("Erro ao atualizar privilÃ©gios:", error);
      toast({ title: "Erro", description: "NÃ£o foi possÃ­vel atualizar os privilÃ©gios.", variant: "destructive" });
    } finally {
      setLoading(false);
    }
  };

  const handleCancelInvite = async (inviteId: string) => {
    setLoading(true);
    try {
      const { error } = await supabase.from("group_invites").delete().eq("id", inviteId);

      if (error) throw error;

      toast({ title: "Convite cancelado", description: "O convite foi cancelado com sucesso." });
      fetchPendingInvites();
    } catch (error) {
      console.error("Erro ao cancelar convite:", error);
      toast({ title: "Erro", description: "NÃ£o foi possÃ­vel cancelar o convite.", variant: "destructive" });
    } finally {
      setLoading(false);
    }
  };

  const handleDeleteGroup = async () => {
    if (!groupId) {
      console.error("Erro: ID do grupo nÃ£o encontrado");
      toast({ title: "Erro", description: "ID do grupo nÃ£o encontrado.", variant: "destructive" });
      return;
    }

    setLoading(true);
    try {
      const { error } = await supabase.from("groups").delete().eq("id", groupId);

      if (error) throw error;

      toast({ title: "Grupo excluÃ­do", description: "O grupo e todos os seus dados foram removidos." });
      setDeleteAlertOpen(false);
      onClose();
      onSuccess?.();
    } catch (error) {
      console.error("Erro ao excluir grupo:", error);
      toast({ title: "Erro", description: "NÃ£o foi possÃ­vel excluir o grupo.", variant: "destructive" });
    } finally {
      setLoading(false);
    }
  };

  return (
    <Dialog open={isOpen} onOpenChange={onClose}>
      <DialogContent className="sm:max-w-[600px] max-h-[90vh] overflow-y-auto">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2">
            <Users className="h-5 w-5 text-primary" />
            Editar Grupo
          </DialogTitle>
          <DialogDescription>Gerencie as informaÃ§Ãµes, membros e convites do grupo.</DialogDescription>
        </DialogHeader>

        <form onSubmit={handleSubmit} className="space-y-6">
          <div className="space-y-4">
            <div className="space-y-2">
              <Label htmlFor="edit-group-name">Nome do Grupo *</Label>
              <Input
                id="edit-group-name"
                placeholder="Ex: FamÃ­lia"
                value={formData.name}
                onChange={(e) => setFormData((prev) => ({ ...prev, name: e.target.value }))}
                disabled={!isGroupAdmin}
              />
            </div>

            <div className="space-y-2">
              <Label htmlFor="edit-group-description">DescriÃ§Ã£o</Label>
              <Textarea
                id="edit-group-description"
                placeholder="Adicione uma descriÃ§Ã£o para o grupo..."
                value={formData.description}
                onChange={(e) => setFormData((prev) => ({ ...prev, description: e.target.value }))}
                disabled={!isGroupAdmin}
                className="min-h-[80px]"
              />
            </div>

            <div className="space-y-2">
              <Label htmlFor="edit-group-color">Cor do Grupo</Label>
              <Select
                value={formData.color}
                onValueChange={(value) => setFormData((prev) => ({ ...prev, color: value }))}
                disabled={!isGroupAdmin}
              >
                <SelectTrigger id="edit-group-color">
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  {colors.map((color) => (
                    <SelectItem key={color.value} value={color.value}>
                      <div className="flex items-center gap-2">
                        <div className={`w-4 h-4 rounded ${color.class}`} />
                        {color.label}
                      </div>
                    </SelectItem>
                  ))}
                </SelectContent>
              </Select>
            </div>
          </div>

          <div className="space-y-4">
            <div className="flex items-center justify-between">
              <h3 className="text-lg font-semibold flex items-center gap-2">
                <UserPlus className="h-5 w-5 text-primary" />
                Membros ({members.length})
              </h3>
            </div>

            <div className="space-y-3 max-h-[200px] overflow-y-auto">
              {members.map((member) => {
                const isOwner = member.user_id === groupOwnerId;
                return (
                  <div key={member.id} className="flex items-center justify-between p-3 rounded-lg bg-muted/50">
                    <div className="flex items-center gap-3">
                      <Avatar>
                        <AvatarFallback>{member.profiles?.full_name?.charAt(0)?.toUpperCase() || "?"}</AvatarFallback>
                      </Avatar>
                      <div>
                        <p className="font-medium">{member.profiles?.full_name || "UsuÃ¡rio sem nome"}</p>
                        <div className="flex items-center gap-2">
                          {isOwner && <Badge variant="secondary">Criador</Badge>}
                          {member.is_admin && !isOwner && <Badge variant="outline">Admin</Badge>}
                        </div>
                      </div>
                    </div>

                    {isGroupAdmin && !isOwner && (
                      <div className="flex items-center gap-2">
                        <div className="flex items-center gap-2">
                          <Label htmlFor={`admin-${member.id}`} className="text-sm">
                            Admin
                          </Label>
                          <Switch
                            id={`admin-${member.id}`}
                            checked={member.is_admin}
                            onCheckedChange={() => handleToggleAdmin(member.user_id, member.is_admin)}
                            disabled={loading}
                          />
                        </div>
                        <Button
                          type="button"
                          variant="ghost"
                          size="sm"
                          onClick={() => handleRemoveMember(member.user_id)}
                          disabled={loading}
                        >
                          <UserMinus className="h-4 w-4 text-destructive" />
                        </Button>
                      </div>
                    )}
                  </div>
                );
              })}
            </div>
          </div>

          {isGroupAdmin && (
            <div className="space-y-4">
              <h3 className="text-lg font-semibold flex items-center gap-2">
                <Mail className="h-5 w-5 text-primary" />
                Convidar Membros
              </h3>

              <div className="flex gap-2">
                <Input
                  placeholder="Email do novo membro"
                  type="email"
                  value={newMemberEmail}
                  onChange={(e) => setNewMemberEmail(e.target.value)}
                  onKeyPress={(e) => e.key === "Enter" && (e.preventDefault(), handleInviteMember())}
                />
                <Button type="button" onClick={handleInviteMember} disabled={loading || !newMemberEmail.trim()}>
                  <UserPlus className="h-4 w-4 mr-2" />
                  Gerar Link
                </Button>
              </div>

              {inviteLink && (
                <div className="p-4 bg-muted rounded-lg space-y-3">
                  <div className="flex items-center justify-between">
                    <span className="text-sm font-medium flex items-center gap-2">
                      <LinkIcon className="h-4 w-4" />
                      Link de Convite
                    </span>
                    <Button type="button" variant="outline" size="sm" onClick={copyInviteLink} className="gap-2">
                      {isCopied ? <Check className="h-4 w-4" /> : <Copy className="h-4 w-4" />}
                      {isCopied ? "Copiado!" : "Copiar"}
                    </Button>
                  </div>
                  <code className="text-xs break-all bg-background p-2 rounded block">{inviteLink}</code>
                </div>
              )}

              {pendingInvites.length > 0 && (
                <div className="space-y-2">
                  <Label className="text-sm text-muted-foreground">Convites Pendentes</Label>
                  {pendingInvites.map((invite) => (
                    <div key={invite.id} className="flex items-center justify-between p-2 rounded-md bg-muted/50">
                      <span className="text-sm">{invite.email}</span>
                      <Button type="button" variant="ghost" size="sm" onClick={() => handleCancelInvite(invite.id)} disabled={loading}>
                        Cancelar
                      </Button>
                    </div>
                  ))}
                </div>
              )}
            </div>
          )}

          <div className="flex gap-2">
            <Button type="button" variant="outline" className="flex-1" onClick={onClose}>
              Cancelar
            </Button>
            {isGroupAdmin && (
              <Button type="submit" className="flex-1" disabled={loading || !formData.name}>
                {loading ? "Salvando..." : "Salvar AlteraÃ§Ãµes"}
              </Button>
            )}
          </div>

          {isGroupAdmin && (
            <div className="mt-6 pt-6 border-t border-destructive/20">
              <div className="bg-destructive/5 p-4 rounded-md border border-destructive/20">
                <h4 className="text-destructive font-semibold flex items-center gap-2 mb-2 text-sm">
                  <AlertTriangle className="h-4 w-4" /> Zona de Perigo
                </h4>
                <p className="text-xs text-muted-foreground mb-4">
                  Excluir este grupo apagarÃ¡ permanentemente todas as transaÃ§Ãµes, investimentos e removerÃ¡ todos os membros.
                </p>
                <Button type="button" variant="destructive" size="sm" className="w-full" onClick={() => setDeleteAlertOpen(true)}>
                  <Trash2 className="h-4 w-4 mr-2" /> Excluir Grupo
                </Button>
              </div>
            </div>
          )}
        </form>

        <AlertDialog open={deleteAlertOpen} onOpenChange={setDeleteAlertOpen}>
          <AlertDialogContent>
            <AlertDialogHeader>
              <AlertDialogTitle>Tem certeza absoluta?</AlertDialogTitle>
              <AlertDialogDescription>
                Esta aÃ§Ã£o nÃ£o pode ser desfeita. Isso excluirÃ¡ permanentemente o grupo
                <strong> {formData.name} </strong> e todos os dados associados.
              </AlertDialogDescription>
            </AlertDialogHeader>
            <AlertDialogFooter>
              <AlertDialogCancel disabled={loading}>Cancelar</AlertDialogCancel>
              <AlertDialogAction
                onClick={handleDeleteGroup}
                className="bg-destructive text-destructive-foreground hover:bg-destructive/90"
                disabled={loading}
              >
                {loading ? "Excluindo..." : "Sim, excluir grupo"}
              </AlertDialogAction>
            </AlertDialogFooter>
          </AlertDialogContent>
        </AlertDialog>
      </DialogContent>
    </Dialog>
  );
};
```
---

### src\components\dialogs\InvestmentAdjustmentDialog.tsx

**Language:** typescript  
**Size:** 7.33 KB  
**Last Modified:** 2025-11-05T19:46:38.900Z

```typescript
import { useState, useEffect } from "react";
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Textarea } from "@/components/ui/textarea";
import { useToast } from "@/hooks/use-toast";
import { supabase } from "@/integrations/supabase/client";
import { Settings } from "lucide-react";

interface AggregatedInvestment {
  name: string;
  type: string;
  totalAmountInvested: number;
  totalCurrentValue: number;
  totalQuantity: number | null;
  averagePrice: number | null;
  firstInvestedAt: string;
  recordIds: string[];
}

interface InvestmentAdjustmentDialogProps {
  investment: AggregatedInvestment | null;
  open: boolean;
  onOpenChange: (open: boolean) => void;
  onSuccess?: () => void;
}

export const InvestmentAdjustmentDialog = ({ investment, open, onOpenChange, onSuccess }: InvestmentAdjustmentDialogProps) => {
  const [loading, setLoading] = useState(false);
  const [formData, setFormData] = useState({
    newCurrentValue: "",
    notes: "",
  });
  const { toast } = useToast();

  useEffect(() => {
    if (investment) {
      setFormData({
        newCurrentValue: investment.totalCurrentValue.toString(),
        notes: "",
      });
    }
  }, [investment]);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!investment) return;

    setLoading(true);
    try {
      const newValue = parseFloat(formData.newCurrentValue);

      if (isNaN(newValue) || newValue < 0) {
        toast({
          title: "Erro",
          description: "Valor invÃ¡lido",
          variant: "destructive",
        });
        return;
      }

      const lastRecordId = investment.recordIds[investment.recordIds.length - 1];

      const { error } = await supabase
        .from("investments")
        .update({
          current_value: newValue,
          quantity: null,
          unit_price: null,
        })
        .eq("id", lastRecordId);

      if (error) throw error;

      toast({
        title: "Sucesso",
        description: "Valor atualizado com sucesso!",
      });

      setFormData({
        newCurrentValue: "",
        notes: "",
      });

      onOpenChange(false);
      onSuccess?.();
    } catch (error) {
      console.error("Erro ao atualizar investimento:", error);
      toast({
        title: "Erro",
        description: "Erro ao atualizar o investimento. Tente novamente.",
        variant: "destructive",
      });
    } finally {
      setLoading(false);
    }
  };

  if (!investment) return null;

  const currentReturn =
    investment.totalAmountInvested > 0
      ? ((investment.totalCurrentValue - investment.totalAmountInvested) / investment.totalAmountInvested) * 100
      : 0;

  const newValue = parseFloat(formData.newCurrentValue) || 0;
  const newReturn =
    investment.totalAmountInvested > 0 ? ((newValue - investment.totalAmountInvested) / investment.totalAmountInvested) * 100 : 0;

  return (
    <Dialog open={open} onOpenChange={onOpenChange}>
      <DialogContent className="sm:max-w-[500px]">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2">
            <Settings className="h-5 w-5 text-primary" />
            Ajustar Investimento
          </DialogTitle>
          <DialogDescription>Atualize o valor atual de {investment.name}</DialogDescription>
        </DialogHeader>

        <form onSubmit={handleSubmit} className="space-y-4">
          <div className="space-y-4 p-4 bg-muted rounded-lg">
            <div className="flex justify-between items-center">
              <span className="text-sm text-muted-foreground">Valor Investido</span>
              <span className="font-medium">
                {new Intl.NumberFormat("pt-BR", {
                  style: "currency",
                  currency: "BRL",
                }).format(investment.totalAmountInvested)}
              </span>
            </div>
            <div className="flex justify-between items-center">
              <span className="text-sm text-muted-foreground">Valor Atual</span>
              <span className="font-medium">
                {new Intl.NumberFormat("pt-BR", {
                  style: "currency",
                  currency: "BRL",
                }).format(investment.totalCurrentValue)}
              </span>
            </div>
            <div className="flex justify-between items-center">
              <span className="text-sm text-muted-foreground">Rentabilidade Atual</span>
              <span className={`font-medium ${currentReturn >= 0 ? "text-success" : "text-destructive"}`}>
                {currentReturn >= 0 ? "+" : ""}
                {currentReturn.toFixed(2)}%
              </span>
            </div>
          </div>

          <div className="space-y-2">
            <Label htmlFor="newCurrentValue">Novo Valor Atual *</Label>
            <Input
              id="newCurrentValue"
              type="number"
              step="0.01"
              placeholder="0,00"
              value={formData.newCurrentValue}
              onChange={(e) => setFormData((prev) => ({ ...prev, newCurrentValue: e.target.value }))}
              required
            />
          </div>

          {newValue > 0 && newValue !== investment.totalCurrentValue && (
            <div className="space-y-2 p-4 bg-primary/10 rounded-lg">
              <div className="flex justify-between items-center">
                <span className="text-sm text-muted-foreground">Nova Rentabilidade</span>
                <span className={`font-medium ${newReturn >= 0 ? "text-success" : "text-destructive"}`}>
                  {newReturn >= 0 ? "+" : ""}
                  {newReturn.toFixed(2)}%
                </span>
              </div>
              <div className="flex justify-between items-center">
                <span className="text-sm text-muted-foreground">VariaÃ§Ã£o</span>
                <span className={`font-medium ${newValue - investment.totalCurrentValue >= 0 ? "text-success" : "text-destructive"}`}>
                  {new Intl.NumberFormat("pt-BR", {
                    style: "currency",
                    currency: "BRL",
                  }).format(newValue - investment.totalCurrentValue)}
                </span>
              </div>
            </div>
          )}

          <div className="space-y-2">
            <Label htmlFor="notes">ObservaÃ§Ãµes (opcional)</Label>
            <Textarea
              id="notes"
              placeholder="Adicione observaÃ§Ãµes sobre este ajuste..."
              value={formData.notes}
              onChange={(e) => setFormData((prev) => ({ ...prev, notes: e.target.value }))}
              rows={3}
            />
          </div>

          <div className="flex gap-2 pt-4">
            <Button type="button" variant="outline" className="flex-1" onClick={() => onOpenChange(false)} disabled={loading}>
              Cancelar
            </Button>
            <Button type="submit" className="flex-1" disabled={loading}>
              {loading ? "Salvando..." : "Salvar Ajuste"}
            </Button>
          </div>
        </form>
      </DialogContent>
    </Dialog>
  );
};
```
---

### src\components\dialogs\InvestmentDetailsModal.tsx

**Language:** typescript  
**Size:** 9.06 KB  
**Last Modified:** 2025-10-31T15:18:24.184Z

```typescript
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from "@/components/ui/dialog";
import { Badge } from "@/components/ui/badge";
import { Card, CardContent } from "@/components/ui/card";
import { TrendingUp, TrendingDown, Calendar, DollarSign } from "@/lib/icons";
import { cn } from "@/lib/utils";
import { sanitizeInput, sanitizeAmount, validateTransactionData, ensureAuthenticated, checkRateLimit } from "@/utils/security";

interface Investment {
  id: string;
  name: string;
  type: string;
  amount: number;
  current_value: number;
  maturity_date?: string;
  created_at: string;
}

interface InvestmentDetailsModalProps {
  open: boolean;
  onOpenChange: (open: boolean) => void;
  type: string;
  investments: Investment[];
}

export const InvestmentDetailsModal = ({ open, onOpenChange, type, investments }: InvestmentDetailsModalProps) => {
  const totalInvested = investments.reduce((sum, inv) => sum + inv.amount, 0);
  const totalCurrent = investments.reduce((sum, inv) => sum + inv.current_value, 0);
  const totalReturn = totalInvested > 0 ? ((totalCurrent - totalInvested) / totalInvested) * 100 : 0;
  const averageReturn = investments.length > 0 ? totalReturn / investments.length : 0;

  return (
    <Dialog open={open} onOpenChange={onOpenChange}>
      <DialogContent className="max-w-4xl max-h-[80vh] overflow-y-auto">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2">
            <TrendingUp className="h-5 w-5 text-primary" />
            Investimentos em {type}
          </DialogTitle>
          <DialogDescription>Detalhamento de todos os seus investimentos do tipo {type}</DialogDescription>
        </DialogHeader>

        <div className="space-y-6">
          {/* Summary Cards */}
          <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
            <Card>
              <CardContent className="p-4">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm font-medium text-muted-foreground">Total Investido</p>
                    <p className="text-xl font-bold">
                      {totalInvested.toLocaleString("pt-BR", {
                        style: "currency",
                        currency: "BRL",
                      })}
                    </p>
                  </div>
                  <DollarSign className="h-6 w-6 text-muted-foreground" />
                </div>
              </CardContent>
            </Card>

            <Card>
              <CardContent className="p-4">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm font-medium text-muted-foreground">Valor Atual</p>
                    <p className="text-xl font-bold text-primary">
                      {totalCurrent.toLocaleString("pt-BR", {
                        style: "currency",
                        currency: "BRL",
                      })}
                    </p>
                  </div>
                  <TrendingUp className="h-6 w-6 text-primary" />
                </div>
              </CardContent>
            </Card>

            <Card>
              <CardContent className="p-4">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm font-medium text-muted-foreground">Rentabilidade</p>
                    <p className={cn("text-xl font-bold", totalReturn >= 0 ? "text-success" : "text-destructive")}>
                      {totalReturn >= 0 ? "+" : ""}
                      {totalReturn.toFixed(2)}%
                    </p>
                  </div>
                  {totalReturn >= 0 ? (
                    <TrendingUp className="h-6 w-6 text-success" />
                  ) : (
                    <TrendingDown className="h-6 w-6 text-destructive" />
                  )}
                </div>
              </CardContent>
            </Card>

            <Card>
              <CardContent className="p-4">
                <div className="flex items-center justify-between">
                  <div>
                    <p className="text-sm font-medium text-muted-foreground">Quantidade</p>
                    <p className="text-xl font-bold">{investments.length}</p>
                  </div>
                  <Badge variant="secondary" className="text-lg">
                    {investments.length}
                  </Badge>
                </div>
              </CardContent>
            </Card>
          </div>

          {/* Investments List */}
          <div className="space-y-4">
            <h3 className="text-lg font-semibold">Detalhamento dos Investimentos</h3>
            {investments.map((investment) => {
              const investmentReturn =
                investment.amount > 0 ? ((investment.current_value - investment.amount) / investment.amount) * 100 : 0;

              return (
                <Card key={investment.id}>
                  <CardContent className="p-4">
                    <div className="flex items-center justify-between">
                      <div className="flex items-center gap-4">
                        <div className="p-3 bg-primary/10 rounded-full">
                          <TrendingUp className="h-5 w-5 text-primary" />
                        </div>
                        <div>
                          <p className="font-medium text-foreground">{investment.name}</p>
                          <div className="flex items-center gap-2 mt-1">
                            <Badge variant="secondary" className="text-xs">
                              {investment.type}
                            </Badge>
                            {investment.maturity_date && (
                              <div className="flex items-center gap-1 text-xs text-muted-foreground">
                                <Calendar className="h-3 w-3" />
                                Venc: {new Date(investment.maturity_date).toLocaleDateString("pt-BR")}
                              </div>
                            )}
                            <div className="flex items-center gap-1 text-xs text-muted-foreground">
                              <Calendar className="h-3 w-3" />
                              Criado: {new Date(investment.created_at).toLocaleDateString("pt-BR")}
                            </div>
                          </div>
                        </div>
                      </div>

                      <div className="text-right">
                        <div className="flex items-center gap-6">
                          <div>
                            <p className="text-sm text-muted-foreground">Investido</p>
                            <p className="font-medium">
                              {investment.amount.toLocaleString("pt-BR", {
                                style: "currency",
                                currency: "BRL",
                              })}
                            </p>
                          </div>
                          <div>
                            <p className="text-sm text-muted-foreground">Atual</p>
                            <p className="font-medium">
                              {investment.current_value.toLocaleString("pt-BR", {
                                style: "currency",
                                currency: "BRL",
                              })}
                            </p>
                          </div>
                          <div>
                            <p className="text-sm text-muted-foreground">Retorno</p>
                            <p className={cn("font-semibold", investmentReturn >= 0 ? "text-success" : "text-destructive")}>
                              {investmentReturn >= 0 ? "+" : ""}
                              {investmentReturn.toFixed(2)}%
                            </p>
                          </div>
                          <div>
                            <p className="text-sm text-muted-foreground">Lucro/PrejuÃ­zo</p>
                            <p className={cn("font-semibold", investmentReturn >= 0 ? "text-success" : "text-destructive")}>
                              {(investment.current_value - investment.amount).toLocaleString("pt-BR", {
                                style: "currency",
                                currency: "BRL",
                              })}
                            </p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </CardContent>
                </Card>
              );
            })}
          </div>

          {investments.length === 0 && (
            <div className="text-center py-8 text-muted-foreground">
              <TrendingUp className="h-12 w-12 mx-auto mb-4 opacity-50" />
              <p>Nenhum investimento do tipo {type} encontrado.</p>
            </div>
          )}
        </div>
      </DialogContent>
    </Dialog>
  );
};
```
---

### src\components\dialogs\ManageInvestmentDialog.tsx

**Language:** typescript  
**Size:** 7.9 KB  
**Last Modified:** 2025-11-26T13:13:29.034Z

```typescript
import { useState, useEffect } from "react";
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
} from "@/components/ui/alert-dialog";
import { useToast } from "@/hooks/use-toast";
import { supabase } from "@/integrations/supabase/client";
import { Settings, Trash2, MinusCircle } from "lucide-react";
import { format } from "@/lib/date";
import { recalculateGoalBalance } from "@/utils/investments/investmentUtils"; // Importe a funÃ§Ã£o nova

interface AggregatedInvestment {
  name: string;
  type: string;
  totalAmountInvested: number;
  totalCurrentValue: number;
  recordIds: string[];
  goalIds: (string | null)[];
}

interface ManageInvestmentDialogProps {
  investment: AggregatedInvestment | null;
  isOpen: boolean;
  onClose: () => void;
  onSuccess?: () => void;
}

export const ManageInvestmentDialog = ({ investment, isOpen, onClose, onSuccess }: ManageInvestmentDialogProps) => {
  const [loading, setLoading] = useState(false);
  const [amountToRemove, setAmountToRemove] = useState("");
  const [removalDate, setRemovalDate] = useState(format(new Date(), "yyyy-MM-dd"));
  const [deleteAlertOpen, setDeleteAlertOpen] = useState(false);
  const { toast } = useToast();

  useEffect(() => {
    if (isOpen) {
      setAmountToRemove("");
      setRemovalDate(format(new Date(), "yyyy-MM-dd"));
    }
  }, [isOpen, investment]);

  // AÃ§Ã£o 1: Retirada Parcial
  const handlePartialRemoval = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!investment || !amountToRemove) return;

    const removalVal = parseFloat(amountToRemove);
    if (isNaN(removalVal) || removalVal <= 0 || removalVal > investment.totalCurrentValue) {
      toast({ title: "Erro", description: "Valor invÃ¡lido", variant: "destructive" });
      return;
    }

    setLoading(true);
    try {
      const {
        data: { user },
      } = await supabase.auth.getUser();
      if (!user) throw new Error("UsuÃ¡rio nÃ£o logado");

      const associatedGoalId = investment.goalIds.find((id) => id !== null) || null;

      // Insere registro negativo (Retirada)
      const { error } = await supabase.from("investments").insert({
        user_id: user.id,
        name: investment.name,
        type: investment.type,
        amount: -removalVal,
        current_value: -removalVal,
        created_at: new Date(removalDate + "T00:00:00").toISOString(),
        goal_id: associatedGoalId,
      });

      if (error) throw error;

      // RECALCULA A META
      if (associatedGoalId) {
        await recalculateGoalBalance(associatedGoalId);
      }

      toast({ title: "Sucesso", description: "Resgate realizado!" });
      onClose();
      onSuccess?.();
    } catch (error) {
      toast({ title: "Erro", description: "Falha ao realizar resgate", variant: "destructive" });
    } finally {
      setLoading(false);
    }
  };

  // AÃ§Ã£o 2: ExclusÃ£o Total
  const handleTotalDeletion = async () => {
    if (!investment) return;
    setLoading(true);
    try {
      const associatedGoalId = investment.goalIds.find((id) => id !== null);

      // Deleta todos os registros
      const { error } = await supabase.from("investments").delete().in("id", investment.recordIds);
      if (error) throw error;

      // RECALCULA A META (agora que os registros sumiram, a soma serÃ¡ atualizada corretamente)
      if (associatedGoalId) {
        await recalculateGoalBalance(associatedGoalId);
      }

      toast({ title: "Sucesso", description: "Investimento excluÃ­do!" });
      setDeleteAlertOpen(false);
      onClose();
      onSuccess?.();
    } catch (error) {
      toast({ title: "Erro", description: "Falha ao excluir", variant: "destructive" });
    } finally {
      setLoading(false);
    }
  };

  if (!investment) return null;

  return (
    <Dialog open={isOpen} onOpenChange={onClose}>
      <DialogContent className="sm:max-w-[500px]">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2">
            <Settings className="h-5 w-5 text-primary" />
            Gerenciar: {investment.name}
          </DialogTitle>
          <DialogDescription>
            Saldo Atual: {investment.totalCurrentValue.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
          </DialogDescription>
        </DialogHeader>

        <Tabs defaultValue="partial" className="w-full">
          <TabsList className="grid w-full grid-cols-2">
            <TabsTrigger value="partial">Resgate Parcial</TabsTrigger>
            <TabsTrigger value="delete" className="text-destructive data-[state=active]:text-destructive">
              ExclusÃ£o Total
            </TabsTrigger>
          </TabsList>

          <TabsContent value="partial" className="space-y-4 py-4">
            <div className="space-y-4 border rounded-md p-4 bg-muted/20">
              <div className="flex items-start gap-3">
                <MinusCircle className="h-5 w-5 text-orange-500 mt-1" />
                <div className="text-sm text-muted-foreground">Registrar saque ou venda parcial.</div>
              </div>

              <form onSubmit={handlePartialRemoval} className="space-y-3">
                <div className="space-y-2">
                  <Label>Valor do Resgate</Label>
                  <Input type="number" step="0.01" value={amountToRemove} onChange={(e) => setAmountToRemove(e.target.value)} required />
                </div>
                <div className="space-y-2">
                  <Label>Data</Label>
                  <Input type="date" value={removalDate} onChange={(e) => setRemovalDate(e.target.value)} required />
                </div>
                <Button type="submit" className="w-full" disabled={loading}>
                  {loading ? "Processando..." : "Confirmar Resgate"}
                </Button>
              </form>
            </div>
          </TabsContent>

          <TabsContent value="delete" className="space-y-4 py-4">
            <div className="space-y-4 border border-destructive/30 rounded-md p-4 bg-destructive/5">
              <div className="flex items-start gap-3">
                <Trash2 className="h-5 w-5 text-destructive mt-1" />
                <div className="text-sm text-destructive">
                  Isso apagarÃ¡ <strong>todo o histÃ³rico</strong> deste investimento.
                </div>
              </div>
              <Button variant="destructive" className="w-full" onClick={() => setDeleteAlertOpen(true)} disabled={loading}>
                Excluir Investimento Permanentemente
              </Button>
            </div>
          </TabsContent>
        </Tabs>

        <AlertDialog open={deleteAlertOpen} onOpenChange={setDeleteAlertOpen}>
          <AlertDialogContent>
            <AlertDialogHeader>
              <AlertDialogTitle>Tem certeza absoluta?</AlertDialogTitle>
              <AlertDialogDescription>AÃ§Ã£o irreversÃ­vel. O saldo da meta serÃ¡ ajustado.</AlertDialogDescription>
            </AlertDialogHeader>
            <AlertDialogFooter>
              <AlertDialogCancel disabled={loading}>Cancelar</AlertDialogCancel>
              <AlertDialogAction onClick={handleTotalDeletion} className="bg-destructive hover:bg-destructive/90" disabled={loading}>
                {loading ? "Excluindo..." : "Sim, excluir tudo"}
              </AlertDialogAction>
            </AlertDialogFooter>
          </AlertDialogContent>
        </AlertDialog>
      </DialogContent>
    </Dialog>
  );
};
```
---

### src\components\dialogs\RemoveInvestmentAmountDialog.tsx

**Language:** typescript  
**Size:** 6.56 KB  
**Last Modified:** 2025-11-25T20:52:24.805Z

```typescript
import { useState, useEffect } from "react";
import { Dialog, DialogContent, DialogDescription, DialogHeader, DialogTitle } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { useToast } from "@/hooks/use-toast";
import { supabase } from "@/integrations/supabase/client";
import { MinusCircle } from "@/lib/icons";
import { format } from "@/lib/date";

// Usaremos a interface AggregatedInvestment para tipar o investimento alvo
interface AggregatedInvestment {
  name: string;
  type: string;
  totalAmountInvested: number;
  totalCurrentValue: number;
  totalQuantity: number | null;
  averagePrice: number | null;
  firstInvestedAt: string;
  recordIds: string[];
  goalIds: (string | null)[]; // Adicionado para saber quais metas estÃ£o vinculadas
}

interface RemoveInvestmentAmountDialogProps {
  investment: AggregatedInvestment | null;
  isOpen: boolean;
  onClose: () => void;
  onSuccess?: () => void;
}

export const RemoveInvestmentAmountDialog = ({ investment, isOpen, onClose, onSuccess }: RemoveInvestmentAmountDialogProps) => {
  const [loading, setLoading] = useState(false);
  const [amountToRemove, setAmountToRemove] = useState("");
  const [removalDate, setRemovalDate] = useState(format(new Date(), "yyyy-MM-dd"));
  const { toast } = useToast();

  useEffect(() => {
    if (isOpen) {
      setAmountToRemove("");
      setRemovalDate(format(new Date(), "yyyy-MM-dd"));
    }
  }, [isOpen, investment]);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();

    if (!investment || !amountToRemove) {
      toast({
        title: "Erro",
        description: "Informe o valor a ser removido",
        variant: "destructive",
      });
      return;
    }

    const removalAmount = parseFloat(amountToRemove);
    if (isNaN(removalAmount) || removalAmount <= 0) {
      toast({
        title: "Erro",
        description: "O valor a ser removido deve ser positivo",
        variant: "destructive",
      });
      return;
    }

    if (removalAmount > investment.totalCurrentValue) {
      toast({
        title: "AtenÃ§Ã£o",
        description: "O valor a remover Ã© maior que o valor atual do investimento.",
        variant: "destructive",
      });
      return;
    }

    setLoading(true);

    try {
      const {
        data: { user },
      } = await supabase.auth.getUser();

      if (!user) throw new Error("UsuÃ¡rio nÃ£o autenticado");

      // Tenta encontrar o goal_id mais recente associado a este grupo de investimentos
      // Assume-se que a retirada afeta a meta associada ao Ãºltimo aporte, ou a mais comum
      const associatedGoalId = investment.goalIds.find((id) => id !== null) || null;

      // Criar um NOVO registro com valor NEGATIVO
      const { error } = await supabase.from("investments").insert({
        user_id: user.id,
        name: investment.name,
        type: investment.type,
        amount: -removalAmount, // Valor negativo
        current_value: -removalAmount, // Valor atual negativo tambÃ©m
        quantity: null,
        unit_price: null,
        created_at: new Date(removalDate + "T00:00:00").toISOString(),
        goal_id: associatedGoalId, // MantÃ©m o vÃ­nculo com a meta para histÃ³rico
      });

      if (error) throw error;

      // Atualizar a Meta (subtrair valor)
      if (associatedGoalId) {
        const { data: goalData } = await supabase.from("investment_goals").select("current_amount").eq("id", associatedGoalId).single();

        if (goalData) {
          const newGoalAmount = (goalData.current_amount || 0) - removalAmount;
          await supabase.from("investment_goals").update({ current_amount: newGoalAmount }).eq("id", associatedGoalId);
        }
      }

      toast({
        title: "Sucesso",
        description: `Valor de ${removalAmount.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })} removido de ${
          investment.name
        }!`,
      });

      onClose();
      onSuccess?.();
    } catch (error) {
      console.error("Erro ao remover valor do investimento:", error);
      toast({
        title: "Erro",
        description: "Erro ao remover valor. Tente novamente.",
        variant: "destructive",
      });
    } finally {
      setLoading(false);
    }
  };

  if (!investment) return null;

  return (
    <Dialog open={isOpen} onOpenChange={onClose}>
      <DialogContent className="sm:max-w-[425px]">
        <DialogHeader>
          <DialogTitle className="flex items-center gap-2">
            <MinusCircle className="h-5 w-5 text-destructive" />
            Remover Valor do Investimento
          </DialogTitle>
          <DialogDescription>Remova um valor especÃ­fico de "{investment.name}". Isso criarÃ¡ um registro de saÃ­da.</DialogDescription>
        </DialogHeader>

        <form onSubmit={handleSubmit} className="space-y-4">
          <div className="space-y-1">
            <p className="text-sm font-medium">Investimento:</p>
            <p className="text-sm text-muted-foreground">
              {investment.name} ({investment.type})
            </p>
            <p className="text-sm text-muted-foreground">
              Valor Atual: {investment.totalCurrentValue.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
            </p>
          </div>

          <div className="space-y-2">
            <Label htmlFor="amountToRemove">Valor a Remover *</Label>
            <Input
              id="amountToRemove"
              type="number"
              step="0.01"
              min="0.01"
              placeholder="0,00"
              value={amountToRemove}
              onChange={(e) => setAmountToRemove(e.target.value)}
              required
            />
          </div>

          <div className="space-y-2">
            <Label htmlFor="removalDate">Data da RemoÃ§Ã£o *</Label>
            <Input id="removalDate" type="date" value={removalDate} onChange={(e) => setRemovalDate(e.target.value)} required />
          </div>

          <div className="flex gap-2 pt-4">
            <Button type="button" variant="outline" className="flex-1" onClick={onClose}>
              Cancelar
            </Button>
            <Button type="submit" variant="destructive" className="flex-1" disabled={loading}>
              {loading ? "Removendo..." : "Confirmar RemoÃ§Ã£o"}
            </Button>
          </div>
        </form>
      </DialogContent>
    </Dialog>
  );
};
```
---

### src\components\filters\DateFilter.tsx

**Language:** typescript  
**Size:** 4.31 KB  
**Last Modified:** 2025-10-31T13:45:46.772Z

```typescript
import { useState } from "react";
import { format, startOfMonth, endOfMonth, startOfYear, endOfYear, subMonths, addMonths } from "@/lib/date";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";

export interface DateRange {
  from: Date;
  to: Date;
}

interface DateFilterProps {
  dateRange: DateRange;
  onDateRangeChange: (range: DateRange) => void;
}

export const DateFilter = ({ dateRange, onDateRangeChange }: DateFilterProps) => {
  const [selectedPreset, setSelectedPreset] = useState("current-month");
  const presets = [
    {
      label: "Este mÃªs",
      value: "current-month",
      getRange: () => ({
        from: startOfMonth(new Date()),
        to: endOfMonth(new Date()),
      }),
    },
    {
      label: "MÃªs passado",
      value: "last-month",
      getRange: () => {
        const lastMonth = subMonths(new Date(), 1);
        return {
          from: startOfMonth(lastMonth),
          to: endOfMonth(lastMonth),
        };
      },
    },
    {
      label: "PrÃ³ximo mÃªs",
      value: "next-month",
      getRange: () => {
        const nextMonth = addMonths(new Date(), 1);
        return {
          from: startOfMonth(nextMonth),
          to: endOfMonth(nextMonth),
        };
      },
    },
    {
      label: "Este ano",
      value: "current-year",
      getRange: () => ({
        from: startOfYear(new Date()),
        to: endOfYear(new Date()),
      }),
    },
    {
      label: "Personalizado",
      value: "custom",
      getRange: () => dateRange,
    },
  ];
  const handlePresetChange = (value: string) => {
    setSelectedPreset(value);
    if (value !== "custom") {
      const preset = presets.find((p) => p.value === value);
      if (preset) {
        onDateRangeChange(preset.getRange());
      }
    }
  };
  const handleFromDateChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    // ForÃ§a a data a ser interpretada no fuso horÃ¡rio local
    const newDate = new Date(e.target.value + "T00:00:00");
    if (!isNaN(newDate.getTime())) {
      onDateRangeChange({ from: newDate, to: dateRange.to });
      setSelectedPreset("custom");
    }
  };
  const handleToDateChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    // ForÃ§a a data a ser interpretada no fuso horÃ¡rio local
    const newDate = new Date(e.target.value + "T00:00:00");
    if (!isNaN(newDate.getTime())) {
      onDateRangeChange({ from: dateRange.from, to: newDate });
      setSelectedPreset("custom");
    }
  };
  return (
    <div className="flex flex-wrap items-end gap-4">
      <div className="w-full sm:w-auto">
        <Label htmlFor="preset" className="mb-2 block">
          PerÃ­odo
        </Label>
        <Select value={selectedPreset} onValueChange={handlePresetChange}>
          <SelectTrigger id="preset" className="w-full sm:w-[180px]">
            <SelectValue />
          </SelectTrigger>
          <SelectContent>
            {presets.map((preset) => (
              <SelectItem key={preset.value} value={preset.value}>
                {preset.label}
              </SelectItem>
            ))}
          </SelectContent>
        </Select>
      </div>

      <div className="w-full sm:w-auto">
        <Label htmlFor="date-from" className="mb-2 block">
          Data InÃ­cio
        </Label>
        <Input
          id="date-from"
          type="date"
          value={format(dateRange.from, "yyyy-MM-dd")}
          onChange={handleFromDateChange}
          className="w-full sm:w-[160px]"
        />
      </div>

      <div className="w-full sm:w-auto">
        <Label htmlFor="date-to" className="mb-2 block">
          Data Fim
        </Label>

        <Input
          id="date-to"
          type="date"
          value={format(dateRange.to, "yyyy-MM-dd")}
          onChange={handleToDateChange}
          className="w-full sm:w-[160px]"
        />
      </div>

      {selectedPreset === "custom" && (
        <Button variant="outline" size="sm" onClick={() => handlePresetChange("current-month")} className="w-full sm:w-auto">
          Resetar
        </Button>
      )}
    </div>
  );
};
```
---

### src\components\groups\GroupDetailsModal.tsx

**Language:** typescript  
**Size:** 23.93 KB  
**Last Modified:** 2025-12-01T13:42:06.340Z

```typescript
import { useState, useEffect } from "react";
import { Dialog, DialogContent, DialogHeader, DialogTitle } from "@/components/ui/dialog";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
// CORREÃ‡ÃƒO: Adicionado 'Users' na importaÃ§Ã£o abaixo
import {
  DollarSign,
  TrendingUp,
  TrendingDown,
  PiggyBank,
  Calendar,
  ArrowUpCircle,
  ArrowDownCircle,
  Plus,
  Layers,
  User,
  Users,
} from "@/lib/icons";
import { supabase } from "@/integrations/supabase/client";
import { useToast } from "@/hooks/use-toast";
import { cn } from "@/lib/utils";
import { Button } from "@/components/ui/button";
import { AddTransactionDialog } from "@/components/dialogs/AddTransactionDialog";
import { AddInvestmentDialog } from "@/components/dialogs/AddInvestmentDialog";
import { AddEventDialog } from "@/components/dialogs/AddEventDialog";
import { DateFilter, DateRange } from "@/components/filters/DateFilter";
import { startOfMonth, endOfMonth, format } from "@/lib/date";
import { EventDetailsModal } from "@/components/transactions/EventDetailsModal";
import { Separator } from "@/components/ui/separator";

interface GroupDetailsModalProps {
  isOpen: boolean;
  onClose: () => void;
  groupId: string;
  groupName: string;
}

interface Transaction {
  id: string;
  description: string;
  amount: number;
  type: "income" | "expense";
  category: string;
  date: string;
  user_id: string;
}

interface Investment {
  id: string;
  name: string;
  type: string;
  amount: number;
  current_value: number;
  created_at: string;
  user_id: string;
}

interface GroupEvent {
  id: string;
  name: string;
  description: string;
  date: string;
  totalAmount?: number;
}

interface Metrics {
  totalIncome: number;
  totalExpenses: number;
  totalInvestments: number;
  balance: number;
}

export const GroupDetailsModal = ({ isOpen, onClose, groupId, groupName }: GroupDetailsModalProps) => {
  const [transactions, setTransactions] = useState<Transaction[]>([]);
  const [investments, setInvestments] = useState<Investment[]>([]);
  const [groupEvents, setGroupEvents] = useState<GroupEvent[]>([]);

  // MÃ©tricas Gerais do Grupo
  const [groupMetrics, setGroupMetrics] = useState<Metrics>({
    totalIncome: 0,
    totalExpenses: 0,
    totalInvestments: 0,
    balance: 0,
  });

  // MÃ©tricas do UsuÃ¡rio Logado ("Minha ParticipaÃ§Ã£o")
  const [myMetrics, setMyMetrics] = useState<Metrics>({
    totalIncome: 0,
    totalExpenses: 0,
    totalInvestments: 0,
    balance: 0,
  });

  const [dateRange, setDateRange] = useState<DateRange>({
    from: startOfMonth(new Date()),
    to: endOfMonth(new Date()),
  });

  const [loading, setLoading] = useState(false);
  const [selectedEvent, setSelectedEvent] = useState<GroupEvent | null>(null);
  const { toast } = useToast();

  useEffect(() => {
    if (isOpen && groupId) {
      loadGroupData();
    }
  }, [isOpen, groupId, dateRange]);

  const loadGroupData = async () => {
    try {
      setLoading(true);

      const {
        data: { user },
      } = await supabase.auth.getUser();
      const currentUserId = user?.id;

      const fromDate = format(dateRange.from, "yyyy-MM-dd");
      const toDate = format(dateRange.to, "yyyy-MM-dd");

      // 1. Carregar TransaÃ§Ãµes
      const { data: transactionsData, error: transError } = await supabase
        .from("transactions")
        .select("*")
        .eq("group_id", groupId)
        .gte("date", fromDate)
        .lte("date", toDate)
        .order("date", { ascending: false });

      if (transError) throw transError;

      // 2. Carregar Investimentos
      const { data: investmentsData, error: invError } = await supabase
        .from("investments")
        .select("*")
        .eq("group_id", groupId)
        .gte("created_at", `${fromDate}T00:00:00`)
        .lte("created_at", `${toDate}T23:59:59`)
        .order("created_at", { ascending: false });

      if (invError) throw invError;

      // 3. Carregar Eventos
      const { data: eventsData, error: eventsError } = await supabase
        .from("events" as any)
        .select("*")
        .eq("group_id", groupId)
        .gte("date", fromDate)
        .lte("date", toDate)
        .order("date", { ascending: false });

      if (eventsError) throw eventsError;

      // Calcular totais dos eventos
      let eventsWithTotals: GroupEvent[] = [];
      if (eventsData && eventsData.length > 0) {
        const eventIds = eventsData.map((e) => e.id);
        const { data: eventTrans } = await supabase.from("transactions").select("event_id, amount, type").in("event_id", eventIds);

        eventsWithTotals = eventsData.map((ev) => {
          const evT = eventTrans?.filter((t) => t.event_id === ev.id) || [];
          const total = evT.reduce((acc, t) => acc + (t.type === "income" ? t.amount : -Math.abs(t.amount)), 0);
          return {
            id: ev.id,
            name: ev.name,
            description: ev.description,
            date: ev.date,
            totalAmount: total,
          };
        });
      }

      const formattedTransactions =
        transactionsData?.map((t) => ({
          id: t.id,
          description: t.description,
          amount: Number(t.amount),
          type: t.type as "income" | "expense",
          category: t.category,
          date: t.date,
          user_id: t.user_id,
        })) || [];

      const formattedInvestments =
        investmentsData?.map((i) => ({
          id: i.id,
          name: i.name,
          type: i.type,
          amount: Number(i.amount),
          current_value: Number(i.current_value),
          created_at: i.created_at,
          user_id: i.user_id,
        })) || [];

      setTransactions(formattedTransactions);
      setInvestments(formattedInvestments);
      setGroupEvents(eventsWithTotals);

      // --- CÃLCULO DE MÃ‰TRICAS GERAIS ---
      const gIncome = formattedTransactions.filter((t) => t.type === "income").reduce((sum, t) => sum + t.amount, 0);
      const gExpenses = formattedTransactions.filter((t) => t.type === "expense").reduce((sum, t) => sum + t.amount, 0);
      const gInvestments = formattedInvestments.reduce((sum, i) => sum + i.current_value, 0);

      setGroupMetrics({
        totalIncome: gIncome,
        totalExpenses: gExpenses,
        totalInvestments: gInvestments,
        balance: gIncome + gExpenses,
      });

      // --- CÃLCULO DE "MINHA PARTICIPAÃ‡ÃƒO" ---
      if (currentUserId) {
        const myTrans = formattedTransactions.filter((t) => t.user_id === currentUserId);
        const myInvs = formattedInvestments.filter((i) => i.user_id === currentUserId);

        const mIncome = myTrans.filter((t) => t.type === "income").reduce((sum, t) => sum + t.amount, 0);
        const mExpenses = myTrans.filter((t) => t.type === "expense").reduce((sum, t) => sum + t.amount, 0);
        const mInvestments = myInvs.reduce((sum, i) => sum + i.current_value, 0);

        setMyMetrics({
          totalIncome: mIncome,
          totalExpenses: mExpenses,
          totalInvestments: mInvestments,
          balance: mIncome + mExpenses,
        });
      }
    } catch (error) {
      console.error("Erro ao carregar dados do grupo:", error);
      toast({
        variant: "destructive",
        title: "Erro",
        description: "NÃ£o foi possÃ­vel carregar os dados do grupo",
      });
    } finally {
      setLoading(false);
    }
  };

  return (
    <Dialog open={isOpen} onOpenChange={onClose}>
      <DialogContent className="max-w-4xl max-h-[90vh] overflow-y-auto">
        <DialogHeader className="flex flex-col gap-4 pr-8">
          <div className="flex flex-row items-center justify-between">
            <DialogTitle>Detalhes do Grupo: {groupName}</DialogTitle>
          </div>

          <div className="flex justify-end">
            <DateFilter dateRange={dateRange} onDateRangeChange={setDateRange} />
          </div>
        </DialogHeader>

        <div className="flex gap-2 mb-4 flex-wrap">
          <AddTransactionDialog
            type="expense"
            defaultGroupId={groupId}
            onSuccess={loadGroupData}
            trigger={
              <Button variant="destructive" size="sm">
                <Plus className="h-4 w-4 mr-2" /> Nova Despesa
              </Button>
            }
          />
          <AddTransactionDialog
            type="income"
            defaultGroupId={groupId}
            onSuccess={loadGroupData}
            trigger={
              <Button variant="default" size="sm" className="bg-success hover:bg-success/90">
                <Plus className="h-4 w-4 mr-2" /> Nova Receita
              </Button>
            }
          />
          <AddInvestmentDialog
            defaultGroupId={groupId}
            onSuccess={loadGroupData}
            trigger={
              <Button variant="outline" size="sm">
                <PiggyBank className="h-4 w-4 mr-2" /> Novo Investimento
              </Button>
            }
          />
          <AddEventDialog
            defaultGroupId={groupId}
            onSuccess={loadGroupData}
            trigger={
              <Button variant="outline" size="sm">
                <Calendar className="h-4 w-4 mr-2" /> Novo Evento
              </Button>
            }
          />
        </div>

        {loading ? (
          <div className="space-y-4">
            {[...Array(4)].map((_, i) => (
              <div key={i} className="h-32 bg-muted rounded-lg animate-pulse" />
            ))}
          </div>
        ) : (
          <div className="space-y-8">
            {/* SEÃ‡ÃƒO: MINHA PARTICIPAÃ‡ÃƒO */}
            <div className="space-y-3">
              <h3 className="text-sm font-semibold flex items-center gap-2 text-muted-foreground">
                <User className="h-4 w-4" /> Minha ParticipaÃ§Ã£o
              </h3>
              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <Card className="bg-primary/5 border-primary/20">
                  <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
                    <CardTitle className="text-sm font-medium">Minhas Receitas</CardTitle>
                    <TrendingUp className="h-4 w-4 text-success" />
                  </CardHeader>
                  <CardContent>
                    <div className="text-xl font-bold text-success">
                      {myMetrics.totalIncome.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                    </div>
                  </CardContent>
                </Card>
                <Card className="bg-primary/5 border-primary/20">
                  <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
                    <CardTitle className="text-sm font-medium">Minhas Despesas</CardTitle>
                    <TrendingDown className="h-4 w-4 text-destructive" />
                  </CardHeader>
                  <CardContent>
                    <div className="text-xl font-bold text-destructive">
                      {myMetrics.totalExpenses.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                    </div>
                  </CardContent>
                </Card>
                <Card className="bg-primary/5 border-primary/20">
                  <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
                    <CardTitle className="text-sm font-medium">Meus Investimentos</CardTitle>
                    <PiggyBank className="h-4 w-4 text-accent" />
                  </CardHeader>
                  <CardContent>
                    <div className="text-xl font-bold">
                      {myMetrics.totalInvestments.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                    </div>
                  </CardContent>
                </Card>
                <Card className="bg-primary/5 border-primary/20">
                  <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
                    <CardTitle className="text-sm font-medium">Meu Saldo</CardTitle>
                    <DollarSign className="h-4 w-4 text-primary" />
                  </CardHeader>
                  <CardContent>
                    <div className={cn("text-xl font-bold", myMetrics.balance >= 0 ? "text-success" : "text-destructive")}>
                      {myMetrics.balance.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                    </div>
                  </CardContent>
                </Card>
              </div>
            </div>

            <Separator />

            {/* SEÃ‡ÃƒO: TOTAL DO GRUPO */}
            <div className="space-y-3">
              <h3 className="text-sm font-semibold flex items-center gap-2 text-muted-foreground">
                <Users className="h-4 w-4" /> Total do Grupo
              </h3>
              <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <Card>
                  <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
                    <CardTitle className="text-sm font-medium">Receitas</CardTitle>
                    <TrendingUp className="h-4 w-4 text-success" />
                  </CardHeader>
                  <CardContent>
                    <div className="text-2xl font-bold text-success">
                      {groupMetrics.totalIncome.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                    </div>
                  </CardContent>
                </Card>

                <Card>
                  <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
                    <CardTitle className="text-sm font-medium">Despesas</CardTitle>
                    <TrendingDown className="h-4 w-4 text-destructive" />
                  </CardHeader>
                  <CardContent>
                    <div className="text-2xl font-bold text-destructive">
                      {groupMetrics.totalExpenses.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                    </div>
                  </CardContent>
                </Card>

                <Card>
                  <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
                    <CardTitle className="text-sm font-medium">Investimentos</CardTitle>
                    <PiggyBank className="h-4 w-4 text-accent" />
                  </CardHeader>
                  <CardContent>
                    <div className="text-2xl font-bold">
                      {groupMetrics.totalInvestments.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                    </div>
                  </CardContent>
                </Card>

                <Card>
                  <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
                    <CardTitle className="text-sm font-medium">Saldo</CardTitle>
                    <DollarSign className="h-4 w-4 text-primary" />
                  </CardHeader>
                  <CardContent>
                    <div className={cn("text-2xl font-bold", groupMetrics.balance >= 0 ? "text-success" : "text-destructive")}>
                      {groupMetrics.balance.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                    </div>
                  </CardContent>
                </Card>
              </div>
            </div>

            {/* Abas */}
            <Tabs defaultValue="transactions" className="w-full">
              <TabsList className="grid w-full grid-cols-3">
                <TabsTrigger value="transactions">TransaÃ§Ãµes</TabsTrigger>
                <TabsTrigger value="events">Eventos</TabsTrigger>
                <TabsTrigger value="investments">Investimentos</TabsTrigger>
              </TabsList>

              <TabsContent value="transactions" className="space-y-4">
                <Card>
                  <CardHeader>
                    <CardTitle className="flex items-center gap-2">
                      <Calendar className="h-5 w-5" />
                      TransaÃ§Ãµes do Grupo
                    </CardTitle>
                  </CardHeader>
                  <CardContent>
                    {transactions.length === 0 ? (
                      <p className="text-center text-muted-foreground py-8">Nenhuma transaÃ§Ã£o encontrada neste perÃ­odo.</p>
                    ) : (
                      <div className="space-y-3">
                        {transactions.map((transaction) => (
                          <div key={transaction.id} className="flex items-center justify-between p-3 rounded-lg border border-border">
                            <div className="flex items-center gap-3">
                              <div
                                className={cn(
                                  "p-2 rounded-full",
                                  transaction.type === "income" ? "bg-success/10 text-success" : "bg-destructive/10 text-destructive"
                                )}
                              >
                                {transaction.type === "income" ? (
                                  <ArrowUpCircle className="h-4 w-4" />
                                ) : (
                                  <ArrowDownCircle className="h-4 w-4" />
                                )}
                              </div>
                              <div>
                                <p className="font-medium">{transaction.description}</p>
                                <Badge variant="secondary" className="text-xs mt-1">
                                  {transaction.category}
                                </Badge>
                              </div>
                            </div>
                            <div className="text-right">
                              <p className={cn("font-semibold", transaction.type === "income" ? "text-success" : "text-destructive")}>
                                {transaction.type === "income" ? "+" : ""}
                                {transaction.amount.toLocaleString("pt-BR", {
                                  style: "currency",
                                  currency: "BRL",
                                })}
                              </p>
                              <p className="text-xs text-muted-foreground">{new Date(transaction.date).toLocaleDateString("pt-BR")}</p>
                            </div>
                          </div>
                        ))}
                      </div>
                    )}
                  </CardContent>
                </Card>
              </TabsContent>

              <TabsContent value="events" className="space-y-4">
                <Card>
                  <CardHeader>
                    <CardTitle className="flex items-center gap-2">
                      <Layers className="h-5 w-5" />
                      Eventos do Grupo
                    </CardTitle>
                  </CardHeader>
                  <CardContent>
                    {groupEvents.length === 0 ? (
                      <p className="text-center text-muted-foreground py-8">Nenhum evento encontrado neste perÃ­odo.</p>
                    ) : (
                      <div className="space-y-3">
                        {groupEvents.map((ev) => (
                          <div
                            key={ev.id}
                            className="flex items-center justify-between p-4 rounded-lg border bg-accent/5 hover:bg-accent/10 border-l-4 border-l-primary cursor-pointer transition-all"
                            onClick={() => setSelectedEvent(ev)}
                          >
                            <div className="flex items-center gap-4">
                              <div>
                                <div className="flex items-center gap-2">
                                  <p className="font-bold text-primary">{ev.name}</p>
                                </div>
                                <span className="text-xs text-muted-foreground">{new Date(ev.date).toLocaleDateString("pt-BR")}</span>
                              </div>
                            </div>
                            <div className="flex items-center gap-2">
                              <p className={cn("font-semibold text-lg", (ev.totalAmount || 0) >= 0 ? "text-success" : "text-destructive")}>
                                {(ev.totalAmount || 0).toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                              </p>
                            </div>
                          </div>
                        ))}
                      </div>
                    )}
                  </CardContent>
                </Card>
              </TabsContent>

              <TabsContent value="investments" className="space-y-4">
                <Card>
                  <CardHeader>
                    <CardTitle className="flex items-center gap-2">
                      <PiggyBank className="h-5 w-5" />
                      Investimentos do Grupo
                    </CardTitle>
                  </CardHeader>
                  <CardContent>
                    {investments.length === 0 ? (
                      <p className="text-center text-muted-foreground py-8">Nenhum investimento encontrado neste perÃ­odo.</p>
                    ) : (
                      <div className="space-y-3">
                        {investments.map((investment) => (
                          <div key={investment.id} className="flex items-center justify-between p-3 rounded-lg border border-border">
                            <div>
                              <p className="font-medium">{investment.name}</p>
                              <div className="flex items-center gap-2 mt-1">
                                <Badge variant="secondary" className="text-xs">
                                  {investment.type}
                                </Badge>
                              </div>
                            </div>
                            <div className="text-right">
                              <p className="font-semibold">
                                {investment.current_value.toLocaleString("pt-BR", {
                                  style: "currency",
                                  currency: "BRL",
                                })}
                              </p>
                              <p className="text-xs text-muted-foreground">
                                Aplicado:{" "}
                                {investment.amount.toLocaleString("pt-BR", {
                                  style: "currency",
                                  currency: "BRL",
                                })}
                              </p>
                              <p className="text-xs text-muted-foreground">{new Date(investment.created_at).toLocaleDateString("pt-BR")}</p>
                            </div>
                          </div>
                        ))}
                      </div>
                    )}
                  </CardContent>
                </Card>
              </TabsContent>
            </Tabs>
          </div>
        )}

        {selectedEvent && (
          <EventDetailsModal
            isOpen={!!selectedEvent}
            onClose={() => setSelectedEvent(null)}
            eventId={selectedEvent.id}
            eventName={selectedEvent.name}
            eventDate={selectedEvent.date}
            groupId={groupId}
            onUpdate={() => {
              loadGroupData();
            }}
          />
        )}
      </DialogContent>
    </Dialog>
  );
};
```
---

### src\components\layout\DashboardLayout.tsx

**Language:** typescript  
**Size:** 1.5 KB  
**Last Modified:** 2025-11-19T20:35:09.376Z

```typescript
import { ReactNode, useState } from "react";
import { Menu } from "@/lib/icons";

import { Sidebar } from "@/components/layout/Sidebar";
import { Button } from "@/components/ui/button";
import { Sheet, SheetContent, SheetTrigger } from "@/components/ui/sheet";

interface DashboardLayoutProps {
  children: ReactNode;
}

export const DashboardLayout = ({ children }: DashboardLayoutProps) => {
  const [sidebarOpen, setSidebarOpen] = useState(false);

  return (
    <div className="flex min-h-screen w-full bg-background">
      <aside className="hidden md:flex md:w-64 md:flex-col md:fixed md:inset-y-0 md:z-50">
        <Sidebar />
      </aside>

      <div className="flex flex-col flex-1 md:pl-64">
        <header className="sticky top-0 z-40 flex h-14 items-center gap-4 border-b bg-background px-4 md:hidden">
          <Sheet open={sidebarOpen} onOpenChange={setSidebarOpen}>
            <SheetTrigger asChild>
              <Button variant="ghost" size="icon" className="md:hidden">
                <Menu className="h-5 w-5" />
              </Button>
            </SheetTrigger>
            <SheetContent side="left" className="p-0 w-64">
              <Sidebar onNavigate={() => setSidebarOpen(false)} />
            </SheetContent>
          </Sheet>
          <h1 className="text-lg font-semibold">Zeni Wallet</h1>
        </header>

        <main className="flex-1 overflow-y-auto">
          <div className="h-full">{children}</div>
        </main>
      </div>
    </div>
  );
};
```
---

### src\components\layout\Sidebar.tsx

**Language:** typescript  
**Size:** 2.56 KB  
**Last Modified:** 2025-11-25T18:58:19.049Z

```typescript
import { NavLink, useNavigate } from "react-router-dom";
import { LayoutDashboard, ArrowUpDown, TrendingUp, Users, PlusCircle, DollarSign, LogOut, Bell, User } from "lucide-react";

import { Button } from "@/components/ui/button";
import { Separator } from "@/components/ui/separator";

import { useAuth } from "@/contexts/AuthContext";

interface SidebarProps {
  onNavigate?: () => void;
}

const navigation = [
  { name: "Dashboard", href: "/dashboard", icon: LayoutDashboard },
  { name: "TransaÃ§Ãµes", href: "/transactions", icon: ArrowUpDown },
  { name: "Investimentos", href: "/investments", icon: TrendingUp },
  { name: "Grupos", href: "/groups", icon: Users },
  { name: "Lembretes", href: "/reminders", icon: Bell },
  { name: "Meu Perfil", href: "/profile", icon: User },
  { name: "Novo LanÃ§amento", href: "/new-transaction", icon: PlusCircle },
];

export const Sidebar = ({ onNavigate }: SidebarProps) => {
  const { signOut, user } = useAuth();
  const navigate = useNavigate();

  const handleLogout = async () => {
    await signOut();
    navigate("/auth");
  };

  const handleNavClick = () => {
    if (onNavigate) {
      onNavigate();
    }
  };

  return (
    <div className="flex h-full w-full flex-col bg-card border-r border-border">
      <div className="p-6">
        <div className="flex items-center gap-2 mb-2">
          <DollarSign className="h-8 w-8 text-primary" />
          <h1 className="text-xl font-bold text-foreground">Zeni Wallet</h1>
        </div>
        {user && <p className="text-sm text-muted-foreground truncate">OlÃ¡, {user.email}</p>}
      </div>

      <Separator />

      <nav className="flex-1 overflow-y-auto p-4 space-y-2">
        {navigation.map((item) => (
          <NavLink
            key={item.href}
            to={item.href}
            onClick={handleNavClick}
            className={({ isActive }) =>
              `flex items-center gap-3 px-3 py-2 rounded-md text-sm font-medium transition-colors ${
                isActive ? "bg-primary text-primary-foreground" : "text-muted-foreground hover:bg-muted hover:text-foreground"
              }`
            }
          >
            <item.icon className="h-5 w-5" />
            <span>{item.name}</span>
          </NavLink>
        ))}
      </nav>

      <Separator />

      <div className="p-4">
        <Button variant="ghost" className="w-full justify-start gap-3" onClick={handleLogout}>
          <LogOut className="h-5 w-5" />
          <span>Sair</span>
        </Button>
      </div>
    </div>
  );
};
```
---

### src\components\LoadingFallback.tsx

**Language:** typescript  
**Size:** 413 Bytes  
**Last Modified:** 2025-11-04T18:32:58.289Z

```typescript
import { Loader2 } from "lucide-react";

export const LoadingFallback = () => {
  return (
    <div className="min-h-screen flex items-center justify-center bg-background">
      <div className="flex flex-col items-center gap-4">
        <Loader2 className="h-12 w-12 animate-spin text-primary" />
        <p className="text-sm text-muted-foreground">Carregando...</p>
      </div>
    </div>
  );
};
```
---

### src\components\PWAPrompt.tsx

**Language:** typescript  
**Size:** 1.63 KB  
**Last Modified:** 2025-11-19T17:43:36.218Z

```typescript
import { useEffect } from "react";
import { Button } from "../components/ui/button";
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "../components/ui/card";
import { RefreshCw, X } from "lucide-react";

import { usePWA } from "../hooks/usePWA";

import type { FC } from "react";

const PWAPrompt: FC = () => {
  const { needRefresh, offlineReady, updateApp, close } = usePWA();

  useEffect(() => {
    if (offlineReady) {
      console.log("App pronta para funcionar offline");
    }
  }, [offlineReady]);

  if (!needRefresh && !offlineReady) {
    return null;
  }

  return (
    <div className="fixed bottom-4 right-4 z-50 max-w-sm">
      <Card className="border-primary">
        <CardHeader className="pb-3">
          <div className="flex items-center justify-between">
            <CardTitle className="text-base">{needRefresh ? "AtualizaÃ§Ã£o DisponÃ­vel" : "App Pronto"}</CardTitle>
            <Button variant="ghost" size="icon" className="h-6 w-6" onClick={close}>
              <X className="h-4 w-4" />
            </Button>
          </div>
          <CardDescription>
            {needRefresh ? "Uma nova versÃ£o do app estÃ¡ disponÃ­vel" : "O app estÃ¡ pronto para funcionar offline"}
          </CardDescription>
        </CardHeader>
        <CardContent className="pt-0">
          {needRefresh && (
            <Button onClick={updateApp} className="w-full" size="sm">
              <RefreshCw className="mr-2 h-4 w-4" />
              Atualizar Agora
            </Button>
          )}
        </CardContent>
      </Card>
    </div>
  );
};

export default PWAPrompt;
```
---

### src\components\reminders\RemindersList.tsx

**Language:** typescript  
**Size:** 9.42 KB  
**Last Modified:** 2025-11-06T16:38:07.240Z

```typescript
import { useState } from "react";
import { Bell, BellOff, Check, Trash2, Clock, RefreshCw } from "lucide-react";
import { format } from "date-fns";
import { ptBR } from "date-fns/locale";

import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import { Switch } from "@/components/ui/switch";
import { Label } from "@/components/ui/label";
import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
} from "@/components/ui/alert-dialog";

import { useReminders } from "@/hooks/useReminders";
import { AddReminderDialog } from "@/components/dialogs/AddReminderDialog";

import { cn } from "@/lib/utils";

import type { Reminder } from "@/utils/types/reminder";

const REPEAT_TYPE_LABELS = {
  none: "NÃ£o repete",
  daily: "Diariamente",
  weekly: "Semanalmente",
  monthly: "Mensalmente",
  yearly: "Anualmente",
};

export const RemindersList = () => {
  const {
    reminders,
    loading,
    isSubscribed,
    notificationPermission,
    completeReminder,
    deleteReminder,
    enableNotifications,
    disableNotifications,
  } = useReminders();

  const [reminderToDelete, setReminderToDelete] = useState<Reminder | null>(null);

  const handleComplete = async (id: string) => {
    await completeReminder(id);
  };

  const handleDelete = async () => {
    if (!reminderToDelete) return;
    await deleteReminder(reminderToDelete.id);
    setReminderToDelete(null);
  };

  const formatReminderDate = (dateString: string) => {
    const date = new Date(dateString);
    return format(date, "dd/MM/yyyy 'Ã s' HH:mm", { locale: ptBR });
  };

  const isOverdue = (dateString: string) => {
    const reminderDate = new Date(dateString);
    const now = new Date();
    return reminderDate.getTime() < now.getTime();
  };

  const sortedReminders = [...reminders].sort((a, b) => {
    if (a.is_completed !== b.is_completed) {
      return a.is_completed ? 1 : -1;
    }
    return new Date(a.reminder_date).getTime() - new Date(b.reminder_date).getTime();
  });

  return (
    <div className="space-y-6">
      <Card>
        <CardHeader>
          <div className="flex items-center justify-between">
            <div>
              <CardTitle>NotificaÃ§Ãµes Push</CardTitle>
              <CardDescription>Receba lembretes mesmo quando nÃ£o estiver usando o aplicativo</CardDescription>
            </div>
            <div className="flex items-center space-x-2">
              <Switch
                id="notifications"
                checked={isSubscribed}
                onCheckedChange={(checked) => {
                  if (checked) {
                    enableNotifications();
                  } else {
                    disableNotifications();
                  }
                }}
                disabled={notificationPermission === "denied"}
              />
              <Label htmlFor="notifications" className="cursor-pointer">
                {isSubscribed ? <Bell className="h-5 w-5" /> : <BellOff className="h-5 w-5" />}
              </Label>
            </div>
          </div>
          {notificationPermission === "denied" && (
            <p className="text-sm text-destructive mt-2">
              As notificaÃ§Ãµes foram bloqueadas. Altere as configuraÃ§Ãµes do navegador para habilitar.
            </p>
          )}
          {notificationPermission === "default" && !isSubscribed && (
            <p className="text-sm text-muted-foreground mt-2">Ative as notificaÃ§Ãµes para receber lembretes no desktop</p>
          )}
        </CardHeader>
      </Card>

      <Card>
        <CardHeader>
          <div className="flex items-center justify-between">
            <div>
              <CardTitle>Meus Lembretes</CardTitle>
              <CardDescription>
                {reminders.length === 0
                  ? "Nenhum lembrete cadastrado"
                  : `${reminders.filter((r) => !r.is_completed).length} lembretes ativos`}
              </CardDescription>
            </div>
            <AddReminderDialog />
          </div>
        </CardHeader>
        <CardContent>
          {loading ? (
            <div className="flex justify-center py-8">
              <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
            </div>
          ) : sortedReminders.length === 0 ? (
            <div className="text-center py-8 text-muted-foreground">
              <Bell className="h-12 w-12 mx-auto mb-2 opacity-20" />
              <p>Nenhum lembrete cadastrado</p>
              <p className="text-sm mt-1">Adicione lembretes para nÃ£o esquecer seus compromissos financeiros</p>
            </div>
          ) : (
            <div className="space-y-3">
              {sortedReminders.map((reminder) => {
                const overdueStatus = !reminder.is_completed && isOverdue(reminder.reminder_date);

                return (
                  <div
                    key={reminder.id}
                    className={cn(
                      "flex items-start gap-3 p-4 rounded-lg border transition-colors",
                      reminder.is_completed
                        ? "bg-muted/50 opacity-60"
                        : overdueStatus
                        ? "bg-destructive/5 border-destructive/20"
                        : "bg-card hover:bg-accent/5"
                    )}
                  >
                    <div className="flex-1 space-y-1">
                      <div className="flex items-start justify-between gap-2">
                        <h4 className={cn("font-medium", reminder.is_completed && "line-through text-muted-foreground")}>
                          {reminder.title}
                        </h4>
                        <div className="flex items-center gap-1">
                          {!reminder.is_completed && (
                            <Button
                              variant="ghost"
                              size="icon"
                              className="h-8 w-8 text-success hover:text-success hover:bg-success/10"
                              onClick={() => handleComplete(reminder.id)}
                              title="Marcar como concluÃ­do"
                            >
                              <Check className="h-4 w-4" />
                            </Button>
                          )}
                          <Button
                            variant="ghost"
                            size="icon"
                            className="h-8 w-8 text-destructive hover:text-destructive hover:bg-destructive/10"
                            onClick={() => setReminderToDelete(reminder)}
                            title="Excluir lembrete"
                          >
                            <Trash2 className="h-4 w-4" />
                          </Button>
                        </div>
                      </div>
                      {reminder.description && <p className="text-sm text-muted-foreground">{reminder.description}</p>}
                      <div className="flex items-center gap-2 flex-wrap">
                        <Badge
                          variant={reminder.is_completed ? "secondary" : overdueStatus ? "destructive" : "default"}
                          className="text-xs"
                        >
                          <Clock className="h-3 w-3 mr-1" />
                          {formatReminderDate(reminder.reminder_date)}
                        </Badge>
                        {reminder.repeat_type && reminder.repeat_type !== "none" && (
                          <Badge variant="outline" className="text-xs">
                            <RefreshCw className="h-3 w-3 mr-1" />
                            {REPEAT_TYPE_LABELS[reminder.repeat_type]}
                          </Badge>
                        )}
                        {reminder.is_completed && (
                          <Badge variant="secondary" className="text-xs">
                            ConcluÃ­do
                          </Badge>
                        )}
                        {overdueStatus && (
                          <Badge variant="destructive" className="text-xs">
                            Atrasado
                          </Badge>
                        )}
                      </div>
                    </div>
                  </div>
                );
              })}
            </div>
          )}
        </CardContent>
      </Card>

      <AlertDialog open={!!reminderToDelete} onOpenChange={() => setReminderToDelete(null)}>
        <AlertDialogContent>
          <AlertDialogHeader>
            <AlertDialogTitle>Remover Lembrete</AlertDialogTitle>
            <AlertDialogDescription>Tem certeza que deseja remover este lembrete? Esta aÃ§Ã£o nÃ£o pode ser desfeita.</AlertDialogDescription>
          </AlertDialogHeader>
          <AlertDialogFooter>
            <AlertDialogCancel>Cancelar</AlertDialogCancel>
            <AlertDialogAction onClick={handleDelete} className="bg-destructive text-destructive-foreground hover:bg-destructive/90">
              Remover
            </AlertDialogAction>
          </AlertDialogFooter>
        </AlertDialogContent>
      </AlertDialog>
    </div>
  );
};
```
---

### src\components\theme-provider.tsx

**Language:** typescript  
**Size:** 1.54 KB  
**Last Modified:** 2025-11-25T18:56:10.641Z

```typescript
import { createContext, useContext, useEffect, useState } from "react";

type Theme = "dark" | "light" | "system";

type ThemeProviderProps = {
  children: React.ReactNode;
  defaultTheme?: Theme;
  storageKey?: string;
};

type ThemeProviderState = {
  theme: Theme;
  setTheme: (theme: Theme) => void;
};

const initialState: ThemeProviderState = {
  theme: "system",
  setTheme: () => null,
};

const ThemeProviderContext = createContext<ThemeProviderState>(initialState);

export function ThemeProvider({ children, defaultTheme = "system", storageKey = "vite-ui-theme" }: ThemeProviderProps) {
  const [theme, setTheme] = useState<Theme>(() => (localStorage.getItem(storageKey) as Theme) || defaultTheme);

  useEffect(() => {
    const root = window.document.documentElement;

    root.classList.remove("light", "dark");

    if (theme === "system") {
      const systemTheme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light";

      root.classList.add(systemTheme);
      return;
    }

    root.classList.add(theme);
  }, [theme]);

  const value = {
    theme,
    setTheme: (theme: Theme) => {
      localStorage.setItem(storageKey, theme);
      setTheme(theme);
    },
  };

  return <ThemeProviderContext.Provider value={value}>{children}</ThemeProviderContext.Provider>;
}

export const useTheme = () => {
  const context = useContext(ThemeProviderContext);

  if (context === undefined) throw new Error("useTheme must be used within a ThemeProvider");

  return context;
};
```
---

### src\components\transactions\EventDetailsModal.tsx

**Language:** typescript  
**Size:** 7.73 KB  
**Last Modified:** 2025-11-28T20:14:08.907Z

```typescript
import { useState, useEffect } from "react";
import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription } from "@/components/ui/dialog";
import { Button } from "@/components/ui/button";
import { Card, CardContent } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { ArrowUpCircle, ArrowDownCircle, Calendar, Trash2, Plus } from "lucide-react";
import { supabase } from "@/integrations/supabase/client";
import { useToast } from "@/hooks/use-toast";
import { cn } from "@/lib/utils";
import { AddTransactionDialog } from "@/components/dialogs/AddTransactionDialog";

interface EventDetailsModalProps {
  isOpen: boolean;
  onClose: () => void;
  eventId: string;
  eventName: string;
  eventDate: string;
  groupId?: string; // NOVO: Permite passar o grupo ao qual o evento pertence
  onUpdate?: () => void;
}

interface Transaction {
  id: string;
  description: string;
  amount: number;
  type: "income" | "expense";
  category: string;
  date: string;
}

export const EventDetailsModal = ({ isOpen, onClose, eventId, eventName, eventDate, groupId, onUpdate }: EventDetailsModalProps) => {
  const [transactions, setTransactions] = useState<Transaction[]>([]);
  const [loading, setLoading] = useState(false);
  const { toast } = useToast();

  const loadEventTransactions = async () => {
    if (!eventId) return;
    setLoading(true);
    try {
      const { data, error } = await supabase.from("transactions").select("*").eq("event_id", eventId).order("date", { ascending: false });
      if (error) throw error;

      setTransactions(
        data?.map((t) => ({
          id: t.id,
          description: t.description,
          amount: Number(t.amount),
          type: t.type as "income" | "expense",
          category: t.category,
          date: t.date,
        })) || []
      );
    } catch (error) {
      console.error("Erro ao carregar transaÃ§Ãµes do evento:", error);
      toast({
        title: "Erro",
        description: "NÃ£o foi possÃ­vel carregar os itens do evento",
        variant: "destructive",
      });
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => {
    if (isOpen) {
      loadEventTransactions();
    }
  }, [isOpen, eventId]);

  const handleDeleteTransaction = async (id: string) => {
    try {
      const { error } = await supabase.from("transactions").delete().eq("id", id);
      if (error) throw error;

      toast({ title: "Sucesso", description: "Item removido do evento" });
      loadEventTransactions();
      if (onUpdate) onUpdate();
    } catch (error) {
      console.error("Erro ao deletar:", error);
      toast({ title: "Erro", description: "Falha ao remover item", variant: "destructive" });
    }
  };

  const handleDeleteEvent = async () => {
    if (!confirm("Tem certeza? Isso apagarÃ¡ o evento e TODAS as transaÃ§Ãµes dentro dele.")) return;
    try {
      const { error } = await supabase
        .from("events" as any)
        .delete()
        .eq("id", eventId);
      if (error) throw error;

      toast({ title: "Sucesso", description: "Evento removido com sucesso" });
      onClose();
      if (onUpdate) onUpdate();
    } catch (error) {
      toast({ title: "Erro", description: "Falha ao remover evento", variant: "destructive" });
    }
  };

  const totalAmount = transactions.reduce((acc, t) => acc + (t.type === "income" ? t.amount : -Math.abs(t.amount)), 0);

  return (
    <Dialog open={isOpen} onOpenChange={onClose}>
      <DialogContent className="max-w-3xl max-h-[90vh] overflow-y-auto">
        <DialogHeader>
          <div className="flex items-center justify-between pr-8">
            <DialogTitle className="text-2xl">{eventName}</DialogTitle>
            <Button variant="ghost" size="icon" onClick={handleDeleteEvent} className="text-destructive">
              <Trash2 className="h-5 w-5" />
            </Button>
          </div>
          <DialogDescription>
            {new Date(eventDate).toLocaleDateString("pt-BR")} â€¢ Total:{" "}
            <span className={cn("font-bold", totalAmount >= 0 ? "text-success" : "text-destructive")}>
              {totalAmount.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
            </span>
          </DialogDescription>
        </DialogHeader>

        <div className="space-y-4 mt-4">
          <div className="flex gap-2">
            <AddTransactionDialog
              type="expense"
              eventId={eventId}
              defaultGroupId={groupId} // Passa o ID do grupo para vincular a transaÃ§Ã£o
              onSuccess={() => {
                loadEventTransactions();
                if (onUpdate) onUpdate();
              }}
              trigger={
                <Button className="flex-1" variant="outline">
                  <Plus className="h-4 w-4 mr-2" /> Adicionar Despesa
                </Button>
              }
            />
            <AddTransactionDialog
              type="income"
              eventId={eventId}
              defaultGroupId={groupId} // Passa o ID do grupo para vincular a transaÃ§Ã£o
              onSuccess={() => {
                loadEventTransactions();
                if (onUpdate) onUpdate();
              }}
              trigger={
                <Button className="flex-1" variant="outline">
                  <Plus className="h-4 w-4 mr-2" /> Adicionar Receita
                </Button>
              }
            />
          </div>

          <div className="space-y-2">
            {loading ? (
              <p className="text-center text-muted-foreground">Carregando...</p>
            ) : transactions.length === 0 ? (
              <p className="text-center text-muted-foreground py-8">Nenhum lanÃ§amento neste evento.</p>
            ) : (
              transactions.map((t) => (
                <Card key={t.id} className="border border-border">
                  <CardContent className="p-3 flex items-center justify-between">
                    <div className="flex items-center gap-3">
                      <div className={cn("p-2 rounded-full", t.type === "income" ? "bg-success/10" : "bg-destructive/10")}>
                        {t.type === "income" ? (
                          <ArrowUpCircle className="h-4 w-4 text-success" />
                        ) : (
                          <ArrowDownCircle className="h-4 w-4 text-destructive" />
                        )}
                      </div>
                      <div>
                        <p className="font-medium text-sm">{t.description}</p>
                        <div className="flex items-center gap-2">
                          <Badge variant="secondary" className="text-[10px]">
                            {t.category}
                          </Badge>
                          <span className="text-[10px] text-muted-foreground">{new Date(t.date).toLocaleDateString("pt-BR")}</span>
                        </div>
                      </div>
                    </div>
                    <div className="flex items-center gap-3">
                      <span className={cn("font-semibold text-sm", t.type === "income" ? "text-success" : "text-destructive")}>
                        {t.amount.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                      </span>
                      <Button variant="ghost" size="icon" className="h-6 w-6" onClick={() => handleDeleteTransaction(t.id)}>
                        <Trash2 className="h-3 w-3 text-muted-foreground" />
                      </Button>
                    </div>
                  </CardContent>
                </Card>
              ))
            )}
          </div>
        </div>
      </DialogContent>
    </Dialog>
  );
};
```
---

### src\components\transactions\types.ts

**Language:** typescript  
**Size:** 539 Bytes  
**Last Modified:** 2025-11-04T18:43:31.372Z

```typescript
export type Transaction = {
  id: string;
  description: string;
  amount: number;
  type: "income" | "expense";
  category: string;
  date: string;
  group_id?: string | null;
  user_id?: string;
  created_at?: string;
  updated_at?: string;
  is_recurring?: boolean;
  is_fixed?: boolean;
  recurrence_id?: string | null;
  recurrence_count?: number | null;
  assigned_to?: string | null;
  [key: string]: any;
};

export type VirtualizedListProps<T> = {
  data: T[];
  height?: number;
  itemHeight?: number;
};
```
---

### src\components\ui\accordion.tsx

**Language:** typescript  
**Size:** 1.97 KB  
**Last Modified:** 2025-10-31T13:45:27.499Z

```typescript
import * as React from "react";
import * as AccordionPrimitive from "@radix-ui/react-accordion";
import { ChevronDown } from "@/lib/icons";

import { cn } from "@/lib/utils";

const Accordion = AccordionPrimitive.Root;

const AccordionItem = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>
>(({ className, ...props }, ref) => <AccordionPrimitive.Item ref={ref} className={cn("border-b", className)} {...props} />);
AccordionItem.displayName = "AccordionItem";

const AccordionTrigger = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <AccordionPrimitive.Header className="flex">
    <AccordionPrimitive.Trigger
      ref={ref}
      className={cn(
        "flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",
        className
      )}
      {...props}
    >
      {children}
      <ChevronDown className="h-4 w-4 shrink-0 transition-transform duration-200" />
    </AccordionPrimitive.Trigger>
  </AccordionPrimitive.Header>
));
AccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName;

const AccordionContent = React.forwardRef<
  React.ElementRef<typeof AccordionPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <AccordionPrimitive.Content
    ref={ref}
    className="overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down"
    {...props}
  >
    <div className={cn("pb-4 pt-0", className)}>{children}</div>
  </AccordionPrimitive.Content>
));

AccordionContent.displayName = AccordionPrimitive.Content.displayName;

export { Accordion, AccordionItem, AccordionTrigger, AccordionContent };
```
---

### src\components\ui\alert-dialog.tsx

**Language:** typescript  
**Size:** 4.28 KB  
**Last Modified:** 2025-11-25T20:32:57.596Z

```typescript
import * as React from "react";
import * as AlertDialogPrimitive from "@radix-ui/react-alert-dialog";

import { cn } from "@/lib/utils";
import { buttonVariants } from "@/components/ui/button";

const AlertDialog = AlertDialogPrimitive.Root;

const AlertDialogTrigger = AlertDialogPrimitive.Trigger;

const AlertDialogPortal = AlertDialogPrimitive.Portal;

const AlertDialogOverlay = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Overlay
    className={cn(
      "fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
      className
    )}
    {...props}
    ref={ref}
  />
));
AlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName;

const AlertDialogContent = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>
>(({ className, ...props }, ref) => (
  <AlertDialogPortal>
    <AlertDialogOverlay />
    <AlertDialogPrimitive.Content
      ref={ref}
      className={cn(
        "fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",
        className
      )}
      {...props}
    />
  </AlertDialogPortal>
));
AlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName;

const AlertDialogHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col space-y-2 text-center sm:text-left", className)} {...props} />
);
AlertDialogHeader.displayName = "AlertDialogHeader";

const AlertDialogFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2", className)} {...props} />
);
AlertDialogFooter.displayName = "AlertDialogFooter";

const AlertDialogTitle = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>
>(({ className, ...props }, ref) => <AlertDialogPrimitive.Title ref={ref} className={cn("text-lg font-semibold", className)} {...props} />);
AlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName;

const AlertDialogDescription = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Description ref={ref} className={cn("text-sm text-muted-foreground", className)} {...props} />
));
AlertDialogDescription.displayName = AlertDialogPrimitive.Description.displayName;

const AlertDialogAction = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Action>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>
>(({ className, ...props }, ref) => <AlertDialogPrimitive.Action ref={ref} className={cn(buttonVariants(), className)} {...props} />);
AlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName;

const AlertDialogCancel = React.forwardRef<
  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,
  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>
>(({ className, ...props }, ref) => (
  <AlertDialogPrimitive.Cancel ref={ref} className={cn(buttonVariants({ variant: "outline" }), "mt-2 sm:mt-0", className)} {...props} />
));
AlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName;

export {
  AlertDialog,
  AlertDialogPortal,
  AlertDialogOverlay,
  AlertDialogTrigger,
  AlertDialogContent,
  AlertDialogHeader,
  AlertDialogFooter,
  AlertDialogTitle,
  AlertDialogDescription,
  AlertDialogAction,
  AlertDialogCancel,
};
```
---

### src\components\ui\alert.tsx

**Language:** typescript  
**Size:** 1.6 KB  
**Last Modified:** 2025-08-28T19:03:37.258Z

```typescript
import * as React from "react"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const alertVariants = cva(
  "relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",
  {
    variants: {
      variant: {
        default: "bg-background text-foreground",
        destructive:
          "border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

const Alert = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>
>(({ className, variant, ...props }, ref) => (
  <div
    ref={ref}
    role="alert"
    className={cn(alertVariants({ variant }), className)}
    {...props}
  />
))
Alert.displayName = "Alert"

const AlertTitle = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLHeadingElement>
>(({ className, ...props }, ref) => (
  <h5
    ref={ref}
    className={cn("mb-1 font-medium leading-none tracking-tight", className)}
    {...props}
  />
))
AlertTitle.displayName = "AlertTitle"

const AlertDescription = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    className={cn("text-sm [&_p]:leading-relaxed", className)}
    {...props}
  />
))
AlertDescription.displayName = "AlertDescription"

export { Alert, AlertTitle, AlertDescription }
```
---

### src\components\ui\aspect-ratio.tsx

**Language:** typescript  
**Size:** 145 Bytes  
**Last Modified:** 2025-08-28T19:03:37.259Z

```typescript
import * as AspectRatioPrimitive from "@radix-ui/react-aspect-ratio"

const AspectRatio = AspectRatioPrimitive.Root

export { AspectRatio }
```
---

### src\components\ui\avatar.tsx

**Language:** typescript  
**Size:** 1.42 KB  
**Last Modified:** 2025-08-28T19:03:37.259Z

```typescript
import * as React from "react"
import * as AvatarPrimitive from "@radix-ui/react-avatar"

import { cn } from "@/lib/utils"

const Avatar = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Root
    ref={ref}
    className={cn(
      "relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",
      className
    )}
    {...props}
  />
))
Avatar.displayName = AvatarPrimitive.Root.displayName

const AvatarImage = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Image>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Image
    ref={ref}
    className={cn("aspect-square h-full w-full", className)}
    {...props}
  />
))
AvatarImage.displayName = AvatarPrimitive.Image.displayName

const AvatarFallback = React.forwardRef<
  React.ElementRef<typeof AvatarPrimitive.Fallback>,
  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>
>(({ className, ...props }, ref) => (
  <AvatarPrimitive.Fallback
    ref={ref}
    className={cn(
      "flex h-full w-full items-center justify-center rounded-full bg-muted",
      className
    )}
    {...props}
  />
))
AvatarFallback.displayName = AvatarPrimitive.Fallback.displayName

export { Avatar, AvatarImage, AvatarFallback }
```
---

### src\components\ui\badge.tsx

**Language:** typescript  
**Size:** 1.14 KB  
**Last Modified:** 2025-08-28T19:03:37.260Z

```typescript
import * as React from "react"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const badgeVariants = cva(
  "inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",
  {
    variants: {
      variant: {
        default:
          "border-transparent bg-primary text-primary-foreground hover:bg-primary/80",
        secondary:
          "border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",
        destructive:
          "border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",
        outline: "text-foreground",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
)

export interface BadgeProps
  extends React.HTMLAttributes<HTMLDivElement>,
    VariantProps<typeof badgeVariants> {}

function Badge({ className, variant, ...props }: BadgeProps) {
  return (
    <div className={cn(badgeVariants({ variant }), className)} {...props} />
  )
}

export { Badge, badgeVariants }
```
---

### src\components\ui\breadcrumb.tsx

**Language:** typescript  
**Size:** 2.58 KB  
**Last Modified:** 2025-10-31T13:45:28.264Z

```typescript
import * as React from "react";
import { Slot } from "@radix-ui/react-slot";
import { ChevronRight, MoreHorizontal } from "@/lib/icons";

import { cn } from "@/lib/utils";

const Breadcrumb = React.forwardRef<
  HTMLElement,
  React.ComponentPropsWithoutRef<"nav"> & {
    separator?: React.ReactNode;
  }
>(({ ...props }, ref) => <nav ref={ref} aria-label="breadcrumb" {...props} />);
Breadcrumb.displayName = "Breadcrumb";

const BreadcrumbList = React.forwardRef<HTMLOListElement, React.ComponentPropsWithoutRef<"ol">>(({ className, ...props }, ref) => (
  <ol
    ref={ref}
    className={cn("flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5", className)}
    {...props}
  />
));
BreadcrumbList.displayName = "BreadcrumbList";

const BreadcrumbItem = React.forwardRef<HTMLLIElement, React.ComponentPropsWithoutRef<"li">>(({ className, ...props }, ref) => (
  <li ref={ref} className={cn("inline-flex items-center gap-1.5", className)} {...props} />
));
BreadcrumbItem.displayName = "BreadcrumbItem";

const BreadcrumbLink = React.forwardRef<
  HTMLAnchorElement,
  React.ComponentPropsWithoutRef<"a"> & {
    asChild?: boolean;
  }
>(({ asChild, className, ...props }, ref) => {
  const Comp = asChild ? Slot : "a";

  return <Comp ref={ref} className={cn("transition-colors hover:text-foreground", className)} {...props} />;
});
BreadcrumbLink.displayName = "BreadcrumbLink";

const BreadcrumbPage = React.forwardRef<HTMLSpanElement, React.ComponentPropsWithoutRef<"span">>(({ className, ...props }, ref) => (
  <span
    ref={ref}
    role="link"
    aria-disabled="true"
    aria-current="page"
    className={cn("font-normal text-foreground", className)}
    {...props}
  />
));
BreadcrumbPage.displayName = "BreadcrumbPage";

const BreadcrumbSeparator = ({ children, className, ...props }: React.ComponentProps<"li">) => (
  <li role="presentation" aria-hidden="true" className={cn("[&>svg]:size-3.5", className)} {...props}>
    {children ?? <ChevronRight />}
  </li>
);
BreadcrumbSeparator.displayName = "BreadcrumbSeparator";

const BreadcrumbEllipsis = ({ className, ...props }: React.ComponentProps<"span">) => (
  <span role="presentation" aria-hidden="true" className={cn("flex h-9 w-9 items-center justify-center", className)} {...props}>
    <MoreHorizontal className="h-4 w-4" />
    <span className="sr-only">More</span>
  </span>
);
BreadcrumbEllipsis.displayName = "BreadcrumbElipssis";

export { Breadcrumb, BreadcrumbList, BreadcrumbItem, BreadcrumbLink, BreadcrumbPage, BreadcrumbSeparator, BreadcrumbEllipsis };
```
---

### src\components\ui\button.tsx

**Language:** typescript  
**Size:** 1.91 KB  
**Last Modified:** 2025-08-28T19:03:37.261Z

```typescript
import * as React from "react"
import { Slot } from "@radix-ui/react-slot"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const buttonVariants = cva(
  "inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",
  {
    variants: {
      variant: {
        default: "bg-primary text-primary-foreground hover:bg-primary/90",
        destructive:
          "bg-destructive text-destructive-foreground hover:bg-destructive/90",
        outline:
          "border border-input bg-background hover:bg-accent hover:text-accent-foreground",
        secondary:
          "bg-secondary text-secondary-foreground hover:bg-secondary/80",
        ghost: "hover:bg-accent hover:text-accent-foreground",
        link: "text-primary underline-offset-4 hover:underline",
      },
      size: {
        default: "h-10 px-4 py-2",
        sm: "h-9 rounded-md px-3",
        lg: "h-11 rounded-md px-8",
        icon: "h-10 w-10",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

export interface ButtonProps
  extends React.ButtonHTMLAttributes<HTMLButtonElement>,
    VariantProps<typeof buttonVariants> {
  asChild?: boolean
}

const Button = React.forwardRef<HTMLButtonElement, ButtonProps>(
  ({ className, variant, size, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : "button"
    return (
      <Comp
        className={cn(buttonVariants({ variant, size, className }))}
        ref={ref}
        {...props}
      />
    )
  }
)
Button.displayName = "Button"

export { Button, buttonVariants }
```
---

### src\components\ui\calendar.tsx

**Language:** typescript  
**Size:** 2.55 KB  
**Last Modified:** 2025-10-31T13:45:28.272Z

```typescript
import * as React from "react";
import { ChevronLeft, ChevronRight } from "@/lib/icons";
import { DayPicker } from "react-day-picker";

import { cn } from "@/lib/utils";
import { buttonVariants } from "@/components/ui/button";

export type CalendarProps = React.ComponentProps<typeof DayPicker>;

function Calendar({ className, classNames, showOutsideDays = true, ...props }: CalendarProps) {
  return (
    <DayPicker
      showOutsideDays={showOutsideDays}
      className={cn("p-3", className)}
      classNames={{
        months: "flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",
        month: "space-y-4",
        caption: "flex justify-center pt-1 relative items-center",
        caption_label: "text-sm font-medium",
        nav: "space-x-1 flex items-center",
        nav_button: cn(buttonVariants({ variant: "outline" }), "h-7 w-7 p-0 opacity-50 hover:opacity-100"),
        nav_button_previous: "absolute left-1",
        nav_button_next: "absolute right-1",
        table: "w-full border-collapse space-y-1",
        head_row: "flex",
        head_cell: "text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",
        row: "flex w-full mt-2",
        cell: "h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",
        day: cn(buttonVariants({ variant: "ghost" }), "h-9 w-9 p-0 font-normal aria-selected:opacity-100"),
        day_range_end: "day-range-end",
        day_selected:
          "bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",
        day_today: "bg-accent text-accent-foreground",
        day_outside:
          "day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",
        day_disabled: "text-muted-foreground opacity-50",
        day_range_middle: "aria-selected:bg-accent aria-selected:text-accent-foreground",
        day_hidden: "invisible",
        ...classNames,
      }}
      components={{
        Chevron: ({ orientation, ...props }) => {
          const Icon = orientation === "left" ? ChevronLeft : ChevronRight;
          return <Icon className="h-4 w-4" {...props} />;
        },
      }}
      {...props}
    />
  );
}
Calendar.displayName = "Calendar";

export { Calendar };
```
---

### src\components\ui\card.tsx

**Language:** typescript  
**Size:** 1.74 KB  
**Last Modified:** 2025-09-05T16:45:01.692Z

```typescript
import * as React from "react";

import { cn } from "@/lib/utils";

const Card = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn("rounded-lg border bg-card text-card-foreground shadow-sm", className)} {...props} />
));
Card.displayName = "Card";

const CardHeader = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn("flex flex-col space-y-1.5 p-6", className)} {...props} />
));
CardHeader.displayName = "CardHeader";

const CardTitle = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLHeadingElement>>(({ className, ...props }, ref) => (
  <h3 ref={ref} className={cn("text-2xl font-semibold leading-none tracking-tight", className)} {...props} />
));
CardTitle.displayName = "CardTitle";

const CardDescription = React.forwardRef<HTMLParagraphElement, React.HTMLAttributes<HTMLParagraphElement>>(
  ({ className, ...props }, ref) => <p ref={ref} className={cn("text-sm text-muted-foreground", className)} {...props} />
);
CardDescription.displayName = "CardDescription";

const CardContent = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn("p-6 pt-0", className)} {...props} />
));
CardContent.displayName = "CardContent";

const CardFooter = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn("flex items-center p-6 pt-0", className)} {...props} />
));
CardFooter.displayName = "CardFooter";

export { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent };
```
---

### src\components\ui\carousel.tsx

**Language:** typescript  
**Size:** 6.17 KB  
**Last Modified:** 2025-10-31T13:45:28.600Z

```typescript
import * as React from "react";
import useEmblaCarousel, { type UseEmblaCarouselType } from "embla-carousel-react";
import { ArrowLeft, ArrowRight } from "@/lib/icons";

import { cn } from "@/lib/utils";
import { Button } from "@/components/ui/button";

type CarouselApi = UseEmblaCarouselType[1];
type UseCarouselParameters = Parameters<typeof useEmblaCarousel>;
type CarouselOptions = UseCarouselParameters[0];
type CarouselPlugin = UseCarouselParameters[1];

type CarouselProps = {
  opts?: CarouselOptions;
  plugins?: CarouselPlugin;
  orientation?: "horizontal" | "vertical";
  setApi?: (api: CarouselApi) => void;
};

type CarouselContextProps = {
  carouselRef: ReturnType<typeof useEmblaCarousel>[0];
  api: ReturnType<typeof useEmblaCarousel>[1];
  scrollPrev: () => void;
  scrollNext: () => void;
  canScrollPrev: boolean;
  canScrollNext: boolean;
} & CarouselProps;

const CarouselContext = React.createContext<CarouselContextProps | null>(null);

function useCarousel() {
  const context = React.useContext(CarouselContext);

  if (!context) {
    throw new Error("useCarousel must be used within a <Carousel />");
  }

  return context;
}

const Carousel = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement> & CarouselProps>(
  ({ orientation = "horizontal", opts, setApi, plugins, className, children, ...props }, ref) => {
    const [carouselRef, api] = useEmblaCarousel(
      {
        ...opts,
        axis: orientation === "horizontal" ? "x" : "y",
      },
      plugins
    );
    const [canScrollPrev, setCanScrollPrev] = React.useState(false);
    const [canScrollNext, setCanScrollNext] = React.useState(false);

    const onSelect = React.useCallback((api: CarouselApi) => {
      if (!api) {
        return;
      }

      setCanScrollPrev(api.canScrollPrev());
      setCanScrollNext(api.canScrollNext());
    }, []);

    const scrollPrev = React.useCallback(() => {
      api?.scrollPrev();
    }, [api]);

    const scrollNext = React.useCallback(() => {
      api?.scrollNext();
    }, [api]);

    const handleKeyDown = React.useCallback(
      (event: React.KeyboardEvent<HTMLDivElement>) => {
        if (event.key === "ArrowLeft") {
          event.preventDefault();
          scrollPrev();
        } else if (event.key === "ArrowRight") {
          event.preventDefault();
          scrollNext();
        }
      },
      [scrollPrev, scrollNext]
    );

    React.useEffect(() => {
      if (!api || !setApi) {
        return;
      }

      setApi(api);
    }, [api, setApi]);

    React.useEffect(() => {
      if (!api) {
        return;
      }

      onSelect(api);
      api.on("reInit", onSelect);
      api.on("select", onSelect);

      return () => {
        api?.off("select", onSelect);
      };
    }, [api, onSelect]);

    return (
      <CarouselContext.Provider
        value={{
          carouselRef,
          api: api,
          opts,
          orientation: orientation || (opts?.axis === "y" ? "vertical" : "horizontal"),
          scrollPrev,
          scrollNext,
          canScrollPrev,
          canScrollNext,
        }}
      >
        <div
          ref={ref}
          onKeyDownCapture={handleKeyDown}
          className={cn("relative", className)}
          role="region"
          aria-roledescription="carousel"
          {...props}
        >
          {children}
        </div>
      </CarouselContext.Provider>
    );
  }
);
Carousel.displayName = "Carousel";

const CarouselContent = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(({ className, ...props }, ref) => {
  const { carouselRef, orientation } = useCarousel();

  return (
    <div ref={carouselRef} className="overflow-hidden">
      <div ref={ref} className={cn("flex", orientation === "horizontal" ? "-ml-4" : "-mt-4 flex-col", className)} {...props} />
    </div>
  );
});
CarouselContent.displayName = "CarouselContent";

const CarouselItem = React.forwardRef<HTMLDivElement, React.HTMLAttributes<HTMLDivElement>>(({ className, ...props }, ref) => {
  const { orientation } = useCarousel();

  return (
    <div
      ref={ref}
      role="group"
      aria-roledescription="slide"
      className={cn("min-w-0 shrink-0 grow-0 basis-full", orientation === "horizontal" ? "pl-4" : "pt-4", className)}
      {...props}
    />
  );
});
CarouselItem.displayName = "CarouselItem";

const CarouselPrevious = React.forwardRef<HTMLButtonElement, React.ComponentProps<typeof Button>>(
  ({ className, variant = "outline", size = "icon", ...props }, ref) => {
    const { orientation, scrollPrev, canScrollPrev } = useCarousel();

    return (
      <Button
        ref={ref}
        variant={variant}
        size={size}
        className={cn(
          "absolute  h-8 w-8 rounded-full",
          orientation === "horizontal" ? "-left-12 top-1/2 -translate-y-1/2" : "-top-12 left-1/2 -translate-x-1/2 rotate-90",
          className
        )}
        disabled={!canScrollPrev}
        onClick={scrollPrev}
        {...props}
      >
        <ArrowLeft className="h-4 w-4" />
        <span className="sr-only">Previous slide</span>
      </Button>
    );
  }
);
CarouselPrevious.displayName = "CarouselPrevious";

const CarouselNext = React.forwardRef<HTMLButtonElement, React.ComponentProps<typeof Button>>(
  ({ className, variant = "outline", size = "icon", ...props }, ref) => {
    const { orientation, scrollNext, canScrollNext } = useCarousel();

    return (
      <Button
        ref={ref}
        variant={variant}
        size={size}
        className={cn(
          "absolute h-8 w-8 rounded-full",
          orientation === "horizontal" ? "-right-12 top-1/2 -translate-y-1/2" : "-bottom-12 left-1/2 -translate-x-1/2 rotate-90",
          className
        )}
        disabled={!canScrollNext}
        onClick={scrollNext}
        {...props}
      >
        <ArrowRight className="h-4 w-4" />
        <span className="sr-only">Next slide</span>
      </Button>
    );
  }
);
CarouselNext.displayName = "CarouselNext";

export { type CarouselApi, Carousel, CarouselContent, CarouselItem, CarouselPrevious, CarouselNext };
```
---

### src\components\ui\chart.tsx

**Language:** typescript  
**Size:** 10.58 KB  
**Last Modified:** 2025-08-28T19:03:37.264Z

```typescript
import * as React from "react"
import * as RechartsPrimitive from "recharts"

import { cn } from "@/lib/utils"

// Format: { THEME_NAME: CSS_SELECTOR }
const THEMES = { light: "", dark: ".dark" } as const

export type ChartConfig = {
  [k in string]: {
    label?: React.ReactNode
    icon?: React.ComponentType
  } & (
    | { color?: string; theme?: never }
    | { color?: never; theme: Record<keyof typeof THEMES, string> }
  )
}

type ChartContextProps = {
  config: ChartConfig
}

const ChartContext = React.createContext<ChartContextProps | null>(null)

function useChart() {
  const context = React.useContext(ChartContext)

  if (!context) {
    throw new Error("useChart must be used within a <ChartContainer />")
  }

  return context
}

const ChartContainer = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & {
    config: ChartConfig
    children: React.ComponentProps<
      typeof RechartsPrimitive.ResponsiveContainer
    >["children"]
  }
>(({ id, className, children, config, ...props }, ref) => {
  const uniqueId = React.useId()
  const chartId = `chart-${id || uniqueId.replace(/:/g, "")}`

  return (
    <ChartContext.Provider value={{ config }}>
      <div
        data-chart={chartId}
        ref={ref}
        className={cn(
          "flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",
          className
        )}
        {...props}
      >
        <ChartStyle id={chartId} config={config} />
        <RechartsPrimitive.ResponsiveContainer>
          {children}
        </RechartsPrimitive.ResponsiveContainer>
      </div>
    </ChartContext.Provider>
  )
})
ChartContainer.displayName = "Chart"

const ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {
  const colorConfig = Object.entries(config).filter(
    ([_, config]) => config.theme || config.color
  )

  if (!colorConfig.length) {
    return null
  }

  return (
    <style
      dangerouslySetInnerHTML={{
        __html: Object.entries(THEMES)
          .map(
            ([theme, prefix]) => `
${prefix} [data-chart=${id}] {
${colorConfig
  .map(([key, itemConfig]) => {
    const color =
      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||
      itemConfig.color
    return color ? `  --color-${key}: ${color};` : null
  })
  .join("\n")}
}
`
          )
          .join("\n"),
      }}
    />
  )
}

const ChartTooltip = RechartsPrimitive.Tooltip

const ChartTooltipContent = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &
    React.ComponentProps<"div"> & {
      hideLabel?: boolean
      hideIndicator?: boolean
      indicator?: "line" | "dot" | "dashed"
      nameKey?: string
      labelKey?: string
    }
>(
  (
    {
      active,
      payload,
      className,
      indicator = "dot",
      hideLabel = false,
      hideIndicator = false,
      label,
      labelFormatter,
      labelClassName,
      formatter,
      color,
      nameKey,
      labelKey,
    },
    ref
  ) => {
    const { config } = useChart()

    const tooltipLabel = React.useMemo(() => {
      if (hideLabel || !payload?.length) {
        return null
      }

      const [item] = payload
      const key = `${labelKey || item.dataKey || item.name || "value"}`
      const itemConfig = getPayloadConfigFromPayload(config, item, key)
      const value =
        !labelKey && typeof label === "string"
          ? config[label as keyof typeof config]?.label || label
          : itemConfig?.label

      if (labelFormatter) {
        return (
          <div className={cn("font-medium", labelClassName)}>
            {labelFormatter(value, payload)}
          </div>
        )
      }

      if (!value) {
        return null
      }

      return <div className={cn("font-medium", labelClassName)}>{value}</div>
    }, [
      label,
      labelFormatter,
      payload,
      hideLabel,
      labelClassName,
      config,
      labelKey,
    ])

    if (!active || !payload?.length) {
      return null
    }

    const nestLabel = payload.length === 1 && indicator !== "dot"

    return (
      <div
        ref={ref}
        className={cn(
          "grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",
          className
        )}
      >
        {!nestLabel ? tooltipLabel : null}
        <div className="grid gap-1.5">
          {payload.map((item, index) => {
            const key = `${nameKey || item.name || item.dataKey || "value"}`
            const itemConfig = getPayloadConfigFromPayload(config, item, key)
            const indicatorColor = color || item.payload.fill || item.color

            return (
              <div
                key={item.dataKey}
                className={cn(
                  "flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground",
                  indicator === "dot" && "items-center"
                )}
              >
                {formatter && item?.value !== undefined && item.name ? (
                  formatter(item.value, item.name, item, index, item.payload)
                ) : (
                  <>
                    {itemConfig?.icon ? (
                      <itemConfig.icon />
                    ) : (
                      !hideIndicator && (
                        <div
                          className={cn(
                            "shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",
                            {
                              "h-2.5 w-2.5": indicator === "dot",
                              "w-1": indicator === "line",
                              "w-0 border-[1.5px] border-dashed bg-transparent":
                                indicator === "dashed",
                              "my-0.5": nestLabel && indicator === "dashed",
                            }
                          )}
                          style={
                            {
                              "--color-bg": indicatorColor,
                              "--color-border": indicatorColor,
                            } as React.CSSProperties
                          }
                        />
                      )
                    )}
                    <div
                      className={cn(
                        "flex flex-1 justify-between leading-none",
                        nestLabel ? "items-end" : "items-center"
                      )}
                    >
                      <div className="grid gap-1.5">
                        {nestLabel ? tooltipLabel : null}
                        <span className="text-muted-foreground">
                          {itemConfig?.label || item.name}
                        </span>
                      </div>
                      {item.value && (
                        <span className="font-mono font-medium tabular-nums text-foreground">
                          {item.value.toLocaleString()}
                        </span>
                      )}
                    </div>
                  </>
                )}
              </div>
            )
          })}
        </div>
      </div>
    )
  }
)
ChartTooltipContent.displayName = "ChartTooltip"

const ChartLegend = RechartsPrimitive.Legend

const ChartLegendContent = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> &
    Pick<RechartsPrimitive.LegendProps, "payload" | "verticalAlign"> & {
      hideIcon?: boolean
      nameKey?: string
    }
>(
  (
    { className, hideIcon = false, payload, verticalAlign = "bottom", nameKey },
    ref
  ) => {
    const { config } = useChart()

    if (!payload?.length) {
      return null
    }

    return (
      <div
        ref={ref}
        className={cn(
          "flex items-center justify-center gap-4",
          verticalAlign === "top" ? "pb-3" : "pt-3",
          className
        )}
      >
        {payload.map((item) => {
          const key = `${nameKey || item.dataKey || "value"}`
          const itemConfig = getPayloadConfigFromPayload(config, item, key)

          return (
            <div
              key={item.value}
              className={cn(
                "flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"
              )}
            >
              {itemConfig?.icon && !hideIcon ? (
                <itemConfig.icon />
              ) : (
                <div
                  className="h-2 w-2 shrink-0 rounded-[2px]"
                  style={{
                    backgroundColor: item.color,
                  }}
                />
              )}
              {itemConfig?.label}
            </div>
          )
        })}
      </div>
    )
  }
)
ChartLegendContent.displayName = "ChartLegend"

// Helper to extract item config from a payload.
function getPayloadConfigFromPayload(
  config: ChartConfig,
  payload: unknown,
  key: string
) {
  if (typeof payload !== "object" || payload === null) {
    return undefined
  }

  const payloadPayload =
    "payload" in payload &&
    typeof payload.payload === "object" &&
    payload.payload !== null
      ? payload.payload
      : undefined

  let configLabelKey: string = key

  if (
    key in payload &&
    typeof payload[key as keyof typeof payload] === "string"
  ) {
    configLabelKey = payload[key as keyof typeof payload] as string
  } else if (
    payloadPayload &&
    key in payloadPayload &&
    typeof payloadPayload[key as keyof typeof payloadPayload] === "string"
  ) {
    configLabelKey = payloadPayload[
      key as keyof typeof payloadPayload
    ] as string
  }

  return configLabelKey in config
    ? config[configLabelKey]
    : config[key as keyof typeof config]
}

export {
  ChartContainer,
  ChartTooltip,
  ChartTooltipContent,
  ChartLegend,
  ChartLegendContent,
  ChartStyle,
}
```
---

### src\components\ui\checkbox.tsx

**Language:** typescript  
**Size:** 1.05 KB  
**Last Modified:** 2025-10-31T13:45:28.307Z

```typescript
import * as React from "react";
import * as CheckboxPrimitive from "@radix-ui/react-checkbox";
import { Check } from "@/lib/icons";

import { cn } from "@/lib/utils";

const Checkbox = React.forwardRef<
  React.ElementRef<typeof CheckboxPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>
>(({ className, ...props }, ref) => (
  <CheckboxPrimitive.Root
    ref={ref}
    className={cn(
      "peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",
      className
    )}
    {...props}
  >
    <CheckboxPrimitive.Indicator className={cn("flex items-center justify-center text-current")}>
      <Check className="h-4 w-4" />
    </CheckboxPrimitive.Indicator>
  </CheckboxPrimitive.Root>
));
Checkbox.displayName = CheckboxPrimitive.Root.displayName;

export { Checkbox };
```
---

### src\components\ui\collapsible.tsx

**Language:** typescript  
**Size:** 324 Bytes  
**Last Modified:** 2025-08-28T19:03:37.265Z

```typescript
import * as CollapsiblePrimitive from "@radix-ui/react-collapsible"

const Collapsible = CollapsiblePrimitive.Root

const CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger

const CollapsibleContent = CollapsiblePrimitive.CollapsibleContent

export { Collapsible, CollapsibleTrigger, CollapsibleContent }
```
---

### src\components\ui\command.tsx

**Language:** typescript  
**Size:** 4.77 KB  
**Last Modified:** 2025-10-31T13:45:28.341Z

```typescript
import * as React from "react";
import { type DialogProps } from "@radix-ui/react-dialog";
import { Command as CommandPrimitive } from "cmdk";
import { Search } from "@/lib/icons";

import { cn } from "@/lib/utils";
import { Dialog, DialogContent } from "@/components/ui/dialog";

const Command = React.forwardRef<React.ElementRef<typeof CommandPrimitive>, React.ComponentPropsWithoutRef<typeof CommandPrimitive>>(
  ({ className, ...props }, ref) => (
    <CommandPrimitive
      ref={ref}
      className={cn("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground", className)}
      {...props}
    />
  )
);
Command.displayName = CommandPrimitive.displayName;

interface CommandDialogProps extends DialogProps {}

const CommandDialog = ({ children, ...props }: CommandDialogProps) => {
  return (
    <Dialog {...props}>
      <DialogContent className="overflow-hidden p-0 shadow-lg">
        <Command className="[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5">
          {children}
        </Command>
      </DialogContent>
    </Dialog>
  );
};

const CommandInput = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Input>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>
>(({ className, ...props }, ref) => (
  <div className="flex items-center border-b px-3" cmdk-input-wrapper="">
    <Search className="mr-2 h-4 w-4 shrink-0 opacity-50" />
    <CommandPrimitive.Input
      ref={ref}
      className={cn(
        "flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",
        className
      )}
      {...props}
    />
  </div>
));

CommandInput.displayName = CommandPrimitive.Input.displayName;

const CommandList = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.List ref={ref} className={cn("max-h-[300px] overflow-y-auto overflow-x-hidden", className)} {...props} />
));

CommandList.displayName = CommandPrimitive.List.displayName;

const CommandEmpty = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Empty>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>
>((props, ref) => <CommandPrimitive.Empty ref={ref} className="py-6 text-center text-sm" {...props} />);

CommandEmpty.displayName = CommandPrimitive.Empty.displayName;

const CommandGroup = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Group>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.Group
    ref={ref}
    className={cn(
      "overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",
      className
    )}
    {...props}
  />
));

CommandGroup.displayName = CommandPrimitive.Group.displayName;

const CommandSeparator = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>
>(({ className, ...props }, ref) => <CommandPrimitive.Separator ref={ref} className={cn("-mx-1 h-px bg-border", className)} {...props} />);
CommandSeparator.displayName = CommandPrimitive.Separator.displayName;

const CommandItem = React.forwardRef<
  React.ElementRef<typeof CommandPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>
>(({ className, ...props }, ref) => (
  <CommandPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",
      className
    )}
    {...props}
  />
));

CommandItem.displayName = CommandPrimitive.Item.displayName;

const CommandShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => {
  return <span className={cn("ml-auto text-xs tracking-widest text-muted-foreground", className)} {...props} />;
};
CommandShortcut.displayName = "CommandShortcut";

export { Command, CommandDialog, CommandInput, CommandList, CommandEmpty, CommandGroup, CommandItem, CommandShortcut, CommandSeparator };
```
---

### src\components\ui\context-menu.tsx

**Language:** typescript  
**Size:** 7.19 KB  
**Last Modified:** 2025-10-31T13:45:27.995Z

```typescript
import * as React from "react";
import * as ContextMenuPrimitive from "@radix-ui/react-context-menu";
import { Check, ChevronRight, Circle } from "@/lib/icons";

import { cn } from "@/lib/utils";

const ContextMenu = ContextMenuPrimitive.Root;

const ContextMenuTrigger = ContextMenuPrimitive.Trigger;

const ContextMenuGroup = ContextMenuPrimitive.Group;

const ContextMenuPortal = ContextMenuPrimitive.Portal;

const ContextMenuSub = ContextMenuPrimitive.Sub;

const ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup;

const ContextMenuSubTrigger = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {
    inset?: boolean;
  }
>(({ className, inset, children, ...props }, ref) => (
  <ContextMenuPrimitive.SubTrigger
    ref={ref}
    className={cn(
      "flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",
      inset && "pl-8",
      className
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto h-4 w-4" />
  </ContextMenuPrimitive.SubTrigger>
));
ContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName;

const ContextMenuSubContent = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <ContextMenuPrimitive.SubContent
    ref={ref}
    className={cn(
      "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className
    )}
    {...props}
  />
));
ContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName;

const ContextMenuContent = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>
>(({ className, ...props }, ref) => (
  <ContextMenuPrimitive.Portal>
    <ContextMenuPrimitive.Content
      ref={ref}
      className={cn(
        "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className
      )}
      {...props}
    />
  </ContextMenuPrimitive.Portal>
));
ContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName;

const ContextMenuItem = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <ContextMenuPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      inset && "pl-8",
      className
    )}
    {...props}
  />
));
ContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName;

const ContextMenuCheckboxItem = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <ContextMenuPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <ContextMenuPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </ContextMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </ContextMenuPrimitive.CheckboxItem>
));
ContextMenuCheckboxItem.displayName = ContextMenuPrimitive.CheckboxItem.displayName;

const ContextMenuRadioItem = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <ContextMenuPrimitive.RadioItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <ContextMenuPrimitive.ItemIndicator>
        <Circle className="h-2 w-2 fill-current" />
      </ContextMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </ContextMenuPrimitive.RadioItem>
));
ContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName;

const ContextMenuLabel = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <ContextMenuPrimitive.Label
    ref={ref}
    className={cn("px-2 py-1.5 text-sm font-semibold text-foreground", inset && "pl-8", className)}
    {...props}
  />
));
ContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName;

const ContextMenuSeparator = React.forwardRef<
  React.ElementRef<typeof ContextMenuPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <ContextMenuPrimitive.Separator ref={ref} className={cn("-mx-1 my-1 h-px bg-border", className)} {...props} />
));
ContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName;

const ContextMenuShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => {
  return <span className={cn("ml-auto text-xs tracking-widest text-muted-foreground", className)} {...props} />;
};
ContextMenuShortcut.displayName = "ContextMenuShortcut";

export {
  ContextMenu,
  ContextMenuTrigger,
  ContextMenuContent,
  ContextMenuItem,
  ContextMenuCheckboxItem,
  ContextMenuRadioItem,
  ContextMenuLabel,
  ContextMenuSeparator,
  ContextMenuShortcut,
  ContextMenuGroup,
  ContextMenuPortal,
  ContextMenuSub,
  ContextMenuSubContent,
  ContextMenuSubTrigger,
  ContextMenuRadioGroup,
};
```
---

### src\components\ui\dialog.tsx

**Language:** typescript  
**Size:** 3.78 KB  
**Last Modified:** 2025-11-25T20:32:26.151Z

```typescript
import * as React from "react";
import * as DialogPrimitive from "@radix-ui/react-dialog";
import { X } from "@/lib/icons";

import { cn } from "@/lib/utils";

const Dialog = DialogPrimitive.Root;

const DialogTrigger = DialogPrimitive.Trigger;

const DialogPortal = DialogPrimitive.Portal;

const DialogClose = DialogPrimitive.Close;

const DialogOverlay = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Overlay
    ref={ref}
    className={cn(
      "fixed inset-0 z-50 bg-black/35 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
      className
    )}
    {...props}
  />
));
DialogOverlay.displayName = DialogPrimitive.Overlay.displayName;

const DialogContent = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <DialogPortal>
    <DialogOverlay />
    <DialogPrimitive.Content
      ref={ref}
      className={cn(
        "fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",
        className
      )}
      {...props}
    >
      {children}
      <DialogPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground">
        <X className="h-4 w-4" />
        <span className="sr-only">Close</span>
      </DialogPrimitive.Close>
    </DialogPrimitive.Content>
  </DialogPortal>
));
DialogContent.displayName = DialogPrimitive.Content.displayName;

const DialogHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col space-y-1.5 text-center sm:text-left", className)} {...props} />
);
DialogHeader.displayName = "DialogHeader";

const DialogFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2", className)} {...props} />
);
DialogFooter.displayName = "DialogFooter";

const DialogTitle = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Title ref={ref} className={cn("text-lg font-semibold leading-none tracking-tight", className)} {...props} />
));
DialogTitle.displayName = DialogPrimitive.Title.displayName;

const DialogDescription = React.forwardRef<
  React.ElementRef<typeof DialogPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>
>(({ className, ...props }, ref) => (
  <DialogPrimitive.Description ref={ref} className={cn("text-sm text-muted-foreground", className)} {...props} />
));
DialogDescription.displayName = DialogPrimitive.Description.displayName;

export {
  Dialog,
  DialogPortal,
  DialogOverlay,
  DialogClose,
  DialogTrigger,
  DialogContent,
  DialogHeader,
  DialogFooter,
  DialogTitle,
  DialogDescription,
};
```
---

### src\components\ui\drawer.tsx

**Language:** typescript  
**Size:** 3.05 KB  
**Last Modified:** 2025-08-28T19:03:37.267Z

```typescript
import * as React from "react"
import { Drawer as DrawerPrimitive } from "vaul"

import { cn } from "@/lib/utils"

const Drawer = ({
  shouldScaleBackground = true,
  ...props
}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (
  <DrawerPrimitive.Root
    shouldScaleBackground={shouldScaleBackground}
    {...props}
  />
)
Drawer.displayName = "Drawer"

const DrawerTrigger = DrawerPrimitive.Trigger

const DrawerPortal = DrawerPrimitive.Portal

const DrawerClose = DrawerPrimitive.Close

const DrawerOverlay = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <DrawerPrimitive.Overlay
    ref={ref}
    className={cn("fixed inset-0 z-50 bg-black/80", className)}
    {...props}
  />
))
DrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName

const DrawerContent = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>
>(({ className, children, ...props }, ref) => (
  <DrawerPortal>
    <DrawerOverlay />
    <DrawerPrimitive.Content
      ref={ref}
      className={cn(
        "fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",
        className
      )}
      {...props}
    >
      <div className="mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted" />
      {children}
    </DrawerPrimitive.Content>
  </DrawerPortal>
))
DrawerContent.displayName = "DrawerContent"

const DrawerHeader = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn("grid gap-1.5 p-4 text-center sm:text-left", className)}
    {...props}
  />
)
DrawerHeader.displayName = "DrawerHeader"

const DrawerFooter = ({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) => (
  <div
    className={cn("mt-auto flex flex-col gap-2 p-4", className)}
    {...props}
  />
)
DrawerFooter.displayName = "DrawerFooter"

const DrawerTitle = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>
>(({ className, ...props }, ref) => (
  <DrawerPrimitive.Title
    ref={ref}
    className={cn(
      "text-lg font-semibold leading-none tracking-tight",
      className
    )}
    {...props}
  />
))
DrawerTitle.displayName = DrawerPrimitive.Title.displayName

const DrawerDescription = React.forwardRef<
  React.ElementRef<typeof DrawerPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>
>(({ className, ...props }, ref) => (
  <DrawerPrimitive.Description
    ref={ref}
    className={cn("text-sm text-muted-foreground", className)}
    {...props}
  />
))
DrawerDescription.displayName = DrawerPrimitive.Description.displayName

export {
  Drawer,
  DrawerPortal,
  DrawerOverlay,
  DrawerTrigger,
  DrawerClose,
  DrawerContent,
  DrawerHeader,
  DrawerFooter,
  DrawerTitle,
  DrawerDescription,
}
```
---

### src\components\ui\dropdown-menu.tsx

**Language:** typescript  
**Size:** 7.24 KB  
**Last Modified:** 2025-10-31T13:45:28.064Z

```typescript
import * as React from "react";
import * as DropdownMenuPrimitive from "@radix-ui/react-dropdown-menu";
import { Check, ChevronRight, Circle } from "@/lib/icons";

import { cn } from "@/lib/utils";

const DropdownMenu = DropdownMenuPrimitive.Root;

const DropdownMenuTrigger = DropdownMenuPrimitive.Trigger;

const DropdownMenuGroup = DropdownMenuPrimitive.Group;

const DropdownMenuPortal = DropdownMenuPrimitive.Portal;

const DropdownMenuSub = DropdownMenuPrimitive.Sub;

const DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup;

const DropdownMenuSubTrigger = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {
    inset?: boolean;
  }
>(({ className, inset, children, ...props }, ref) => (
  <DropdownMenuPrimitive.SubTrigger
    ref={ref}
    className={cn(
      "flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",
      inset && "pl-8",
      className
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto h-4 w-4" />
  </DropdownMenuPrimitive.SubTrigger>
));
DropdownMenuSubTrigger.displayName = DropdownMenuPrimitive.SubTrigger.displayName;

const DropdownMenuSubContent = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <DropdownMenuPrimitive.SubContent
    ref={ref}
    className={cn(
      "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className
    )}
    {...props}
  />
));
DropdownMenuSubContent.displayName = DropdownMenuPrimitive.SubContent.displayName;

const DropdownMenuContent = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>
>(({ className, sideOffset = 4, ...props }, ref) => (
  <DropdownMenuPrimitive.Portal>
    <DropdownMenuPrimitive.Content
      ref={ref}
      sideOffset={sideOffset}
      className={cn(
        "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className
      )}
      {...props}
    />
  </DropdownMenuPrimitive.Portal>
));
DropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName;

const DropdownMenuItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <DropdownMenuPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      inset && "pl-8",
      className
    )}
    {...props}
  />
));
DropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName;

const DropdownMenuCheckboxItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <DropdownMenuPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <DropdownMenuPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </DropdownMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </DropdownMenuPrimitive.CheckboxItem>
));
DropdownMenuCheckboxItem.displayName = DropdownMenuPrimitive.CheckboxItem.displayName;

const DropdownMenuRadioItem = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <DropdownMenuPrimitive.RadioItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <DropdownMenuPrimitive.ItemIndicator>
        <Circle className="h-2 w-2 fill-current" />
      </DropdownMenuPrimitive.ItemIndicator>
    </span>
    {children}
  </DropdownMenuPrimitive.RadioItem>
));
DropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName;

const DropdownMenuLabel = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <DropdownMenuPrimitive.Label ref={ref} className={cn("px-2 py-1.5 text-sm font-semibold", inset && "pl-8", className)} {...props} />
));
DropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName;

const DropdownMenuSeparator = React.forwardRef<
  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <DropdownMenuPrimitive.Separator ref={ref} className={cn("-mx-1 my-1 h-px bg-muted", className)} {...props} />
));
DropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName;

const DropdownMenuShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => {
  return <span className={cn("ml-auto text-xs tracking-widest opacity-60", className)} {...props} />;
};
DropdownMenuShortcut.displayName = "DropdownMenuShortcut";

export {
  DropdownMenu,
  DropdownMenuTrigger,
  DropdownMenuContent,
  DropdownMenuItem,
  DropdownMenuCheckboxItem,
  DropdownMenuRadioItem,
  DropdownMenuLabel,
  DropdownMenuSeparator,
  DropdownMenuShortcut,
  DropdownMenuGroup,
  DropdownMenuPortal,
  DropdownMenuSub,
  DropdownMenuSubContent,
  DropdownMenuSubTrigger,
  DropdownMenuRadioGroup,
};
```
---

### src\components\ui\form.tsx

**Language:** typescript  
**Size:** 4.16 KB  
**Last Modified:** 2025-08-28T19:03:37.269Z

```typescript
import * as React from "react"
import * as LabelPrimitive from "@radix-ui/react-label"
import { Slot } from "@radix-ui/react-slot"
import {
  Controller,
  ControllerProps,
  FieldPath,
  FieldValues,
  FormProvider,
  useFormContext,
} from "react-hook-form"

import { cn } from "@/lib/utils"
import { Label } from "@/components/ui/label"

const Form = FormProvider

type FormFieldContextValue<
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>
> = {
  name: TName
}

const FormFieldContext = React.createContext<FormFieldContextValue>(
  {} as FormFieldContextValue
)

const FormField = <
  TFieldValues extends FieldValues = FieldValues,
  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>
>({
  ...props
}: ControllerProps<TFieldValues, TName>) => {
  return (
    <FormFieldContext.Provider value={{ name: props.name }}>
      <Controller {...props} />
    </FormFieldContext.Provider>
  )
}

const useFormField = () => {
  const fieldContext = React.useContext(FormFieldContext)
  const itemContext = React.useContext(FormItemContext)
  const { getFieldState, formState } = useFormContext()

  const fieldState = getFieldState(fieldContext.name, formState)

  if (!fieldContext) {
    throw new Error("useFormField should be used within <FormField>")
  }

  const { id } = itemContext

  return {
    id,
    name: fieldContext.name,
    formItemId: `${id}-form-item`,
    formDescriptionId: `${id}-form-item-description`,
    formMessageId: `${id}-form-item-message`,
    ...fieldState,
  }
}

type FormItemContextValue = {
  id: string
}

const FormItemContext = React.createContext<FormItemContextValue>(
  {} as FormItemContextValue
)

const FormItem = React.forwardRef<
  HTMLDivElement,
  React.HTMLAttributes<HTMLDivElement>
>(({ className, ...props }, ref) => {
  const id = React.useId()

  return (
    <FormItemContext.Provider value={{ id }}>
      <div ref={ref} className={cn("space-y-2", className)} {...props} />
    </FormItemContext.Provider>
  )
})
FormItem.displayName = "FormItem"

const FormLabel = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>
>(({ className, ...props }, ref) => {
  const { error, formItemId } = useFormField()

  return (
    <Label
      ref={ref}
      className={cn(error && "text-destructive", className)}
      htmlFor={formItemId}
      {...props}
    />
  )
})
FormLabel.displayName = "FormLabel"

const FormControl = React.forwardRef<
  React.ElementRef<typeof Slot>,
  React.ComponentPropsWithoutRef<typeof Slot>
>(({ ...props }, ref) => {
  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()

  return (
    <Slot
      ref={ref}
      id={formItemId}
      aria-describedby={
        !error
          ? `${formDescriptionId}`
          : `${formDescriptionId} ${formMessageId}`
      }
      aria-invalid={!!error}
      {...props}
    />
  )
})
FormControl.displayName = "FormControl"

const FormDescription = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, ...props }, ref) => {
  const { formDescriptionId } = useFormField()

  return (
    <p
      ref={ref}
      id={formDescriptionId}
      className={cn("text-sm text-muted-foreground", className)}
      {...props}
    />
  )
})
FormDescription.displayName = "FormDescription"

const FormMessage = React.forwardRef<
  HTMLParagraphElement,
  React.HTMLAttributes<HTMLParagraphElement>
>(({ className, children, ...props }, ref) => {
  const { error, formMessageId } = useFormField()
  const body = error ? String(error?.message) : children

  if (!body) {
    return null
  }

  return (
    <p
      ref={ref}
      id={formMessageId}
      className={cn("text-sm font-medium text-destructive", className)}
      {...props}
    >
      {body}
    </p>
  )
})
FormMessage.displayName = "FormMessage"

export {
  useFormField,
  Form,
  FormItem,
  FormLabel,
  FormControl,
  FormDescription,
  FormMessage,
  FormField,
}
```
---

### src\components\ui\hover-card.tsx

**Language:** typescript  
**Size:** 1.18 KB  
**Last Modified:** 2025-08-28T19:03:37.270Z

```typescript
import * as React from "react"
import * as HoverCardPrimitive from "@radix-ui/react-hover-card"

import { cn } from "@/lib/utils"

const HoverCard = HoverCardPrimitive.Root

const HoverCardTrigger = HoverCardPrimitive.Trigger

const HoverCardContent = React.forwardRef<
  React.ElementRef<typeof HoverCardPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>
>(({ className, align = "center", sideOffset = 4, ...props }, ref) => (
  <HoverCardPrimitive.Content
    ref={ref}
    align={align}
    sideOffset={sideOffset}
    className={cn(
      "z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className
    )}
    {...props}
  />
))
HoverCardContent.displayName = HoverCardPrimitive.Content.displayName

export { HoverCard, HoverCardTrigger, HoverCardContent }
```
---

### src\components\ui\input-otp.tsx

**Language:** typescript  
**Size:** 2.2 KB  
**Last Modified:** 2025-10-31T13:45:28.272Z

```typescript
import * as React from "react";
import { OTPInput, OTPInputContext } from "input-otp";
import { Dot } from "@/lib/icons";

import { cn } from "@/lib/utils";

const InputOTP = React.forwardRef<React.ElementRef<typeof OTPInput>, React.ComponentPropsWithoutRef<typeof OTPInput>>(
  ({ className, containerClassName, ...props }, ref) => (
    <OTPInput
      ref={ref}
      containerClassName={cn("flex items-center gap-2 has-[:disabled]:opacity-50", containerClassName)}
      className={cn("disabled:cursor-not-allowed", className)}
      {...props}
    />
  )
);
InputOTP.displayName = "InputOTP";

const InputOTPGroup = React.forwardRef<React.ElementRef<"div">, React.ComponentPropsWithoutRef<"div">>(({ className, ...props }, ref) => (
  <div ref={ref} className={cn("flex items-center", className)} {...props} />
));
InputOTPGroup.displayName = "InputOTPGroup";

const InputOTPSlot = React.forwardRef<React.ElementRef<"div">, React.ComponentPropsWithoutRef<"div"> & { index: number }>(
  ({ index, className, ...props }, ref) => {
    const inputOTPContext = React.useContext(OTPInputContext);
    const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index];

    return (
      <div
        ref={ref}
        className={cn(
          "relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",
          isActive && "z-10 ring-2 ring-ring ring-offset-background",
          className
        )}
        {...props}
      >
        {char}
        {hasFakeCaret && (
          <div className="pointer-events-none absolute inset-0 flex items-center justify-center">
            <div className="h-4 w-px animate-caret-blink bg-foreground duration-1000" />
          </div>
        )}
      </div>
    );
  }
);
InputOTPSlot.displayName = "InputOTPSlot";

const InputOTPSeparator = React.forwardRef<React.ElementRef<"div">, React.ComponentPropsWithoutRef<"div">>(({ ...props }, ref) => (
  <div ref={ref} role="separator" {...props}>
    <Dot />
  </div>
));
InputOTPSeparator.displayName = "InputOTPSeparator";

export { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator };
```
---

### src\components\ui\input.tsx

**Language:** typescript  
**Size:** 813 Bytes  
**Last Modified:** 2025-08-28T19:03:37.271Z

```typescript
import * as React from "react"

import { cn } from "@/lib/utils"

const Input = React.forwardRef<HTMLInputElement, React.ComponentProps<"input">>(
  ({ className, type, ...props }, ref) => {
    return (
      <input
        type={type}
        className={cn(
          "flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",
          className
        )}
        ref={ref}
        {...props}
      />
    )
  }
)
Input.displayName = "Input"

export { Input }
```
---

### src\components\ui\label.tsx

**Language:** typescript  
**Size:** 734 Bytes  
**Last Modified:** 2025-08-28T19:03:37.272Z

```typescript
import * as React from "react"
import * as LabelPrimitive from "@radix-ui/react-label"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const labelVariants = cva(
  "text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"
)

const Label = React.forwardRef<
  React.ElementRef<typeof LabelPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &
    VariantProps<typeof labelVariants>
>(({ className, ...props }, ref) => (
  <LabelPrimitive.Root
    ref={ref}
    className={cn(labelVariants(), className)}
    {...props}
  />
))
Label.displayName = LabelPrimitive.Root.displayName

export { Label }
```
---

### src\components\ui\menubar.tsx

**Language:** typescript  
**Size:** 7.86 KB  
**Last Modified:** 2025-10-31T13:45:28.039Z

```typescript
import * as React from "react";
import * as MenubarPrimitive from "@radix-ui/react-menubar";
import { Check, ChevronRight, Circle } from "@/lib/icons";

import { cn } from "@/lib/utils";

const MenubarMenu = MenubarPrimitive.Menu;

const MenubarGroup = MenubarPrimitive.Group;

const MenubarPortal = MenubarPrimitive.Portal;

const MenubarSub = MenubarPrimitive.Sub;

const MenubarRadioGroup = MenubarPrimitive.RadioGroup;

const Menubar = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Root
    ref={ref}
    className={cn("flex h-10 items-center space-x-1 rounded-md border bg-background p-1", className)}
    {...props}
  />
));
Menubar.displayName = MenubarPrimitive.Root.displayName;

const MenubarTrigger = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Trigger
    ref={ref}
    className={cn(
      "flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",
      className
    )}
    {...props}
  />
));
MenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName;

const MenubarSubTrigger = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {
    inset?: boolean;
  }
>(({ className, inset, children, ...props }, ref) => (
  <MenubarPrimitive.SubTrigger
    ref={ref}
    className={cn(
      "flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",
      inset && "pl-8",
      className
    )}
    {...props}
  >
    {children}
    <ChevronRight className="ml-auto h-4 w-4" />
  </MenubarPrimitive.SubTrigger>
));
MenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName;

const MenubarSubContent = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.SubContent>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.SubContent
    ref={ref}
    className={cn(
      "z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className
    )}
    {...props}
  />
));
MenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName;

const MenubarContent = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>
>(({ className, align = "start", alignOffset = -4, sideOffset = 8, ...props }, ref) => (
  <MenubarPrimitive.Portal>
    <MenubarPrimitive.Content
      ref={ref}
      align={align}
      alignOffset={alignOffset}
      sideOffset={sideOffset}
      className={cn(
        "z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className
      )}
      {...props}
    />
  </MenubarPrimitive.Portal>
));
MenubarContent.displayName = MenubarPrimitive.Content.displayName;

const MenubarItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <MenubarPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      inset && "pl-8",
      className
    )}
    {...props}
  />
));
MenubarItem.displayName = MenubarPrimitive.Item.displayName;

const MenubarCheckboxItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>
>(({ className, children, checked, ...props }, ref) => (
  <MenubarPrimitive.CheckboxItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    checked={checked}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <MenubarPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </MenubarPrimitive.ItemIndicator>
    </span>
    {children}
  </MenubarPrimitive.CheckboxItem>
));
MenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName;

const MenubarRadioItem = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.RadioItem>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>
>(({ className, children, ...props }, ref) => (
  <MenubarPrimitive.RadioItem
    ref={ref}
    className={cn(
      "relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",
      className
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <MenubarPrimitive.ItemIndicator>
        <Circle className="h-2 w-2 fill-current" />
      </MenubarPrimitive.ItemIndicator>
    </span>
    {children}
  </MenubarPrimitive.RadioItem>
));
MenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName;

const MenubarLabel = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {
    inset?: boolean;
  }
>(({ className, inset, ...props }, ref) => (
  <MenubarPrimitive.Label ref={ref} className={cn("px-2 py-1.5 text-sm font-semibold", inset && "pl-8", className)} {...props} />
));
MenubarLabel.displayName = MenubarPrimitive.Label.displayName;

const MenubarSeparator = React.forwardRef<
  React.ElementRef<typeof MenubarPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <MenubarPrimitive.Separator ref={ref} className={cn("-mx-1 my-1 h-px bg-muted", className)} {...props} />
));
MenubarSeparator.displayName = MenubarPrimitive.Separator.displayName;

const MenubarShortcut = ({ className, ...props }: React.HTMLAttributes<HTMLSpanElement>) => {
  return <span className={cn("ml-auto text-xs tracking-widest text-muted-foreground", className)} {...props} />;
};
MenubarShortcut.displayname = "MenubarShortcut";

export {
  Menubar,
  MenubarMenu,
  MenubarTrigger,
  MenubarContent,
  MenubarItem,
  MenubarSeparator,
  MenubarLabel,
  MenubarCheckboxItem,
  MenubarRadioGroup,
  MenubarRadioItem,
  MenubarPortal,
  MenubarSubContent,
  MenubarSubTrigger,
  MenubarGroup,
  MenubarSub,
  MenubarShortcut,
};
```
---

### src\components\ui\navigation-menu.tsx

**Language:** typescript  
**Size:** 5.01 KB  
**Last Modified:** 2025-10-31T13:45:28.126Z

```typescript
import * as React from "react";
import * as NavigationMenuPrimitive from "@radix-ui/react-navigation-menu";
import { cva } from "class-variance-authority";
import { ChevronDown } from "@/lib/icons";

import { cn } from "@/lib/utils";

const NavigationMenu = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>
>(({ className, children, ...props }, ref) => (
  <NavigationMenuPrimitive.Root
    ref={ref}
    className={cn("relative z-10 flex max-w-max flex-1 items-center justify-center", className)}
    {...props}
  >
    {children}
    <NavigationMenuViewport />
  </NavigationMenuPrimitive.Root>
));
NavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName;

const NavigationMenuList = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>
>(({ className, ...props }, ref) => (
  <NavigationMenuPrimitive.List
    ref={ref}
    className={cn("group flex flex-1 list-none items-center justify-center space-x-1", className)}
    {...props}
  />
));
NavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName;

const NavigationMenuItem = NavigationMenuPrimitive.Item;

const navigationMenuTriggerStyle = cva(
  "group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50"
);

const NavigationMenuTrigger = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <NavigationMenuPrimitive.Trigger ref={ref} className={cn(navigationMenuTriggerStyle(), "group", className)} {...props}>
    {children}{" "}
    <ChevronDown
      className="relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180"
      aria-hidden="true"
    />
  </NavigationMenuPrimitive.Trigger>
));
NavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName;

const NavigationMenuContent = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>
>(({ className, ...props }, ref) => (
  <NavigationMenuPrimitive.Content
    ref={ref}
    className={cn(
      "left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto ",
      className
    )}
    {...props}
  />
));
NavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName;

const NavigationMenuLink = NavigationMenuPrimitive.Link;

const NavigationMenuViewport = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>
>(({ className, ...props }, ref) => (
  <div className={cn("absolute left-0 top-full flex justify-center")}>
    <NavigationMenuPrimitive.Viewport
      className={cn(
        "origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]",
        className
      )}
      ref={ref}
      {...props}
    />
  </div>
));
NavigationMenuViewport.displayName = NavigationMenuPrimitive.Viewport.displayName;

const NavigationMenuIndicator = React.forwardRef<
  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,
  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>
>(({ className, ...props }, ref) => (
  <NavigationMenuPrimitive.Indicator
    ref={ref}
    className={cn(
      "top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in",
      className
    )}
    {...props}
  >
    <div className="relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md" />
  </NavigationMenuPrimitive.Indicator>
));
NavigationMenuIndicator.displayName = NavigationMenuPrimitive.Indicator.displayName;

export {
  navigationMenuTriggerStyle,
  NavigationMenu,
  NavigationMenuList,
  NavigationMenuItem,
  NavigationMenuContent,
  NavigationMenuTrigger,
  NavigationMenuLink,
  NavigationMenuIndicator,
  NavigationMenuViewport,
};
```
---

### src\components\ui\pagination.tsx

**Language:** typescript  
**Size:** 2.64 KB  
**Last Modified:** 2025-10-31T13:45:28.383Z

```typescript
import * as React from "react";
import { ChevronLeft, ChevronRight, MoreHorizontal } from "@/lib/icons";

import { cn } from "@/lib/utils";
import { ButtonProps, buttonVariants } from "@/components/ui/button";

const Pagination = ({ className, ...props }: React.ComponentProps<"nav">) => (
  <nav role="navigation" aria-label="pagination" className={cn("mx-auto flex w-full justify-center", className)} {...props} />
);
Pagination.displayName = "Pagination";

const PaginationContent = React.forwardRef<HTMLUListElement, React.ComponentProps<"ul">>(({ className, ...props }, ref) => (
  <ul ref={ref} className={cn("flex flex-row items-center gap-1", className)} {...props} />
));
PaginationContent.displayName = "PaginationContent";

const PaginationItem = React.forwardRef<HTMLLIElement, React.ComponentProps<"li">>(({ className, ...props }, ref) => (
  <li ref={ref} className={cn("", className)} {...props} />
));
PaginationItem.displayName = "PaginationItem";

type PaginationLinkProps = {
  isActive?: boolean;
} & Pick<ButtonProps, "size"> &
  React.ComponentProps<"a">;

const PaginationLink = ({ className, isActive, size = "icon", ...props }: PaginationLinkProps) => (
  <a
    aria-current={isActive ? "page" : undefined}
    className={cn(
      buttonVariants({
        variant: isActive ? "outline" : "ghost",
        size,
      }),
      className
    )}
    {...props}
  />
);
PaginationLink.displayName = "PaginationLink";

const PaginationPrevious = ({ className, ...props }: React.ComponentProps<typeof PaginationLink>) => (
  <PaginationLink aria-label="Go to previous page" size="default" className={cn("gap-1 pl-2.5", className)} {...props}>
    <ChevronLeft className="h-4 w-4" />
    <span>Previous</span>
  </PaginationLink>
);
PaginationPrevious.displayName = "PaginationPrevious";

const PaginationNext = ({ className, ...props }: React.ComponentProps<typeof PaginationLink>) => (
  <PaginationLink aria-label="Go to next page" size="default" className={cn("gap-1 pr-2.5", className)} {...props}>
    <span>Next</span>
    <ChevronRight className="h-4 w-4" />
  </PaginationLink>
);
PaginationNext.displayName = "PaginationNext";

const PaginationEllipsis = ({ className, ...props }: React.ComponentProps<"span">) => (
  <span aria-hidden className={cn("flex h-9 w-9 items-center justify-center", className)} {...props}>
    <MoreHorizontal className="h-4 w-4" />
    <span className="sr-only">More pages</span>
  </span>
);
PaginationEllipsis.displayName = "PaginationEllipsis";

export { Pagination, PaginationContent, PaginationEllipsis, PaginationItem, PaginationLink, PaginationNext, PaginationPrevious };
```
---

### src\components\ui\popover.tsx

**Language:** typescript  
**Size:** 1.24 KB  
**Last Modified:** 2025-11-25T20:35:10.386Z

```typescript
import * as React from "react";
import * as PopoverPrimitive from "@radix-ui/react-popover";

import { cn } from "@/lib/utils";

const Popover = PopoverPrimitive.Root;

const PopoverTrigger = PopoverPrimitive.Trigger;

const PopoverContent = React.forwardRef<
  React.ElementRef<typeof PopoverPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>
>(({ className, align = "center", sideOffset = 4, ...props }, ref) => (
  <PopoverPrimitive.Portal>
    <PopoverPrimitive.Content
      ref={ref}
      align={align}
      sideOffset={sideOffset}
      className={cn(
        "z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        className
      )}
      {...props}
    />
  </PopoverPrimitive.Portal>
));
PopoverContent.displayName = PopoverPrimitive.Content.displayName;

export { Popover, PopoverTrigger, PopoverContent };
```
---

### src\components\ui\progress.tsx

**Language:** typescript  
**Size:** 803 Bytes  
**Last Modified:** 2025-08-28T19:03:37.275Z

```typescript
import * as React from "react"
import * as ProgressPrimitive from "@radix-ui/react-progress"

import { cn } from "@/lib/utils"

const Progress = React.forwardRef<
  React.ElementRef<typeof ProgressPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>
>(({ className, value, ...props }, ref) => (
  <ProgressPrimitive.Root
    ref={ref}
    className={cn(
      "relative h-4 w-full overflow-hidden rounded-full bg-secondary",
      className
    )}
    {...props}
  >
    <ProgressPrimitive.Indicator
      className="h-full w-full flex-1 bg-primary transition-all"
      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}
    />
  </ProgressPrimitive.Root>
))
Progress.displayName = ProgressPrimitive.Root.displayName

export { Progress }
```
---

### src\components\ui\radio-group.tsx

**Language:** typescript  
**Size:** 1.45 KB  
**Last Modified:** 2025-10-31T13:45:28.264Z

```typescript
import * as React from "react";
import * as RadioGroupPrimitive from "@radix-ui/react-radio-group";
import { Circle } from "@/lib/icons";

import { cn } from "@/lib/utils";

const RadioGroup = React.forwardRef<
  React.ElementRef<typeof RadioGroupPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>
>(({ className, ...props }, ref) => {
  return <RadioGroupPrimitive.Root className={cn("grid gap-2", className)} {...props} ref={ref} />;
});
RadioGroup.displayName = RadioGroupPrimitive.Root.displayName;

const RadioGroupItem = React.forwardRef<
  React.ElementRef<typeof RadioGroupPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>
>(({ className, ...props }, ref) => {
  return (
    <RadioGroupPrimitive.Item
      ref={ref}
      className={cn(
        "aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",
        className
      )}
      {...props}
    >
      <RadioGroupPrimitive.Indicator className="flex items-center justify-center">
        <Circle className="h-2.5 w-2.5 fill-current text-current" />
      </RadioGroupPrimitive.Indicator>
    </RadioGroupPrimitive.Item>
  );
});
RadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName;

export { RadioGroup, RadioGroupItem };
```
---

### src\components\ui\resizable.tsx

**Language:** typescript  
**Size:** 1.69 KB  
**Last Modified:** 2025-10-31T13:45:28.271Z

```typescript
import { GripVertical } from "@/lib/icons";
import * as ResizablePrimitive from "react-resizable-panels";

import { cn } from "@/lib/utils";

const ResizablePanelGroup = ({ className, ...props }: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (
  <ResizablePrimitive.PanelGroup
    className={cn("flex h-full w-full data-[panel-group-direction=vertical]:flex-col", className)}
    {...props}
  />
);

const ResizablePanel = ResizablePrimitive.Panel;

const ResizableHandle = ({
  withHandle,
  className,
  ...props
}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {
  withHandle?: boolean;
}) => (
  <ResizablePrimitive.PanelResizeHandle
    className={cn(
      "relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",
      className
    )}
    {...props}
  >
    {withHandle && (
      <div className="z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border">
        <GripVertical className="h-2.5 w-2.5" />
      </div>
    )}
  </ResizablePrimitive.PanelResizeHandle>
);

export { ResizablePanelGroup, ResizablePanel, ResizableHandle };
```
---

### src\components\ui\scroll-area.tsx

**Language:** typescript  
**Size:** 1.65 KB  
**Last Modified:** 2025-08-28T19:03:37.277Z

```typescript
import * as React from "react"
import * as ScrollAreaPrimitive from "@radix-ui/react-scroll-area"

import { cn } from "@/lib/utils"

const ScrollArea = React.forwardRef<
  React.ElementRef<typeof ScrollAreaPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>
>(({ className, children, ...props }, ref) => (
  <ScrollAreaPrimitive.Root
    ref={ref}
    className={cn("relative overflow-hidden", className)}
    {...props}
  >
    <ScrollAreaPrimitive.Viewport className="h-full w-full rounded-[inherit]">
      {children}
    </ScrollAreaPrimitive.Viewport>
    <ScrollBar />
    <ScrollAreaPrimitive.Corner />
  </ScrollAreaPrimitive.Root>
))
ScrollArea.displayName = ScrollAreaPrimitive.Root.displayName

const ScrollBar = React.forwardRef<
  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,
  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>
>(({ className, orientation = "vertical", ...props }, ref) => (
  <ScrollAreaPrimitive.ScrollAreaScrollbar
    ref={ref}
    orientation={orientation}
    className={cn(
      "flex touch-none select-none transition-colors",
      orientation === "vertical" &&
        "h-full w-2.5 border-l border-l-transparent p-[1px]",
      orientation === "horizontal" &&
        "h-2.5 flex-col border-t border-t-transparent p-[1px]",
      className
    )}
    {...props}
  >
    <ScrollAreaPrimitive.ScrollAreaThumb className="relative flex-1 rounded-full bg-border" />
  </ScrollAreaPrimitive.ScrollAreaScrollbar>
))
ScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName

export { ScrollArea, ScrollBar }
```
---

### src\components\ui\select.tsx

**Language:** typescript  
**Size:** 5.52 KB  
**Last Modified:** 2025-11-25T20:34:57.035Z

```typescript
import * as React from "react";
import * as SelectPrimitive from "@radix-ui/react-select";
import { Check, ChevronDown, ChevronUp } from "@/lib/icons";

import { cn } from "@/lib/utils";

const Select = SelectPrimitive.Root;

const SelectGroup = SelectPrimitive.Group;

const SelectValue = SelectPrimitive.Value;

const SelectTrigger = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Trigger
    ref={ref}
    className={cn(
      "flex h-10 w-full items-center justify-between rounded-md border border-input bg-popover px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",
      className
    )}
    {...props}
  >
    {children}
    <SelectPrimitive.Icon asChild>
      <ChevronDown className="h-4 w-4 opacity-50" />
    </SelectPrimitive.Icon>
  </SelectPrimitive.Trigger>
));
SelectTrigger.displayName = SelectPrimitive.Trigger.displayName;

const SelectScrollUpButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollUpButton ref={ref} className={cn("flex cursor-default items-center justify-center py-1", className)} {...props}>
    <ChevronUp className="h-4 w-4" />
  </SelectPrimitive.ScrollUpButton>
));
SelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName;

const SelectScrollDownButton = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.ScrollDownButton ref={ref} className={cn("flex cursor-default items-center justify-center py-1", className)} {...props}>
    <ChevronDown className="h-4 w-4" />
  </SelectPrimitive.ScrollDownButton>
));
SelectScrollDownButton.displayName = SelectPrimitive.ScrollDownButton.displayName;

const SelectContent = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>
>(({ className, children, position = "popper", ...props }, ref) => (
  <SelectPrimitive.Portal>
    <SelectPrimitive.Content
      ref={ref}
      className={cn(
        "relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border border-border bg-popover text-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
        position === "popper" &&
          "data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",
        className
      )}
      position={position}
      {...props}
    >
      <SelectScrollUpButton />
      <SelectPrimitive.Viewport
        className={cn(
          "p-1",
          position === "popper" && "h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"
        )}
      >
        {children}
      </SelectPrimitive.Viewport>
      <SelectScrollDownButton />
    </SelectPrimitive.Content>
  </SelectPrimitive.Portal>
));
SelectContent.displayName = SelectPrimitive.Content.displayName;

const SelectLabel = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Label>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Label ref={ref} className={cn("py-1.5 pl-8 pr-2 text-sm font-semibold", className)} {...props} />
));
SelectLabel.displayName = SelectPrimitive.Label.displayName;

const SelectItem = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>
>(({ className, children, ...props }, ref) => (
  <SelectPrimitive.Item
    ref={ref}
    className={cn(
      "relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:",
      className
    )}
    {...props}
  >
    <span className="absolute left-2 flex h-3.5 w-3.5 items-center justify-center">
      <SelectPrimitive.ItemIndicator>
        <Check className="h-4 w-4" />
      </SelectPrimitive.ItemIndicator>
    </span>

    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>
  </SelectPrimitive.Item>
));
SelectItem.displayName = SelectPrimitive.Item.displayName;

const SelectSeparator = React.forwardRef<
  React.ElementRef<typeof SelectPrimitive.Separator>,
  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>
>(({ className, ...props }, ref) => (
  <SelectPrimitive.Separator ref={ref} className={cn("-mx-1 my-1 h-px bg-muted", className)} {...props} />
));
SelectSeparator.displayName = SelectPrimitive.Separator.displayName;

export {
  Select,
  SelectGroup,
  SelectValue,
  SelectTrigger,
  SelectContent,
  SelectLabel,
  SelectItem,
  SelectSeparator,
  SelectScrollUpButton,
  SelectScrollDownButton,
};
```
---

### src\components\ui\separator.tsx

**Language:** typescript  
**Size:** 785 Bytes  
**Last Modified:** 2025-08-28T19:03:37.279Z

```typescript
import * as React from "react"
import * as SeparatorPrimitive from "@radix-ui/react-separator"

import { cn } from "@/lib/utils"

const Separator = React.forwardRef<
  React.ElementRef<typeof SeparatorPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>
>(
  (
    { className, orientation = "horizontal", decorative = true, ...props },
    ref
  ) => (
    <SeparatorPrimitive.Root
      ref={ref}
      decorative={decorative}
      orientation={orientation}
      className={cn(
        "shrink-0 bg-border",
        orientation === "horizontal" ? "h-[1px] w-full" : "h-full w-[1px]",
        className
      )}
      {...props}
    />
  )
)
Separator.displayName = SeparatorPrimitive.Root.displayName

export { Separator }
```
---

### src\components\ui\sheet.tsx

**Language:** typescript  
**Size:** 4.15 KB  
**Last Modified:** 2025-10-31T13:45:28.502Z

```typescript
import * as SheetPrimitive from "@radix-ui/react-dialog";
import { cva, type VariantProps } from "class-variance-authority";
import { X } from "@/lib/icons";
import * as React from "react";

import { cn } from "@/lib/utils";

const Sheet = SheetPrimitive.Root;

const SheetTrigger = SheetPrimitive.Trigger;

const SheetClose = SheetPrimitive.Close;

const SheetPortal = SheetPrimitive.Portal;

const SheetOverlay = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Overlay>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Overlay
    className={cn(
      "fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",
      className
    )}
    {...props}
    ref={ref}
  />
));
SheetOverlay.displayName = SheetPrimitive.Overlay.displayName;

const sheetVariants = cva(
  "fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",
  {
    variants: {
      side: {
        top: "inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",
        bottom: "inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",
        left: "inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",
        right:
          "inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm",
      },
    },
    defaultVariants: {
      side: "right",
    },
  }
);

interface SheetContentProps extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>, VariantProps<typeof sheetVariants> {}

const SheetContent = React.forwardRef<React.ElementRef<typeof SheetPrimitive.Content>, SheetContentProps>(
  ({ side = "right", className, children, ...props }, ref) => (
    <SheetPortal>
      <SheetOverlay />
      <SheetPrimitive.Content ref={ref} className={cn(sheetVariants({ side }), className)} {...props}>
        {children}
        <SheetPrimitive.Close className="absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary">
          <X className="h-4 w-4" />
          <span className="sr-only">Close</span>
        </SheetPrimitive.Close>
      </SheetPrimitive.Content>
    </SheetPortal>
  )
);
SheetContent.displayName = SheetPrimitive.Content.displayName;

const SheetHeader = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col space-y-2 text-center sm:text-left", className)} {...props} />
);
SheetHeader.displayName = "SheetHeader";

const SheetFooter = ({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) => (
  <div className={cn("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2", className)} {...props} />
);
SheetFooter.displayName = "SheetFooter";

const SheetTitle = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Title>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Title ref={ref} className={cn("text-lg font-semibold text-foreground", className)} {...props} />
));
SheetTitle.displayName = SheetPrimitive.Title.displayName;

const SheetDescription = React.forwardRef<
  React.ElementRef<typeof SheetPrimitive.Description>,
  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>
>(({ className, ...props }, ref) => (
  <SheetPrimitive.Description ref={ref} className={cn("text-sm text-muted-foreground", className)} {...props} />
));
SheetDescription.displayName = SheetPrimitive.Description.displayName;

export { Sheet, SheetClose, SheetContent, SheetDescription, SheetFooter, SheetHeader, SheetOverlay, SheetPortal, SheetTitle, SheetTrigger };
```
---

### src\components\ui\sidebar.tsx

**Language:** typescript  
**Size:** 22.54 KB  
**Last Modified:** 2025-10-31T13:45:28.255Z

```typescript
import * as React from "react";
import { Slot } from "@radix-ui/react-slot";
import { VariantProps, cva } from "class-variance-authority";
import { PanelLeft } from "@/lib/icons";

import { useIsMobile } from "@/hooks/use-mobile";
import { cn } from "@/lib/utils";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Separator } from "@/components/ui/separator";
import { Sheet, SheetContent } from "@/components/ui/sheet";
import { Skeleton } from "@/components/ui/skeleton";
import { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from "@/components/ui/tooltip";

const SIDEBAR_COOKIE_NAME = "sidebar:state";
const SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7;
const SIDEBAR_WIDTH = "16rem";
const SIDEBAR_WIDTH_MOBILE = "18rem";
const SIDEBAR_WIDTH_ICON = "3rem";
const SIDEBAR_KEYBOARD_SHORTCUT = "b";

type SidebarContext = {
  state: "expanded" | "collapsed";
  open: boolean;
  setOpen: (open: boolean) => void;
  openMobile: boolean;
  setOpenMobile: (open: boolean) => void;
  isMobile: boolean;
  toggleSidebar: () => void;
};

const SidebarContext = React.createContext<SidebarContext | null>(null);

function useSidebar() {
  const context = React.useContext(SidebarContext);
  if (!context) {
    throw new Error("useSidebar must be used within a SidebarProvider.");
  }

  return context;
}

const SidebarProvider = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & {
    defaultOpen?: boolean;
    open?: boolean;
    onOpenChange?: (open: boolean) => void;
  }
>(({ defaultOpen = true, open: openProp, onOpenChange: setOpenProp, className, style, children, ...props }, ref) => {
  const isMobile = useIsMobile();
  const [openMobile, setOpenMobile] = React.useState(false);

  // This is the internal state of the sidebar.
  // We use openProp and setOpenProp for control from outside the component.
  const [_open, _setOpen] = React.useState(defaultOpen);
  const open = openProp ?? _open;
  const setOpen = React.useCallback(
    (value: boolean | ((value: boolean) => boolean)) => {
      const openState = typeof value === "function" ? value(open) : value;
      if (setOpenProp) {
        setOpenProp(openState);
      } else {
        _setOpen(openState);
      }

      // This sets the cookie to keep the sidebar state.
      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`;
    },
    [setOpenProp, open]
  );

  // Helper to toggle the sidebar.
  const toggleSidebar = React.useCallback(() => {
    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open);
  }, [isMobile, setOpen, setOpenMobile]);

  // Adds a keyboard shortcut to toggle the sidebar.
  React.useEffect(() => {
    const handleKeyDown = (event: KeyboardEvent) => {
      if (event.key === SIDEBAR_KEYBOARD_SHORTCUT && (event.metaKey || event.ctrlKey)) {
        event.preventDefault();
        toggleSidebar();
      }
    };

    window.addEventListener("keydown", handleKeyDown);
    return () => window.removeEventListener("keydown", handleKeyDown);
  }, [toggleSidebar]);

  // We add a state so that we can do data-state="expanded" or "collapsed".
  // This makes it easier to style the sidebar with Tailwind classes.
  const state = open ? "expanded" : "collapsed";

  const contextValue = React.useMemo<SidebarContext>(
    () => ({
      state,
      open,
      setOpen,
      isMobile,
      openMobile,
      setOpenMobile,
      toggleSidebar,
    }),
    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]
  );

  return (
    <SidebarContext.Provider value={contextValue}>
      <TooltipProvider delayDuration={0}>
        <div
          style={
            {
              "--sidebar-width": SIDEBAR_WIDTH,
              "--sidebar-width-icon": SIDEBAR_WIDTH_ICON,
              ...style,
            } as React.CSSProperties
          }
          className={cn("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar", className)}
          ref={ref}
          {...props}
        >
          {children}
        </div>
      </TooltipProvider>
    </SidebarContext.Provider>
  );
});
SidebarProvider.displayName = "SidebarProvider";

const Sidebar = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & {
    side?: "left" | "right";
    variant?: "sidebar" | "floating" | "inset";
    collapsible?: "offcanvas" | "icon" | "none";
  }
>(({ side = "left", variant = "sidebar", collapsible = "offcanvas", className, children, ...props }, ref) => {
  const { isMobile, state, openMobile, setOpenMobile } = useSidebar();

  if (collapsible === "none") {
    return (
      <div className={cn("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground", className)} ref={ref} {...props}>
        {children}
      </div>
    );
  }

  if (isMobile) {
    return (
      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>
        <SheetContent
          data-sidebar="sidebar"
          data-mobile="true"
          className="w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden"
          style={
            {
              "--sidebar-width": SIDEBAR_WIDTH_MOBILE,
            } as React.CSSProperties
          }
          side={side}
        >
          <div className="flex h-full w-full flex-col">{children}</div>
        </SheetContent>
      </Sheet>
    );
  }

  return (
    <div
      ref={ref}
      className="group peer hidden md:block text-sidebar-foreground"
      data-state={state}
      data-collapsible={state === "collapsed" ? collapsible : ""}
      data-variant={variant}
      data-side={side}
    >
      {/* This is what handles the sidebar gap on desktop */}
      <div
        className={cn(
          "duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear",
          "group-data-[collapsible=offcanvas]:w-0",
          "group-data-[side=right]:rotate-180",
          variant === "floating" || variant === "inset"
            ? "group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]"
            : "group-data-[collapsible=icon]:w-[--sidebar-width-icon]"
        )}
      />
      <div
        className={cn(
          "duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex",
          side === "left"
            ? "left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]"
            : "right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]",
          // Adjust the padding for floating and inset variants.
          variant === "floating" || variant === "inset"
            ? "p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]"
            : "group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",
          className
        )}
        {...props}
      >
        <div
          data-sidebar="sidebar"
          className="flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow"
        >
          {children}
        </div>
      </div>
    </div>
  );
});
Sidebar.displayName = "Sidebar";

const SidebarTrigger = React.forwardRef<React.ElementRef<typeof Button>, React.ComponentProps<typeof Button>>(
  ({ className, onClick, ...props }, ref) => {
    const { toggleSidebar } = useSidebar();

    return (
      <Button
        ref={ref}
        data-sidebar="trigger"
        variant="ghost"
        size="icon"
        className={cn("h-7 w-7", className)}
        onClick={(event) => {
          onClick?.(event);
          toggleSidebar();
        }}
        {...props}
      >
        <PanelLeft />
        <span className="sr-only">Toggle Sidebar</span>
      </Button>
    );
  }
);
SidebarTrigger.displayName = "SidebarTrigger";

const SidebarRail = React.forwardRef<HTMLButtonElement, React.ComponentProps<"button">>(({ className, ...props }, ref) => {
  const { toggleSidebar } = useSidebar();

  return (
    <button
      ref={ref}
      data-sidebar="rail"
      aria-label="Toggle Sidebar"
      tabIndex={-1}
      onClick={toggleSidebar}
      title="Toggle Sidebar"
      className={cn(
        "absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex",
        "[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize",
        "[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize",
        "group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar",
        "[[data-side=left][data-collapsible=offcanvas]_&]:-right-2",
        "[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",
        className
      )}
      {...props}
    />
  );
});
SidebarRail.displayName = "SidebarRail";

const SidebarInset = React.forwardRef<HTMLDivElement, React.ComponentProps<"main">>(({ className, ...props }, ref) => {
  return (
    <main
      ref={ref}
      className={cn(
        "relative flex min-h-svh flex-1 flex-col bg-background",
        "peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",
        className
      )}
      {...props}
    />
  );
});
SidebarInset.displayName = "SidebarInset";

const SidebarInput = React.forwardRef<React.ElementRef<typeof Input>, React.ComponentProps<typeof Input>>(
  ({ className, ...props }, ref) => {
    return (
      <Input
        ref={ref}
        data-sidebar="input"
        className={cn("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring", className)}
        {...props}
      />
    );
  }
);
SidebarInput.displayName = "SidebarInput";

const SidebarHeader = React.forwardRef<HTMLDivElement, React.ComponentProps<"div">>(({ className, ...props }, ref) => {
  return <div ref={ref} data-sidebar="header" className={cn("flex flex-col gap-2 p-2", className)} {...props} />;
});
SidebarHeader.displayName = "SidebarHeader";

const SidebarFooter = React.forwardRef<HTMLDivElement, React.ComponentProps<"div">>(({ className, ...props }, ref) => {
  return <div ref={ref} data-sidebar="footer" className={cn("flex flex-col gap-2 p-2", className)} {...props} />;
});
SidebarFooter.displayName = "SidebarFooter";

const SidebarSeparator = React.forwardRef<React.ElementRef<typeof Separator>, React.ComponentProps<typeof Separator>>(
  ({ className, ...props }, ref) => {
    return <Separator ref={ref} data-sidebar="separator" className={cn("mx-2 w-auto bg-sidebar-border", className)} {...props} />;
  }
);
SidebarSeparator.displayName = "SidebarSeparator";

const SidebarContent = React.forwardRef<HTMLDivElement, React.ComponentProps<"div">>(({ className, ...props }, ref) => {
  return (
    <div
      ref={ref}
      data-sidebar="content"
      className={cn("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden", className)}
      {...props}
    />
  );
});
SidebarContent.displayName = "SidebarContent";

const SidebarGroup = React.forwardRef<HTMLDivElement, React.ComponentProps<"div">>(({ className, ...props }, ref) => {
  return <div ref={ref} data-sidebar="group" className={cn("relative flex w-full min-w-0 flex-col p-2", className)} {...props} />;
});
SidebarGroup.displayName = "SidebarGroup";

const SidebarGroupLabel = React.forwardRef<HTMLDivElement, React.ComponentProps<"div"> & { asChild?: boolean }>(
  ({ className, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : "div";

    return (
      <Comp
        ref={ref}
        data-sidebar="group-label"
        className={cn(
          "duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
          "group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",
          className
        )}
        {...props}
      />
    );
  }
);
SidebarGroupLabel.displayName = "SidebarGroupLabel";

const SidebarGroupAction = React.forwardRef<HTMLButtonElement, React.ComponentProps<"button"> & { asChild?: boolean }>(
  ({ className, asChild = false, ...props }, ref) => {
    const Comp = asChild ? Slot : "button";

    return (
      <Comp
        ref={ref}
        data-sidebar="group-action"
        className={cn(
          "absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0",
          // Increases the hit area of the button on mobile.
          "after:absolute after:-inset-2 after:md:hidden",
          "group-data-[collapsible=icon]:hidden",
          className
        )}
        {...props}
      />
    );
  }
);
SidebarGroupAction.displayName = "SidebarGroupAction";

const SidebarGroupContent = React.forwardRef<HTMLDivElement, React.ComponentProps<"div">>(({ className, ...props }, ref) => (
  <div ref={ref} data-sidebar="group-content" className={cn("w-full text-sm", className)} {...props} />
));
SidebarGroupContent.displayName = "SidebarGroupContent";

const SidebarMenu = React.forwardRef<HTMLUListElement, React.ComponentProps<"ul">>(({ className, ...props }, ref) => (
  <ul ref={ref} data-sidebar="menu" className={cn("flex w-full min-w-0 flex-col gap-1", className)} {...props} />
));
SidebarMenu.displayName = "SidebarMenu";

const SidebarMenuItem = React.forwardRef<HTMLLIElement, React.ComponentProps<"li">>(({ className, ...props }, ref) => (
  <li ref={ref} data-sidebar="menu-item" className={cn("group/menu-item relative", className)} {...props} />
));
SidebarMenuItem.displayName = "SidebarMenuItem";

const sidebarMenuButtonVariants = cva(
  "peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",
  {
    variants: {
      variant: {
        default: "hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",
        outline:
          "bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]",
      },
      size: {
        default: "h-8 text-sm",
        sm: "h-7 text-xs",
        lg: "h-12 text-sm group-data-[collapsible=icon]:!p-0",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
);

const SidebarMenuButton = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<"button"> & {
    asChild?: boolean;
    isActive?: boolean;
    tooltip?: string | React.ComponentProps<typeof TooltipContent>;
  } & VariantProps<typeof sidebarMenuButtonVariants>
>(({ asChild = false, isActive = false, variant = "default", size = "default", tooltip, className, ...props }, ref) => {
  const Comp = asChild ? Slot : "button";
  const { isMobile, state } = useSidebar();

  const button = (
    <Comp
      ref={ref}
      data-sidebar="menu-button"
      data-size={size}
      data-active={isActive}
      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}
      {...props}
    />
  );

  if (!tooltip) {
    return button;
  }

  if (typeof tooltip === "string") {
    tooltip = {
      children: tooltip,
    };
  }

  return (
    <Tooltip>
      <TooltipTrigger asChild>{button}</TooltipTrigger>
      <TooltipContent side="right" align="center" hidden={state !== "collapsed" || isMobile} {...tooltip} />
    </Tooltip>
  );
});
SidebarMenuButton.displayName = "SidebarMenuButton";

const SidebarMenuAction = React.forwardRef<
  HTMLButtonElement,
  React.ComponentProps<"button"> & {
    asChild?: boolean;
    showOnHover?: boolean;
  }
>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {
  const Comp = asChild ? Slot : "button";

  return (
    <Comp
      ref={ref}
      data-sidebar="menu-action"
      className={cn(
        "absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0",
        // Increases the hit area of the button on mobile.
        "after:absolute after:-inset-2 after:md:hidden",
        "peer-data-[size=sm]/menu-button:top-1",
        "peer-data-[size=default]/menu-button:top-1.5",
        "peer-data-[size=lg]/menu-button:top-2.5",
        "group-data-[collapsible=icon]:hidden",
        showOnHover &&
          "group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",
        className
      )}
      {...props}
    />
  );
});
SidebarMenuAction.displayName = "SidebarMenuAction";

const SidebarMenuBadge = React.forwardRef<HTMLDivElement, React.ComponentProps<"div">>(({ className, ...props }, ref) => (
  <div
    ref={ref}
    data-sidebar="menu-badge"
    className={cn(
      "absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none",
      "peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground",
      "peer-data-[size=sm]/menu-button:top-1",
      "peer-data-[size=default]/menu-button:top-1.5",
      "peer-data-[size=lg]/menu-button:top-2.5",
      "group-data-[collapsible=icon]:hidden",
      className
    )}
    {...props}
  />
));
SidebarMenuBadge.displayName = "SidebarMenuBadge";

const SidebarMenuSkeleton = React.forwardRef<
  HTMLDivElement,
  React.ComponentProps<"div"> & {
    showIcon?: boolean;
  }
>(({ className, showIcon = false, ...props }, ref) => {
  // Random width between 50 to 90%.
  const width = React.useMemo(() => {
    return `${Math.floor(Math.random() * 40) + 50}%`;
  }, []);

  return (
    <div ref={ref} data-sidebar="menu-skeleton" className={cn("rounded-md h-8 flex gap-2 px-2 items-center", className)} {...props}>
      {showIcon && <Skeleton className="size-4 rounded-md" data-sidebar="menu-skeleton-icon" />}
      <Skeleton
        className="h-4 flex-1 max-w-[--skeleton-width]"
        data-sidebar="menu-skeleton-text"
        style={
          {
            "--skeleton-width": width,
          } as React.CSSProperties
        }
      />
    </div>
  );
});
SidebarMenuSkeleton.displayName = "SidebarMenuSkeleton";

const SidebarMenuSub = React.forwardRef<HTMLUListElement, React.ComponentProps<"ul">>(({ className, ...props }, ref) => (
  <ul
    ref={ref}
    data-sidebar="menu-sub"
    className={cn(
      "mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5",
      "group-data-[collapsible=icon]:hidden",
      className
    )}
    {...props}
  />
));
SidebarMenuSub.displayName = "SidebarMenuSub";

const SidebarMenuSubItem = React.forwardRef<HTMLLIElement, React.ComponentProps<"li">>(({ ...props }, ref) => <li ref={ref} {...props} />);
SidebarMenuSubItem.displayName = "SidebarMenuSubItem";

const SidebarMenuSubButton = React.forwardRef<
  HTMLAnchorElement,
  React.ComponentProps<"a"> & {
    asChild?: boolean;
    size?: "sm" | "md";
    isActive?: boolean;
  }
>(({ asChild = false, size = "md", isActive, className, ...props }, ref) => {
  const Comp = asChild ? Slot : "a";

  return (
    <Comp
      ref={ref}
      data-sidebar="menu-sub-button"
      data-size={size}
      data-active={isActive}
      className={cn(
        "flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground",
        "data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground",
        size === "sm" && "text-xs",
        size === "md" && "text-sm",
        "group-data-[collapsible=icon]:hidden",
        className
      )}
      {...props}
    />
  );
});
SidebarMenuSubButton.displayName = "SidebarMenuSubButton";

export {
  Sidebar,
  SidebarContent,
  SidebarFooter,
  SidebarGroup,
  SidebarGroupAction,
  SidebarGroupContent,
  SidebarGroupLabel,
  SidebarHeader,
  SidebarInput,
  SidebarInset,
  SidebarMenu,
  SidebarMenuAction,
  SidebarMenuBadge,
  SidebarMenuButton,
  SidebarMenuItem,
  SidebarMenuSkeleton,
  SidebarMenuSub,
  SidebarMenuSubButton,
  SidebarMenuSubItem,
  SidebarProvider,
  SidebarRail,
  SidebarSeparator,
  SidebarTrigger,
  useSidebar,
};
```
---

### src\components\ui\skeleton.tsx

**Language:** typescript  
**Size:** 276 Bytes  
**Last Modified:** 2025-08-28T19:03:37.280Z

```typescript
import { cn } from "@/lib/utils"

function Skeleton({
  className,
  ...props
}: React.HTMLAttributes<HTMLDivElement>) {
  return (
    <div
      className={cn("animate-pulse rounded-md bg-muted", className)}
      {...props}
    />
  )
}

export { Skeleton }
```
---

### src\components\ui\slider.tsx

**Language:** typescript  
**Size:** 1.08 KB  
**Last Modified:** 2025-08-28T19:03:37.281Z

```typescript
import * as React from "react"
import * as SliderPrimitive from "@radix-ui/react-slider"

import { cn } from "@/lib/utils"

const Slider = React.forwardRef<
  React.ElementRef<typeof SliderPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>
>(({ className, ...props }, ref) => (
  <SliderPrimitive.Root
    ref={ref}
    className={cn(
      "relative flex w-full touch-none select-none items-center",
      className
    )}
    {...props}
  >
    <SliderPrimitive.Track className="relative h-2 w-full grow overflow-hidden rounded-full bg-secondary">
      <SliderPrimitive.Range className="absolute h-full bg-primary" />
    </SliderPrimitive.Track>
    <SliderPrimitive.Thumb className="block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50" />
  </SliderPrimitive.Root>
))
Slider.displayName = SliderPrimitive.Root.displayName

export { Slider }
```
---

### src\components\ui\sonner.tsx

**Language:** typescript  
**Size:** 923 Bytes  
**Last Modified:** 2025-08-28T19:03:37.281Z

```typescript
import { useTheme } from "next-themes"
import { Toaster as Sonner, toast } from "sonner"

type ToasterProps = React.ComponentProps<typeof Sonner>

const Toaster = ({ ...props }: ToasterProps) => {
  const { theme = "system" } = useTheme()

  return (
    <Sonner
      theme={theme as ToasterProps["theme"]}
      className="toaster group"
      toastOptions={{
        classNames: {
          toast:
            "group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",
          description: "group-[.toast]:text-muted-foreground",
          actionButton:
            "group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",
          cancelButton:
            "group-[.toast]:bg-muted group-[.toast]:text-muted-foreground",
        },
      }}
      {...props}
    />
  )
}

export { Toaster, toast }
```
---

### src\components\ui\switch.tsx

**Language:** typescript  
**Size:** 1.14 KB  
**Last Modified:** 2025-08-28T19:03:37.282Z

```typescript
import * as React from "react"
import * as SwitchPrimitives from "@radix-ui/react-switch"

import { cn } from "@/lib/utils"

const Switch = React.forwardRef<
  React.ElementRef<typeof SwitchPrimitives.Root>,
  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>
>(({ className, ...props }, ref) => (
  <SwitchPrimitives.Root
    className={cn(
      "peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",
      className
    )}
    {...props}
    ref={ref}
  >
    <SwitchPrimitives.Thumb
      className={cn(
        "pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0"
      )}
    />
  </SwitchPrimitives.Root>
))
Switch.displayName = SwitchPrimitives.Root.displayName

export { Switch }
```
---

### src\components\ui\table.tsx

**Language:** typescript  
**Size:** 2.81 KB  
**Last Modified:** 2025-08-28T19:03:37.283Z

```typescript
import * as React from "react"

import { cn } from "@/lib/utils"

const Table = React.forwardRef<
  HTMLTableElement,
  React.HTMLAttributes<HTMLTableElement>
>(({ className, ...props }, ref) => (
  <div className="relative w-full overflow-auto">
    <table
      ref={ref}
      className={cn("w-full caption-bottom text-sm", className)}
      {...props}
    />
  </div>
))
Table.displayName = "Table"

const TableHeader = React.forwardRef<
  HTMLTableSectionElement,
  React.HTMLAttributes<HTMLTableSectionElement>
>(({ className, ...props }, ref) => (
  <thead ref={ref} className={cn("[&_tr]:border-b", className)} {...props} />
))
TableHeader.displayName = "TableHeader"

const TableBody = React.forwardRef<
  HTMLTableSectionElement,
  React.HTMLAttributes<HTMLTableSectionElement>
>(({ className, ...props }, ref) => (
  <tbody
    ref={ref}
    className={cn("[&_tr:last-child]:border-0", className)}
    {...props}
  />
))
TableBody.displayName = "TableBody"

const TableFooter = React.forwardRef<
  HTMLTableSectionElement,
  React.HTMLAttributes<HTMLTableSectionElement>
>(({ className, ...props }, ref) => (
  <tfoot
    ref={ref}
    className={cn(
      "border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",
      className
    )}
    {...props}
  />
))
TableFooter.displayName = "TableFooter"

const TableRow = React.forwardRef<
  HTMLTableRowElement,
  React.HTMLAttributes<HTMLTableRowElement>
>(({ className, ...props }, ref) => (
  <tr
    ref={ref}
    className={cn(
      "border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",
      className
    )}
    {...props}
  />
))
TableRow.displayName = "TableRow"

const TableHead = React.forwardRef<
  HTMLTableCellElement,
  React.ThHTMLAttributes<HTMLTableCellElement>
>(({ className, ...props }, ref) => (
  <th
    ref={ref}
    className={cn(
      "h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",
      className
    )}
    {...props}
  />
))
TableHead.displayName = "TableHead"

const TableCell = React.forwardRef<
  HTMLTableCellElement,
  React.TdHTMLAttributes<HTMLTableCellElement>
>(({ className, ...props }, ref) => (
  <td
    ref={ref}
    className={cn("p-4 align-middle [&:has([role=checkbox])]:pr-0", className)}
    {...props}
  />
))
TableCell.displayName = "TableCell"

const TableCaption = React.forwardRef<
  HTMLTableCaptionElement,
  React.HTMLAttributes<HTMLTableCaptionElement>
>(({ className, ...props }, ref) => (
  <caption
    ref={ref}
    className={cn("mt-4 text-sm text-muted-foreground", className)}
    {...props}
  />
))
TableCaption.displayName = "TableCaption"

export {
  Table,
  TableHeader,
  TableBody,
  TableFooter,
  TableHead,
  TableRow,
  TableCell,
  TableCaption,
}
```
---

### src\components\ui\tabs.tsx

**Language:** typescript  
**Size:** 1.89 KB  
**Last Modified:** 2025-08-28T19:03:37.283Z

```typescript
import * as React from "react"
import * as TabsPrimitive from "@radix-ui/react-tabs"

import { cn } from "@/lib/utils"

const Tabs = TabsPrimitive.Root

const TabsList = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.List>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.List
    ref={ref}
    className={cn(
      "inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",
      className
    )}
    {...props}
  />
))
TabsList.displayName = TabsPrimitive.List.displayName

const TabsTrigger = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Trigger>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Trigger
    ref={ref}
    className={cn(
      "inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",
      className
    )}
    {...props}
  />
))
TabsTrigger.displayName = TabsPrimitive.Trigger.displayName

const TabsContent = React.forwardRef<
  React.ElementRef<typeof TabsPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>
>(({ className, ...props }, ref) => (
  <TabsPrimitive.Content
    ref={ref}
    className={cn(
      "mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",
      className
    )}
    {...props}
  />
))
TabsContent.displayName = TabsPrimitive.Content.displayName

export { Tabs, TabsList, TabsTrigger, TabsContent }
```
---

### src\components\ui\textarea.tsx

**Language:** typescript  
**Size:** 796 Bytes  
**Last Modified:** 2025-08-28T19:03:37.284Z

```typescript
import * as React from "react"

import { cn } from "@/lib/utils"

export interface TextareaProps
  extends React.TextareaHTMLAttributes<HTMLTextAreaElement> {}

const Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(
  ({ className, ...props }, ref) => {
    return (
      <textarea
        className={cn(
          "flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",
          className
        )}
        ref={ref}
        {...props}
      />
    )
  }
)
Textarea.displayName = "Textarea"

export { Textarea }
```
---

### src\components\ui\toast.tsx

**Language:** typescript  
**Size:** 4.77 KB  
**Last Modified:** 2025-10-31T13:45:28.787Z

```typescript
import * as React from "react";
import * as ToastPrimitives from "@radix-ui/react-toast";
import { cva, type VariantProps } from "class-variance-authority";
import { X } from "@/lib/icons";

import { cn } from "@/lib/utils";

const ToastProvider = ToastPrimitives.Provider;

const ToastViewport = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Viewport>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Viewport
    ref={ref}
    className={cn(
      "fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",
      className
    )}
    {...props}
  />
));
ToastViewport.displayName = ToastPrimitives.Viewport.displayName;

const toastVariants = cva(
  "group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",
  {
    variants: {
      variant: {
        default: "border bg-background text-foreground",
        destructive: "destructive group border-destructive bg-destructive text-destructive-foreground",
      },
    },
    defaultVariants: {
      variant: "default",
    },
  }
);

const Toast = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Root>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> & VariantProps<typeof toastVariants>
>(({ className, variant, ...props }, ref) => {
  return <ToastPrimitives.Root ref={ref} className={cn(toastVariants({ variant }), className)} {...props} />;
});
Toast.displayName = ToastPrimitives.Root.displayName;

const ToastAction = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Action>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Action
    ref={ref}
    className={cn(
      "inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",
      className
    )}
    {...props}
  />
));
ToastAction.displayName = ToastPrimitives.Action.displayName;

const ToastClose = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Close>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>
>(({ className, ...props }, ref) => (
  <ToastPrimitives.Close
    ref={ref}
    className={cn(
      "absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",
      className
    )}
    toast-close=""
    {...props}
  >
    <X className="h-4 w-4" />
  </ToastPrimitives.Close>
));
ToastClose.displayName = ToastPrimitives.Close.displayName;

const ToastTitle = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Title>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>
>(({ className, ...props }, ref) => <ToastPrimitives.Title ref={ref} className={cn("text-sm font-semibold", className)} {...props} />);
ToastTitle.displayName = ToastPrimitives.Title.displayName;

const ToastDescription = React.forwardRef<
  React.ElementRef<typeof ToastPrimitives.Description>,
  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>
>(({ className, ...props }, ref) => <ToastPrimitives.Description ref={ref} className={cn("text-sm opacity-90", className)} {...props} />);
ToastDescription.displayName = ToastPrimitives.Description.displayName;

type ToastProps = React.ComponentPropsWithoutRef<typeof Toast>;

type ToastActionElement = React.ReactElement<typeof ToastAction>;

export {
  type ToastProps,
  type ToastActionElement,
  ToastProvider,
  ToastViewport,
  Toast,
  ToastTitle,
  ToastDescription,
  ToastClose,
  ToastAction,
};
```
---

### src\components\ui\toaster.tsx

**Language:** typescript  
**Size:** 805 Bytes  
**Last Modified:** 2025-08-28T19:03:37.285Z

```typescript
import { useToast } from "@/hooks/use-toast"
import {
  Toast,
  ToastClose,
  ToastDescription,
  ToastProvider,
  ToastTitle,
  ToastViewport,
} from "@/components/ui/toast"

export function Toaster() {
  const { toasts } = useToast()

  return (
    <ToastProvider>
      {toasts.map(function ({ id, title, description, action, ...props }) {
        return (
          <Toast key={id} {...props}>
            <div className="grid gap-1">
              {title && <ToastTitle>{title}</ToastTitle>}
              {description && (
                <ToastDescription>{description}</ToastDescription>
              )}
            </div>
            {action}
            <ToastClose />
          </Toast>
        )
      })}
      <ToastViewport />
    </ToastProvider>
  )
}
```
---

### src\components\ui\toggle-group.tsx

**Language:** typescript  
**Size:** 1.76 KB  
**Last Modified:** 2025-08-28T19:03:37.286Z

```typescript
import * as React from "react"
import * as ToggleGroupPrimitive from "@radix-ui/react-toggle-group"
import { type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"
import { toggleVariants } from "@/components/ui/toggle"

const ToggleGroupContext = React.createContext<
  VariantProps<typeof toggleVariants>
>({
  size: "default",
  variant: "default",
})

const ToggleGroup = React.forwardRef<
  React.ElementRef<typeof ToggleGroupPrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &
    VariantProps<typeof toggleVariants>
>(({ className, variant, size, children, ...props }, ref) => (
  <ToggleGroupPrimitive.Root
    ref={ref}
    className={cn("flex items-center justify-center gap-1", className)}
    {...props}
  >
    <ToggleGroupContext.Provider value={{ variant, size }}>
      {children}
    </ToggleGroupContext.Provider>
  </ToggleGroupPrimitive.Root>
))

ToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName

const ToggleGroupItem = React.forwardRef<
  React.ElementRef<typeof ToggleGroupPrimitive.Item>,
  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &
    VariantProps<typeof toggleVariants>
>(({ className, children, variant, size, ...props }, ref) => {
  const context = React.useContext(ToggleGroupContext)

  return (
    <ToggleGroupPrimitive.Item
      ref={ref}
      className={cn(
        toggleVariants({
          variant: context.variant || variant,
          size: context.size || size,
        }),
        className
      )}
      {...props}
    >
      {children}
    </ToggleGroupPrimitive.Item>
  )
})

ToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName

export { ToggleGroup, ToggleGroupItem }
```
---

### src\components\ui\toggle.tsx

**Language:** typescript  
**Size:** 1.44 KB  
**Last Modified:** 2025-08-28T19:03:37.287Z

```typescript
import * as React from "react"
import * as TogglePrimitive from "@radix-ui/react-toggle"
import { cva, type VariantProps } from "class-variance-authority"

import { cn } from "@/lib/utils"

const toggleVariants = cva(
  "inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground",
  {
    variants: {
      variant: {
        default: "bg-transparent",
        outline:
          "border border-input bg-transparent hover:bg-accent hover:text-accent-foreground",
      },
      size: {
        default: "h-10 px-3",
        sm: "h-9 px-2.5",
        lg: "h-11 px-5",
      },
    },
    defaultVariants: {
      variant: "default",
      size: "default",
    },
  }
)

const Toggle = React.forwardRef<
  React.ElementRef<typeof TogglePrimitive.Root>,
  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &
    VariantProps<typeof toggleVariants>
>(({ className, variant, size, ...props }, ref) => (
  <TogglePrimitive.Root
    ref={ref}
    className={cn(toggleVariants({ variant, size, className }))}
    {...props}
  />
))

Toggle.displayName = TogglePrimitive.Root.displayName

export { Toggle, toggleVariants }
```
---

### src\components\ui\tooltip.tsx

**Language:** typescript  
**Size:** 1.15 KB  
**Last Modified:** 2025-08-28T19:03:37.287Z

```typescript
import * as React from "react"
import * as TooltipPrimitive from "@radix-ui/react-tooltip"

import { cn } from "@/lib/utils"

const TooltipProvider = TooltipPrimitive.Provider

const Tooltip = TooltipPrimitive.Root

const TooltipTrigger = TooltipPrimitive.Trigger

const TooltipContent = React.forwardRef<
  React.ElementRef<typeof TooltipPrimitive.Content>,
  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>
>(({ className, sideOffset = 4, ...props }, ref) => (
  <TooltipPrimitive.Content
    ref={ref}
    sideOffset={sideOffset}
    className={cn(
      "z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",
      className
    )}
    {...props}
  />
))
TooltipContent.displayName = TooltipPrimitive.Content.displayName

export { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }
```
---

### src\components\ui\use-toast.ts

**Language:** typescript  
**Size:** 85 Bytes  
**Last Modified:** 2025-08-28T19:03:37.288Z

```typescript
import { useToast, toast } from "@/hooks/use-toast";

export { useToast, toast };
```
---

### src\components\VirtualizedTransactionsList.tsx

**Language:** typescript  
**Size:** 3.41 KB  
**Last Modified:** 2025-11-04T18:54:30.425Z

```typescript
import { useMemo } from "react";
import { FixedSizeList as List } from "react-window";

import { Badge } from "@/components/ui/badge";
import { Button } from "@/components/ui/button";
import { ArrowUpCircle, ArrowDownCircle, Calendar, Trash2 } from "@/lib/icons";
import { cn } from "@/lib/utils";

import type { Transaction } from "./transactions/types";

interface VirtualizedTransactionsListProps {
  transactions: Transaction[];
  onDelete: (id: string) => void;
  height?: number;
  itemHeight?: number;
}

export const VirtualizedTransactionsList = ({
  transactions,
  onDelete,
  height = 600,
  itemHeight = 80,
}: VirtualizedTransactionsListProps) => {
  const sortedTransactions = useMemo(
    () => [...transactions].sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime()),
    [transactions]
  );

  const Row = ({ index, style }: { index: number; style: React.CSSProperties }) => {
    const transaction = sortedTransactions[index];

    return (
      <div style={style} className="px-4">
        <div className="flex items-center justify-between py-4 border-b">
          <div className="flex items-center gap-3 flex-1">
            <div className={cn("p-2 rounded-full", transaction.type === "income" ? "bg-success/10" : "bg-destructive/10")}>
              {transaction.type === "income" ? (
                <ArrowUpCircle className="h-4 w-4 text-success" />
              ) : (
                <ArrowDownCircle className="h-4 w-4 text-destructive" />
              )}
            </div>

            <div className="flex-1 min-w-0">
              <p className="font-medium truncate">{transaction.description}</p>
              <div className="flex items-center gap-2 mt-1">
                <Badge variant="secondary" className="text-xs">
                  {transaction.category}
                </Badge>
                <span className="text-xs text-muted-foreground flex items-center gap-1">
                  <Calendar className="h-3 w-3" />
                  {new Date(transaction.date).toLocaleDateString("pt-BR")}
                </span>
                {transaction.group_id && (
                  <Badge variant="outline" className="text-xs">
                    Grupo
                  </Badge>
                )}
              </div>
            </div>
          </div>

          <div className="flex items-center gap-3">
            <p
              className={cn("font-semibold text-lg whitespace-nowrap", transaction.type === "income" ? "text-success" : "text-destructive")}
            >
              {transaction.type === "income" ? "+" : "-"}
              {Math.abs(transaction.amount).toLocaleString("pt-BR", {
                style: "currency",
                currency: "BRL",
              })}
            </p>

            <Button
              variant="ghost"
              size="icon"
              onClick={() => onDelete(transaction.id)}
              className="text-destructive hover:text-destructive hover:bg-destructive/10"
            >
              <Trash2 className="h-4 w-4" />
            </Button>
          </div>
        </div>
      </div>
    );
  };

  if (sortedTransactions.length === 0) {
    return (
      <div className="text-center py-12 text-muted-foreground">
        <p>Nenhuma transaÃ§Ã£o encontrada</p>
      </div>
    );
  }

  return (
    <List height={height} itemCount={sortedTransactions.length} itemSize={itemHeight} width="100%" className="scrollbar-thin">
      {Row}
    </List>
  );
};
```
---

### src\constants\investment-types.ts

**Language:** typescript  
**Size:** 265 Bytes  
**Last Modified:** 2025-11-05T20:22:08.926Z

```typescript
export const INVESTMENT_TYPES = [
  "AÃ§Ãµes",
  "FIIs",
  "Renda Fixa",
  "Tesouro Direto",
  "CDB",
  "LCI/LCA",
  "Criptomoedas",
  "Fundos",
  "PrevidÃªncia",
  "Outro",
] as const;

export type InvestmentType = (typeof INVESTMENT_TYPES)[number];
```
---

### src\contexts\AuthContext.tsx

**Language:** typescript  
**Size:** 7.9 KB  
**Last Modified:** 2025-11-25T19:25:05.271Z

```typescript
import { createContext, useContext, useState, useEffect, ReactNode } from "react";
import { User, Session } from "@supabase/supabase-js";

import { supabase } from "@/integrations/supabase/client";
import { useToast } from "@/hooks/use-toast";

interface AuthContextType {
  user: User | null;
  session: Session | null;
  loading: boolean;
  signUp: (email: string, password: string, fullName?: string) => Promise<{ error: any }>;
  signIn: (email: string, password: string) => Promise<{ error: any }>;
  signOut: () => Promise<void>;
  resetPassword: (email: string) => Promise<{ error: any }>;
  updatePassword: (password: string) => Promise<{ error: any }>;
  // Atualizado para aceitar avatar_url
  updateProfile: (data: {
    full_name?: string;
    age?: number | null;
    gender?: string;
    avatar_url?: string | null;
  }) => Promise<{ error: any }>;
}

const AuthContext = createContext<AuthContextType | undefined>(undefined);

export const useAuth = () => {
  const context = useContext(AuthContext);
  if (context === undefined) {
    throw new Error("useAuth must be used within an AuthProvider");
  }
  return context;
};

interface AuthProviderProps {
  children: ReactNode;
}

export const AuthProvider = ({ children }: AuthProviderProps) => {
  const [user, setUser] = useState<User | null>(null);
  const [session, setSession] = useState<Session | null>(null);
  const [loading, setLoading] = useState(true);
  const { toast } = useToast();

  useEffect(() => {
    const {
      data: { subscription },
    } = supabase.auth.onAuthStateChange((event, session) => {
      setSession(session);
      setUser(session?.user ?? null);
      setLoading(false);

      if (event === "USER_UPDATED") {
        toast({
          title: "Perfil atualizado!",
          description: "Suas informaÃ§Ãµes foram atualizadas.",
        });
      }

      if (event === "PASSWORD_RECOVERY") {
        toast({
          title: "RecuperaÃ§Ã£o de senha",
          description: "VocÃª entrou em modo de recuperaÃ§Ã£o. VÃ¡ em 'Meu Perfil' para definir uma nova senha.",
        });
      }
    });

    supabase.auth.getSession().then(({ data: { session } }) => {
      setSession(session);
      setUser(session?.user ?? null);
      setLoading(false);
    });

    return () => subscription.unsubscribe();
  }, [toast]);

  const signUp = async (email: string, password: string, fullName?: string) => {
    try {
      const redirectUrl = `${window.location.origin}/auth`;

      const { data, error } = await supabase.auth.signUp({
        email,
        password,
        options: {
          emailRedirectTo: redirectUrl,
          data: {
            full_name: fullName,
          },
        },
      });

      if (error) {
        toast({
          title: "Erro no cadastro",
          description: error.message,
          variant: "destructive",
        });
        return { error };
      }

      if (data?.user?.identities?.length === 0) {
        toast({
          title: "Email jÃ¡ cadastrado",
          description: "Este email jÃ¡ possui uma conta. FaÃ§a login ou recupere sua senha.",
          variant: "destructive",
        });
        return { error: { message: "Email jÃ¡ cadastrado" } };
      }

      toast({
        title: "Cadastro realizado!",
        description: "Se o envio de email estiver ativo, verifique sua caixa de entrada para confirmar.",
      });

      return { error: null };
    } catch (error) {
      toast({
        title: "Erro no cadastro",
        description: "Ocorreu um erro ao processar seu cadastro. Tente novamente.",
        variant: "destructive",
      });
      return { error };
    }
  };

  const signIn = async (email: string, password: string) => {
    try {
      const { data, error } = await supabase.auth.signInWithPassword({
        email,
        password,
      });

      if (error) {
        if (error.message.includes("Email not confirmed")) {
          toast({
            title: "Email nÃ£o confirmado",
            description: "Por favor, confirme seu email antes de fazer login. Verifique sua caixa de entrada.",
            variant: "destructive",
          });
        } else if (error.message.includes("Invalid login credentials")) {
          toast({
            title: "Credenciais invÃ¡lidas",
            description: "Email ou senha incorretos. Tente novamente.",
            variant: "destructive",
          });
        } else {
          toast({
            title: "Erro no login",
            description: error.message,
            variant: "destructive",
          });
        }
        return { error };
      }

      toast({
        title: "Login realizado!",
        description: "Bem-vindo ao sistema.",
      });

      return { error: null };
    } catch (error) {
      toast({
        title: "Erro no login",
        description: "Ocorreu um erro ao fazer login. Tente novamente.",
        variant: "destructive",
      });
      return { error };
    }
  };

  const signOut = async () => {
    try {
      await supabase.auth.signOut();
      setUser(null);
      setSession(null);
      toast({
        title: "Logout realizado",
        description: "AtÃ© logo!",
      });
    } catch (error) {
      toast({
        title: "Erro no logout",
        description: "Ocorreu um erro ao fazer logout.",
        variant: "destructive",
      });
    }
  };

  const resetPassword = async (email: string) => {
    try {
      const redirectTo = `${window.location.origin}/profile`;
      const { error } = await supabase.auth.resetPasswordForEmail(email, {
        redirectTo,
      });

      if (error) throw error;

      toast({
        title: "Email enviado",
        description: "Verifique seu email para o link de recuperaÃ§Ã£o de senha.",
      });
      return { error: null };
    } catch (error: any) {
      toast({
        title: "Erro ao recuperar",
        description: error.message || "NÃ£o foi possÃ­vel enviar o email.",
        variant: "destructive",
      });
      return { error };
    }
  };

  const updatePassword = async (password: string) => {
    try {
      const { error } = await supabase.auth.updateUser({ password });
      if (error) throw error;

      toast({
        title: "Sucesso",
        description: "Sua senha foi alterada com sucesso.",
      });
      return { error: null };
    } catch (error: any) {
      toast({
        title: "Erro",
        description: error.message,
        variant: "destructive",
      });
      return { error };
    }
  };

  // FunÃ§Ã£o corrigida para usar UPSERT e garantir que o perfil seja salvo
  const updateProfile = async (data: { full_name?: string; age?: number | null; gender?: string; avatar_url?: string | null }) => {
    if (!user) return { error: "UsuÃ¡rio nÃ£o logado" };

    try {
      const updates = {
        user_id: user.id,
        ...data,
        updated_at: new Date().toISOString(),
      };

      // Upsert: Cria se nÃ£o existir, Atualiza se existir
      // A opÃ§Ã£o { onConflict: 'user_id' } instrui o Supabase a usar o campo user_id para resolver conflitos
      const { error } = await supabase.from("profiles").upsert(updates, { onConflict: "user_id" });

      if (error) throw error;

      toast({ title: "Perfil salvo", description: "Seus dados foram atualizados." });

      return { error: null };
    } catch (error: any) {
      console.error(error);
      toast({
        title: "Erro ao atualizar",
        description: "NÃ£o foi possÃ­vel salvar os dados.",
        variant: "destructive",
      });
      return { error };
    }
  };

  const value = {
    user,
    session,
    loading,
    signUp,
    signIn,
    signOut,
    resetPassword,
    updatePassword,
    updateProfile,
  };

  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;
};
```
---

### src\hooks\use-mobile.tsx

**Language:** typescript  
**Size:** 584 Bytes  
**Last Modified:** 2025-08-28T19:03:37.289Z

```typescript
import * as React from "react"

const MOBILE_BREAKPOINT = 768

export function useIsMobile() {
  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)

  React.useEffect(() => {
    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)
    const onChange = () => {
      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)
    }
    mql.addEventListener("change", onChange)
    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)
    return () => mql.removeEventListener("change", onChange)
  }, [])

  return !!isMobile
}
```
---

### src\hooks\use-toast.ts

**Language:** typescript  
**Size:** 3.99 KB  
**Last Modified:** 2025-08-28T19:03:37.290Z

```typescript
import * as React from "react"

import type {
  ToastActionElement,
  ToastProps,
} from "@/components/ui/toast"

const TOAST_LIMIT = 1
const TOAST_REMOVE_DELAY = 1000000

type ToasterToast = ToastProps & {
  id: string
  title?: React.ReactNode
  description?: React.ReactNode
  action?: ToastActionElement
}

const actionTypes = {
  ADD_TOAST: "ADD_TOAST",
  UPDATE_TOAST: "UPDATE_TOAST",
  DISMISS_TOAST: "DISMISS_TOAST",
  REMOVE_TOAST: "REMOVE_TOAST",
} as const

let count = 0

function genId() {
  count = (count + 1) % Number.MAX_SAFE_INTEGER
  return count.toString()
}

type ActionType = typeof actionTypes

type Action =
  | {
      type: ActionType["ADD_TOAST"]
      toast: ToasterToast
    }
  | {
      type: ActionType["UPDATE_TOAST"]
      toast: Partial<ToasterToast>
    }
  | {
      type: ActionType["DISMISS_TOAST"]
      toastId?: ToasterToast["id"]
    }
  | {
      type: ActionType["REMOVE_TOAST"]
      toastId?: ToasterToast["id"]
    }

interface State {
  toasts: ToasterToast[]
}

const toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()

const addToRemoveQueue = (toastId: string) => {
  if (toastTimeouts.has(toastId)) {
    return
  }

  const timeout = setTimeout(() => {
    toastTimeouts.delete(toastId)
    dispatch({
      type: "REMOVE_TOAST",
      toastId: toastId,
    })
  }, TOAST_REMOVE_DELAY)

  toastTimeouts.set(toastId, timeout)
}

export const reducer = (state: State, action: Action): State => {
  switch (action.type) {
    case "ADD_TOAST":
      return {
        ...state,
        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),
      }

    case "UPDATE_TOAST":
      return {
        ...state,
        toasts: state.toasts.map((t) =>
          t.id === action.toast.id ? { ...t, ...action.toast } : t
        ),
      }

    case "DISMISS_TOAST": {
      const { toastId } = action

      // ! Side effects ! - This could be extracted into a dismissToast() action,
      // but I'll keep it here for simplicity
      if (toastId) {
        addToRemoveQueue(toastId)
      } else {
        state.toasts.forEach((toast) => {
          addToRemoveQueue(toast.id)
        })
      }

      return {
        ...state,
        toasts: state.toasts.map((t) =>
          t.id === toastId || toastId === undefined
            ? {
                ...t,
                open: false,
              }
            : t
        ),
      }
    }
    case "REMOVE_TOAST":
      if (action.toastId === undefined) {
        return {
          ...state,
          toasts: [],
        }
      }
      return {
        ...state,
        toasts: state.toasts.filter((t) => t.id !== action.toastId),
      }
  }
}

const listeners: Array<(state: State) => void> = []

let memoryState: State = { toasts: [] }

function dispatch(action: Action) {
  memoryState = reducer(memoryState, action)
  listeners.forEach((listener) => {
    listener(memoryState)
  })
}

type Toast = Omit<ToasterToast, "id">

function toast({ ...props }: Toast) {
  const id = genId()

  const update = (props: ToasterToast) =>
    dispatch({
      type: "UPDATE_TOAST",
      toast: { ...props, id },
    })
  const dismiss = () => dispatch({ type: "DISMISS_TOAST", toastId: id })

  dispatch({
    type: "ADD_TOAST",
    toast: {
      ...props,
      id,
      open: true,
      onOpenChange: (open) => {
        if (!open) dismiss()
      },
    },
  })

  return {
    id: id,
    dismiss,
    update,
  }
}

function useToast() {
  const [state, setState] = React.useState<State>(memoryState)

  React.useEffect(() => {
    listeners.push(setState)
    return () => {
      const index = listeners.indexOf(setState)
      if (index > -1) {
        listeners.splice(index, 1)
      }
    }
  }, [state])

  return {
    ...state,
    toast,
    dismiss: (toastId?: string) => dispatch({ type: "DISMISS_TOAST", toastId }),
  }
}

export { useToast, toast }
```
---

### src\hooks\usePWA.ts

**Language:** typescript  
**Size:** 1.19 KB  
**Last Modified:** 2025-11-19T20:20:23.739Z

```typescript
import { useEffect, useState } from "react";
import { useRegisterSW } from "virtual:pwa-register/react";

import type { RegisterSWOptions } from "virtual:pwa-register/react";

export const usePWA = () => {
  const [needRefresh, setNeedRefresh] = useState(false);
  const [offlineReady, setOfflineReady] = useState(false);
  const [registration, setRegistration] = useState<ServiceWorkerRegistration | undefined>();

  const {
    offlineReady: pwaOfflineReady,
    needRefresh: pwaNeedRefresh,
    updateServiceWorker,
  } = useRegisterSW({
    onRegistered(r) {
      setRegistration(r);
      console.log("SW Registered:", r);
    },
    onRegisterError(error) {
      console.error("SW registration error", error);
    },
  } as RegisterSWOptions);

  useEffect(() => {
    setOfflineReady(pwaOfflineReady);
  }, [pwaOfflineReady]);

  useEffect(() => {
    setNeedRefresh(pwaNeedRefresh);
  }, [pwaNeedRefresh]);

  const close = () => {
    setOfflineReady(false);
    setNeedRefresh(false);
  };

  const updateApp = () => {
    updateServiceWorker(true);
  };

  return {
    needRefresh,
    offlineReady,
    registration,
    updateApp,
    close,
  };
};
```
---

### src\hooks\useReminders.ts

**Language:** typescript  
**Size:** 5.73 KB  
**Last Modified:** 2025-11-06T17:40:42.071Z

```typescript
import { useState, useEffect, useCallback } from "react";
import { useAuth } from "@/contexts/AuthContext";
import { useToast } from "@/hooks/use-toast";

import { reminderService } from "@/utils/services/reminderService";
import { pushNotificationService } from "@/utils/services/pushNotificationService";

import type { Reminder, ReminderFormData } from "@/utils/types/reminder";

export const useReminders = () => {
  const { user } = useAuth();
  const { toast } = useToast();
  const [reminders, setReminders] = useState<Reminder[]>([]);
  const [loading, setLoading] = useState(true);
  const [isSubscribed, setIsSubscribed] = useState(false);
  const [notificationPermission, setNotificationPermission] = useState<NotificationPermission>("default");

  const loadReminders = useCallback(async () => {
    if (!user) return;

    try {
      setLoading(true);
      const data = await reminderService.getUserReminders(user.id);
      setReminders(data);
    } catch (error) {
      console.error("Erro ao carregar lembretes:", error);
      toast({
        title: "Erro",
        description: "NÃ£o foi possÃ­vel carregar os lembretes",
        variant: "destructive",
      });
    } finally {
      setLoading(false);
    }
  }, [user, toast]);

  const checkNotificationStatus = useCallback(async () => {
    const permission = await pushNotificationService.getPermissionState();
    setNotificationPermission(permission);

    const subscribed = await pushNotificationService.isSubscribed();
    setIsSubscribed(subscribed);
  }, []);

  useEffect(() => {
    loadReminders();
    checkNotificationStatus();
  }, [loadReminders, checkNotificationStatus]);

  // REMOVA ESTE 'useEffect' COMPLETAMENTE.
  // A verificaÃ§Ã£o nÃ£o serÃ¡ mais feita pelo cliente.
  /*
  useEffect(() => {
    if (!user) return;

    const interval = setInterval(async () => {
      await reminderService.checkPendingReminders(user.id);
    }, 15000); 

    return () => clearInterval(interval);
  }, [user]);
  */

  const createReminder = async (data: ReminderFormData, transactionId?: string) => {
    if (!user) {
      toast({
        title: "Erro",
        description: "UsuÃ¡rio nÃ£o autenticado",
        variant: "destructive",
      });
      return;
    }

    try {
      await reminderService.createReminder(user.id, data, transactionId);
      await loadReminders();
      toast({
        title: "Sucesso",
        description: "Lembrete criado com sucesso",
      });
    } catch (error) {
      console.error("Erro ao criar lembrete:", error);
      toast({
        title: "Erro",
        description: "NÃ£o foi possÃ­vel criar o lembrete",
        variant: "destructive",
      });
      throw error;
    }
  };

  const updateReminder = async (id: string, data: Partial<ReminderFormData>) => {
    try {
      await reminderService.updateReminder(id, data);
      await loadReminders();

      toast({
        title: "Sucesso",
        description: "Lembrete atualizado com sucesso",
      });
    } catch (error) {
      console.error("Erro ao atualizar lembrete:", error);
      toast({
        title: "Erro",
        description: "NÃ£o foi possÃ­vel atualizar o lembrete",
        variant: "destructive",
      });
      throw error;
    }
  };

  const deleteReminder = async (id: string) => {
    try {
      await reminderService.deleteReminder(id);
      await loadReminders();

      toast({
        title: "Sucesso",
        description: "Lembrete removido com sucesso",
      });
    } catch (error) {
      console.error("Erro ao remover lembrete:", error);
      toast({
        title: "Erro",
        description: "NÃ£o foi possÃ­vel remover o lembrete",
        variant: "destructive",
      });
      throw error;
    }
  };

  const completeReminder = async (id: string) => {
    try {
      await reminderService.markAsCompleted(id);
      await loadReminders();

      toast({
        title: "Sucesso",
        description: "Lembrete marcado como concluÃ­do",
      });
    } catch (error) {
      console.error("Erro ao completar lembrete:", error);
      toast({
        title: "Erro",
        description: "NÃ£o foi possÃ­vel marcar o lembrete como concluÃ­do",
        variant: "destructive",
      });
      throw error;
    }
  };

  const enableNotifications = async () => {
    if (!user) return;
    try {
      await pushNotificationService.initialize();
      await pushNotificationService.subscribe(user.id);

      setIsSubscribed(true);
      setNotificationPermission("granted");
      toast({
        title: "Sucesso",
        description: "NotificaÃ§Ãµes ativadas com sucesso",
      });
    } catch (error) {
      console.error("Erro ao ativar notificaÃ§Ãµes:", error);
      toast({
        title: "Erro",
        description: "NÃ£o foi possÃ­vel ativar as notificaÃ§Ãµes",
        variant: "destructive",
      });
    }
  };

  const disableNotifications = async () => {
    if (!user) return;
    try {
      await pushNotificationService.unsubscribe(user.id);

      setIsSubscribed(false);
      toast({
        title: "Sucesso",
        description: "NotificaÃ§Ãµes desativadas com sucesso",
      });
    } catch (error) {
      console.error("Erro ao desativar notificaÃ§Ãµes:", error);
      toast({
        title: "Erro",
        description: "NÃ£o foi possÃ­vel desativar as notificaÃ§Ãµes",
        variant: "destructive",
      });
    }
  };

  return {
    reminders,
    loading,
    isSubscribed,
    notificationPermission,
    createReminder,
    updateReminder,
    deleteReminder,
    completeReminder,
    enableNotifications,
    disableNotifications,
    refreshReminders: loadReminders,
  };
};
```
---

### src\hooks\useSanitizedForm.ts

**Language:** typescript  
**Size:** 4.28 KB  
**Last Modified:** 2025-10-31T16:56:13.816Z

```typescript
import { useState, useCallback } from 'react';

import { useToast } from '@/hooks/use-toast';

import { sanitizeObject } from '@/utils/security/sanitize';

import type { SanitizerFunction, ValidatorFunction, ValidationResult } from '@/utils/security/types';

interface UseSanitizedFormOptions<T> {
  initialValues: T;
  sanitizers?: Partial<Record<keyof T, SanitizerFunction>>;
  validators?: Partial<Record<keyof T, ValidatorFunction>>;
  onSubmit: (values: T) => Promise<void> | void;
  validateOnChange?: boolean;
}

interface UseSanitizedFormReturn<T> {
  values: T;
  errors: Partial<Record<keyof T, string>>;
  isSubmitting: boolean;
  handleChange: (field: keyof T, value: any) => void;
  handleSubmit: (e?: React.FormEvent) => Promise<void>;
  setValues: (values: Partial<T>) => void;
  resetForm: () => void;
  validateField: (field: keyof T) => boolean;
  validateAll: () => boolean;
}

export const useSanitizedForm = <T extends Record<string, any>>({
  initialValues,
  sanitizers = {},
  validators = {},
  onSubmit,
  validateOnChange = true,
}: UseSanitizedFormOptions<T>): UseSanitizedFormReturn<T> => {
  const [values, setFormValues] = useState<T>(initialValues);
  const [errors, setErrors] = useState<Partial<Record<keyof T, string>>>({});
  const [isSubmitting, setIsSubmitting] = useState(false);
  const { toast } = useToast();

  const sanitizeValue = useCallback(
    (field: keyof T, value: any): any => {
      const sanitizer = sanitizers[field];
      return sanitizer ? sanitizer(value) : value;
    },
    [sanitizers]
  );

  const validateField = useCallback(
    (field: keyof T): boolean => {
      const validator = validators[field];
      
      if (!validator) {
        setErrors(prev => {
          const next = { ...prev };
          delete next[field];
          return next;
        });
        return true;
      }

      const result: ValidationResult = validator(values[field]);

      if (!result.isValid) {
        setErrors(prev => ({
          ...prev,
          [field]: result.error || 'Erro de validaÃ§Ã£o',
        }));
        return false;
      }

      setErrors(prev => {
        const next = { ...prev };
        delete next[field];
        return next;
      });
      return true;
    },
    [validators, values]
  );

  const validateAll = useCallback((): boolean => {
    const fields = Object.keys(validators) as (keyof T)[];
    const results = fields.map(field => validateField(field));
    return results.every(result => result);
  }, [validators, validateField]);

  const handleChange = useCallback(
    (field: keyof T, value: any): void => {
      const sanitizedValue = sanitizeValue(field, value);

      setFormValues(prev => ({
        ...prev,
        [field]: sanitizedValue,
      }));

      if (validateOnChange && validators[field]) {
        setTimeout(() => validateField(field), 0);
      }
    },
    [sanitizeValue, validateOnChange, validators, validateField]
  );

  const setValues = useCallback(
    (newValues: Partial<T>): void => {
      const sanitizedValues = sanitizeObject(newValues, sanitizers);
      
      setFormValues(prev => ({
        ...prev,
        ...sanitizedValues,
      }));
    },
    [sanitizers]
  );

  const resetForm = useCallback((): void => {
    setFormValues(initialValues);
    setErrors({});
    setIsSubmitting(false);
  }, [initialValues]);

  const handleSubmit = useCallback(
    async (e?: React.FormEvent): Promise<void> => {
      if (e) {
        e.preventDefault();
      }

      const isValid = validateAll();

      if (!isValid) {
        toast({
          title: 'Erro de validaÃ§Ã£o',
          description: 'Corrija os erros antes de continuar',
          variant: 'destructive',
        });
        return;
      }

      setIsSubmitting(true);

      try {
        await onSubmit(values);
      } catch (error) {
        console.error('Erro ao submeter formulÃ¡rio:', error);
        toast({
          title: 'Erro',
          description: error instanceof Error ? error.message : 'Erro ao processar formulÃ¡rio',
          variant: 'destructive',
        });
      } finally {
        setIsSubmitting(false);
      }
    },
    [validateAll, onSubmit, values, toast]
  );

  return {
    values,
    errors,
    isSubmitting,
    handleChange,
    handleSubmit,
    setValues,
    resetForm,
    validateField,
    validateAll,
  };
};
```
---

### src\index.css

**Language:** css  
**Size:** 4.05 KB  
**Last Modified:** 2025-11-05T17:25:04.903Z

```css
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 222.2 84% 4.9%;
    --card: 0 0% 100%;
    --card-foreground: 222.2 84% 4.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 222.2 84% 4.9%;

    --primary: 142 71% 45%;
    --primary-foreground: 0 0% 100%;

    --secondary: 210 40% 96.1%;
    --secondary-foreground: 222.2 47.4% 11.2%;

    --muted: 210 40% 96.1%;
    --muted-foreground: 215.4 16.3% 46.9%;

    --accent: 210 40% 96.1%;
    --accent-foreground: 222.2 47.4% 11.2%;

    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 0 0% 98%;

    --success: 142 71% 45%;
    --success-foreground: 0 0% 100%;

    --warning: 38 92% 50%;
    --warning-foreground: 0 0% 100%;

    --income: 142 71% 45%;
    --income-foreground: 0 0% 100%;

    --expense: 0 72% 51%;
    --expense-foreground: 0 0% 100%;

    --investment: 221 83% 53%;
    --investment-foreground: 0 0% 100%;

    --border: 214.3 31.8% 91.4%;
    --input: 214.3 31.8% 91.4%;
    --ring: 142 71% 45%;

    --radius: 0.5rem;

    --sidebar-background: 0 0% 98%;
    --sidebar-foreground: 222.2 47.4% 11.2%;
    --sidebar-primary: 142 71% 45%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 210 40% 96.1%;
    --sidebar-accent-foreground: 222.2 47.4% 11.2%;
    --sidebar-border: 214.3 31.8% 91.4%;
    --sidebar-ring: 142 71% 45%;

    --gradient-income: linear-gradient(135deg, hsl(142 71% 45%) 0%, hsl(158 64% 52%) 100%);
    --gradient-expense: linear-gradient(135deg, hsl(0 72% 51%) 0%, hsl(0 72% 41%) 100%);
    --gradient-investment: linear-gradient(135deg, hsl(221 83% 53%) 0%, hsl(221 83% 43%) 100%);
    --gradient-card: linear-gradient(135deg, hsl(0 0% 100%) 0%, hsl(210 40% 98%) 100%);
    --gradient-primary: linear-gradient(135deg, hsl(0 0% 100%) 0%, hsl(0 0% 100%) 100%);

    --shadow-financial: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
  }

  .dark {
    --background: 222.2 84% 4.9%;
    --foreground: 210 40% 98%;
    --card: 222.2 84% 4.9%;
    --card-foreground: 210 40% 98%;
    --popover: 222.2 84% 4.9%;
    --popover-foreground: 210 40% 98%;

    --primary: 142 71% 45%;
    --primary-foreground: 0 0% 100%;

    --secondary: 217.2 32.6% 17.5%;
    --secondary-foreground: 210 40% 98%;

    --muted: 217.2 32.6% 17.5%;
    --muted-foreground: 215 20.2% 65.1%;

    --accent: 217.2 32.6% 17.5%;
    --accent-foreground: 210 40% 98%;

    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 210 40% 98%;

    --success: 142 71% 45%;
    --success-foreground: 0 0% 100%;

    --warning: 38 92% 50%;
    --warning-foreground: 0 0% 100%;

    --income: 142 71% 45%;
    --income-foreground: 0 0% 100%;

    --expense: 0 63% 40%;
    --expense-foreground: 210 40% 98%;

    --investment: 221 83% 53%;
    --investment-foreground: 0 0% 100%;

    --border: 217.2 32.6% 17.5%;
    --input: 217.2 32.6% 17.5%;
    --ring: 142 71% 45%;

    --sidebar-background: 222.2 84% 4.9%;
    --sidebar-foreground: 210 40% 98%;
    --sidebar-primary: 142 71% 45%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 217.2 32.6% 17.5%;
    --sidebar-accent-foreground: 210 40% 98%;
    --sidebar-border: 217.2 32.6% 17.5%;
    --sidebar-ring: 142 71% 45%;

    --gradient-income: linear-gradient(135deg, hsl(142 71% 45%) 0%, hsl(142 71% 35%) 100%);
    --gradient-expense: linear-gradient(135deg, hsl(0 63% 40%) 0%, hsl(0 63% 30%) 100%);
    --gradient-investment: linear-gradient(135deg, hsl(221 83% 53%) 0%, hsl(221 83% 43%) 100%);
    --gradient-card: linear-gradient(135deg, hsl(222 84% 4.9%) 0%, hsl(217 32% 17.5%) 100%);
    --gradient-primary: linear-gradient(135deg, hsl(217 32% 17.5%) 0%, hsl(217 32% 12%) 100%);

    --shadow-financial: 0 4px 6px -1px rgb(0 0 0 / 0.3), 0 2px 4px -2px rgb(0 0 0 / 0.3);
  }
}

@layer base {
  * {
    border-color: hsl(var(--border));
  }

  body {
    background-color: hsl(var(--background));
    color: hsl(var(--foreground));
  }
}
```
---

### src\integrations\supabase\client.ts

**Language:** typescript  
**Size:** 435 Bytes  
**Last Modified:** 2025-10-30T19:20:35.288Z

```typescript
import { createClient } from "@supabase/supabase-js";
import type { Database } from "./types";

const SUPABASE_URL = import.meta.env.VITE_SUPABASE_URL;
const SUPABASE_PUBLISHABLE_KEY = import.meta.env.VITE_SUPABASE_PUBLISHABLE_KEY;

export const supabase = createClient<Database>(SUPABASE_URL, SUPABASE_PUBLISHABLE_KEY, {
  auth: {
    storage: localStorage,
    persistSession: true,
    autoRefreshToken: true,
  },
});
```
---

### src\integrations\supabase\types.ts

**Language:** typescript  
**Size:** 7.87 KB  
**Last Modified:** 2025-12-03T21:27:10.887Z

```typescript
export type Json = string | number | boolean | null | { [key: string]: Json | undefined } | Json[];

export type Database = {
  public: {
    Tables: {
      group_members: {
        Row: {
          group_id: string;
          id: string;
          is_admin: boolean;
          joined_at: string;
          user_id: string;
        };
        Insert: {
          group_id: string;
          id?: string;
          is_admin?: boolean;
          joined_at?: string;
          user_id: string;
        };
        Update: {
          group_id?: string;
          id?: string;
          is_admin?: boolean;
          joined_at?: string;
          user_id?: string;
        };
        Relationships: [
          {
            foreignKeyName: "group_members_group_id_fkey";
            columns: ["group_id"];
            isOneToOne: false;
            referencedRelation: "groups";
            referencedColumns: ["id"];
          }
        ];
      };
      group_invites: {
  Row: {
    id: string;
    group_id: string;
    email: string;
    invited_by: string;
    status: "pending" | "accepted" | "rejected";
    created_at: string;
  };
  Insert: {
    group_id: string;
    email: string;
    invited_by?: string;
    status?: "pending" | "accepted" | "rejected";
  };
  Update: {
    status?: "pending" | "accepted" | "rejected";
  };
}
      groups: {
        Row: {
          color: string | null;
          created_at: string;
          created_by: string;
          description: string | null;
          id: string;
          name: string;
          updated_at: string;
        };
        Insert: {
          color?: string | null;
          created_at?: string;
          created_by: string;
          description?: string | null;
          id?: string;
          name: string;
          updated_at?: string;
        };
        Update: {
          color?: string | null;
          created_at?: string;
          created_by?: string;
          description?: string | null;
          id?: string;
          name?: string;
          updated_at?: string;
        };
        Relationships: [];
      };
      investment_goals: {
        Row: {
          color: string | null;
          created_at: string;
          current_amount: number;
          description: string | null;
          id: string;
          name: string;
          target_amount: number;
          target_date: string | null;
          updated_at: string;
          user_id: string;
        };
        Insert: {
          color?: string | null;
          created_at?: string;
          current_amount?: number;
          description?: string | null;
          id?: string;
          name: string;
          target_amount: number;
          target_date?: string | null;
          updated_at?: string;
          user_id: string;
        };
        Update: {
          color?: string | null;
          created_at?: string;
          current_amount?: number;
          description?: string | null;
          id?: string;
          name?: string;
          target_amount?: number;
          target_date?: string | null;
          updated_at?: string;
          user_id?: string;
        };
        Relationships: [];
      };
      investments: {
        Row: {
          amount: number;
          created_at: string;
          current_value: number;
          group_id: string | null;
          id: string;
          maturity_date: string | null;
          name: string;
          type: string;
          updated_at: string;
          user_id: string;
          quantity: number | null;
          unit_price: number | null;
        };
        Insert: {
          amount: number;
          created_at?: string;
          current_value: number;
          group_id?: string | null;
          id?: string;
          maturity_date?: string | null;
          name: string;
          type: string;
          updated_at?: string;
          user_id: string;
          quantity: number | null;
          unit_price: number | null;
        };
        Update: {
          amount?: number;
          created_at?: string;
          current_value?: number;
          group_id?: string | null;
          id?: string;
          maturity_date?: string | null;
          name?: string;
          type?: string;
          updated_at?: string;
          user_id?: string;
          quantity: number | null;
          unit_price: number | null;
        };
        Relationships: [
          {
            foreignKeyName: "investments_group_id_fkey";
            columns: ["group_id"];
            isOneToOne: false;
            referencedRelation: "groups";
            referencedColumns: ["id"];
          }
        ];
      };
      profiles: {
        Row: {
          avatar_url: string | null;
          created_at: string;
          full_name: string | null;
          id: string;
          updated_at: string;
          user_id: string;
          age: number | null;
          gender: string | null;
        };
        Insert: {
          avatar_url?: string | null;
          created_at?: string;
          full_name?: string | null;
          id?: string;
          updated_at?: string;
          user_id: string;
          age?: number | null;
          gender?: string | null;
        };
        Update: {
          avatar_url?: string | null;
          created_at?: string;
          full_name?: string | null;
          id?: string;
          updated_at?: string;
          user_id?: string;
          age?: number | null;
          gender?: string | null;
        };
        Relationships: [];
      };
      transactions: {
        Row: {
          amount: number;
          category: string;
          created_at: string;
          date: string;
          description: string;
          group_id: string | null;
          id: string;
          type: string;
          updated_at: string;
          user_id: string;
          event_id: string | null;
        };
        Insert: {
          amount: number;
          category: string;
          created_at?: string;
          date?: string;
          description: string;
          group_id?: string | null;
          id?: string;
          type: string;
          updated_at?: string;
          user_id: string;
          event_id?: string | null;
        };
        Update: {
          amount?: number;
          category?: string;
          created_at?: string;
          date?: string;
          description?: string;
          group_id?: string | null;
          id?: string;
          type?: string;
          updated_at?: string;
          user_id?: string;
          event_id?: string | null;
        };
        Relationships: [
          {
            foreignKeyName: "transactions_group_id_fkey";
            columns: ["group_id"];
            isOneToOne: false;
            referencedRelation: "groups";
            referencedColumns: ["id"];
          }
        ];
      };
      events: {
        Row: {
          id: string;
          user_id: string;
          name: string;
          description: string | null;
          date: string;
          created_at: string;
        };
        Insert: {
          id?: string;
          user_id: string;
          name: string;
          description?: string | null;
          date: string;
          created_at?: string;
        };
        Update: {
          id?: string;
          user_id?: string;
          name?: string;
          description?: string | null;
          date?: string;
          created_at?: string;
        };
        Relationships: [];
      };
    };
    Views: {
      [_ in never]: never;
    };
    Functions: {
      [_ in never]: never;
    };
    Enums: {
      [_ in never]: never;
    };
    CompositeTypes: {
      [_ in never]: never;
    };
  };
};
```
---

### src\lib\date.ts

**Language:** typescript  
**Size:** 236 Bytes  
**Last Modified:** 2025-10-31T13:48:32.130Z

```typescript
export {
  format,
  startOfMonth,
  endOfMonth,
  startOfYear,
  endOfYear,
  subMonths,
  addMonths,
  isAfter,
  isBefore,
  parseISO,
  addDays,
  subDays,
} from 'date-fns';

export { ptBR } from 'date-fns/locale';
```
---

### src\lib\icons.ts

**Language:** typescript  
**Size:** 717 Bytes  
**Last Modified:** 2025-11-27T21:39:43.150Z

```typescript
export {
  ArrowUpCircle,
  ArrowDownCircle,
  ArrowRight,
  BarChart3,
  Shield,
  TrendingUp,
  TrendingDown,
  DollarSign,
  PiggyBank,
  Calendar,
  Search,
  Filter,
  ChevronUp,
  Plus,
  PlusCircle,
  MinusCircle,
  Trash2,
  Eye,
  Edit,
  X,
  Check,
  ChevronLeft,
  ChevronRight,
  Menu,
  LogOut,
  Users,
  Settings,
  Home,
  FileText,
  Target,
  Wallet,
  AlertCircle,
  Info,
  ChevronDown,
  MoreHorizontal,
  EyeOff,
  LayoutDashboard,
  ArrowUpDown,
  PieChart,
  UserPlus,
  UserMinus,
  Bell,
  Layers,
  User,
  Moon,
  Sun,
  Laptop,
  Lock,
  Mail,
  Camera,
  AlertTriangle,
  Loader2,
  Copy,
  Link,
  Scale,
} from "lucide-react";
```
---

### src\lib\utils.ts

**Language:** typescript  
**Size:** 172 Bytes  
**Last Modified:** 2025-08-28T19:03:37.293Z

```typescript
import { clsx, type ClassValue } from "clsx"
import { twMerge } from "tailwind-merge"

export function cn(...inputs: ClassValue[]) {
  return twMerge(clsx(inputs))
}
```
---

### src\main.tsx

**Language:** typescript  
**Size:** 331 Bytes  
**Last Modified:** 2025-09-02T14:20:28.357Z

```typescript
import { createRoot } from 'react-dom/client'
import App from './App.tsx'
import './index.css'
import { AuthProvider } from './contexts/AuthContext'
import { Toaster } from './components/ui/toaster'

createRoot(document.getElementById("root")!).render(
  <AuthProvider>
    <App />
    <Toaster />
  </AuthProvider>
);
```
---

### src\pages\Auth.tsx

**Language:** typescript  
**Size:** 12.57 KB  
**Last Modified:** 2025-11-25T18:57:10.697Z

```typescript
import { useState } from "react";
import { useAuth } from "@/contexts/AuthContext";
import { Navigate } from "react-router-dom";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@/components/ui/tabs";
import { Eye, EyeOff, TrendingUp, Shield, Users, BarChart3 } from "@/lib/icons";
import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogTrigger } from "@/components/ui/dialog";

export default function Auth() {
  const { user, signIn, signUp, resetPassword, loading } = useAuth();
  const [showPassword, setShowPassword] = useState(false);
  const [isSubmitting, setIsSubmitting] = useState(false);
  const [forgotPasswordOpen, setForgotPasswordOpen] = useState(false);
  const [resetEmail, setResetEmail] = useState("");

  const [loginData, setLoginData] = useState({
    email: "",
    password: "",
  });

  const [registerData, setRegisterData] = useState({
    fullName: "",
    email: "",
    password: "",
    confirmPassword: "",
  });

  // Redirect if already authenticated
  if (user) {
    return <Navigate to="/" replace />;
  }

  if (loading) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-gradient-primary">
        <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
      </div>
    );
  }

  const handleLogin = async (e: React.FormEvent) => {
    e.preventDefault();
    setIsSubmitting(true);

    await signIn(loginData.email, loginData.password);
    setIsSubmitting(false);
  };

  const handleRegister = async (e: React.FormEvent) => {
    e.preventDefault();

    if (registerData.password !== registerData.confirmPassword) {
      return;
    }

    setIsSubmitting(true);
    const { error } = await signUp(registerData.email, registerData.password, registerData.fullName);
    if (!error) {
      // Clear form on successful registration
      setRegisterData({ fullName: "", email: "", password: "", confirmPassword: "" });
    }
    setIsSubmitting(false);
  };

  const handleResetPassword = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!resetEmail) return;
    setIsSubmitting(true);
    await resetPassword(resetEmail);
    setIsSubmitting(false);
    setForgotPasswordOpen(false);
  };

  return (
    <div className="min-h-screen bg-gradient-primary flex items-center justify-center p-4">
      <div className="w-full max-w-6xl grid lg:grid-cols-2 gap-8 items-center">
        <div className="hidden lg:block space-y-8 text-foreground">
          <div className="space-y-4">
            <h1 className="text-4xl font-bold bg-gradient-income bg-clip-text text-transparent">Controle Financeiro Inteligente</h1>
            <p className="text-xl text-muted-foreground">Gerencie suas finanÃ§as pessoais e em grupo com facilidade e seguranÃ§a</p>
          </div>

          <div className="grid grid-cols-2 gap-6">
            <div className="space-y-2">
              <div className="flex items-center gap-2">
                <TrendingUp className="h-5 w-5 text-income" />
                <h3 className="font-semibold">Controle Completo</h3>
              </div>
              <p className="text-sm text-muted-foreground">Acompanhe receitas, despesas e investimentos</p>
            </div>

            <div className="space-y-2">
              <div className="flex items-center gap-2">
                <Users className="h-5 w-5 text-accent" />
                <h3 className="font-semibold">Grupos</h3>
              </div>
              <p className="text-sm text-muted-foreground">Compartilhe despesas com famÃ­lia e amigos</p>
            </div>

            <div className="space-y-2">
              <div className="flex items-center gap-2">
                <BarChart3 className="h-5 w-5 text-investment" />
                <h3 className="font-semibold">RelatÃ³rios</h3>
              </div>
              <p className="text-sm text-muted-foreground">Visualize seus dados financeiros</p>
            </div>

            <div className="space-y-2">
              <div className="flex items-center gap-2">
                <Shield className="h-5 w-5 text-success" />
                <h3 className="font-semibold">Seguro</h3>
              </div>
              <p className="text-sm text-muted-foreground">Seus dados protegidos e criptografados</p>
            </div>
          </div>
        </div>

        {/* Right side - Auth forms */}
        <Card className="w-full max-w-md mx-auto bg-card/95 backdrop-blur shadow-financial border-0">
          <CardHeader>
            <CardTitle className="text-2xl font-bold text-center">Bem-vindo</CardTitle>
            <CardDescription className="text-center">Entre na sua conta ou crie uma nova</CardDescription>
          </CardHeader>
          <CardContent>
            <Tabs defaultValue="login" className="w-full">
              <TabsList className="grid w-full grid-cols-2">
                <TabsTrigger value="login">Entrar</TabsTrigger>
                <TabsTrigger value="register">Cadastrar</TabsTrigger>
              </TabsList>

              <TabsContent value="login" className="space-y-4">
                <form onSubmit={handleLogin} className="space-y-4">
                  <div className="space-y-2">
                    <Label htmlFor="email">Email</Label>
                    <Input
                      id="email"
                      type="email"
                      placeholder="seu@email.com"
                      value={loginData.email}
                      onChange={(e) => setLoginData((prev) => ({ ...prev, email: e.target.value }))}
                      required
                    />
                  </div>

                  <div className="space-y-2">
                    <Label htmlFor="password">Senha</Label>
                    <div className="relative">
                      <Input
                        id="password"
                        type={showPassword ? "text" : "password"}
                        placeholder="Sua senha"
                        value={loginData.password}
                        autoComplete="off"
                        onChange={(e) => setLoginData((prev) => ({ ...prev, password: e.target.value }))}
                        required
                      />
                      <Button
                        type="button"
                        variant="ghost"
                        size="sm"
                        className="absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent"
                        onClick={() => setShowPassword(!showPassword)}
                      >
                        {showPassword ? <EyeOff className="h-4 w-4" /> : <Eye className="h-4 w-4" />}
                      </Button>
                    </div>
                  </div>

                  <div className="flex justify-end">
                    <Dialog open={forgotPasswordOpen} onOpenChange={setForgotPasswordOpen}>
                      <DialogTrigger asChild>
                        <Button variant="link" className="px-0 text-xs text-muted-foreground" type="button">
                          Esqueci minha senha
                        </Button>
                      </DialogTrigger>
                      <DialogContent>
                        <DialogHeader>
                          <DialogTitle>Recuperar Senha</DialogTitle>
                          <DialogDescription>Digite seu email para receber um link de recuperaÃ§Ã£o de senha.</DialogDescription>
                        </DialogHeader>
                        <form onSubmit={handleResetPassword} className="space-y-4 mt-4">
                          <div className="space-y-2">
                            <Label htmlFor="reset-email">Email</Label>
                            <Input
                              id="reset-email"
                              type="email"
                              placeholder="seu@email.com"
                              value={resetEmail}
                              onChange={(e) => setResetEmail(e.target.value)}
                              required
                            />
                          </div>
                          <Button type="submit" className="w-full" disabled={isSubmitting}>
                            {isSubmitting ? "Enviando..." : "Enviar Link"}
                          </Button>
                        </form>
                      </DialogContent>
                    </Dialog>
                  </div>

                  <Button type="submit" className="w-full bg-gradient-income hover:opacity-90 transition-opacity" disabled={isSubmitting}>
                    {isSubmitting ? "Entrando..." : "Entrar"}
                  </Button>
                </form>
              </TabsContent>

              <TabsContent value="register" className="space-y-4">
                <form onSubmit={handleRegister} className="space-y-4">
                  <div className="space-y-2">
                    <Label htmlFor="fullName">Nome completo</Label>
                    <Input
                      id="fullName"
                      placeholder="Seu nome completo"
                      value={registerData.fullName}
                      onChange={(e) => setRegisterData((prev) => ({ ...prev, fullName: e.target.value }))}
                      required
                    />
                  </div>

                  <div className="space-y-2">
                    <Label htmlFor="registerEmail">Email</Label>
                    <Input
                      id="registerEmail"
                      type="email"
                      placeholder="seu@email.com"
                      value={registerData.email}
                      onChange={(e) => setRegisterData((prev) => ({ ...prev, email: e.target.value }))}
                      required
                    />
                  </div>

                  <div className="space-y-2">
                    <Label htmlFor="registerPassword">Senha</Label>
                    <div className="relative">
                      <Input
                        id="registerPassword"
                        type={showPassword ? "text" : "password"}
                        placeholder="Crie uma senha"
                        value={registerData.password}
                        autoComplete="off"
                        onChange={(e) => setRegisterData((prev) => ({ ...prev, password: e.target.value }))}
                        required
                      />
                      <Button
                        type="button"
                        variant="ghost"
                        size="sm"
                        className="absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent"
                        onClick={() => setShowPassword(!showPassword)}
                      >
                        {showPassword ? <EyeOff className="h-4 w-4" /> : <Eye className="h-4 w-4" />}
                      </Button>
                    </div>
                  </div>

                  <div className="space-y-2">
                    <Label htmlFor="confirmPassword">Confirmar senha</Label>
                    <Input
                      id="confirmPassword"
                      type={showPassword ? "text" : "password"}
                      placeholder="Confirme sua senha"
                      value={registerData.confirmPassword}
                      autoComplete="off"
                      onChange={(e) => setRegisterData((prev) => ({ ...prev, confirmPassword: e.target.value }))}
                      required
                    />
                  </div>

                  <Button
                    type="submit"
                    className="w-full bg-gradient-investment hover:opacity-90 transition-opacity"
                    disabled={isSubmitting || registerData.password !== registerData.confirmPassword}
                  >
                    {isSubmitting ? "Cadastrando..." : "Cadastrar"}
                  </Button>

                  {registerData.password !== registerData.confirmPassword && registerData.confirmPassword && (
                    <p className="text-sm text-expense">As senhas nÃ£o coincidem</p>
                  )}
                </form>
              </TabsContent>
            </Tabs>
          </CardContent>
        </Card>
      </div>
    </div>
  );
}
```
---

### src\pages\Dashboard.tsx

**Language:** typescript  
**Size:** 7.06 KB  
**Last Modified:** 2025-12-01T13:30:11.753Z

```typescript
import { useState, useEffect } from "react";
import { DashboardLayout } from "@/components/layout/DashboardLayout";
import { MetricCard } from "@/components/dashboard/MetricCard";
import { TransactionsList } from "@/components/dashboard/TransactionsList";
import { AddTransactionDialog } from "@/components/dialogs/AddTransactionDialog";
import { AddInvestmentDialog } from "@/components/dialogs/AddInvestmentDialog";
import { DateFilter, DateRange } from "@/components/filters/DateFilter";
import { DollarSign, TrendingUp, TrendingDown, PiggyBank, Filter } from "@/lib/icons";
import { Button } from "@/components/ui/button";
import { Card, CardContent, CardHeader, CardTitle, CardDescription } from "@/components/ui/card";
import { startOfMonth, endOfMonth, format } from "@/lib/date";
import { supabase } from "@/integrations/supabase/client";
import { useToast } from "@/hooks/use-toast";
import { FixedBalanceCard } from "@/components/dashboard/FixedBalanceCard";

const Dashboard = () => {
  const [dateRange, setDateRange] = useState<DateRange>({
    from: startOfMonth(new Date()),
    to: endOfMonth(new Date()),
  });
  const [metrics, setMetrics] = useState({
    totalBalance: 0,
    totalIncome: 0,
    totalExpenses: 0,
    totalInvestments: 0,
  });
  const [loading, setLoading] = useState(true);
  const { toast } = useToast();

  // Carrega dados iniciais e sempre que a data mudar
  useEffect(() => {
    loadMetrics();
  }, [dateRange]);

  // CONFIGURAÃ‡ÃƒO DO REALTIME (TEMPO REAL)
  useEffect(() => {
    // Inscreve-se para ouvir mudanÃ§as nas tabelas
    const channel = supabase
      .channel("dashboard-changes")
      .on("postgres_changes", { event: "*", schema: "public", table: "transactions" }, (payload) => {
        console.log("MudanÃ§a detectada em transaÃ§Ãµes:", payload);
        loadMetrics(); // Recarrega os dados quando houver mudanÃ§a
      })
      .on("postgres_changes", { event: "*", schema: "public", table: "investments" }, () => {
        loadMetrics();
      })
      .subscribe();

    // Limpeza ao sair da pÃ¡gina
    return () => {
      supabase.removeChannel(channel);
    };
  }, [dateRange]); // DependÃªncia dateRange garante que o reload use as datas certas

  const loadMetrics = async () => {
    try {
      // NÃ£o ativamos o setLoading(true) aqui para evitar "piscar" a tela em atualizaÃ§Ãµes automÃ¡ticas
      // Apenas na primeira carga ou mudanÃ§a de data manual pode ser interessante,
      // mas para realtime Ã© melhor ser silencioso.

      const { data: transactions, error: transError } = await supabase
        .from("transactions")
        .select("amount, type, date")
        .gte("date", format(dateRange.from, "yyyy-MM-dd"))
        .lte("date", format(dateRange.to, "yyyy-MM-dd"));

      if (transError) throw transError;

      const { data: investments, error: invError } = await supabase.from("investments").select("current_value, amount, created_at");

      if (invError) throw invError;

      // CÃ¡lculos
      const income = transactions?.filter((t) => t.type === "income").reduce((sum, t) => sum + Number(t.amount), 0) || 0;

      const expenses = transactions?.filter((t) => t.type === "expense").reduce((sum, t) => sum + Number(t.amount), 0) || 0;

      const totalInvestments = investments?.reduce((sum, inv) => sum + Number(inv.current_value), 0) || 0;

      //O valor do saldo Ã© receita - despesa. Como as despesas sÃ£o negativas, somamos os valores (saldo = receita + despesa negativa)
      const balance = income + expenses;

      setMetrics({
        totalBalance: balance,
        totalIncome: income,
        totalExpenses: expenses,
        totalInvestments: totalInvestments,
      });
    } catch (error) {
      console.error("Erro ao carregar mÃ©tricas:", error);
    } finally {
      setLoading(false);
    }
  };

  return (
    <DashboardLayout>
      <div className="p-6 space-y-6">
        {/* Header */}
        <div className="flex justify-between items-center">
          <div>
            <h1 className="text-3xl font-bold text-foreground">Dashboard</h1>
            <p className="text-muted-foreground">
              VisÃ£o geral das suas finanÃ§as em {new Date().toLocaleDateString("pt-BR", { month: "long", year: "numeric" })}
            </p>
          </div>
          <DateFilter dateRange={dateRange} onDateRangeChange={setDateRange} />
        </div>

        {/* Metrics Cards */}
        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
          {loading ? (
            [...Array(4)].map((_, i) => <div key={i} className="h-32 bg-muted rounded-lg animate-pulse" />)
          ) : (
            <>
              <MetricCard
                title="Saldo do PerÃ­odo"
                value={metrics.totalBalance.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                icon={<DollarSign className="h-5 w-5 text-primary" />}
                changeType={metrics.totalBalance >= 0 ? "positive" : "negative"}
              />
              <MetricCard
                title="Receitas"
                value={metrics.totalIncome.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                icon={<TrendingUp className="h-5 w-5 text-success" />}
                changeType="positive"
              />
              <MetricCard
                title="Despesas"
                value={metrics.totalExpenses.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                icon={<TrendingDown className="h-5 w-5 text-destructive" />}
                changeType="negative"
              />
              <MetricCard
                title="PatrimÃ´nio Investido"
                value={metrics.totalInvestments.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                icon={<PiggyBank className="h-5 w-5 text-accent" />}
                changeType="positive"
              />
            </>
          )}
        </div>

        {/* Charts and Recent Transactions */}
        <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <FixedBalanceCard />
          <TransactionsList />
        </div>

        {/* Quick Actions */}
        <Card>
          <CardHeader>
            <CardTitle>AÃ§Ãµes RÃ¡pidas</CardTitle>
            <CardDescription>Acesse rapidamente as funcionalidades mais utilizadas</CardDescription>
          </CardHeader>
          <CardContent>
            <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
              <AddTransactionDialog type="income" onSuccess={loadMetrics} />
              <AddTransactionDialog type="expense" onSuccess={loadMetrics} />
              <AddInvestmentDialog onSuccess={loadMetrics} />
              <Button variant="outline" className="h-20 flex flex-col gap-2">
                <DollarSign className="h-6 w-6" />
                <span className="text-sm">Ver RelatÃ³rios</span>
              </Button>
            </div>
          </CardContent>
        </Card>
      </div>
    </DashboardLayout>
  );
};

export default Dashboard;
```
---

### src\pages\Groups.tsx

**Language:** typescript  
**Size:** 18.82 KB  
**Last Modified:** 2025-11-27T18:34:38.864Z

```typescript
import React, { useState, useEffect } from "react";
import { Users, Wallet, TrendingDown, TrendingUp, Clock, CheckCircle, XCircle, AlertCircle } from "lucide-react";

import { DashboardLayout } from "@/components/layout/DashboardLayout";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import { useToast } from "@/hooks/use-toast";
import { supabase } from "@/integrations/supabase/client";
import { AddGroupDialog } from "@/components/dialogs/AddGroupDialog";
import { EditGroupDialog } from "@/components/dialogs/EditGroupDialog";
import { GroupDetailsModal } from "@/components/groups/GroupDetailsModal";

interface Group {
  id: string;
  name: string;
  description: string;
  color: string;
  created_by: string;
  memberCount: number;
  members: Array<{
    user_id: string;
    joined_at: string;
    profiles: {
      full_name: string | null;
    } | null;
  }>;
  totalExpenses: number;
  totalIncome: number;
  lastActivity: string | null;
}

interface Invite {
  id: string;
  group_id: string;
  status: string;
  groups: {
    name: string;
    description: string;
    created_by: string;
  } | null;
}

const Groups = () => {
  const [groups, setGroups] = useState<Group[]>([]);
  const [invites, setInvites] = useState<Invite[]>([]);
  const [loading, setLoading] = useState(true);
  const [currentUserId, setCurrentUserId] = useState<string | null>(null);
  const [selectedGroup, setSelectedGroup] = useState<{ id: string; name: string } | null>(null);
  const [editGroupId, setEditGroupId] = useState<string | null>(null);
  const [editDialogOpen, setEditDialogOpen] = useState(false);
  const { toast } = useToast();

  // --- REALTIME: ATUALIZAÃ‡ÃƒO AUTOMÃTICA ---
  useEffect(() => {
    // Escuta mudanÃ§as em transaÃ§Ãµes, grupos e membros para atualizar a tela sem F5
    const channel = supabase
      .channel("groups-page-realtime")
      .on("postgres_changes", { event: "*", schema: "public", table: "transactions" }, () => fetchGroups())
      .on("postgres_changes", { event: "*", schema: "public", table: "groups" }, () => fetchGroups())
      .on("postgres_changes", { event: "*", schema: "public", table: "group_members" }, () => fetchGroups())
      .on("postgres_changes", { event: "*", schema: "public", table: "group_invites" }, () => fetchInvites())
      .subscribe();

    return () => {
      supabase.removeChannel(channel);
    };
  }, []);

  const fetchGroups = async () => {
    try {
      const {
        data: { user },
      } = await supabase.auth.getUser();
      if (!user) return;

      setCurrentUserId(user.id);

      const { data: createdGroups, error: createdError } = await supabase.from("groups").select("*").eq("created_by", user.id);

      if (createdError) throw createdError;

      const { data: memberGroups, error: memberError } = await supabase
        .from("group_members")
        .select(
          `
          groups (*)
        `
        )
        .eq("user_id", user.id);

      if (memberError) throw memberError;

      const allGroups = [...(createdGroups || []), ...(memberGroups?.map((mg) => mg.groups).filter(Boolean) || [])];
      const uniqueGroups = allGroups.filter((group, index, arr) => arr.findIndex((g) => g.id === group.id) === index);

      const groupsWithStats = await Promise.all(
        uniqueGroups.map(async (group) => {
          const { data: members, error: membersError } = await supabase
            .from("group_members")
            .select("user_id, joined_at")
            .eq("group_id", group.id);

          if (membersError) throw membersError;

          const membersWithProfiles = await Promise.all(
            (members || []).map(async (member) => {
              const { data: profile } = await supabase.from("profiles").select("full_name").eq("user_id", member.user_id).maybeSingle();

              return {
                ...member,
                profiles: profile,
              };
            })
          );

          const { data: transactions } = await supabase.from("transactions").select("amount, type, created_at").eq("group_id", group.id);

          let totalExpenses = 0;
          let totalIncome = 0;
          let lastActivity = null;

          if (transactions) {
            transactions.forEach((t) => {
              // CORREÃ‡ÃƒO DE SALDO AQUI:
              // Usamos Math.abs() porque no banco a despesa Ã© salva como negativo (ex: -100).
              // Queremos somar a magnitude da despesa (100) para mostrar no card de "Despesas"
              // e para subtrair corretamente do saldo depois.
              if (t.type === "expense") {
                totalExpenses += Math.abs(t.amount);
              } else {
                totalIncome += t.amount;
              }

              if (!lastActivity || new Date(t.created_at) > new Date(lastActivity)) {
                lastActivity = t.created_at;
              }
            });
          }

          if (members && members.length > 0) {
            members.forEach((m) => {
              if (!lastActivity || new Date(m.joined_at) > new Date(lastActivity)) {
                lastActivity = m.joined_at;
              }
            });
          }

          return {
            ...group,
            memberCount: members?.length || 0,
            members: membersWithProfiles,
            totalExpenses,
            totalIncome,
            lastActivity,
          };
        })
      );

      setGroups(groupsWithStats);
    } catch (error) {
      console.error("Erro ao buscar grupos:", error);
      toast({
        title: "Erro ao carregar grupos",
        description: "NÃ£o foi possÃ­vel carregar seus grupos. Tente novamente.",
        variant: "destructive",
      });
    } finally {
      setLoading(false);
    }
  };

  const fetchInvites = async () => {
    try {
      const {
        data: { user },
      } = await supabase.auth.getUser();
      if (!user) return;

      const userEmail = user.email;
      if (userEmail) {
        const { data, error } = await supabase
          .from("group_invites")
          .select(
            `
            id,
            group_id,
            status,
            groups (
              name,
              description,
              created_by
            )
          `
          )
          .eq("email", userEmail)
          .eq("status", "pending");

        if (error) throw error;

        const formattedInvites: Invite[] = (data || []).map((item) => ({
          id: item.id,
          group_id: item.group_id,
          status: item.status,
          groups: item.groups
            ? {
                name: item.groups.name,
                description: item.groups.description || "",
                created_by: item.groups.created_by,
              }
            : null,
        }));

        setInvites(formattedInvites);
      }
    } catch (error) {
      console.error("Erro ao buscar convites:", error);
    }
  };

  useEffect(() => {
    fetchGroups();
    fetchInvites();
  }, []);

  const handleInviteResponse = async (invite: Invite, accept: boolean) => {
    try {
      const {
        data: { user },
      } = await supabase.auth.getUser();
      if (!user) return;

      if (accept) {
        const { data: existingMember } = await supabase
          .from("group_members")
          .select("id")
          .eq("group_id", invite.group_id)
          .eq("user_id", user.id)
          .single();

        if (!existingMember) {
          const { error: memberError } = await supabase.from("group_members").insert({
            group_id: invite.group_id,
            user_id: user.id,
            is_admin: false,
          });
          if (memberError) throw memberError;
        }

        await supabase.from("group_invites").update({ status: "accepted" }).eq("id", invite.id);
        toast({
          title: "Sucesso",
          description: `VocÃª entrou no grupo ${invite.groups?.name || "do convite"}`,
        });
      } else {
        await supabase.from("group_invites").update({ status: "rejected" }).eq("id", invite.id);
        toast({
          title: "Convite rejeitado",
        });
      }

      fetchInvites();
      fetchGroups();
    } catch (error) {
      console.error(error);
      toast({
        title: "Erro",
        description: "Erro ao processar convite",
        variant: "destructive",
      });
    }
  };

  const handleEditGroup = (groupId: string) => {
    setEditGroupId(groupId);
    setEditDialogOpen(true);
  };

  const handleEditClose = () => {
    setEditDialogOpen(false);
    setEditGroupId(null);
  };

  if (loading) {
    return (
      <DashboardLayout>
        <div className="p-6 space-y-6">
          <div className="animate-pulse space-y-4">
            <div className="h-8 bg-muted rounded w-1/4"></div>
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
              {[1, 2, 3].map((i) => (
                <div key={i} className="h-48 bg-muted rounded"></div>
              ))}
            </div>
          </div>
        </div>
      </DashboardLayout>
    );
  }

  return (
    <DashboardLayout>
      <div className="h-full overflow-y-auto">
        <div className="container max-w-7xl mx-auto p-4 md:p-6 space-y-4 md:space-y-6">
          <div className="flex flex-col md:flex-row md:justify-between md:items-center gap-4">
            <div>
              <h1 className="text-2xl md:text-3xl font-bold text-foreground">Grupos</h1>
              <p className="text-sm md:text-base text-muted-foreground">Gerencie e compartilhe despesas com seus grupos</p>
            </div>
            <AddGroupDialog onGroupCreated={fetchGroups} />
          </div>

          {invites.length > 0 && (
            <div className="space-y-4">
              <h2 className="text-lg font-semibold flex items-center gap-2">
                <Clock className="h-5 w-5 text-yellow-500" />
                Convites Pendentes
              </h2>
              <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
                {invites.map((invite) => (
                  <Card key={invite.id} className="border-yellow-200 bg-yellow-50 dark:bg-yellow-900/20">
                    <CardHeader>
                      <CardTitle className="flex items-center justify-between">
                        <span className="text-lg">{invite.groups?.name || "Grupo IndisponÃ­vel"}</span>
                        <Badge variant="outline" className="bg-yellow-100 dark:bg-yellow-800">
                          Pendente
                        </Badge>
                      </CardTitle>
                    </CardHeader>
                    <CardContent>
                      {invite.groups ? (
                        <>
                          {invite.groups.description && <p className="text-sm text-muted-foreground mb-4">{invite.groups.description}</p>}
                          <div className="flex gap-2">
                            <Button size="sm" variant="outline" className="flex-1" onClick={() => handleInviteResponse(invite, false)}>
                              <XCircle className="h-4 w-4 mr-1" />
                              Recusar
                            </Button>
                            <Button size="sm" className="flex-1" onClick={() => handleInviteResponse(invite, true)}>
                              <CheckCircle className="h-4 w-4 mr-1" />
                              Aceitar
                            </Button>
                          </div>
                        </>
                      ) : (
                        <div className="flex flex-col gap-2">
                          <p className="text-sm text-destructive flex items-center gap-2">
                            <AlertCircle className="h-4 w-4" />
                            Detalhes do grupo nÃ£o disponÃ­veis.
                          </p>
                          <Button size="sm" variant="outline" className="w-full" onClick={() => handleInviteResponse(invite, false)}>
                            Remover Convite
                          </Button>
                        </div>
                      )}
                    </CardContent>
                  </Card>
                ))}
              </div>
            </div>
          )}

          <div className="grid gap-4 md:gap-6 md:grid-cols-2 lg:grid-cols-3">
            {groups.length === 0 ? (
              <Card className="md:col-span-2 lg:col-span-3 border-2 border-dashed">
                <CardContent className="flex flex-col items-center justify-center py-12">
                  <Users className="h-12 w-12 text-muted-foreground mb-4" />
                  <p className="text-lg font-medium text-muted-foreground mb-2">Nenhum grupo encontrado</p>
                  <p className="text-sm text-muted-foreground mb-4">Crie seu primeiro grupo para comeÃ§ar a compartilhar despesas</p>
                  <AddGroupDialog onGroupCreated={fetchGroups} />
                </CardContent>
              </Card>
            ) : (
              groups.map((group) => {
                const getColorClasses = (color: string) => {
                  const colorMap: Record<string, string> = {
                    blue: "bg-blue-500",
                    green: "bg-green-500",
                    purple: "bg-purple-500",
                    red: "bg-red-500",
                    yellow: "bg-yellow-500",
                    pink: "bg-pink-500",
                    orange: "bg-orange-500",
                    indigo: "bg-indigo-500",
                  };
                  return colorMap[color] || "bg-blue-500";
                };

                // Agora que totalExpenses Ã© positivo, a subtraÃ§Ã£o funciona como esperado (Receita - Despesa)
                const balance = group.totalIncome - group.totalExpenses;
                const isCreator = group.created_by === currentUserId;

                return (
                  <Card
                    key={group.id}
                    className="relative overflow-hidden hover:shadow-lg transition-all duration-200 cursor-pointer"
                    onClick={() => setSelectedGroup({ id: group.id, name: group.name })}
                  >
                    <div
                      className={`absolute top-0 right-0 w-32 h-32 ${getColorClasses(group.color)} opacity-10 rounded-full -mr-16 -mt-16`}
                    />
                    <CardHeader className="pb-4">
                      <div className="flex justify-between items-start">
                        <CardTitle className="text-xl">{group.name}</CardTitle>
                        <div className="flex flex-col items-end gap-1">
                          <Badge variant={isCreator ? "default" : "secondary"} className="text-xs">
                            {isCreator ? "Criador" : "Membro"}
                          </Badge>
                          <Badge variant="outline" className="text-xs">
                            <Users className="w-3 h-3 mr-1" />
                            {group.memberCount} {group.memberCount === 1 ? "membro" : "membros"}
                          </Badge>
                        </div>
                      </div>
                      {group.description && <p className="text-sm text-muted-foreground mt-2">{group.description}</p>}
                    </CardHeader>
                    <CardContent className="space-y-4">
                      <div className="grid grid-cols-2 gap-4">
                        <div>
                          <p className="text-sm text-muted-foreground">Receitas</p>
                          <p className="text-lg font-semibold text-green-600 dark:text-green-400 flex items-center gap-1">
                            <TrendingUp className="w-4 h-4" />
                            R$ {group.totalIncome.toFixed(2)}
                          </p>
                        </div>
                        <div>
                          <p className="text-sm text-muted-foreground">Despesas</p>
                          <p className="text-lg font-semibold text-red-600 dark:text-red-400 flex items-center gap-1">
                            <TrendingDown className="w-4 h-4" />
                            {/* Mostra despesas como valor positivo no card, pois jÃ¡ estÃ¡ na seÃ§Ã£o "Despesas" */}
                            R$ {group.totalExpenses.toFixed(2)}
                          </p>
                        </div>
                      </div>

                      <div>
                        <p className="text-sm text-muted-foreground">Saldo</p>
                        <div className="flex items-center justify-between">
                          <p
                            className={`text-xl font-bold flex items-center gap-1 ${
                              balance >= 0 ? "text-green-600 dark:text-green-400" : "text-red-600 dark:text-red-400"
                            }`}
                          >
                            <Wallet className="w-5 h-5" />
                            R$ {Math.abs(balance).toFixed(2)}
                            {balance < 0 && " (negativo)"}
                          </p>
                        </div>
                      </div>

                      <div className="pt-2 flex justify-between items-center">
                        <p className="text-xs text-muted-foreground">
                          {group.lastActivity
                            ? `Ãšltima atividade: ${new Date(group.lastActivity).toLocaleDateString("pt-BR")}`
                            : "Sem atividades"}
                        </p>
                        {isCreator && (
                          <Button
                            variant="ghost"
                            size="sm"
                            onClick={(e) => {
                              e.stopPropagation();
                              handleEditGroup(group.id);
                            }}
                          >
                            Editar
                          </Button>
                        )}
                      </div>
                    </CardContent>
                  </Card>
                );
              })
            )}
          </div>

          <EditGroupDialog groupId={editGroupId} isOpen={editDialogOpen} onClose={handleEditClose} onSuccess={fetchGroups} />

          {selectedGroup && (
            <GroupDetailsModal
              isOpen={!!selectedGroup}
              onClose={() => setSelectedGroup(null)}
              groupId={selectedGroup.id}
              groupName={selectedGroup.name}
            />
          )}
        </div>
      </div>
    </DashboardLayout>
  );
};

export default Groups;
```
---

### src\pages\Index.tsx

**Language:** typescript  
**Size:** 5.61 KB  
**Last Modified:** 2025-10-31T13:45:27.058Z

```typescript
import { Link, Navigate } from "react-router-dom";
import { Button } from "@/components/ui/button";
import { useAuth } from "@/contexts/AuthContext";
import { DollarSign, TrendingUp, Users, Shield, BarChart3, PiggyBank, ArrowRight } from "@/lib/icons";

const Index = () => {
  const { user } = useAuth();

  // Redirect if already authenticated
  if (user) {
    return <Navigate to="/dashboard" replace />;
  }
  return (
    <div className="min-h-screen bg-gradient-to-br from-primary/5 via-background to-accent/5">
      {/* Hero Section */}
      <section className="container mx-auto px-4 py-20">
        <div className="text-center max-w-4xl mx-auto">
          <div className="flex justify-center mb-8">
            <div className="p-4 bg-primary/10 rounded-full">
              <DollarSign className="h-16 w-16 text-primary" />
            </div>
          </div>

          <h1 className="text-5xl font-bold text-foreground mb-6">
            Seu Agente Financeiro
            <span className="block text-primary mt-2">Inteligente</span>
          </h1>

          <p className="text-xl text-muted-foreground mb-8 max-w-2xl mx-auto">
            Gerencie suas finanÃ§as pessoais e em grupo com inteligÃªncia. Controle investimentos, despesas compartilhadas e alcance seus
            objetivos financeiros.
          </p>

          <div className="flex gap-4 justify-center">
            <Button asChild size="lg" className="bg-gradient-income hover:opacity-90">
              <Link to="/auth">
                ComeÃ§ar Agora
                <ArrowRight className="ml-2 h-4 w-4" />
              </Link>
            </Button>
          </div>
        </div>
      </section>

      {/* Features Section */}
      <section className="container mx-auto px-4 py-20">
        <div className="text-center mb-16">
          <h2 className="text-3xl font-bold text-foreground mb-4">Tudo que vocÃª precisa para gerenciar suas finanÃ§as</h2>
          <p className="text-muted-foreground max-w-2xl mx-auto">Uma plataforma completa para controle financeiro pessoal e em grupo</p>
        </div>

        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
          <div className="text-center p-6 rounded-lg bg-card border border-border">
            <div className="p-3 bg-primary/10 rounded-full w-fit mx-auto mb-4">
              <BarChart3 className="h-8 w-8 text-primary" />
            </div>
            <h3 className="text-xl font-semibold mb-2">Dashboard Intuitivo</h3>
            <p className="text-muted-foreground">Visualize todas suas finanÃ§as em um painel claro e organizado</p>
          </div>

          <div className="text-center p-6 rounded-lg bg-card border border-border">
            <div className="p-3 bg-success/10 rounded-full w-fit mx-auto mb-4">
              <PiggyBank className="h-8 w-8 text-success" />
            </div>
            <h3 className="text-xl font-semibold mb-2">Controle de Investimentos</h3>
            <p className="text-muted-foreground">Acompanhe a performance da sua carteira e defina metas</p>
          </div>

          <div className="text-center p-6 rounded-lg bg-card border border-border">
            <div className="p-3 bg-accent/10 rounded-full w-fit mx-auto mb-4">
              <Users className="h-8 w-8 text-accent" />
            </div>
            <h3 className="text-xl font-semibold mb-2">Despesas em Grupo</h3>
            <p className="text-muted-foreground">Compartilhe gastos com famÃ­lia e amigos de forma transparente</p>
          </div>

          <div className="text-center p-6 rounded-lg bg-card border border-border">
            <div className="p-3 bg-warning/10 rounded-full w-fit mx-auto mb-4">
              <TrendingUp className="h-8 w-8 text-warning" />
            </div>
            <h3 className="text-xl font-semibold mb-2">AnÃ¡lises Detalhadas</h3>
            <p className="text-muted-foreground">RelatÃ³rios completos sobre seus hÃ¡bitos financeiros</p>
          </div>

          <div className="text-center p-6 rounded-lg bg-card border border-border">
            <div className="p-3 bg-destructive/10 rounded-full w-fit mx-auto mb-4">
              <Shield className="h-8 w-8 text-destructive" />
            </div>
            <h3 className="text-xl font-semibold mb-2">SeguranÃ§a Total</h3>
            <p className="text-muted-foreground">Seus dados financeiros protegidos com criptografia avanÃ§ada</p>
          </div>

          <div className="text-center p-6 rounded-lg bg-card border border-border">
            <div className="p-3 bg-primary/10 rounded-full w-fit mx-auto mb-4">
              <DollarSign className="h-8 w-8 text-primary" />
            </div>
            <h3 className="text-xl font-semibold mb-2">CategorizaÃ§Ã£o AutomÃ¡tica</h3>
            <p className="text-muted-foreground">IA que aprende seus padrÃµes e categoriza transaÃ§Ãµes automaticamente</p>
          </div>
        </div>
      </section>

      {/* CTA Section */}
      <section className="container mx-auto px-4 py-20">
        <div className="bg-primary/5 rounded-2xl p-12 text-center">
          <h2 className="text-3xl font-bold text-foreground mb-4">Pronto para transformar suas finanÃ§as?</h2>
          <p className="text-muted-foreground mb-8 max-w-xl mx-auto">
            Junte-se a milhares de usuÃ¡rios que jÃ¡ conquistaram o controle financeiro
          </p>
          <Button size="lg" asChild className="bg-gradient-investment hover:opacity-90">
            <Link to="/auth">Criar Conta Gratuita</Link>
          </Button>
        </div>
      </section>
    </div>
  );
};

export default Index;
```
---

### src\pages\Investments.tsx

**Language:** typescript  
**Size:** 21.72 KB  
**Last Modified:** 2025-11-26T13:14:03.870Z

```typescript
import { useState, useEffect, useMemo } from "react";
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Progress } from "@/components/ui/progress";
import { DashboardLayout } from "@/components/layout/DashboardLayout";
import { AddInvestmentDialog } from "@/components/dialogs/AddInvestmentDialog";
import { InvestmentDetailsModal } from "@/components/dialogs/InvestmentDetailsModal";
import { ManageInvestmentDialog } from "@/components/dialogs/ManageInvestmentDialog";
import { AddGoalDialog } from "@/components/dialogs/AddGoalDialog";
import { EditGoalDialog } from "@/components/dialogs/EditGoalDialog";
import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
} from "@/components/ui/alert-dialog";
import { supabase } from "@/integrations/supabase/client";
import { useToast } from "@/hooks/use-toast";
import { TrendingUp, Target, Plus, PieChart, Trash2, Edit, ChevronLeft, ChevronRight } from "@/lib/icons";
import { recalculateGoalBalance } from "@/utils/investments/investmentUtils"; // Importe a funÃ§Ã£o nova

// Interfaces... (mesmas de antes)
interface InvestmentRecord {
  id: string;
  name: string;
  type: string;
  amount: number;
  current_value: number;
  group_id: string | null;
  maturity_date: string | null;
  user_id: string;
  created_at: string;
  quantity: number | null;
  unit_price: number | null;
  goal_id: string | null;
}

interface AggregatedInvestment {
  name: string;
  type: string;
  totalAmountInvested: number;
  totalCurrentValue: number;
  totalQuantity: number | null;
  averagePrice: number | null;
  firstInvestedAt: string;
  recordIds: string[];
  totalAmountForAvgPrice?: number;
  goalIds: (string | null)[];
}

interface InvestmentGoal {
  id: string;
  name: string;
  target_amount: number;
  current_amount: number;
  color: string;
  description?: string;
  target_date?: string;
  priority: number;
}

const Investments = () => {
  const [allInvestments, setAllInvestments] = useState<InvestmentRecord[]>([]);
  const [goals, setGoals] = useState<InvestmentGoal[]>([]);
  const [loading, setLoading] = useState(true);

  const [modalOpen, setModalOpen] = useState(false);
  const [selectedType, setSelectedType] = useState("");

  // Estados de DiÃ¡logo
  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false);
  const [investmentToDelete, setInvestmentToDelete] = useState<string | null>(null);
  const [deleteGoalDialogOpen, setDeleteGoalDialogOpen] = useState(false);
  const [goalToDelete, setGoalToDelete] = useState<string | null>(null);
  const [editGoalDialogOpen, setEditGoalDialogOpen] = useState(false);
  const [goalToEdit, setGoalToEdit] = useState<InvestmentGoal | null>(null);
  const [manageInvestment, setManageInvestment] = useState<AggregatedInvestment | null>(null);

  // PaginaÃ§Ã£o
  const [itemsPerPage] = useState(10);
  const [currentPage, setCurrentPage] = useState(1);
  const [goalPage, setGoalPage] = useState(0);

  const { toast } = useToast();
  const GOALS_PER_PAGE = 3;

  useEffect(() => {
    loadData();
  }, []);

  const loadData = async () => {
    setLoading(true);
    await Promise.all([loadInvestments(), loadGoals()]);
    setLoading(false);
  };

  const loadInvestments = async () => {
    const { data } = await supabase.from("investments").select("*").order("name").order("created_at");
    setAllInvestments(data || []);
  };

  const loadGoals = async () => {
    const { data } = await supabase.from("investment_goals").select("*").order("priority");
    setGoals(data || []);
  };

  // AgregaÃ§Ã£o (Mantida igual)
  const aggregatedInvestments = useMemo(() => {
    const aggregationMap = new Map<string, AggregatedInvestment>();
    allInvestments.forEach((record) => {
      const existing = aggregationMap.get(record.name);
      const isStockOrFII = record.type === "AÃ§Ãµes" || record.type === "FIIs";
      if (existing) {
        existing.totalAmountInvested += record.amount;
        existing.totalCurrentValue += record.current_value;
        existing.recordIds.push(record.id);
        existing.goalIds.push(record.goal_id);
        if (isStockOrFII && record.quantity) {
          existing.totalAmountForAvgPrice = (existing.totalAmountForAvgPrice || 0) + record.amount;
          existing.totalQuantity = (existing.totalQuantity || 0) + record.quantity;
          if (existing.totalQuantity > 0) existing.averagePrice = existing.totalAmountForAvgPrice / existing.totalQuantity;
        }
      } else {
        aggregationMap.set(record.name, {
          name: record.name,
          type: record.type,
          totalAmountInvested: record.amount,
          totalCurrentValue: record.current_value,
          totalQuantity: record.quantity,
          averagePrice: record.unit_price,
          firstInvestedAt: record.created_at,
          recordIds: [record.id],
          totalAmountForAvgPrice: record.amount,
          goalIds: [record.goal_id],
        });
      }
    });
    return Array.from(aggregationMap.values());
  }, [allInvestments]);

  // --- Handlers ---

  // BotÃ£o de EdiÃ§Ã£o/Gerenciamento
  const handleManageClick = (investment: AggregatedInvestment) => {
    setManageInvestment(investment);
  };

  // ExclusÃ£o unitÃ¡ria (se houver apenas 1 registro ou botÃ£o especÃ­fico)
  const handleDeleteClick = (investmentId: string) => {
    setInvestmentToDelete(investmentId);
    setDeleteDialogOpen(true);
  };

  const handleDeleteConfirm = async () => {
    if (!investmentToDelete) return;
    try {
      const investment = allInvestments.find((inv) => inv.id === investmentToDelete);

      const { error } = await supabase.from("investments").delete().eq("id", investmentToDelete);
      if (error) throw error;

      // RECALCULA A META
      if (investment && investment.goal_id) {
        await recalculateGoalBalance(investment.goal_id);
      }

      toast({ title: "Sucesso", description: "Investimento removido!" });
      await loadData();
    } catch (error) {
      toast({ title: "Erro", description: "Falha ao remover", variant: "destructive" });
    } finally {
      setDeleteDialogOpen(false);
      setInvestmentToDelete(null);
    }
  };

  const handleDeleteGoalClick = (goalId: string) => {
    setGoalToDelete(goalId);
    setDeleteGoalDialogOpen(true);
  };

  const handleDeleteGoalConfirm = async () => {
    if (!goalToDelete) return;
    try {
      const { error } = await supabase.from("investment_goals").delete().eq("id", goalToDelete);
      if (error) throw error;
      toast({ title: "Sucesso", description: "Meta removida!" });
      await loadGoals();
      setGoalPage(0);
    } catch (error) {
      toast({ title: "Erro", description: "Falha ao remover meta", variant: "destructive" });
    } finally {
      setDeleteGoalDialogOpen(false);
      setGoalToDelete(null);
    }
  };

  const handleEditGoalClick = (goal: InvestmentGoal) => {
    setGoalToEdit(goal);
    setEditGoalDialogOpen(true);
  };

  const handleTypeClick = (type: string) => {
    setSelectedType(type);
    setModalOpen(true);
  };

  const totalInvested = allInvestments.reduce((sum, inv) => sum + inv.amount, 0);
  const totalCurrentValue = allInvestments.reduce((sum, inv) => sum + inv.current_value, 0);
  const totalReturn = totalInvested > 0 ? ((totalCurrentValue - totalInvested) / totalInvested) * 100 : 0;
  const investmentTypes = [...new Set(aggregatedInvestments.map((inv) => inv.type))];

  // PaginaÃ§Ã£o
  const paginatedAggregatedInvestments = aggregatedInvestments.slice((currentPage - 1) * itemsPerPage, currentPage * itemsPerPage);
  const totalPages = Math.ceil(aggregatedInvestments.length / itemsPerPage);
  const paginatedGoals = goals.slice(goalPage * GOALS_PER_PAGE, (goalPage + 1) * GOALS_PER_PAGE);
  const totalGoalPages = Math.ceil(goals.length / GOALS_PER_PAGE);

  const handlePreviousGoals = () => goalPage > 0 && setGoalPage(goalPage - 1);
  const handleNextGoals = () => goalPage < totalGoalPages - 1 && setGoalPage(goalPage + 1);

  if (loading) {
    return (
      <DashboardLayout>
        <div className="p-6 space-y-6">
          <div className="animate-pulse space-y-4">
            <div className="h-8 bg-muted rounded w-1/4"></div>
            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
              {[1, 2, 3].map((i) => (
                <div key={i} className="h-24 bg-muted rounded"></div>
              ))}
            </div>
          </div>
        </div>
      </DashboardLayout>
    );
  }

  return (
    <DashboardLayout>
      <div className="p-6 space-y-6">
        <div className="flex justify-between items-center">
          <div>
            <h1 className="text-3xl font-bold text-foreground">Investimentos</h1>
            <p className="text-muted-foreground">Acompanhe e gerencie seu portfÃ³lio</p>
          </div>
          <AddInvestmentDialog onSuccess={loadData} />
        </div>

        {/* Resumo */}
        <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
          <Card>
            <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
              <CardTitle className="text-sm font-medium">Total Investido</CardTitle>
              <TrendingUp className="h-4 w-4 text-muted-foreground" />
            </CardHeader>
            <CardContent>
              <div className="text-2xl font-bold">
                {new Intl.NumberFormat("pt-BR", { style: "currency", currency: "BRL" }).format(totalInvested)}
              </div>
            </CardContent>
          </Card>
          <Card>
            <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
              <CardTitle className="text-sm font-medium">Valor Atual</CardTitle>
              <TrendingUp className="h-4 w-4 text-muted-foreground" />
            </CardHeader>
            <CardContent>
              <div className="text-2xl font-bold">
                {new Intl.NumberFormat("pt-BR", { style: "currency", currency: "BRL" }).format(totalCurrentValue)}
              </div>
            </CardContent>
          </Card>
          <Card>
            <CardHeader className="flex flex-row items-center justify-between space-y-0 pb-2">
              <CardTitle className="text-sm font-medium">Rentabilidade</CardTitle>
              <TrendingUp className="h-4 w-4 text-muted-foreground" />
            </CardHeader>
            <CardContent>
              <div className={`text-2xl font-bold ${totalReturn >= 0 ? "text-success" : "text-destructive"}`}>
                {totalReturn >= 0 ? "+" : ""}
                {totalReturn.toFixed(2)}%
              </div>
            </CardContent>
          </Card>
        </div>

        {/* Metas */}
        {goals.length > 0 && (
          <Card>
            <CardHeader>
              <div className="flex items-center justify-between">
                <div>
                  <CardTitle className="flex items-center gap-2">
                    <Target className="h-5 w-5" /> Metas
                  </CardTitle>
                </div>
                <div className="flex items-center gap-2">
                  {totalGoalPages > 1 && (
                    <>
                      <Button variant="outline" size="icon" onClick={handlePreviousGoals} disabled={goalPage === 0}>
                        <ChevronLeft className="h-4 w-4" />
                      </Button>
                      <Button variant="outline" size="icon" onClick={handleNextGoals} disabled={goalPage >= totalGoalPages - 1}>
                        <ChevronRight className="h-4 w-4" />
                      </Button>
                    </>
                  )}
                  <AddGoalDialog onSuccess={loadGoals} />
                </div>
              </div>
            </CardHeader>
            <CardContent>
              <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                {paginatedGoals.map((goal) => {
                  const progress = goal.target_amount > 0 ? (goal.current_amount / goal.target_amount) * 100 : 0;
                  return (
                    <Card key={goal.id} className="relative group hover:shadow-md transition-shadow">
                      <div className="absolute top-4 right-4 flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity">
                        <Button variant="secondary" size="icon" className="h-8 w-8" onClick={() => handleEditGoalClick(goal)}>
                          <Edit className="h-4 w-4" />
                        </Button>
                        <Button variant="destructive" size="icon" className="h-8 w-8" onClick={() => handleDeleteGoalClick(goal.id)}>
                          <Trash2 className="h-4 w-4" />
                        </Button>
                      </div>
                      <CardHeader>
                        <CardTitle className="text-lg pr-16 truncate">{goal.name}</CardTitle>
                        {goal.description && <CardDescription className="line-clamp-1">{goal.description}</CardDescription>}
                      </CardHeader>
                      <CardContent className="space-y-4">
                        <div className="space-y-2">
                          <div className="flex justify-between text-sm">
                            <span className="text-muted-foreground">Progresso</span>
                            <span className="font-medium">{Math.min(progress, 100).toFixed(1)}%</span>
                          </div>
                          <Progress value={Math.min(progress, 100)} className="h-2" />
                        </div>
                        <div className="flex justify-between text-sm">
                          <div>
                            <p className="text-muted-foreground">Atual</p>
                            <p className="font-medium">
                              {new Intl.NumberFormat("pt-BR", { style: "currency", currency: "BRL" }).format(goal.current_amount)}
                            </p>
                          </div>
                          <div className="text-right">
                            <p className="text-muted-foreground">Meta</p>
                            <p className="font-medium">
                              {new Intl.NumberFormat("pt-BR", { style: "currency", currency: "BRL" }).format(goal.target_amount)}
                            </p>
                          </div>
                        </div>
                      </CardContent>
                    </Card>
                  );
                })}
              </div>
            </CardContent>
          </Card>
        )}

        {/* Ativos Consolidados */}
        {aggregatedInvestments.length > 0 ? (
          <Card>
            <CardHeader>
              <CardTitle>Ativos Consolidados</CardTitle>
              <CardDescription>Gerencie seus ativos</CardDescription>
            </CardHeader>
            <CardContent>
              <div className="space-y-4">
                {paginatedAggregatedInvestments.map((aggInvestment) => {
                  const investmentReturn =
                    aggInvestment.totalAmountInvested > 0
                      ? ((aggInvestment.totalCurrentValue - aggInvestment.totalAmountInvested) / aggInvestment.totalAmountInvested) * 100
                      : 0;

                  return (
                    <Card key={aggInvestment.name} className="relative border hover:bg-accent/5 transition-colors">
                      <CardContent className="pt-6">
                        <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                          <div className="flex-1">
                            <div className="flex items-center gap-2 mb-2">
                              <h3 className="text-lg font-semibold">{aggInvestment.name}</h3>
                              <span className="text-xs px-2 py-1 bg-muted rounded-full">{aggInvestment.type}</span>
                            </div>
                            <div className="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                              <div>
                                <p className="text-muted-foreground">Investido</p>
                                <p className="font-medium">
                                  {new Intl.NumberFormat("pt-BR", { style: "currency", currency: "BRL" }).format(
                                    aggInvestment.totalAmountInvested
                                  )}
                                </p>
                              </div>
                              <div>
                                <p className="text-muted-foreground">Valor Atual</p>
                                <p className="font-medium">
                                  {new Intl.NumberFormat("pt-BR", { style: "currency", currency: "BRL" }).format(
                                    aggInvestment.totalCurrentValue
                                  )}
                                </p>
                              </div>
                              {aggInvestment.totalQuantity !== null && (
                                <>
                                  <div>
                                    <p className="text-muted-foreground">Quantidade</p>
                                    <p className="font-medium">{aggInvestment.totalQuantity}</p>
                                  </div>
                                  <div>
                                    <p className="text-muted-foreground">PreÃ§o MÃ©dio</p>
                                    <p className="font-medium">
                                      {new Intl.NumberFormat("pt-BR", { style: "currency", currency: "BRL" }).format(
                                        aggInvestment.averagePrice || 0
                                      )}
                                    </p>
                                  </div>
                                </>
                              )}
                              <div>
                                <p className="text-muted-foreground">Rentabilidade</p>
                                <p className={`font-medium ${investmentReturn >= 0 ? "text-success" : "text-destructive"}`}>
                                  {investmentReturn >= 0 ? "+" : ""}
                                  {investmentReturn.toFixed(2)}%
                                </p>
                              </div>
                            </div>
                          </div>

                          {/* BotÃ£o de EdiÃ§Ã£o */}
                          <div>
                            <Button
                              variant="outline"
                              size="sm"
                              className="flex items-center gap-2"
                              onClick={() => handleManageClick(aggInvestment)}
                            >
                              <Edit className="h-4 w-4" />
                              Editar
                            </Button>
                          </div>
                        </div>
                      </CardContent>
                    </Card>
                  );
                })}
              </div>

              {/* PaginaÃ§Ã£o... (mantida) */}
            </CardContent>
          </Card>
        ) : (
          <Card>
            <CardContent className="flex flex-col items-center justify-center py-12">
              <PieChart className="h-16 w-16 text-muted-foreground mb-4" />
              <h3 className="text-lg font-semibold mb-2">Nenhum investimento cadastrado</h3>
              <AddInvestmentDialog
                trigger={
                  <Button>
                    <Plus className="h-4 w-4 mr-2" /> Adicionar Investimento
                  </Button>
                }
                onSuccess={loadData}
              />
            </CardContent>
          </Card>
        )}

        {/* Modais */}
        <InvestmentDetailsModal
          open={modalOpen}
          onOpenChange={setModalOpen}
          type={selectedType}
          investments={selectedType ? allInvestments.filter((inv) => inv.type === selectedType) : []}
        />

        {manageInvestment && (
          <ManageInvestmentDialog
            isOpen={!!manageInvestment}
            onClose={() => setManageInvestment(null)}
            investment={manageInvestment}
            onSuccess={() => {
              loadData();
              setManageInvestment(null);
            }}
          />
        )}

        {goalToEdit && (
          <EditGoalDialog
            open={editGoalDialogOpen}
            onOpenChange={setEditGoalDialogOpen}
            goal={goalToEdit}
            onSuccess={loadGoals}
            onClose={() => setEditGoalDialogOpen(false)}
          />
        )}

        <AlertDialog open={deleteGoalDialogOpen} onOpenChange={setDeleteGoalDialogOpen}>
          <AlertDialogContent>
            <AlertDialogHeader>
              <AlertDialogTitle>Excluir Meta?</AlertDialogTitle>
              <AlertDialogDescription>Essa aÃ§Ã£o nÃ£o pode ser desfeita.</AlertDialogDescription>
            </AlertDialogHeader>
            <AlertDialogFooter>
              <AlertDialogCancel>Cancelar</AlertDialogCancel>
              <AlertDialogAction onClick={handleDeleteGoalConfirm} className="bg-destructive text-destructive-foreground">
                Excluir
              </AlertDialogAction>
            </AlertDialogFooter>
          </AlertDialogContent>
        </AlertDialog>
      </div>
    </DashboardLayout>
  );
};

export default Investments;
```
---

### src\pages\JoinGroup.tsx

**Language:** typescript  
**Size:** 5.61 KB  
**Last Modified:** 2025-11-27T19:21:37.083Z

```typescript
import { useEffect, useState } from "react";
import { useParams, useNavigate } from "react-router-dom";
import { Loader2, Users, Check, X } from "lucide-react";

import { DashboardLayout } from "@/components/layout/DashboardLayout";
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { useToast } from "@/hooks/use-toast";
import { supabase } from "@/integrations/supabase/client";

interface InviteData {
  id: string;
  group_id: string;
  email: string;
  status: string;
  groups: {
    name: string;
    description: string | null;
    created_by: string;
  };
}

export default function JoinGroup() {
  const { inviteId } = useParams();
  const navigate = useNavigate();
  const { toast } = useToast();
  const [loading, setLoading] = useState(true);
  const [invite, setInvite] = useState<InviteData | null>(null);
  const [user, setUser] = useState<any>(null);

  useEffect(() => {
    loadInvite();
  }, [inviteId]);

  const loadInvite = async () => {
    try {
      const {
        data: { user },
      } = await supabase.auth.getUser();

      if (!user) {
        sessionStorage.setItem("redirectUrl", window.location.pathname);
        navigate("/auth");
        return;
      }
      setUser(user);

      if (!inviteId) throw new Error("Link invÃ¡lido");

      const { data, error } = await supabase
        .from("group_invites")
        .select(
          `
          *,
          groups (name, description, created_by)
        `
        )
        .eq("id", inviteId)
        .single();

      if (error) throw error;

      if (data.status !== "pending") {
        toast({
          title: "Convite invÃ¡lido",
          description: "Este convite jÃ¡ foi aceito, rejeitado ou expirou.",
          variant: "destructive",
        });
        navigate("/groups");
        return;
      }

      setInvite(data);
    } catch (error) {
      console.error(error);
      toast({
        title: "Erro",
        description: "NÃ£o foi possÃ­vel carregar o convite.",
        variant: "destructive",
      });
      navigate("/dashboard");
    } finally {
      setLoading(false);
    }
  };

  const handleRespond = async (accept: boolean) => {
    if (!user || !invite) return;
    setLoading(true);

    try {
      if (accept) {
        const { data: existingMember } = await supabase
          .from("group_members")
          .select("id")
          .eq("group_id", invite.group_id)
          .eq("user_id", user.id)
          .single();

        if (existingMember) {
          toast({
            title: "Aviso",
            description: "VocÃª jÃ¡ faz parte deste grupo.",
          });
        } else {
          const { error: joinError } = await supabase.from("group_members").insert({
            group_id: invite.group_id,
            user_id: user.id,
            is_admin: false,
          });

          if (joinError) throw joinError;
        }

        await supabase.from("group_invites").update({ status: "accepted" }).eq("id", invite.id);

        toast({
          title: "Bem-vindo!",
          description: `VocÃª entrou no grupo ${invite.groups.name}`,
        });
        navigate("/groups");
      } else {
        await supabase.from("group_invites").update({ status: "rejected" }).eq("id", invite.id);

        toast({
          title: "Convite recusado",
        });
        navigate("/dashboard");
      }
    } catch (error) {
      console.error(error);
      toast({
        title: "Erro",
        description: "Falha ao processar solicitaÃ§Ã£o",
        variant: "destructive",
      });
    } finally {
      setLoading(false);
    }
  };

  if (loading) {
    return (
      <div className="min-h-screen flex items-center justify-center bg-background">
        <div className="flex flex-col items-center gap-4">
          <Loader2 className="h-10 w-10 animate-spin text-primary" />
          <p className="text-muted-foreground">Verificando convite...</p>
        </div>
      </div>
    );
  }

  if (!invite) return null;

  return (
    <DashboardLayout>
      <div className="flex items-center justify-center min-h-[80vh] p-4">
        <Card className="w-full max-w-md shadow-lg">
          <CardHeader className="text-center">
            <div className="mx-auto bg-primary/10 p-4 rounded-full w-fit mb-4">
              <Users className="h-8 w-8 text-primary" />
            </div>
            <CardTitle>Convite para Grupo</CardTitle>
            <CardDescription>VocÃª foi convidado para participar de um grupo financeiro.</CardDescription>
          </CardHeader>
          <CardContent className="space-y-6">
            <div className="bg-muted/30 p-6 rounded-lg text-center border border-border">
              <h3 className="font-bold text-2xl mb-2 text-foreground">{invite.groups.name}</h3>
              {invite.groups.description && <p className="text-sm text-muted-foreground">{invite.groups.description}</p>}
            </div>

            <div className="flex gap-3 pt-2">
              <Button variant="outline" className="flex-1" onClick={() => handleRespond(false)} disabled={loading}>
                <X className="mr-2 h-4 w-4" />
                Recusar
              </Button>
              <Button className="flex-1" onClick={() => handleRespond(true)} disabled={loading}>
                <Check className="mr-2 h-4 w-4" />
                Aceitar
              </Button>
            </div>
          </CardContent>
        </Card>
      </div>
    </DashboardLayout>
  );
}
```
---

### src\pages\NotFound.tsx

**Language:** typescript  
**Size:** 766 Bytes  
**Last Modified:** 2025-08-28T19:03:37.298Z

```typescript
import { useLocation } from "react-router-dom";
import { useEffect } from "react";

const NotFound = () => {
  const location = useLocation();

  useEffect(() => {
    console.error(
      "404 Error: User attempted to access non-existent route:",
      location.pathname
    );
  }, [location.pathname]);

  return (
    <div className="min-h-screen flex items-center justify-center bg-gray-100">
      <div className="text-center">
        <h1 className="text-4xl font-bold mb-4">404</h1>
        <p className="text-xl text-gray-600 mb-4">Oops! Page not found</p>
        <a href="/" className="text-blue-500 hover:text-blue-700 underline">
          Return to Home
        </a>
      </div>
    </div>
  );
};

export default NotFound;
```
---

### src\pages\Profile.tsx

**Language:** typescript  
**Size:** 11.24 KB  
**Last Modified:** 2025-11-25T19:26:52.743Z

```typescript
import { useState, useEffect, useRef } from "react";
import { DashboardLayout } from "@/components/layout/DashboardLayout";
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { User, Lock, Moon, Sun, Laptop, Mail, Camera } from "@/lib/icons";
import { useAuth } from "@/contexts/AuthContext";
import { useTheme } from "@/components/theme-provider";
import { supabase } from "@/integrations/supabase/client";
import { Avatar, AvatarFallback, AvatarImage } from "@/components/ui/avatar";

const Profile = () => {
  const { user, updateProfile, updatePassword } = useAuth();
  const { theme, setTheme } = useTheme();
  const fileInputRef = useRef<HTMLInputElement>(null);

  const [loading, setLoading] = useState(false);
  const [profileData, setProfileData] = useState({
    full_name: "",
    age: "",
    gender: "",
    avatar_url: "",
  });

  const [passwordData, setPasswordData] = useState({
    newPassword: "",
    confirmPassword: "",
  });

  useEffect(() => {
    if (user) {
      fetchProfile();
    }
  }, [user]);

  const fetchProfile = async () => {
    try {
      const { data, error } = await supabase.from("profiles").select("*").eq("user_id", user!.id).single();

      if (error && error.code !== "PGRST116") throw error; // Ignora erro se nÃ£o encontrar perfil (serÃ¡ criado no upsert)

      if (data) {
        setProfileData({
          full_name: data.full_name || "",
          age: data.age ? data.age.toString() : "",
          gender: data.gender || "",
          avatar_url: data.avatar_url || "",
        });
      }
    } catch (error) {
      console.error("Erro ao carregar perfil:", error);
    }
  };

  // FunÃ§Ã£o para processar a imagem e converter para Base64
  const handleFileChange = (event: React.ChangeEvent<HTMLInputElement>) => {
    const file = event.target.files?.[0];
    if (file) {
      // Verifica tamanho (exemplo: max 2MB)
      if (file.size > 2 * 1024 * 1024) {
        alert("A imagem deve ter no mÃ¡ximo 2MB.");
        return;
      }

      const reader = new FileReader();
      reader.onloadend = () => {
        const base64String = reader.result as string;
        setProfileData((prev) => ({ ...prev, avatar_url: base64String }));
      };
      reader.readAsDataURL(file);
    }
  };

  const handleProfileUpdate = async (e: React.FormEvent) => {
    e.preventDefault();
    setLoading(true);
    await updateProfile({
      full_name: profileData.full_name,
      age: profileData.age ? parseInt(profileData.age) : null,
      gender: profileData.gender,
      avatar_url: profileData.avatar_url,
    });
    setLoading(false);
  };

  const handlePasswordUpdate = async (e: React.FormEvent) => {
    e.preventDefault();
    if (passwordData.newPassword !== passwordData.confirmPassword) return;

    setLoading(true);
    await updatePassword(passwordData.newPassword);
    setPasswordData({ newPassword: "", confirmPassword: "" });
    setLoading(false);
  };

  const triggerFileInput = () => {
    fileInputRef.current?.click();
  };

  return (
    <DashboardLayout>
      <div className="p-6 space-y-6 max-w-4xl mx-auto">
        <h1 className="text-3xl font-bold">Meu Perfil</h1>
        <p className="text-muted-foreground">Gerencie suas informaÃ§Ãµes pessoais e preferÃªncias</p>

        <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
          {/* CartÃ£o de InformaÃ§Ãµes BÃ¡sicas (Esquerda) */}
          <Card className="md:col-span-1">
            <CardContent className="pt-6 flex flex-col items-center text-center">
              <div className="relative mb-4 group cursor-pointer" onClick={triggerFileInput}>
                <Avatar className="h-32 w-32 border-4 border-background shadow-xl">
                  <AvatarImage src={profileData.avatar_url} className="object-cover" />
                  <AvatarFallback className="text-4xl bg-primary/10 text-primary">
                    {profileData.full_name ? profileData.full_name.charAt(0).toUpperCase() : "U"}
                  </AvatarFallback>
                </Avatar>
                <div className="absolute inset-0 flex items-center justify-center bg-black/40 rounded-full opacity-0 group-hover:opacity-100 transition-opacity">
                  <Camera className="text-white h-8 w-8" />
                </div>
                <input type="file" ref={fileInputRef} className="hidden" accept="image/*" onChange={handleFileChange} />
              </div>

              <Button variant="ghost" size="sm" className="mb-4" onClick={triggerFileInput}>
                Alterar Foto
              </Button>

              <h2 className="text-xl font-bold">{profileData.full_name || "UsuÃ¡rio"}</h2>
              <p className="text-sm text-muted-foreground flex items-center gap-1 mt-1 justify-center">
                <Mail className="h-3 w-3" /> {user?.email}
              </p>
            </CardContent>
          </Card>

          {/* Ãrea de EdiÃ§Ã£o (Direita) */}
          <div className="md:col-span-2 space-y-6">
            {/* Dados Pessoais */}
            <Card>
              <CardHeader>
                <CardTitle className="flex items-center gap-2">
                  <User className="h-5 w-5" /> Dados Pessoais
                </CardTitle>
                <CardDescription>Atualize suas informaÃ§Ãµes de identificaÃ§Ã£o</CardDescription>
              </CardHeader>
              <CardContent>
                <form onSubmit={handleProfileUpdate} className="space-y-4">
                  <div className="space-y-2">
                    <Label htmlFor="fullName">Nome Completo</Label>
                    <Input
                      id="fullName"
                      value={profileData.full_name}
                      onChange={(e) => setProfileData({ ...profileData, full_name: e.target.value })}
                    />
                  </div>

                  <div className="grid grid-cols-2 gap-4">
                    <div className="space-y-2">
                      <Label htmlFor="age">Idade</Label>
                      <Input
                        id="age"
                        type="number"
                        value={profileData.age}
                        onChange={(e) => setProfileData({ ...profileData, age: e.target.value })}
                      />
                    </div>

                    <div className="space-y-2">
                      <Label htmlFor="gender">Identidade de GÃªnero</Label>
                      <Select value={profileData.gender} onValueChange={(val) => setProfileData({ ...profileData, gender: val })}>
                        <SelectTrigger>
                          <SelectValue placeholder="Selecione" />
                        </SelectTrigger>
                        <SelectContent>
                          <SelectItem value="feminino">Feminino</SelectItem>
                          <SelectItem value="masculino">Masculino</SelectItem>
                          <SelectItem value="nao-binario">NÃ£o-binÃ¡rio</SelectItem>
                          <SelectItem value="agenero">AgÃªnero</SelectItem>
                          <SelectItem value="genero-fluido">GÃªnero Fluido</SelectItem>
                          <SelectItem value="transgenero">TransgÃªnero</SelectItem>
                          <SelectItem value="outro">Outro</SelectItem>
                          <SelectItem value="prefiro-nao-dizer">Prefiro nÃ£o dizer</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                  </div>

                  <Button type="submit" disabled={loading}>
                    {loading ? "Salvando..." : "Salvar AlteraÃ§Ãµes"}
                  </Button>
                </form>
              </CardContent>
            </Card>

            {/* AparÃªncia */}
            <Card>
              <CardHeader>
                <CardTitle className="flex items-center gap-2">
                  <Laptop className="h-5 w-5" /> AparÃªncia
                </CardTitle>
                <CardDescription>Escolha o tema da interface</CardDescription>
              </CardHeader>
              <CardContent>
                <div className="flex gap-4">
                  <Button variant={theme === "light" ? "default" : "outline"} className="flex-1" onClick={() => setTheme("light")}>
                    <Sun className="mr-2 h-4 w-4" /> Claro
                  </Button>
                  <Button variant={theme === "dark" ? "default" : "outline"} className="flex-1" onClick={() => setTheme("dark")}>
                    <Moon className="mr-2 h-4 w-4" /> Escuro
                  </Button>
                  <Button variant={theme === "system" ? "default" : "outline"} className="flex-1" onClick={() => setTheme("system")}>
                    <Laptop className="mr-2 h-4 w-4" /> Sistema
                  </Button>
                </div>
              </CardContent>
            </Card>

            {/* SeguranÃ§a */}
            <Card>
              <CardHeader>
                <CardTitle className="flex items-center gap-2">
                  <Lock className="h-5 w-5" /> SeguranÃ§a
                </CardTitle>
                <CardDescription>Alterar senha de acesso</CardDescription>
              </CardHeader>
              <CardContent>
                <form onSubmit={handlePasswordUpdate} className="space-y-4">
                  <div className="space-y-2">
                    <Label htmlFor="newPassword">Nova Senha</Label>
                    <Input
                      id="newPassword"
                      type="password"
                      value={passwordData.newPassword}
                      onChange={(e) => setPasswordData({ ...passwordData, newPassword: e.target.value })}
                    />
                  </div>
                  <div className="space-y-2">
                    <Label htmlFor="confirmPassword">Confirmar Nova Senha</Label>
                    <Input
                      id="confirmPassword"
                      type="password"
                      value={passwordData.confirmPassword}
                      onChange={(e) => setPasswordData({ ...passwordData, confirmPassword: e.target.value })}
                    />
                  </div>
                  {passwordData.newPassword && passwordData.newPassword !== passwordData.confirmPassword && (
                    <p className="text-xs text-destructive">As senhas nÃ£o coincidem</p>
                  )}
                  <Button
                    type="submit"
                    disabled={loading || !passwordData.newPassword || passwordData.newPassword !== passwordData.confirmPassword}
                    variant="secondary"
                  >
                    {loading ? "Atualizando..." : "Atualizar Senha"}
                  </Button>
                </form>
              </CardContent>
            </Card>
          </div>
        </div>
      </div>
    </DashboardLayout>
  );
};

export default Profile;
```
---

### src\pages\Reminders.tsx

**Language:** typescript  
**Size:** 550 Bytes  
**Last Modified:** 2025-11-06T14:50:00.397Z

```typescript
import { DashboardLayout } from "@/components/layout/DashboardLayout";
import { RemindersList } from "@/components/reminders/RemindersList";

const Reminders = () => {
  return (
    <DashboardLayout>
      <div className="space-y-6">
        <div>
          <h1 className="text-3xl font-bold">Lembretes</h1>
          <p className="text-muted-foreground mt-2">Gerencie seus lembretes e notificaÃ§Ãµes financeiras</p>
        </div>

        <RemindersList />
      </div>
    </DashboardLayout>
  );
};

export default Reminders;
```
---

### src\pages\Transactions.tsx

**Language:** typescript  
**Size:** 21.78 KB  
**Last Modified:** 2025-12-03T21:27:10.889Z

```typescript
import { useState, useEffect, useMemo } from "react";
import { ArrowUpCircle, ArrowDownCircle, Search, Filter, Plus, Trash2, Calendar as CalendarIcon, Layers } from "@/lib/icons";
import { startOfMonth, endOfMonth, format } from "@/lib/date";
import { DashboardLayout } from "@/components/layout/DashboardLayout";
import { AddTransactionDialog } from "@/components/dialogs/AddTransactionDialog";
import { AddEventDialog } from "@/components/dialogs/AddEventDialog";
import { EventDetailsModal } from "@/components/transactions/EventDetailsModal";
import { DateFilter, DateRange } from "@/components/filters/DateFilter";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from "@/components/ui/select";
import { Badge } from "@/components/ui/badge";
import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
} from "@/components/ui/alert-dialog";
import { supabase } from "@/integrations/supabase/client";
import { useToast } from "@/hooks/use-toast";
import { cn } from "@/lib/utils";

// Tipos extendidos
interface Transaction {
  id: string;
  description: string;
  amount: number;
  type: "income" | "expense";
  category: string;
  date: string;
  group_id: string | null;
  event_id: string | null;
  group_name?: string;
  is_fixed: boolean;
  is_recurring: boolean;
  recurrence_id: string | null;
}

interface Event {
  id: string;
  name: string;
  description: string;
  date: string;
  totalAmount?: number;
  // Calculado no frontend
}

type DisplayItem = { kind: "transaction"; data: Transaction } | { kind: "event"; data: Event };

const Transactions = () => {
  const [transactions, setTransactions] = useState<Transaction[]>([]);
  const [events, setEvents] = useState<Event[]>([]);
  const [loading, setLoading] = useState(true);

  // Filtros
  const [searchTerm, setSearchTerm] = useState("");
  const [filterType, setFilterType] = useState("all");
  const [filterCategory, setFilterCategory] = useState("all");
  const [filterGroup, setFilterGroup] = useState("all");
  const [dateRange, setDateRange] = useState<DateRange>({
    from: startOfMonth(new Date()),
    to: endOfMonth(new Date()),
  });

  // Modais
  const [deleteDialogOpen, setDeleteDialogOpen] = useState(false);
  const [transactionToDelete, setTransactionToDelete] = useState<Transaction | null>(null);
  const [selectedEvent, setSelectedEvent] = useState<Event | null>(null); // Para abrir o modal do evento

  const { toast } = useToast();

  useEffect(() => {
    loadData();
  }, [dateRange]);

  const loadData = async () => {
    setLoading(true);
    try {
      await Promise.all([loadTransactions(), loadEvents()]);
    } finally {
      setLoading(false);
    }
  };

  const loadTransactions = async () => {
    try {
      // CORREÃ‡ÃƒO AQUI:
      // 1. Usamos 'transactions_user_id_fkey' para dizer explicitamente que queremos o perfil do CRIADOR (user_id),
      //    evitando o erro de relacionamento ambÃ­guo (PGRST201) com payer_id.
      // 2. Usamos 'groups!left' para garantir que transaÃ§Ãµes SEM grupo (pessoais) tambÃ©m venham (Left Join).
      //    Se fosse apenas 'groups' ou 'groups!inner', traria apenas transaÃ§Ãµes que TEM grupo.
      let query = supabase
        .from("transactions")
        .select(
          `
          *,
          groups!left (name),
          profiles!transactions_user_id_fkey (full_name)
        `
        )
        .order("date", { ascending: false });

      if (dateRange.from) query = query.gte("date", format(dateRange.from, "yyyy-MM-dd"));
      if (dateRange.to) query = query.lte("date", format(dateRange.to, "yyyy-MM-dd"));

      const { data, error } = await query;

      if (error) throw error;

      const formattedData =
        data?.map((t) => ({
          id: t.id,
          description: t.description,
          amount: Number(t.amount),
          type: t.type as "income" | "expense",
          category: t.category,
          date: t.date,
          group_id: t.group_id,
          event_id: t.event_id,
          group_name: t.groups?.name,
          is_fixed: t.is_fixed || false,
          is_recurring: t.is_recurring || false,
          recurrence_id: t.recurrence_id,
        })) || [];

      setTransactions(formattedData);
    } catch (error) {
      console.error("Erro ao carregar transaÃ§Ãµes:", error);
    }
  };

  const loadEvents = async () => {
    try {
      // Carrega eventos que ocorreram neste perÃ­odo (data de referÃªncia)
      let query = supabase
        .from("events" as any)
        .select("*")
        .order("date", { ascending: false });

      if (dateRange.from) query = query.gte("date", format(dateRange.from, "yyyy-MM-dd"));
      if (dateRange.to) query = query.lte("date", format(dateRange.to, "yyyy-MM-dd"));

      const { data, error } = await query;
      if (error) throw error;

      setEvents(data || []);
    } catch (error) {
      console.error("Erro ao carregar eventos:", error);
    }
  };

  // LÃ³gica de DeleÃ§Ã£o de TransaÃ§Ã£o Simples
  const handleDeleteClick = (transaction: Transaction) => {
    setTransactionToDelete(transaction);
    setDeleteDialogOpen(true);
  };

  const handleDeleteConfirm = async () => {
    if (!transactionToDelete) return;

    try {
      if (transactionToDelete.is_fixed && transactionToDelete.recurrence_id) {
        await supabase.from("transactions").delete().eq("recurrence_id", transactionToDelete.recurrence_id);
      } else {
        await supabase.from("transactions").delete().eq("id", transactionToDelete.id);
      }
      toast({ title: "Sucesso", description: "TransaÃ§Ã£o removida" });
      loadTransactions();
    } catch (error) {
      toast({ title: "Erro", description: "Erro ao remover", variant: "destructive" });
    } finally {
      setDeleteDialogOpen(false);
      setTransactionToDelete(null);
    }
  };

  // --- LÃ³gica de Mesclagem e ExibiÃ§Ã£o ---

  // 1. Calcular totais dos eventos para exibiÃ§Ã£o no CARD DO EVENTO (Lista)
  useEffect(() => {
    if (events.length > 0) {
      updateEventTotals();
    }
  }, [events.length]);

  const updateEventTotals = async () => {
    const eventIds = events.map((e) => e.id);
    if (eventIds.length === 0) return;

    const { data } = await supabase.from("transactions").select("event_id, amount, type").in("event_id", eventIds);

    if (data) {
      setEvents((prev) =>
        prev.map((ev) => {
          const evTrans = data.filter((t) => t.event_id === ev.id);
          const total = evTrans.reduce((acc, t) => acc + (t.type === "income" ? t.amount : -Math.abs(t.amount)), 0);
          return { ...ev, totalAmount: total };
        })
      );
    }
  };

  // 2. Preparar lista de exibiÃ§Ã£o (Visual apenas)
  const displayList = useMemo(() => {
    const list: DisplayItem[] = [];

    // Adiciona transaÃ§Ãµes que NÃƒO tÃªm event_id (transaÃ§Ãµes soltas) na lista principal
    transactions.forEach((t) => {
      if (!t.event_id) {
        list.push({ kind: "transaction", data: t });
      }
    });

    // Adiciona os eventos na lista principal
    events.forEach((e) => {
      list.push({ kind: "event", data: e });
    });

    // Filtros em memÃ³ria
    return list
      .filter((item) => {
        if (item.kind === "transaction") {
          const matchesSearch =
            item.data.description.toLowerCase().includes(searchTerm.toLowerCase()) ||
            item.data.category.toLowerCase().includes(searchTerm.toLowerCase());
          const matchesType = filterType === "all" || item.data.type === filterType;
          const matchesCategory = filterCategory === "all" || item.data.category === filterCategory;
          const matchesGroup =
            filterGroup === "all" || (filterGroup === "none" && !item.data.group_id) || item.data.group_id === filterGroup;
          return matchesSearch && matchesType && matchesCategory && matchesGroup;
        } else {
          // Filtros para eventos
          const matchesSearch = item.data.name.toLowerCase().includes(searchTerm.toLowerCase());
          return matchesSearch;
        }
      })
      .sort((a, b) => {
        const dateA = new Date(a.kind === "transaction" ? a.data.date : a.data.date).getTime();
        const dateB = new Date(b.kind === "transaction" ? b.data.date : b.data.date).getTime();
        return dateB - dateA; // Decrescente
      });
  }, [transactions, events, searchTerm, filterType, filterCategory, filterGroup]);

  // --- CÃLCULO DE TOTAIS ---
  const totalIncome = transactions.reduce((acc, t) => {
    if (t.type === "income") return acc + t.amount;
    return acc;
  }, 0);

  const totalExpense = transactions.reduce((acc, t) => {
    if (t.type === "expense") return acc + Math.abs(t.amount);
    return acc;
  }, 0);

  const balance = totalIncome - totalExpense;

  // Filtra categorias vazias para evitar erro no Select do Shadcn
  const categories = Array.from(new Set(transactions.map((t) => t.category))).filter((cat) => cat && cat.trim() !== "");

  const clearFilters = () => {
    setSearchTerm("");
    setFilterType("all");
    setFilterCategory("all");
    setFilterGroup("all");
  };

  return (
    <DashboardLayout>
      <div className="p-6 space-y-6">
        <div className="flex flex-col md:flex-row justify-between items-start md:items-center gap-4">
          <div>
            <h1 className="text-3xl font-bold text-foreground">TransaÃ§Ãµes</h1>
            <p className="text-muted-foreground">Gerencie suas entradas, saÃ­das e eventos</p>
          </div>
          <div className="flex flex-wrap gap-2">
            <AddEventDialog onSuccess={loadData} />
            <AddTransactionDialog
              type="income"
              onSuccess={loadData}
              trigger={
                <Button variant="outline">
                  <Plus className="h-4 w-4 mr-2" /> Receita
                </Button>
              }
            />
            <AddTransactionDialog
              type="expense"
              onSuccess={loadData}
              trigger={
                <Button>
                  <Plus className="h-4 w-4 mr-2" /> Despesa
                </Button>
              }
            />
          </div>
        </div>

        <Card>
          <CardHeader>
            <CardTitle className="flex items-center gap-2">
              <Filter className="h-5 w-5" /> Filtros
            </CardTitle>
          </CardHeader>
          <CardContent>
            <div className="space-y-4">
              <DateFilter dateRange={dateRange} onDateRangeChange={setDateRange} />
              <div className="grid grid-cols-1 md:grid-cols-5 gap-4">
                <div className="relative">
                  <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground" />
                  <Input placeholder="Buscar..." value={searchTerm} onChange={(e) => setSearchTerm(e.target.value)} className="pl-10" />
                </div>
                <Select value={filterType} onValueChange={setFilterType}>
                  <SelectTrigger>
                    <SelectValue placeholder="Tipo" />
                  </SelectTrigger>
                  <SelectContent>
                    <SelectItem value="all">Todos</SelectItem>
                    <SelectItem value="income">Receitas</SelectItem>
                    <SelectItem value="expense">Despesas</SelectItem>
                  </SelectContent>
                </Select>

                <Select value={filterCategory} onValueChange={setFilterCategory}>
                  <SelectTrigger>
                    <SelectValue placeholder="Categoria" />
                  </SelectTrigger>
                  <SelectContent>
                    <SelectItem value="all">Todas</SelectItem>
                    {categories.map((cat) => (
                      <SelectItem key={cat} value={cat}>
                        {cat}
                      </SelectItem>
                    ))}
                  </SelectContent>
                </Select>

                <Select value={filterGroup} onValueChange={setFilterGroup}>
                  <SelectTrigger>
                    <SelectValue placeholder="Grupo" />
                  </SelectTrigger>
                  <SelectContent>
                    <SelectItem value="all">Todos</SelectItem>
                    <SelectItem value="none">Pessoal</SelectItem>
                  </SelectContent>
                </Select>
                <Button variant="outline" onClick={clearFilters}>
                  Limpar
                </Button>
              </div>
            </div>
          </CardContent>
        </Card>

        <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
          <Card>
            <CardHeader className="pb-3">
              <CardTitle className="text-sm font-medium">Total Receitas</CardTitle>
            </CardHeader>
            <CardContent>
              <div className="text-2xl font-bold text-success">
                {totalIncome.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
              </div>
            </CardContent>
          </Card>
          <Card>
            <CardHeader className="pb-3">
              <CardTitle className="text-sm font-medium">Total Despesas</CardTitle>
            </CardHeader>
            <CardContent>
              <div className="text-2xl font-bold text-destructive">
                {totalExpense.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
              </div>
            </CardContent>
          </Card>
          <Card>
            <CardHeader className="pb-3">
              <CardTitle className="text-sm font-medium">Saldo</CardTitle>
            </CardHeader>
            <CardContent>
              <div className={cn("text-2xl font-bold", balance >= 0 ? "text-success" : "text-destructive")}>
                {balance.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
              </div>
            </CardContent>
          </Card>
        </div>

        <Card>
          <CardHeader>
            <CardTitle>LanÃ§amentos</CardTitle>
          </CardHeader>
          <CardContent>
            {loading ? (
              <div className="flex justify-center py-8">
                <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-primary"></div>
              </div>
            ) : displayList.length === 0 ? (
              <div className="text-center py-8 text-muted-foreground">Nenhum lanÃ§amento encontrado</div>
            ) : (
              <div className="space-y-4">
                {displayList.map((item) => {
                  if (item.kind === "event") {
                    // RenderizaÃ§Ã£o do Card de Evento
                    const ev = item.data;
                    const total = ev.totalAmount || 0;
                    return (
                      <div
                        key={`event-${ev.id}`}
                        onClick={() => setSelectedEvent(ev)}
                        className="flex items-center justify-between p-4 rounded-lg border bg-accent/5 hover:bg-accent/10 border-l-4 border-l-primary cursor-pointer transition-all"
                      >
                        <div className="flex items-center gap-4">
                          <div className="p-2 rounded-full bg-primary/20 text-primary">
                            <Layers className="h-5 w-5" />
                          </div>
                          <div>
                            <div className="flex items-center gap-2">
                              <p className="font-bold text-primary">{ev.name}</p>
                              <Badge className="bg-primary text-primary-foreground hover:bg-primary/90 text-[10px]">Evento</Badge>
                            </div>
                            <span className="text-xs text-muted-foreground">
                              {new Date(ev.date).toLocaleDateString("pt-BR")} â€¢ Clique para ver detalhes
                            </span>
                          </div>
                        </div>
                        <div className="flex items-center gap-2">
                          <p className={cn("font-semibold text-lg", total >= 0 ? "text-success" : "text-destructive")}>
                            {total.toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                          </p>
                        </div>
                      </div>
                    );
                  } else {
                    // RenderizaÃ§Ã£o da TransaÃ§Ã£o Normal
                    const transaction = item.data;
                    return (
                      <div
                        key={transaction.id}
                        className="flex items-center justify-between p-4 rounded-lg border hover:bg-accent/50 transition-colors"
                      >
                        <div className="flex items-center gap-4">
                          <div
                            className={cn(
                              "p-2 rounded-full",
                              transaction.type === "income" ? "bg-success/10 text-success" : "bg-destructive/10 text-destructive"
                            )}
                          >
                            {transaction.type === "income" ? (
                              <ArrowUpCircle className="h-5 w-5" />
                            ) : (
                              <ArrowDownCircle className="h-5 w-5" />
                            )}
                          </div>
                          <div>
                            <div className="flex items-center gap-2">
                              <p className="font-medium">{transaction.description}</p>
                              {transaction.is_fixed && (
                                <Badge variant="outline" className="text-xs">
                                  Fixo
                                </Badge>
                              )}
                              {transaction.is_recurring && !transaction.is_fixed && (
                                <Badge variant="outline" className="text-xs">
                                  Recorrente
                                </Badge>
                              )}
                            </div>
                            <div className="flex items-center gap-2 mt-1">
                              <Badge variant="secondary" className="text-xs">
                                {transaction.category}
                              </Badge>
                              {transaction.group_name && (
                                <Badge variant="outline" className="text-xs">
                                  {transaction.group_name}
                                </Badge>
                              )}
                              <span className="text-xs text-muted-foreground">
                                {new Date(transaction.date).toLocaleDateString("pt-BR")}
                              </span>
                            </div>
                          </div>
                        </div>
                        <div className="flex items-center gap-2">
                          <p className={cn("font-semibold text-lg", transaction.type === "income" ? "text-success" : "text-destructive")}>
                            {transaction.type === "income" ? "+" : "-"}
                            {Math.abs(transaction.amount).toLocaleString("pt-BR", { style: "currency", currency: "BRL" })}
                          </p>
                          <Button
                            variant="ghost"
                            size="icon"
                            onClick={() => handleDeleteClick(transaction)}
                            className="text-destructive hover:bg-destructive/10"
                          >
                            <Trash2 className="h-4 w-4" />
                          </Button>
                        </div>
                      </div>
                    );
                  }
                })}
              </div>
            )}
          </CardContent>
        </Card>

        {/* Modais */}
        <AlertDialog open={deleteDialogOpen} onOpenChange={setDeleteDialogOpen}>
          <AlertDialogContent>
            <AlertDialogHeader>
              <AlertDialogTitle>Confirmar exclusÃ£o</AlertDialogTitle>
              <AlertDialogDescription>Tem certeza que deseja remover esta transaÃ§Ã£o?</AlertDialogDescription>
            </AlertDialogHeader>
            <AlertDialogFooter>
              <AlertDialogCancel>Cancelar</AlertDialogCancel>
              <AlertDialogAction onClick={handleDeleteConfirm} className="bg-destructive hover:bg-destructive/90">
                Remover
              </AlertDialogAction>
            </AlertDialogFooter>
          </AlertDialogContent>
        </AlertDialog>

        {selectedEvent && (
          <EventDetailsModal
            isOpen={!!selectedEvent}
            onClose={() => setSelectedEvent(null)}
            eventId={selectedEvent.id}
            eventName={selectedEvent.name}
            eventDate={selectedEvent.date}
            // Verifica se o objeto de evento tem group_id (pode precisar ajustar a interface Event se ainda nÃ£o tiver)
            groupId={(selectedEvent as any).group_id}
            onUpdate={() => {
              loadData();
              updateEventTotals();
            }}
          />
        )}
      </div>
    </DashboardLayout>
  );
};

export default Transactions;
```
---

### src\sw.ts

**Language:** typescript  
**Size:** 3.38 KB  
**Last Modified:** 2025-11-19T20:35:00.803Z

```typescript
import { precacheAndRoute } from "workbox-precaching";
import { registerRoute } from "workbox-routing";
import { CacheFirst, NetworkFirst } from "workbox-strategies";
import { ExpirationPlugin } from "workbox-expiration";
import { CacheableResponsePlugin } from "workbox-cacheable-response";

declare const self: ServiceWorkerGlobalScope;

precacheAndRoute(self.__WB_MANIFEST);

registerRoute(
  ({ url }) => url.origin === "https://fonts.googleapis.com",
  new CacheFirst({
    cacheName: "google-fonts-stylesheets",
    plugins: [
      new ExpirationPlugin({
        maxEntries: 10,
        maxAgeSeconds: 60 * 60 * 24 * 365,
      }),
    ],
  })
);

registerRoute(
  ({ url }) => url.origin === "https://fonts.gstatic.com",
  new CacheFirst({
    cacheName: "google-fonts-webfonts",
    plugins: [
      new CacheableResponsePlugin({
        statuses: [0, 200],
      }),
      new ExpirationPlugin({
        maxEntries: 30,
        maxAgeSeconds: 60 * 60 * 24 * 365,
      }),
    ],
  })
);

registerRoute(
  ({ url }) => url.hostname.includes("supabase.co"),
  new NetworkFirst({
    cacheName: "supabase-api",
    networkTimeoutSeconds: 10,
    plugins: [
      new CacheableResponsePlugin({
        statuses: [0, 200],
      }),
      new ExpirationPlugin({
        maxEntries: 50,
        maxAgeSeconds: 60 * 5,
      }),
    ],
  })
);

self.addEventListener("push", (event) => {
  if (!event.data) {
    return;
  }

  let data;
  try {
    data = event.data.json();
  } catch (error) {
    data = {
      title: event.data.text(),
      body: "",
    };
  }

  const title = data.title || "Zeni Wallet";
  const options = {
    body: data.body || "",
    icon: "/icons/icon-192x192.png",
    badge: "/icons/badge-96x96.png",
    tag: data.tag || "notification",
    requireInteraction: data.requireInteraction !== false,
    actions: data.actions || [
      {
        action: "view",
        title: "Ver",
      },
      {
        action: "dismiss",
        title: "Dispensar",
      },
    ],
    data: {
      url: data.url || "/",
      ...data.data,
    },
  };

  if (data.vibrate) {
    options.vibrate = data.vibrate;
  }

  event.waitUntil(self.registration.showNotification(title, options));
});

self.addEventListener("notificationclick", (event) => {
  event.notification.close();

  const action = event.action;
  const data = event.notification.data;

  if (action === "dismiss") {
    return;
  }

  const urlToOpen = action === "view" && data.url ? data.url : "/";

  event.waitUntil(
    self.clients
      .matchAll({
        type: "window",
        includeUncontrolled: true,
      })
      .then((clientList) => {
        for (const client of clientList) {
          if (client.url === urlToOpen && "focus" in client) {
            return client.focus();
          }
        }
        if (self.clients.openWindow) {
          return self.clients.openWindow(urlToOpen);
        }
      })
  );
});

self.addEventListener("notificationclose", (event) => {
  console.log("Notification closed:", event.notification.tag);
});

self.addEventListener("install", (event) => {
  console.log("Service Worker installing...");
  self.skipWaiting();
});

self.addEventListener("activate", (event) => {
  console.log("Service Worker activating...");
  event.waitUntil(self.clients.claim());
});
```
---

### src\utils\date\dateutils.ts

**Language:** typescript  
**Size:** 2.5 KB  
**Last Modified:** 2025-11-06T16:57:56.580Z

```typescript
export const formatDateForInput = (date: Date | string): string => {
  const d = typeof date === "string" ? new Date(date) : date;
  const year = d.getFullYear();
  const month = String(d.getMonth() + 1).padStart(2, "0");
  const day = String(d.getDate()).padStart(2, "0");
  return `${year}-${month}-${day}`;
};

export const formatDateTimeForInput = (date: Date | string): string => {
  const d = typeof date === "string" ? new Date(date) : date;
  const year = d.getFullYear();
  const month = String(d.getMonth() + 1).padStart(2, "0");
  const day = String(d.getDate()).padStart(2, "0");
  const hours = String(d.getHours()).padStart(2, "0");
  const minutes = String(d.getMinutes()).padStart(2, "0");
  return `${year}-${month}-${day}T${hours}:${minutes}`;
};

export const parseDateFromInput = (dateString: string): Date => {
  const [year, month, day] = dateString.split("-").map(Number);
  return new Date(year, month - 1, day, 0, 0, 0, 0);
};

export const parseDateTimeFromInput = (dateTimeString: string): Date => {
  const date = new Date(dateTimeString);
  return date;
};

export const formatDateForDatabase = (date: Date | string): string => {
  if (typeof date === "string") {
    if (date.includes("T")) {
      const d = new Date(date);
      return formatDateForInput(d);
    }
    return date;
  }
  return formatDateForInput(date);
};

export const formatDateTimeForDatabase = (dateTimeString: string): string => {
  if (!dateTimeString) return "";

  const parts = dateTimeString.split("T");
  if (parts.length !== 2) return dateTimeString;

  const [datePart, timePart] = parts;
  const [year, month, day] = datePart.split("-");
  const [hours, minutes] = timePart.split(":");

  const localDate = new Date(parseInt(year), parseInt(month) - 1, parseInt(day), parseInt(hours), parseInt(minutes), 0, 0);

  return localDate.toISOString();
};

export const compareDates = (date1: Date | string, date2: Date | string): number => {
  const d1 = typeof date1 === "string" ? new Date(date1) : date1;
  const d2 = typeof date2 === "string" ? new Date(date2) : date2;
  return d1.getTime() - d2.getTime();
};

export const isDateInPast = (date: Date | string): boolean => {
  const d = typeof date === "string" ? new Date(date) : date;
  return d.getTime() < new Date().getTime();
};

export const addMinutesToDate = (date: Date | string, minutes: number): Date => {
  const d = typeof date === "string" ? new Date(date) : date;
  return new Date(d.getTime() + minutes * 60000);
};
```
---

### src\utils\investments\investmentUtils.ts

**Language:** typescript  
**Size:** 960 Bytes  
**Last Modified:** 2025-11-26T13:12:42.989Z

```typescript
// src/utils/investmentUtils.ts
import { supabase } from "@/integrations/supabase/client";

export const recalculateGoalBalance = async (goalId: string) => {
  try {
    // 1. Busca todos os investimentos (ativos e retiradas) vinculados a esta meta
    const { data: investments, error } = await supabase.from("investments").select("current_value").eq("goal_id", goalId);

    if (error) throw error;

    // 2. Soma tudo (valores negativos de retiradas serÃ£o subtraÃ­dos automaticamente)
    const totalBalance = investments?.reduce((acc, inv) => acc + Number(inv.current_value), 0) || 0;

    // 3. Atualiza a meta com o valor real calculado
    const { error: updateError } = await supabase.from("investment_goals").update({ current_amount: totalBalance }).eq("id", goalId);

    if (updateError) throw updateError;

    return totalBalance;
  } catch (error) {
    console.error("Erro ao sincronizar saldo da meta:", error);
  }
};
```
---

### src\utils\security\constants.ts

**Language:** typescript  
**Size:** 1.49 KB  
**Last Modified:** 2025-10-31T15:11:00.490Z

```typescript
export const SECURITY_LIMITS = {
  MAX_STRING_LENGTH: 5000,
  MAX_DESCRIPTION_LENGTH: 1000,
  MAX_NAME_LENGTH: 255,
  MAX_AMOUNT: 999999999.99,
  MIN_AMOUNT: -999999999.99,
  MAX_QUANTITY: 999999999,
  MIN_QUANTITY: 0,
  MAX_RECURRENCE_COUNT: 120,
  MIN_RECURRENCE_COUNT: 1,
} as const;

export const ALLOWED_TRANSACTION_TYPES = ['income', 'expense'] as const;

export const ALLOWED_INVESTMENT_TYPES = [
  'AÃ§Ãµes',
  'FIIs',
  'Renda Fixa',
  'Tesouro Direto',
  'CDB',
  'LCI/LCA',
  'Criptomoedas',
  'Outro'
] as const;

export const ALLOWED_CATEGORIES = [
  'AlimentaÃ§Ã£o',
  'Transporte',
  'Moradia',
  'SaÃºde',
  'EducaÃ§Ã£o',
  'Lazer',
  'Compras',
  'ServiÃ§os',
  'Investimentos',
  'Outros'
] as const;

export const REGEX_PATTERNS = {
  EMAIL: /^[^\s@]+@[^\s@]+\.[^\s@]+$/,
  UUID: /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i,
  DATE: /^\d{4}-\d{2}-\d{2}$/,
  NUMERIC: /^-?\d+\.?\d*$/,
  ALPHANUMERIC: /^[a-zA-Z0-9\s\-_]+$/,
  HEX_COLOR: /^#[0-9A-Fa-f]{6}$/,
} as const;

export const SQL_INJECTION_PATTERNS = [
  /(\bSELECT\b|\bINSERT\b|\bUPDATE\b|\bDELETE\b|\bDROP\b|\bCREATE\b|\bALTER\b)/i,
  /(--|\|\|)/,
  /(\bOR\b|\bAND\b)\s+[\d'"]+=[\d'"]+/i,
  /\bEXEC\b|\bEXECUTE\b/i,
  /;.*DROP/i,
] as const;

export const XSS_PATTERNS = [
  /<script[^>]*>.*?<\/script>/gi,
  /javascript:/gi,
  /on\w+\s*=/gi,
  /<iframe/gi,
  /<object/gi,
  /<embed/gi,
] as const;

export const RATE_LIMIT_CONFIG = {
  MAX_REQUESTS_PER_MINUTE: 60,
  MAX_REQUESTS_PER_HOUR: 1000,
  WINDOW_MS: 60000,
} as const;
```
---

### src\utils\security\index.ts

**Language:** typescript  
**Size:** 234 Bytes  
**Last Modified:** 2025-10-31T15:10:21.477Z

```typescript
export * from './constants';
export * from './sanitize';
export * from './validate';
export * from './permissions';
export * from './rateLimiter';
export * from './types';

export { useSanitizedForm } from '@/hooks/useSanitizedForm';
```
---

### src\utils\security\permissions.ts

**Language:** typescript  
**Size:** 5.05 KB  
**Last Modified:** 2025-11-27T13:08:55.353Z

```typescript
import { supabase } from '@/integrations/supabase/client';

import type { PermissionContext } from './types';

export const checkIsResourceOwner = (userId: string, resourceOwnerId: string): boolean => {
  return userId === resourceOwnerId;
};

export const checkGroupMembership = async (userId: string, groupId: string): Promise<boolean> => {
if (!groupId || groupId === "undefined" || groupId === "personal" || groupId === "none") {
    return false;
  }

  try {
    const { data, error } = await supabase
      .from('group_members')
      .select('id')
      .eq('user_id', userId)
      .eq('group_id', groupId)
      .maybeSingle(); // Use maybeSingle para nÃ£o gerar erro no console se nÃ£o encontrar

    if (error || !data) {
      return false;
    }

    return true;
  } catch {
    return false;
  }
};

export const checkGroupAdmin = async (userId: string, groupId: string): Promise<boolean> => {
  try {
    const { data: groupData, error: groupError } = await supabase
      .from('groups')
      .select('created_by')
      .eq('id', groupId)
      .single();

    if (groupError || !groupData) {
      return false;
    }

    if (groupData.created_by === userId) {
      return true;
    }

    const { data: memberData, error: memberError } = await supabase
      .from('group_members')
      .select('is_admin')
      .eq('user_id', userId)
      .eq('group_id', groupId)
      .single();

    if (memberError || !memberData) {
      return false;
    }

    return memberData.is_admin || false;
  } catch {
    return false;
  }
};

export const checkCanViewTransaction = async (context: PermissionContext): Promise<boolean> => {
  if (context.resourceOwnerId === context.userId) {
    return true;
  }

  if (context.groupId) {
    return checkGroupMembership(context.userId, context.groupId);
  }

  return false;
};

export const checkCanEditTransaction = async (context: PermissionContext): Promise<boolean> => {
  if (context.resourceOwnerId === context.userId) {
    return true;
  }

  if (context.groupId && context.isGroupAdmin !== undefined) {
    return context.isGroupAdmin;
  }

  if (context.groupId) {
    return checkGroupAdmin(context.userId, context.groupId);
  }

  return false;
};

export const checkCanDeleteTransaction = async (context: PermissionContext): Promise<boolean> => {
  return checkCanEditTransaction(context);
};

export const checkCanViewInvestment = async (context: PermissionContext): Promise<boolean> => {
  if (context.resourceOwnerId === context.userId) {
    return true;
  }

  if (context.groupId) {
    return checkGroupMembership(context.userId, context.groupId);
  }

  return false;
};

export const checkCanEditInvestment = async (context: PermissionContext): Promise<boolean> => {
  if (context.resourceOwnerId === context.userId) {
    return true;
  }

  if (context.groupId && context.isGroupAdmin !== undefined) {
    return context.isGroupAdmin;
  }

  if (context.groupId) {
    return checkGroupAdmin(context.userId, context.groupId);
  }

  return false;
};

export const checkCanDeleteInvestment = async (context: PermissionContext): Promise<boolean> => {
  return checkCanEditInvestment(context);
};

export const checkCanViewGroup = async (userId: string, groupId: string): Promise<boolean> => {
  return checkGroupMembership(userId, groupId);
};

export const checkCanEditGroup = async (userId: string, groupId: string): Promise<boolean> => {
  return checkGroupAdmin(userId, groupId);
};

export const checkCanDeleteGroup = async (userId: string, groupId: string): Promise<boolean> => {
  try {
    const { data, error } = await supabase
      .from('groups')
      .select('created_by')
      .eq('id', groupId)
      .single();

    if (error || !data) {
      return false;
    }

    return data.created_by === userId;
  } catch {
    return false;
  }
};

export const checkCanAddGroupMember = async (userId: string, groupId: string): Promise<boolean> => {
  return checkGroupAdmin(userId, groupId);
};

export const checkCanRemoveGroupMember = async (userId: string, groupId: string, targetUserId: string): Promise<boolean> => {
  if (userId === targetUserId) {
    return true;
  }

  return checkGroupAdmin(userId, groupId);
};

export const getCurrentUser = async (): Promise<string | null> => {
  try {
    const { data: { user } } = await supabase.auth.getUser();
    return user?.id || null;
  } catch {
    return null;
  }
};

export const ensureAuthenticated = async (): Promise<string> => {
  const userId = await getCurrentUser();
  
  if (!userId) {
    throw new Error('UsuÃ¡rio nÃ£o autenticado');
  }

  return userId;
};

export const withPermissionCheck = async <T>(
  permissionCheck: () => Promise<boolean>,
  action: () => Promise<T>,
  errorMessage: string = 'Sem permissÃ£o para realizar esta aÃ§Ã£o'
): Promise<T> => {
  const hasPermission = await permissionCheck();

  if (!hasPermission) {
    throw new Error(errorMessage);
  }

  return action();
};
```
---

### src\utils\security\rateLimiter.ts

**Language:** typescript  
**Size:** 3.66 KB  
**Last Modified:** 2025-10-31T15:10:19.277Z

```typescript
import { RATE_LIMIT_CONFIG } from './constants';

import type { RateLimitEntry } from './types';

class RateLimiter {
  private requests: Map<string, RateLimitEntry> = new Map();
  private cleanupInterval: NodeJS.Timeout | null = null;

  constructor() {
    this.startCleanup();
  }

  private startCleanup(): void {
    this.cleanupInterval = setInterval(() => {
      this.cleanup();
    }, RATE_LIMIT_CONFIG.WINDOW_MS);
  }

  private cleanup(): void {
    const now = Date.now();
    const expiredKeys: string[] = [];

    this.requests.forEach((entry, key) => {
      if (now - entry.lastRequest > RATE_LIMIT_CONFIG.WINDOW_MS * 2) {
        expiredKeys.push(key);
      }
    });

    expiredKeys.forEach(key => this.requests.delete(key));
  }

  public checkLimit(identifier: string, maxRequests: number = RATE_LIMIT_CONFIG.MAX_REQUESTS_PER_MINUTE): boolean {
    const now = Date.now();
    const entry = this.requests.get(identifier);

    if (!entry) {
      this.requests.set(identifier, {
        count: 1,
        firstRequest: now,
        lastRequest: now,
      });
      return true;
    }

    const timeWindow = now - entry.firstRequest;

    if (timeWindow > RATE_LIMIT_CONFIG.WINDOW_MS) {
      this.requests.set(identifier, {
        count: 1,
        firstRequest: now,
        lastRequest: now,
      });
      return true;
    }

    if (entry.count >= maxRequests) {
      return false;
    }

    entry.count += 1;
    entry.lastRequest = now;
    this.requests.set(identifier, entry);

    return true;
  }

  public getRemainingRequests(identifier: string, maxRequests: number = RATE_LIMIT_CONFIG.MAX_REQUESTS_PER_MINUTE): number {
    const entry = this.requests.get(identifier);

    if (!entry) {
      return maxRequests;
    }

    const now = Date.now();
    const timeWindow = now - entry.firstRequest;

    if (timeWindow > RATE_LIMIT_CONFIG.WINDOW_MS) {
      return maxRequests;
    }

    return Math.max(0, maxRequests - entry.count);
  }

  public getResetTime(identifier: string): number {
    const entry = this.requests.get(identifier);

    if (!entry) {
      return 0;
    }

    return entry.firstRequest + RATE_LIMIT_CONFIG.WINDOW_MS;
  }

  public reset(identifier: string): void {
    this.requests.delete(identifier);
  }

  public destroy(): void {
    if (this.cleanupInterval) {
      clearInterval(this.cleanupInterval);
      this.cleanupInterval = null;
    }
    this.requests.clear();
  }
}

export const rateLimiter = new RateLimiter();

export const checkRateLimit = (
  identifier: string,
  maxRequests?: number
): { allowed: boolean; remaining: number; resetAt: number } => {
  const allowed = rateLimiter.checkLimit(identifier, maxRequests);
  const remaining = rateLimiter.getRemainingRequests(identifier, maxRequests);
  const resetAt = rateLimiter.getResetTime(identifier);

  return { allowed, remaining, resetAt };
};

export const withRateLimit = async <T>(
  identifier: string,
  fn: () => Promise<T>,
  maxRequests?: number
): Promise<T> => {
  const { allowed, resetAt } = checkRateLimit(identifier, maxRequests);

  if (!allowed) {
    const waitTime = Math.ceil((resetAt - Date.now()) / 1000);
    throw new Error(`Limite de requisiÃ§Ãµes excedido. Tente novamente em ${waitTime} segundos.`);
  }

  return fn();
};

export const createUserRateLimiter = (userId: string) => {
  return {
    check: (action: string, maxRequests?: number) => {
      const identifier = `${userId}:${action}`;
      return checkRateLimit(identifier, maxRequests);
    },
    wrap: async <T>(action: string, fn: () => Promise<T>, maxRequests?: number): Promise<T> => {
      const identifier = `${userId}:${action}`;
      return withRateLimit(identifier, fn, maxRequests);
    },
  };
};
```
---

### src\utils\security\sanitize.ts

**Language:** typescript  
**Size:** 4.43 KB  
**Last Modified:** 2025-11-06T16:36:34.843Z

```typescript
import DOMPurify from "dompurify";

import { SECURITY_LIMITS, SQL_INJECTION_PATTERNS, XSS_PATTERNS } from "./constants";

export const sanitizeString = (input: string, maxLength: number = SECURITY_LIMITS.MAX_STRING_LENGTH): string => {
  if (typeof input !== "string") {
    return "";
  }

  let sanitized = input.trim();

  sanitized = sanitized.slice(0, maxLength);

  sanitized = sanitized.replace(/[\x00-\x08\x0B-\x0C\x0E-\x1F\x7F]/g, "");

  return sanitized;
};

export const sanitizeHTML = (input: string): string => {
  if (typeof input !== "string") {
    return "";
  }

  return DOMPurify.sanitize(input, {
    ALLOWED_TAGS: [],
    ALLOWED_ATTR: [],
    KEEP_CONTENT: true,
  });
};

export const sanitizeNumber = (input: string | number): number => {
  const parsed = typeof input === "string" ? parseFloat(input) : input;

  if (isNaN(parsed) || !isFinite(parsed)) {
    return 0;
  }

  return parsed;
};

export const sanitizeAmount = (input: string | number): number => {
  const amount = sanitizeNumber(input);

  if (amount > SECURITY_LIMITS.MAX_AMOUNT) {
    return SECURITY_LIMITS.MAX_AMOUNT;
  }

  if (amount < SECURITY_LIMITS.MIN_AMOUNT) {
    return SECURITY_LIMITS.MIN_AMOUNT;
  }

  return Math.round(amount * 100) / 100;
};

export const sanitizeInteger = (input: string | number, min: number = 0, max: number = Number.MAX_SAFE_INTEGER): number => {
  const parsed = typeof input === "string" ? parseInt(input, 10) : Math.floor(input);

  if (isNaN(parsed) || !isFinite(parsed)) {
    return min;
  }

  if (parsed < min) {
    return min;
  }

  if (parsed > max) {
    return max;
  }

  return parsed;
};

export const detectSQLInjection = (input: string): boolean => {
  return SQL_INJECTION_PATTERNS.some((pattern) => pattern.test(input));
};

export const detectXSS = (input: string): boolean => {
  return XSS_PATTERNS.some((pattern) => pattern.test(input));
};

export const sanitizeInput = (input: string, maxLength?: number): string => {
  const cleaned = sanitizeString(input, maxLength);
  const htmlSafe = sanitizeHTML(cleaned);

  if (detectSQLInjection(htmlSafe) || detectXSS(htmlSafe)) {
    return "";
  }

  return htmlSafe;
};

export const sanitizeObject = <T extends Record<string, any>>(obj: T, sanitizers: Partial<Record<keyof T, (value: any) => any>>): T => {
  const sanitized = { ...obj };

  for (const key in sanitizers) {
    if (key in sanitized) {
      const sanitizer = sanitizers[key];
      if (sanitizer) {
        sanitized[key] = sanitizer(sanitized[key]);
      }
    }
  }

  return sanitized;
};

export const sanitizeArray = <T>(arr: T[], itemSanitizer: (item: T) => T, maxLength: number = 1000): T[] => {
  if (!Array.isArray(arr)) {
    return [];
  }

  return arr.slice(0, maxLength).map(itemSanitizer);
};

export const sanitizeUUID = (input: string): string | null => {
  const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;

  if (typeof input === "string" && uuidRegex.test(input.trim())) {
    return input.trim().toLowerCase();
  }

  return null;
};

export const sanitizeDate = (input: string | Date | null): string | null => {
  if (!input) return null;

  try {
    let dateStr: string;

    if (typeof input === "string") {
      if (/^\d{4}-\d{2}-\d{2}$/.test(input)) {
        return input;
      }
      dateStr = input;
    } else {
      const year = input.getFullYear();
      const month = String(input.getMonth() + 1).padStart(2, "0");
      const day = String(input.getDate()).padStart(2, "0");
      dateStr = `${year}-${month}-${day}`;
    }

    const [year, month, day] = dateStr.split("T")[0].split("-").map(Number);

    if (year < 1900 || year > 2100) {
      return null;
    }

    if (month < 1 || month > 12 || day < 1 || day > 31) {
      return null;
    }

    return `${year}-${String(month).padStart(2, "0")}-${String(day).padStart(2, "0")}`;
  } catch {
    return null;
  }
};

export const sanitizeEmail = (email: string): string | null => {
  const cleaned = sanitizeString(email, 320).toLowerCase();
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

  if (emailRegex.test(cleaned)) {
    return cleaned;
  }

  return null;
};

export const sanitizeColor = (color: string): string | null => {
  const cleaned = sanitizeString(color, 7);
  const hexRegex = /^#[0-9A-Fa-f]{6}$/;

  if (hexRegex.test(cleaned)) {
    return cleaned.toUpperCase();
  }

  return null;
};

export const escapeRegExp = (string: string): string => {
  return string.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
};
```
---

### src\utils\security\types.ts

**Language:** typescript  
**Size:** 1.44 KB  
**Last Modified:** 2025-12-03T21:27:10.892Z

```typescript
export interface ValidationResult {
  isValid: boolean;
  error: string | null;
}

export interface TransactionData {
  description: string;
  amount: number;
  type: "income" | "expense";
  category: string;
  date: string;
  group_id?: string | null;
  user_id?: string | null;
  is_recurring?: boolean;
  is_fixed?: boolean;
  recurrence_count?: number | null;
  recurrence_id?: string | null;
  event_id?: string | null; // Adicionado
}

export interface InvestmentData {
  name: string;
  type: string;
  amount: number;
  current_value?: number;
  quantity?: number | null;
  unit_price?: number | null;
  group_id?: string | null;
  user_id?: string | null;
  maturity_date?: string | null;
}

export interface GroupData {
  name: string;
  description?: string | null;
  color?: string | null;
  created_by?: string | null;
}

export interface EventData {
  name: string;
  description?: string | null;
  date: string;
}

export interface RateLimitEntry {
  count: number;
  firstRequest: number;
  lastRequest: number;
}

export interface PermissionContext {
  userId: string;
  groupId?: string | null;
  resourceOwnerId?: string | null;
  isGroupAdmin?: boolean;
}

export interface SanitizeConfig {
  maxLength?: number;
  allowHTML?: boolean;
  trim?: boolean;
}

export type SanitizerFunction<T = any> = (value: T) => T;

export type ValidatorFunction<T = any> = (value: T) => ValidationResult;
```
---

### src\utils\security\validate.ts

**Language:** typescript  
**Size:** 7.43 KB  
**Last Modified:** 2025-10-31T15:10:15.042Z

```typescript
import {
  SECURITY_LIMITS,
  ALLOWED_TRANSACTION_TYPES,
  ALLOWED_INVESTMENT_TYPES,
  ALLOWED_CATEGORIES,
  REGEX_PATTERNS,
} from './constants';

import type { ValidationResult, TransactionData, InvestmentData, GroupData } from './types';

export const createValidationResult = (isValid: boolean, error?: string): ValidationResult => ({
  isValid,
  error: error || null,
});

export const validateString = (
  value: string,
  fieldName: string,
  minLength: number = 1,
  maxLength: number = SECURITY_LIMITS.MAX_STRING_LENGTH
): ValidationResult => {
  if (typeof value !== 'string') {
    return createValidationResult(false, `${fieldName} deve ser uma string`);
  }

  const trimmed = value.trim();

  if (trimmed.length < minLength) {
    return createValidationResult(false, `${fieldName} deve ter no mÃ­nimo ${minLength} caracteres`);
  }

  if (trimmed.length > maxLength) {
    return createValidationResult(false, `${fieldName} deve ter no mÃ¡ximo ${maxLength} caracteres`);
  }

  return createValidationResult(true);
};

export const validateNumber = (
  value: number,
  fieldName: string,
  min?: number,
  max?: number
): ValidationResult => {
  if (typeof value !== 'number' || isNaN(value) || !isFinite(value)) {
    return createValidationResult(false, `${fieldName} deve ser um nÃºmero vÃ¡lido`);
  }

  if (min !== undefined && value < min) {
    return createValidationResult(false, `${fieldName} deve ser no mÃ­nimo ${min}`);
  }

  if (max !== undefined && value > max) {
    return createValidationResult(false, `${fieldName} deve ser no mÃ¡ximo ${max}`);
  }

  return createValidationResult(true);
};

export const validateAmount = (amount: number): ValidationResult => {
  return validateNumber(
    amount,
    'Valor',
    SECURITY_LIMITS.MIN_AMOUNT,
    SECURITY_LIMITS.MAX_AMOUNT
  );
};

export const validateUUID = (uuid: string, fieldName: string = 'ID'): ValidationResult => {
  if (!REGEX_PATTERNS.UUID.test(uuid)) {
    return createValidationResult(false, `${fieldName} invÃ¡lido`);
  }

  return createValidationResult(true);
};

export const validateDate = (date: string, fieldName: string = 'Data'): ValidationResult => {
  if (!REGEX_PATTERNS.DATE.test(date)) {
    return createValidationResult(false, `${fieldName} deve estar no formato YYYY-MM-DD`);
  }

  const parsedDate = new Date(date);
  if (isNaN(parsedDate.getTime())) {
    return createValidationResult(false, `${fieldName} invÃ¡lida`);
  }

  const year = parsedDate.getFullYear();
  if (year < 1900 || year > 2100) {
    return createValidationResult(false, `${fieldName} fora do intervalo permitido (1900-2100)`);
  }

  return createValidationResult(true);
};

export const validateEmail = (email: string): ValidationResult => {
  if (!REGEX_PATTERNS.EMAIL.test(email)) {
    return createValidationResult(false, 'Email invÃ¡lido');
  }

  return createValidationResult(true);
};

export const validateEnum = <T extends readonly string[]>(
  value: string,
  allowedValues: T,
  fieldName: string
): ValidationResult => {
  if (!allowedValues.includes(value as T[number])) {
    return createValidationResult(false, `${fieldName} invÃ¡lido`);
  }

  return createValidationResult(true);
};

export const validateTransactionType = (type: string): ValidationResult => {
  return validateEnum(type, ALLOWED_TRANSACTION_TYPES, 'Tipo de transaÃ§Ã£o');
};

export const validateInvestmentType = (type: string): ValidationResult => {
  return validateEnum(type, ALLOWED_INVESTMENT_TYPES, 'Tipo de investimento');
};

export const validateCategory = (category: string): ValidationResult => {
  return validateEnum(category, ALLOWED_CATEGORIES, 'Categoria');
};

export const validateBoolean = (value: any, fieldName: string): ValidationResult => {
  if (typeof value !== 'boolean') {
    return createValidationResult(false, `${fieldName} deve ser verdadeiro ou falso`);
  }

  return createValidationResult(true);
};

export const validateOptionalUUID = (uuid: string | null | undefined, fieldName: string = 'ID'): ValidationResult => {
  if (!uuid) {
    return createValidationResult(true);
  }

  return validateUUID(uuid, fieldName);
};

export const validateOptionalNumber = (
  value: number | null | undefined,
  fieldName: string,
  min?: number,
  max?: number
): ValidationResult => {
  if (value === null || value === undefined) {
    return createValidationResult(true);
  }

  return validateNumber(value, fieldName, min, max);
};

export const validateTransactionData = (data: Partial<TransactionData>): ValidationResult => {
  const validations = [
    validateString(data.description || '', 'DescriÃ§Ã£o', 1, SECURITY_LIMITS.MAX_DESCRIPTION_LENGTH),
    validateAmount(data.amount || 0),
    validateTransactionType(data.type || ''),
    validateCategory(data.category || ''),
    validateDate(data.date || ''),
    validateOptionalUUID(data.group_id, 'ID do grupo'),
    validateOptionalUUID(data.user_id, 'ID do usuÃ¡rio'),
  ];

  if (data.is_recurring !== undefined) {
    validations.push(validateBoolean(data.is_recurring, 'Ã‰ recorrente'));
  }

  if (data.is_fixed !== undefined) {
    validations.push(validateBoolean(data.is_fixed, 'Ã‰ fixo'));
  }

  if (data.recurrence_count !== undefined && data.recurrence_count !== null) {
    validations.push(
      validateNumber(
        data.recurrence_count,
        'Quantidade de recorrÃªncia',
        SECURITY_LIMITS.MIN_RECURRENCE_COUNT,
        SECURITY_LIMITS.MAX_RECURRENCE_COUNT
      )
    );
  }

  const failed = validations.find(v => !v.isValid);
  return failed || createValidationResult(true);
};

export const validateInvestmentData = (data: Partial<InvestmentData>): ValidationResult => {
  const validations = [
    validateString(data.name || '', 'Nome', 1, SECURITY_LIMITS.MAX_NAME_LENGTH),
    validateInvestmentType(data.type || ''),
    validateAmount(data.amount || 0),
    validateOptionalUUID(data.group_id, 'ID do grupo'),
    validateOptionalUUID(data.user_id, 'ID do usuÃ¡rio'),
  ];

  if (data.quantity !== undefined && data.quantity !== null) {
    validations.push(
      validateNumber(
        data.quantity,
        'Quantidade',
        SECURITY_LIMITS.MIN_QUANTITY,
        SECURITY_LIMITS.MAX_QUANTITY
      )
    );
  }

  if (data.unit_price !== undefined && data.unit_price !== null) {
    validations.push(validateAmount(data.unit_price));
  }

  if (data.maturity_date !== undefined && data.maturity_date !== null) {
    validations.push(validateDate(data.maturity_date, 'Data de vencimento'));
  }

  const failed = validations.find(v => !v.isValid);
  return failed || createValidationResult(true);
};

export const validateGroupData = (data: Partial<GroupData>): ValidationResult => {
  const validations = [
    validateString(data.name || '', 'Nome', 1, SECURITY_LIMITS.MAX_NAME_LENGTH),
    validateOptionalUUID(data.created_by, 'ID do criador'),
  ];

  if (data.description !== undefined && data.description !== null && data.description !== '') {
    validations.push(
      validateString(data.description, 'DescriÃ§Ã£o', 0, SECURITY_LIMITS.MAX_DESCRIPTION_LENGTH)
    );
  }

  if (data.color !== undefined && data.color !== null) {
    if (!REGEX_PATTERNS.HEX_COLOR.test(data.color)) {
      return createValidationResult(false, 'Cor invÃ¡lida (use formato hexadecimal #RRGGBB)');
    }
  }

  const failed = validations.find(v => !v.isValid);
  return failed || createValidationResult(true);
};

export const validateBatch = (results: ValidationResult[]): ValidationResult => {
  const failed = results.find(v => !v.isValid);
  return failed || createValidationResult(true);
};
```
---

### src\utils\services\pushNotificationService.ts

**Language:** typescript  
**Size:** 7.26 KB  
**Last Modified:** 2025-11-19T20:26:23.448Z

```typescript
import { supabase } from "@/integrations/supabase/client";
import type { PushSubscription } from "@/utils/types/reminder.types";

const PUBLIC_VAPID_KEY =
  import.meta.env.VITE_VAPID_PUBLIC_KEY || "BETwmgmXXkeAecI8eHXj-kCKkj_0c-qDX3znwN4oCgQUn2QAblyPI3E1Sc3xLgurcNnz12-K8AuUYyTyQLIFXT4";

export class PushNotificationService {
  private static instance: PushNotificationService;
  private registration: ServiceWorkerRegistration | null = null;

  private constructor() {}

  static getInstance(): PushNotificationService {
    if (!PushNotificationService.instance) {
      PushNotificationService.instance = new PushNotificationService();
    }
    return PushNotificationService.instance;
  }

  async initialize(): Promise<boolean> {
    if (!("serviceWorker" in navigator)) {
      console.warn("Service Workers nÃ£o suportados neste navegador");
      return false;
    }

    if (!("PushManager" in window)) {
      console.warn("Push API nÃ£o suportada neste navegador");
      return false;
    }

    try {
      // CORREÃ‡ÃƒO AQUI:
      // Em vez de tentar registrar manualmente com .register("/sw.js"),
      // nÃ³s aguardamos o registro que o VitePWA jÃ¡ fez automaticamente.
      this.registration = await navigator.serviceWorker.ready;

      console.log("Service Worker recuperado e pronto:", this.registration);
      return true;
    } catch (error) {
      console.error("Erro ao obter Service Worker:", error);
      return false;
    }
  }

  async requestPermission(): Promise<NotificationPermission> {
    if (!("Notification" in window)) {
      throw new Error("NotificaÃ§Ãµes nÃ£o suportadas");
    }

    const permission = await Notification.requestPermission();
    console.log("PermissÃ£o de notificaÃ§Ã£o:", permission);
    return permission;
  }

  async getPermissionState(): Promise<NotificationPermission> {
    if (!("Notification" in window)) {
      return "denied";
    }
    return Notification.permission;
  }

  async subscribe(userId: string): Promise<PushSubscription | null> {
    // Garante que estÃ¡ inicializado antes de prosseguir
    if (!this.registration) {
      const initialized = await this.initialize();
      if (!initialized) {
        throw new Error("Falha ao inicializar Service Worker (SW nÃ£o encontrado ou nÃ£o suportado)");
      }
    }

    // VerificaÃ§Ã£o de seguranÃ§a adicional
    if (!this.registration) {
      throw new Error("Service Worker Registration Ã© nulo apÃ³s inicializaÃ§Ã£o.");
    }

    const permission = await this.requestPermission();
    if (permission !== "granted") {
      throw new Error("PermissÃ£o de notificaÃ§Ã£o negada");
    }

    try {
      // Verifica se jÃ¡ existe uma inscriÃ§Ã£o
      let subscription = await this.registration.pushManager.getSubscription();

      // Se nÃ£o existir, cria uma nova
      if (!subscription) {
        subscription = await this.registration.pushManager.subscribe({
          userVisibleOnly: true,
          applicationServerKey: this.urlBase64ToUint8Array(PUBLIC_VAPID_KEY),
        });
      }

      const subscriptionData = {
        user_id: userId,
        endpoint: subscription.endpoint,
        p256dh: this.arrayBufferToBase64(subscription.getKey("p256dh")),
        auth: this.arrayBufferToBase64(subscription.getKey("auth")),
        user_agent: navigator.userAgent,
        is_active: true,
      };

      const { data, error } = await supabase
        .from("push_subscriptions" as any)
        .upsert(subscriptionData, { onConflict: "endpoint" })
        .select()
        .single();

      if (error) throw error;

      console.log("InscriÃ§Ã£o push criada com sucesso");

      await this.showNotification("NotificaÃ§Ãµes Ativadas!", {
        body: "VocÃª receberÃ¡ lembretes mesmo quando nÃ£o estiver usando o aplicativo.",
        icon: "/pwa-192x192.png", // Atualizei o caminho do Ã­cone para garantir que existe
        badge: "/pwa-192x192.png",
      });

      return data;
    } catch (error) {
      console.error("Erro ao criar inscriÃ§Ã£o push:", error);
      throw error;
    }
  }

  async unsubscribe(userId: string): Promise<void> {
    if (!this.registration) {
      return;
    }

    try {
      const subscription = await this.registration.pushManager.getSubscription();
      if (subscription) {
        await subscription.unsubscribe();
      }

      await supabase.from("push_subscriptions").delete().eq("user_id", userId);

      console.log("InscriÃ§Ã£o push cancelada");
    } catch (error) {
      console.error("Erro ao cancelar inscriÃ§Ã£o push:", error);
      throw error;
    }
  }

  async isSubscribed(): Promise<boolean> {
    // Tenta obter o registro sem forÃ§ar inicializaÃ§Ã£o pesada se possÃ­vel
    if (!this.registration) {
      // Tenta pegar o ready sem bloquear muito tempo se jÃ¡ estiver ativo
      const reg = await navigator.serviceWorker.getRegistration();
      if (reg) {
        this.registration = reg;
      } else {
        // Se nÃ£o encontrar, tenta o ready
        return false;
      }
    }

    if (!this.registration) {
      return false;
    }

    const subscription = await this.registration.pushManager.getSubscription();
    return subscription !== null;
  }

  async showNotification(title: string, options?: NotificationOptions): Promise<void> {
    const permission = await this.getPermissionState();
    if (permission !== "granted") {
      console.warn("PermissÃ£o de notificaÃ§Ã£o nÃ£o concedida");
      return;
    }

    if (!this.registration) {
      await this.initialize();
    }

    if (this.registration && this.registration.active) {
      try {
        this.registration.showNotification(title, {
          icon: "/pwa-192x192.png",
          badge: "/pwa-192x192.png",
          vibrate: [200, 100, 200],
          requireInteraction: false,
          ...options,
        });
      } catch (e) {
        console.error("Erro ao exibir notificaÃ§Ã£o via SW:", e);
        this.fallbackNotification(title, options);
      }
    } else {
      this.fallbackNotification(title, options);
    }
  }

  private fallbackNotification(title: string, options?: NotificationOptions) {
    try {
      new Notification(title, {
        icon: "/pwa-192x192.png",
        badge: "/pwa-192x192.png",
        ...options,
      });
    } catch (e) {
      console.error("Erro ao exibir notificaÃ§Ã£o de fallback:", e);
    }
  }

  private urlBase64ToUint8Array(base64String: string): Uint8Array {
    const padding = "=".repeat((4 - (base64String.length % 4)) % 4);
    const base64 = (base64String + padding).replace(/\-/g, "+").replace(/_/g, "/");

    const rawData = window.atob(base64);
    const outputArray = new Uint8Array(rawData.length);

    for (let i = 0; i < rawData.length; ++i) {
      outputArray[i] = rawData.charCodeAt(i);
    }

    return outputArray;
  }

  private arrayBufferToBase64(buffer: ArrayBuffer | null): string {
    if (!buffer) return "";
    const bytes = new Uint8Array(buffer);
    let binary = "";
    for (let i = 0; i < bytes.byteLength; i++) {
      binary += String.fromCharCode(bytes[i]);
    }
    return window.btoa(binary);
  }
}

export const pushNotificationService = PushNotificationService.getInstance();
```
---

### src\utils\services\reminderService.ts

**Language:** typescript  
**Size:** 4.02 KB  
**Last Modified:** 2025-11-06T17:40:59.214Z

```typescript
import { supabase } from "@/integrations/supabase/client";
import { pushNotificationService } from "@/utils/services/pushNotificationService";

import type { Reminder, ReminderFormData } from "@/utils/types/reminder";

export class ReminderService {
  async createReminder(userId: string, data: ReminderFormData, transactionId?: string): Promise<Reminder> {
    const { data: reminder, error } = await supabase
      .from("reminders")
      .insert({
        user_id: userId,
        transaction_id: transactionId,
        title: data.title,
        description: data.description,
        reminder_date: data.reminder_date,
        repeat_type: data.repeat_type,
      })
      .select()
      .single();

    if (error) throw error;

    return reminder;
  }

  async updateReminder(id: string, data: Partial<ReminderFormData>): Promise<Reminder> {
    const { data: reminder, error } = await supabase
      .from("reminders")
      .update({
        ...data,
        updated_at: new Date().toISOString(),
      })
      .eq("id", id)
      .select()
      .single();

    if (error) throw error;

    return reminder;
  }

  async deleteReminder(id: string): Promise<void> {
    const { error } = await supabase.from("reminders").delete().eq("id", id);
    if (error) throw error;
  }

  async getUserReminders(userId: string, includeCompleted = false): Promise<Reminder[]> {
    let query = supabase.from("reminders").select("*").eq("user_id", userId).order("reminder_date", { ascending: true });
    if (!includeCompleted) {
      query = query.eq("is_completed", false);
    }

    const { data, error } = await query;

    if (error) throw error;

    return data || [];
  }

  async getUpcomingReminders(userId: string, hours = 24): Promise<Reminder[]> {
    const now = new Date();
    const future = new Date(now.getTime() + hours * 60 * 60 * 1000);
    const { data, error } = await supabase
      .from("reminders")
      .select("*")
      .eq("user_id", userId)
      .eq("is_completed", false)
      .gte("reminder_date", now.toISOString())
      .lte("reminder_date", future.toISOString())
      .order("reminder_date", { ascending: true });

    if (error) throw error;

    return data || [];
  }

  async markAsCompleted(id: string): Promise<void> {
    const { error } = await supabase
      .from("reminders")
      .update({
        is_completed: true,
        updated_at: new Date().toISOString(),
      })
      .eq("id", id);
    if (error) throw error;
  }

  async markAsNotified(id: string): Promise<void> {
    const { error } = await supabase
      .from("reminders")
      .update({
        is_notified: true,
        notification_sent_at: new Date().toISOString(),
        updated_at: new Date().toISOString(),
      })
      .eq("id", id);
    if (error) throw error;
  }

  // A funÃ§Ã£o 'sendNotification' nÃ£o Ã© mais necessÃ¡ria no cliente
  // A funÃ§Ã£o 'scheduleReminder' nÃ£o Ã© mais necessÃ¡ria no cliente

  private async createRecurringReminder(reminder: Reminder): Promise<void> {
    const currentDate = new Date(reminder.reminder_date);
    let nextDate: Date;

    switch (reminder.repeat_type) {
      case "daily":
        nextDate = new Date(currentDate.setDate(currentDate.getDate() + 1));
        break;
      case "weekly":
        nextDate = new Date(currentDate.setDate(currentDate.getDate() + 7));
        break;
      case "monthly":
        nextDate = new Date(currentDate.setMonth(currentDate.getMonth() + 1));
        break;
      case "yearly":
        nextDate = new Date(currentDate.setFullYear(currentDate.getFullYear() + 1));
        break;
      default:
        return;
    }

    await this.createReminder(
      reminder.user_id,
      {
        title: reminder.title,
        description: reminder.description,
        reminder_date: nextDate.toISOString(),
        repeat_type: reminder.repeat_type,
      },
      reminder.transaction_id
    );
  }
}

export const reminderService = new ReminderService();
```
---

### src\utils\types\reminder.types.ts

**Language:** typescript  
**Size:** 1.08 KB  
**Last Modified:** 2025-11-06T14:46:46.436Z

```typescript
export type RepeatType = "none" | "daily" | "weekly" | "monthly" | "yearly";

export interface Reminder {
  id: string;
  user_id: string;
  transaction_id?: string;
  title: string;
  description?: string;
  reminder_date: string;
  is_completed: boolean;
  is_notified: boolean;
  notification_sent_at?: string;
  repeat_type?: RepeatType;
  created_at: string;
  updated_at: string;
}

export interface ReminderFormData {
  title: string;
  description?: string;
  reminder_date: string;
  repeat_type: RepeatType;
}

export interface PushSubscription {
  id: string;
  user_id: string;
  endpoint: string;
  p256dh: string;
  auth: string;
  user_agent?: string;
  is_active: boolean;
  created_at: string;
  updated_at: string;
}

export interface NotificationPermissionState {
  granted: boolean;
  denied: boolean;
  default: boolean;
}

export interface InAppNotification {
  id: string;
  title: string;
  description?: string;
  type: "reminder" | "transaction" | "goal" | "system";
  timestamp: string;
  isRead: boolean;
  actionUrl?: string;
}
```
---

### src\vite-env.d.ts

**Language:** typescript  
**Size:** 39 Bytes  
**Last Modified:** 2025-08-28T19:03:37.299Z

```typescript
/// <reference types="vite/client" />
```
---

### supabase\config.toml

**Language:** text  
**Size:** 35 Bytes  
**Last Modified:** 2025-08-28T19:03:37.300Z

```text
project_id = "chfbshwjiddnkiunpdzk"
```
---

### supabase\functions\check-reminders\index.ts

**Language:** typescript  
**Size:** 4.38 KB  
**Last Modified:** 2025-11-06T17:40:08.266Z

```typescript
import { createClient } from "https";
import * as webpush from "web-push";

// Tipos bÃ¡sicos (melhor seria compartilhar com o 'types.ts' do seu app, mas isto funciona)
interface Reminder {
  id: string;
  user_id: string;
  title: string;
  description?: string;
  reminder_date: string;
}
interface Subscription {
  endpoint: string;
  p256dh: string;
  auth: string;
}

// Configurar o web-push com suas chaves VAPID
// IMPORTANTE: Use as mesmas chaves do seu .env (VITE_VAPID_PUBLIC_KEY e VAPID_PRIVATE_KEY)
// VocÃª deve adicionar VAPID_PRIVATE_KEY nas 'secrets' do seu projeto Supabase
// supabase secrets set VAPID_PUBLIC_KEY=SUA_CHAVE_PUBLICA
// supabase secrets set VAPID_PRIVATE_KEY=SUA_CHAVE_PRIVADA
webpush.setVapidDetails(
  "mailto:seu-email@dominio.com", // Adicione seu email
  Deno.env.get("VAPID_PUBLIC_KEY")!,
  Deno.env.get("VAPID_PRIVATE_KEY")!
);

const corsHeaders = {
  "Access-Control-Allow-Origin": "*",
  "Access-Control-Allow-Headers": "authorization, x-client-info, apikey, content-type",
};

Deno.serve(async (req) => {
  // Tratar requisiÃ§Ã£o OPTIONS (CORS)
  if (req.method === "OPTIONS") {
    return new Response("ok", { headers: corsHeaders });
  }

  try {
    const supabaseClient = createClient(
      Deno.env.get("SUPABASE_URL")!,
      Deno.env.get("SUPABASE_SERVICE_ROLE_KEY")! // Use a Service Role Key para rodar no servidor
    );

    const now = new Date().toISOString();

    // 1. Buscar lembretes pendentes
    const { data: reminders, error: remindersError } = await supabaseClient
      .from("reminders")
      .select("*")
      .eq("is_completed", false)
      .eq("is_notified", false)
      .lte("reminder_date", now);

    if (remindersError) throw remindersError;
    if (!reminders || reminders.length === 0) {
      return new Response(JSON.stringify({ message: "Nenhum lembrete pendente." }), {
        headers: { ...corsHeaders, "Content-Type": "application/json" },
        status: 200,
      });
    }

    const notificationsToSend: Promise<any>[] = [];
    const notifiedReminderIds: string[] = [];

    // 2. Para cada lembrete, buscar as inscriÃ§Ãµes (assinaturas) do usuÃ¡rio
    for (const reminder of reminders) {
      const { data: subscriptions, error: subsError } = await supabaseClient
        .from("push_subscriptions")
        .select("endpoint, p256dh, auth")
        .eq("user_id", reminder.user_id)
        .eq("is_active", true);

      if (subsError || !subscriptions) continue;

      for (const sub of subscriptions) {
        const pushSubscription = {
          endpoint: sub.endpoint,
          keys: {
            p256dh: sub.p256dh,
            auth: sub.auth,
          },
        };

        const payload = JSON.stringify({
          title: reminder.title,
          body: reminder.description || "VocÃª tem um novo lembrete.",
          tag: `reminder-${reminder.id}`,
          data: {
            url: "/reminders", // Para onde o usuÃ¡rio vai ao clicar
          },
        });

        // 3. Adicionar o envio da notificaÃ§Ã£o Ã  fila
        notificationsToSend.push(
          webpush.sendNotification(pushSubscription, payload).catch(async (err) => {
            console.error(`Erro ao enviar notificaÃ§Ã£o para ${sub.endpoint}: ${err.message}`);
            // Se a inscriÃ§Ã£o expirou (410 Gone), desativa ela no banco
            if (err.statusCode === 410) {
              await supabaseClient.from("push_subscriptions").update({ is_active: false }).eq("endpoint", sub.endpoint);
            }
          })
        );
      }
      notifiedReminderIds.push(reminder.id);
    }

    // 4. Enviar todas as notificaÃ§Ãµes
    await Promise.all(notificationsToSend);

    // 5. Marcar lembretes como notificados
    if (notifiedReminderIds.length > 0) {
      await supabaseClient
        .from("reminders")
        .update({ is_notified: true, notification_sent_at: new Date().toISOString() })
        .in("id", notifiedReminderIds);
    }

    return new Response(JSON.stringify({ message: `${notificationsToSend.length} notificaÃ§Ãµes enviadas.` }), {
      headers: { ...corsHeaders, "Content-Type": "application/json" },
      status: 200,
    });
  } catch (error) {
    return new Response(JSON.stringify({ error: error.message }), {
      headers: { ...corsHeaders, "Content-Type": "application/json" },
      status: 500,
    });
  }
});
```
---

### supabase\functions\send-invite-email\index.ts

**Language:** typescript  
**Size:** 2.31 KB  
**Last Modified:** 2025-11-27T13:08:55.360Z

```typescript
import { serve } from "https://deno.land/std@0.168.0/http/server.ts"
import { createClient } from "https://esm.sh/@supabase/supabase-js@2"

const RESEND_API_KEY = Deno.env.get('RESEND_API_KEY')

const corsHeaders = {
  'Access-Control-Allow-Origin': '*',
  'Access-Control-Allow-Headers': 'authorization, x-client-info, apikey, content-type',
}

serve(async (req) => {
  if (req.method === 'OPTIONS') {
    return new Response('ok', { headers: corsHeaders })
  }

  try {
    const supabase = createClient(
      Deno.env.get('SUPABASE_URL') ?? '',
      Deno.env.get('SUPABASE_ANON_KEY') ?? ''
    )

    // Verifica autenticaÃ§Ã£o de quem chamou a funÃ§Ã£o
    const { data: { user }, error: authError } = await supabase.auth.getUser(
      req.headers.get('Authorization')?.replace('Bearer ', '') ?? ''
    )

    if (authError || !user) {
      return new Response(JSON.stringify({ error: 'Unauthorized' }), { status: 401, headers: corsHeaders })
    }

    const { email, link, groupName } = await req.json()

    // Chama API de Email (Exemplo com Resend)
    const res = await fetch('https://api.resend.com/emails', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${RESEND_API_KEY}`
      },
      body: JSON.stringify({
        from: 'Zeni Wallet <noreply@seu-dominio.com>',
        to: [email],
        subject: `Convite para participar do grupo ${groupName}`,
        html: `
          <h1>VocÃª foi convidado!</h1>
          <p>OlÃ¡,</p>
          <p>VocÃª foi convidado para participar do grupo financeiro <strong>${groupName}</strong> no Zeni Wallet.</p>
          <p>Clique no botÃ£o abaixo para aceitar:</p>
          <a href="${link}" style="background-color: #10b981; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px;">Aceitar Convite</a>
          <p>Ou copie este link: ${link}</p>
        `
      })
    })

    const data = await res.json()

    return new Response(JSON.stringify(data), {
      headers: { ...corsHeaders, 'Content-Type': 'application/json' },
      status: 200,
    })
  } catch (error) {
    return new Response(JSON.stringify({ error: error.message }), {
      headers: { ...corsHeaders, 'Content-Type': 'application/json' },
      status: 400,
    })
  }
})
```
---

### supabase\migrations\20250101000000_add_rls_policies.sql

**Language:** sql  
**Size:** 6.36 KB  
**Last Modified:** 2025-10-31T15:11:17.228Z

```sql
BEGIN;

ALTER TABLE profiles ENABLE ROW LEVEL SECURITY;
ALTER TABLE transactions ENABLE ROW LEVEL SECURITY;
ALTER TABLE investments ENABLE ROW LEVEL SECURITY;
ALTER TABLE groups ENABLE ROW LEVEL SECURITY;
ALTER TABLE group_members ENABLE ROW LEVEL SECURITY;
ALTER TABLE investment_goals ENABLE ROW LEVEL SECURITY;

DROP POLICY IF EXISTS "profiles_select_own" ON profiles;
CREATE POLICY "profiles_select_own" ON profiles
  FOR SELECT
  USING (auth.uid() = user_id);

DROP POLICY IF EXISTS "profiles_update_own" ON profiles;
CREATE POLICY "profiles_update_own" ON profiles
  FOR UPDATE
  USING (auth.uid() = user_id);

DROP POLICY IF EXISTS "profiles_insert_own" ON profiles;
CREATE POLICY "profiles_insert_own" ON profiles
  FOR INSERT
  WITH CHECK (auth.uid() = user_id);

DROP POLICY IF EXISTS "transactions_select_own_or_group" ON transactions;
CREATE POLICY "transactions_select_own_or_group" ON transactions
  FOR SELECT
  USING (
    auth.uid() = user_id
    OR
    (group_id IS NOT NULL AND EXISTS (
      SELECT 1 FROM group_members
      WHERE group_members.group_id = transactions.group_id
      AND group_members.user_id = auth.uid()
    ))
  );

DROP POLICY IF EXISTS "transactions_insert_own_or_group" ON transactions;
CREATE POLICY "transactions_insert_own_or_group" ON transactions
  FOR INSERT
  WITH CHECK (
    auth.uid() = user_id
    OR
    (group_id IS NOT NULL AND EXISTS (
      SELECT 1 FROM group_members
      WHERE group_members.group_id = transactions.group_id
      AND group_members.user_id = auth.uid()
    ))
  );

DROP POLICY IF EXISTS "transactions_update_own" ON transactions;
CREATE POLICY "transactions_update_own" ON transactions
  FOR UPDATE
  USING (auth.uid() = user_id)
  WITH CHECK (auth.uid() = user_id);

DROP POLICY IF EXISTS "transactions_delete_own" ON transactions;
CREATE POLICY "transactions_delete_own" ON transactions
  FOR DELETE
  USING (auth.uid() = user_id);

DROP POLICY IF EXISTS "investments_select_own_or_group" ON investments;
CREATE POLICY "investments_select_own_or_group" ON investments
  FOR SELECT
  USING (
    auth.uid() = user_id
    OR
    (group_id IS NOT NULL AND EXISTS (
      SELECT 1 FROM group_members
      WHERE group_members.group_id = investments.group_id
      AND group_members.user_id = auth.uid()
    ))
  );

DROP POLICY IF EXISTS "investments_insert_own_or_group" ON investments;
CREATE POLICY "investments_insert_own_or_group" ON investments
  FOR INSERT
  WITH CHECK (
    auth.uid() = user_id
    OR
    (group_id IS NOT NULL AND EXISTS (
      SELECT 1 FROM group_members
      WHERE group_members.group_id = investments.group_id
      AND group_members.user_id = auth.uid()
    ))
  );

DROP POLICY IF EXISTS "investments_update_own" ON investments;
CREATE POLICY "investments_update_own" ON investments
  FOR UPDATE
  USING (auth.uid() = user_id)
  WITH CHECK (auth.uid() = user_id);

DROP POLICY IF EXISTS "investments_delete_own" ON investments;
CREATE POLICY "investments_delete_own" ON investments
  FOR DELETE
  USING (auth.uid() = user_id);

DROP POLICY IF EXISTS "groups_select_member" ON groups;
CREATE POLICY "groups_select_member" ON groups
  FOR SELECT
  USING (
    auth.uid() = created_by
    OR
    EXISTS (
      SELECT 1 FROM group_members
      WHERE group_members.group_id = groups.id
      AND group_members.user_id = auth.uid()
    )
  );

DROP POLICY IF EXISTS "groups_insert_own" ON groups;
CREATE POLICY "groups_insert_own" ON groups
  FOR INSERT
  WITH CHECK (auth.uid() = created_by);

DROP POLICY IF EXISTS "groups_update_creator_or_admin" ON groups;
CREATE POLICY "groups_update_creator_or_admin" ON groups
  FOR UPDATE
  USING (
    auth.uid() = created_by
    OR
    EXISTS (
      SELECT 1 FROM group_members
      WHERE group_members.group_id = groups.id
      AND group_members.user_id = auth.uid()
      AND group_members.is_admin = true
    )
  )
  WITH CHECK (
    auth.uid() = created_by
    OR
    EXISTS (
      SELECT 1 FROM group_members
      WHERE group_members.group_id = groups.id
      AND group_members.user_id = auth.uid()
      AND group_members.is_admin = true
    )
  );

DROP POLICY IF EXISTS "groups_delete_creator" ON groups;
CREATE POLICY "groups_delete_creator" ON groups
  FOR DELETE
  USING (auth.uid() = created_by);

DROP POLICY IF EXISTS "group_members_select_member" ON group_members;
CREATE POLICY "group_members_select_member" ON group_members
  FOR SELECT
  USING (
    auth.uid() = user_id
    OR
    EXISTS (
      SELECT 1 FROM groups
      WHERE groups.id = group_members.group_id
      AND groups.created_by = auth.uid()
    )
    OR
    EXISTS (
      SELECT 1 FROM group_members gm
      WHERE gm.group_id = group_members.group_id
      AND gm.user_id = auth.uid()
    )
  );

DROP POLICY IF EXISTS "group_members_insert_admin" ON group_members;
CREATE POLICY "group_members_insert_admin" ON group_members
  FOR INSERT
  WITH CHECK (
    EXISTS (
      SELECT 1 FROM groups
      WHERE groups.id = group_members.group_id
      AND groups.created_by = auth.uid()
    )
    OR
    EXISTS (
      SELECT 1 FROM group_members gm
      WHERE gm.group_id = group_members.group_id
      AND gm.user_id = auth.uid()
      AND gm.is_admin = true
    )
  );

DROP POLICY IF EXISTS "group_members_delete_self_or_admin" ON group_members;
CREATE POLICY "group_members_delete_self_or_admin" ON group_members
  FOR DELETE
  USING (
    auth.uid() = user_id
    OR
    EXISTS (
      SELECT 1 FROM groups
      WHERE groups.id = group_members.group_id
      AND groups.created_by = auth.uid()
    )
    OR
    EXISTS (
      SELECT 1 FROM group_members gm
      WHERE gm.group_id = group_members.group_id
      AND gm.user_id = auth.uid()
      AND gm.is_admin = true
    )
  );

DROP POLICY IF EXISTS "investment_goals_select_own" ON investment_goals;
CREATE POLICY "investment_goals_select_own" ON investment_goals
  FOR SELECT
  USING (auth.uid() = user_id);

DROP POLICY IF EXISTS "investment_goals_insert_own" ON investment_goals;
CREATE POLICY "investment_goals_insert_own" ON investment_goals
  FOR INSERT
  WITH CHECK (auth.uid() = user_id);

DROP POLICY IF EXISTS "investment_goals_update_own" ON investment_goals;
CREATE POLICY "investment_goals_update_own" ON investment_goals
  FOR UPDATE
  USING (auth.uid() = user_id)
  WITH CHECK (auth.uid() = user_id);

DROP POLICY IF EXISTS "investment_goals_delete_own" ON investment_goals;
CREATE POLICY "investment_goals_delete_own" ON investment_goals
  FOR DELETE
  USING (auth.uid() = user_id);

COMMIT;
```
---

### supabase\migrations\20250101000001_add_constraints.sql

**Language:** sql  
**Size:** 3.36 KB  
**Last Modified:** 2025-10-31T15:11:09.952Z

```sql
BEGIN;

ALTER TABLE transactions
  ADD CONSTRAINT transactions_description_length 
    CHECK (length(trim(description)) > 0 AND length(description) <= 1000),
  ADD CONSTRAINT transactions_amount_range 
    CHECK (amount >= -999999999.99 AND amount <= 999999999.99),
  ADD CONSTRAINT transactions_type_valid 
    CHECK (type IN ('income', 'expense')),
  ADD CONSTRAINT transactions_recurrence_count_range 
    CHECK (recurrence_count IS NULL OR (recurrence_count >= 1 AND recurrence_count <= 120)),
  ADD CONSTRAINT transactions_category_not_empty 
    CHECK (length(trim(category)) > 0 AND length(category) <= 255),
  ADD CONSTRAINT transactions_date_range 
    CHECK (date >= '1900-01-01' AND date <= '2100-12-31');

ALTER TABLE investments
  ADD CONSTRAINT investments_name_length 
    CHECK (length(trim(name)) > 0 AND length(name) <= 255),
  ADD CONSTRAINT investments_amount_range 
    CHECK (amount >= 0 AND amount <= 999999999.99),
  ADD CONSTRAINT investments_current_value_range 
    CHECK (current_value >= 0 AND current_value <= 999999999.99),
  ADD CONSTRAINT investments_quantity_range 
    CHECK (quantity IS NULL OR (quantity >= 0 AND quantity <= 999999999)),
  ADD CONSTRAINT investments_unit_price_range 
    CHECK (unit_price IS NULL OR (unit_price >= 0 AND unit_price <= 999999999.99)),
  ADD CONSTRAINT investments_type_not_empty 
    CHECK (length(trim(type)) > 0 AND length(type) <= 255),
  ADD CONSTRAINT investments_maturity_date_range 
    CHECK (maturity_date IS NULL OR (maturity_date >= '1900-01-01' AND maturity_date <= '2100-12-31'));

ALTER TABLE groups
  ADD CONSTRAINT groups_name_length 
    CHECK (length(trim(name)) > 0 AND length(name) <= 255),
  ADD CONSTRAINT groups_description_length 
    CHECK (description IS NULL OR length(description) <= 1000),
  ADD CONSTRAINT groups_color_format 
    CHECK (color IS NULL OR color ~ '^#[0-9A-Fa-f]{6}$');

ALTER TABLE investment_goals
  ADD CONSTRAINT investment_goals_name_length 
    CHECK (length(trim(name)) > 0 AND length(name) <= 255),
  ADD CONSTRAINT investment_goals_target_amount_range 
    CHECK (target_amount > 0 AND target_amount <= 999999999.99),
  ADD CONSTRAINT investment_goals_current_amount_range 
    CHECK (current_amount >= 0 AND current_amount <= 999999999.99),
  ADD CONSTRAINT investment_goals_target_date_range 
    CHECK (target_date IS NULL OR (target_date >= CURRENT_DATE AND target_date <= '2100-12-31'));

ALTER TABLE profiles
  ADD CONSTRAINT profiles_full_name_length 
    CHECK (full_name IS NULL OR (length(trim(full_name)) > 0 AND length(full_name) <= 255)),
  ADD CONSTRAINT profiles_theme_valid 
    CHECK (theme IS NULL OR theme IN ('light', 'dark', 'system'));

CREATE INDEX IF NOT EXISTS idx_transactions_user_date ON transactions(user_id, date DESC);
CREATE INDEX IF NOT EXISTS idx_transactions_group_date ON transactions(group_id, date DESC) WHERE group_id IS NOT NULL;
CREATE INDEX IF NOT EXISTS idx_transactions_recurrence ON transactions(recurrence_id) WHERE recurrence_id IS NOT NULL;

CREATE INDEX IF NOT EXISTS idx_investments_user ON investments(user_id);
CREATE INDEX IF NOT EXISTS idx_investments_group ON investments(group_id) WHERE group_id IS NOT NULL;

CREATE INDEX IF NOT EXISTS idx_group_members_user ON group_members(user_id);
CREATE INDEX IF NOT EXISTS idx_group_members_group ON group_members(group_id);

CREATE INDEX IF NOT EXISTS idx_investment_goals_user ON investment_goals(user_id);

COMMIT;
```
---

### supabase\migrations\20250828143646_7e8a986a-c67f-48ef-b9ee-26d0eecacbe4.sql

**Language:** sql  
**Size:** 6.52 KB  
**Last Modified:** 2025-08-28T19:03:37.301Z

```sql
-- Create user profiles table
CREATE TABLE public.profiles (
  id UUID NOT NULL DEFAULT gen_random_uuid() PRIMARY KEY,
  user_id UUID NOT NULL UNIQUE REFERENCES auth.users(id) ON DELETE CASCADE,
  full_name TEXT,
  avatar_url TEXT,
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now()
);

-- Enable RLS
ALTER TABLE public.profiles ENABLE ROW LEVEL SECURITY;

-- Create profiles policies
CREATE POLICY "Users can view their own profile" 
ON public.profiles 
FOR SELECT 
USING (auth.uid() = user_id);

CREATE POLICY "Users can update their own profile" 
ON public.profiles 
FOR UPDATE 
USING (auth.uid() = user_id);

CREATE POLICY "Users can insert their own profile" 
ON public.profiles 
FOR INSERT 
WITH CHECK (auth.uid() = user_id);

-- Create groups table
CREATE TABLE public.groups (
  id UUID NOT NULL DEFAULT gen_random_uuid() PRIMARY KEY,
  name TEXT NOT NULL,
  description TEXT,
  color TEXT DEFAULT 'blue',
  created_by UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now()
);

-- Enable RLS for groups
ALTER TABLE public.groups ENABLE ROW LEVEL SECURITY;

-- Create group_members table
CREATE TABLE public.group_members (
  id UUID NOT NULL DEFAULT gen_random_uuid() PRIMARY KEY,
  group_id UUID NOT NULL REFERENCES public.groups(id) ON DELETE CASCADE,
  user_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,
  joined_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  UNIQUE(group_id, user_id)
);

-- Enable RLS for group_members
ALTER TABLE public.group_members ENABLE ROW LEVEL SECURITY;

-- Create transactions table
CREATE TABLE public.transactions (
  id UUID NOT NULL DEFAULT gen_random_uuid() PRIMARY KEY,
  user_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,
  group_id UUID REFERENCES public.groups(id) ON DELETE SET NULL,
  description TEXT NOT NULL,
  amount DECIMAL(15,2) NOT NULL,
  type TEXT NOT NULL CHECK (type IN ('income', 'expense')),
  category TEXT NOT NULL,
  date DATE NOT NULL DEFAULT CURRENT_DATE,
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now()
);

-- Enable RLS for transactions
ALTER TABLE public.transactions ENABLE ROW LEVEL SECURITY;

-- Create investments table
CREATE TABLE public.investments (
  id UUID NOT NULL DEFAULT gen_random_uuid() PRIMARY KEY,
  user_id UUID NOT NULL REFERENCES auth.users(id) ON DELETE CASCADE,
  group_id UUID REFERENCES public.groups(id) ON DELETE SET NULL,
  name TEXT NOT NULL,
  type TEXT NOT NULL CHECK (type IN ('Renda Fixa', 'AÃ§Ãµes', 'FIIs', 'Cripto', 'Outros')),
  amount DECIMAL(15,2) NOT NULL,
  current_value DECIMAL(15,2) NOT NULL,
  maturity_date DATE,
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now()
);

-- Enable RLS for investments
ALTER TABLE public.investments ENABLE ROW LEVEL SECURITY;

-- Groups policies
CREATE POLICY "Users can view groups they are members of" 
ON public.groups 
FOR SELECT 
USING (
  created_by = auth.uid() OR 
  EXISTS (
    SELECT 1 FROM public.group_members 
    WHERE group_id = groups.id AND user_id = auth.uid()
  )
);

CREATE POLICY "Users can create groups" 
ON public.groups 
FOR INSERT 
WITH CHECK (auth.uid() = created_by);

CREATE POLICY "Group creators can update their groups" 
ON public.groups 
FOR UPDATE 
USING (auth.uid() = created_by);

-- Group members policies
CREATE POLICY "Users can view group members of their groups" 
ON public.group_members 
FOR SELECT 
USING (
  EXISTS (
    SELECT 1 FROM public.groups 
    WHERE id = group_id AND (
      created_by = auth.uid() OR 
      EXISTS (
        SELECT 1 FROM public.group_members gm2 
        WHERE gm2.group_id = groups.id AND gm2.user_id = auth.uid()
      )
    )
  )
);

CREATE POLICY "Group creators can add members" 
ON public.group_members 
FOR INSERT 
WITH CHECK (
  EXISTS (
    SELECT 1 FROM public.groups 
    WHERE id = group_id AND created_by = auth.uid()
  )
);

-- Transactions policies
CREATE POLICY "Users can view their own transactions" 
ON public.transactions 
FOR SELECT 
USING (auth.uid() = user_id);

CREATE POLICY "Users can create their own transactions" 
ON public.transactions 
FOR INSERT 
WITH CHECK (auth.uid() = user_id);

CREATE POLICY "Users can update their own transactions" 
ON public.transactions 
FOR UPDATE 
USING (auth.uid() = user_id);

CREATE POLICY "Users can delete their own transactions" 
ON public.transactions 
FOR DELETE 
USING (auth.uid() = user_id);

-- Investments policies
CREATE POLICY "Users can view their own investments" 
ON public.investments 
FOR SELECT 
USING (auth.uid() = user_id);

CREATE POLICY "Users can create their own investments" 
ON public.investments 
FOR INSERT 
WITH CHECK (auth.uid() = user_id);

CREATE POLICY "Users can update their own investments" 
ON public.investments 
FOR UPDATE 
USING (auth.uid() = user_id);

CREATE POLICY "Users can delete their own investments" 
ON public.investments 
FOR DELETE 
USING (auth.uid() = user_id);

-- Create function to update timestamps
CREATE OR REPLACE FUNCTION public.update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
  NEW.updated_at = now();
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

-- Create triggers for automatic timestamp updates
CREATE TRIGGER update_profiles_updated_at
BEFORE UPDATE ON public.profiles
FOR EACH ROW
EXECUTE FUNCTION public.update_updated_at_column();

CREATE TRIGGER update_groups_updated_at
BEFORE UPDATE ON public.groups
FOR EACH ROW
EXECUTE FUNCTION public.update_updated_at_column();

CREATE TRIGGER update_transactions_updated_at
BEFORE UPDATE ON public.transactions
FOR EACH ROW
EXECUTE FUNCTION public.update_updated_at_column();

CREATE TRIGGER update_investments_updated_at
BEFORE UPDATE ON public.investments
FOR EACH ROW
EXECUTE FUNCTION public.update_updated_at_column();

-- Create function to handle new user signup
CREATE OR REPLACE FUNCTION public.handle_new_user()
RETURNS TRIGGER AS $$
BEGIN
  INSERT INTO public.profiles (user_id, full_name)
  VALUES (NEW.id, NEW.raw_user_meta_data ->> 'full_name');
  RETURN NEW;
END;
$$ LANGUAGE plpgsql SECURITY DEFINER;

-- Create trigger for new user signup
CREATE TRIGGER on_auth_user_created
AFTER INSERT ON auth.users
FOR EACH ROW
EXECUTE FUNCTION public.handle_new_user();
```
---

### supabase\migrations\20250828143805_72b78b28-1c94-4cd7-8ffd-bf20871859b1.sql

**Language:** sql  
**Size:** 548 Bytes  
**Last Modified:** 2025-08-28T19:03:37.302Z

```sql
-- Fix linter: set immutable search_path for functions
CREATE OR REPLACE FUNCTION public.update_updated_at_column()
RETURNS TRIGGER
LANGUAGE plpgsql
SECURITY DEFINER
SET search_path = public
AS $$
BEGIN
  NEW.updated_at = now();
  RETURN NEW;
END;
$$;

CREATE OR REPLACE FUNCTION public.handle_new_user()
RETURNS TRIGGER
LANGUAGE plpgsql
SECURITY DEFINER
SET search_path = public
AS $$
BEGIN
  INSERT INTO public.profiles (user_id, full_name)
  VALUES (NEW.id, NEW.raw_user_meta_data ->> 'full_name');
  RETURN NEW;
END;
$$;
```
---

### supabase\migrations\20250829132211_c0e738ba-7e8f-48f0-9deb-ffde44a30808.sql

**Language:** sql  
**Size:** 320 Bytes  
**Last Modified:** 2025-09-02T14:20:28.383Z

```sql
-- Create trigger to populate profiles on new auth user
DO $$
BEGIN
  IF NOT EXISTS (
    SELECT 1 FROM pg_trigger WHERE tgname = 'on_auth_user_created'
  ) THEN
    CREATE TRIGGER on_auth_user_created
    AFTER INSERT ON auth.users
    FOR EACH ROW EXECUTE FUNCTION public.handle_new_user();
  END IF;
END $$;
```
---

### supabase\migrations\20250903015953_5404a739-66c9-4a37-9263-5a31b04b7cf0.sql

**Language:** sql  
**Size:** 1.07 KB  
**Last Modified:** 2025-09-05T14:35:38.506Z

```sql
-- Primeiro, vamos remover as polÃ­ticas problemÃ¡ticas
DROP POLICY IF EXISTS "Users can view group members of their groups" ON group_members;
DROP POLICY IF EXISTS "Users can view groups they are members of" ON groups;

-- Criar novas polÃ­ticas sem recursÃ£o
-- Para group_members: permitir visualizar apenas se for criador do grupo ou se for o prÃ³prio usuÃ¡rio
CREATE POLICY "Users can view group members" 
ON group_members 
FOR SELECT 
USING (
  user_id = auth.uid() 
  OR 
  EXISTS (
    SELECT 1 FROM groups 
    WHERE groups.id = group_members.group_id 
    AND groups.created_by = auth.uid()
  )
);

-- Para groups: permitir visualizar se for o criador
CREATE POLICY "Users can view groups they created" 
ON groups 
FOR SELECT 
USING (created_by = auth.uid());

-- Criar polÃ­tica separada para visualizar grupos como membro
-- Aqui fazemos a busca direta sem recursÃ£o
CREATE POLICY "Users can view groups where they are members" 
ON groups 
FOR SELECT 
USING (
  id IN (
    SELECT group_id 
    FROM group_members 
    WHERE user_id = auth.uid()
  )
);
```
---

### supabase\migrations\20250904021942_62909a3a-55dc-49d7-9e8c-022c6b9a7a56.sql

**Language:** sql  
**Size:** 1.58 KB  
**Last Modified:** 2025-09-05T14:35:38.507Z

```sql
-- Create helper functions to avoid RLS recursion
CREATE OR REPLACE FUNCTION public.is_group_creator(_group_id uuid)
RETURNS boolean
LANGUAGE sql
STABLE
SECURITY DEFINER
SET search_path = public
AS $$
  SELECT EXISTS (
    SELECT 1 FROM public.groups g
    WHERE g.id = _group_id AND g.created_by = auth.uid()
  );
$$;

CREATE OR REPLACE FUNCTION public.is_group_member(_group_id uuid)
RETURNS boolean
LANGUAGE sql
STABLE
SECURITY DEFINER
SET search_path = public
AS $$
  SELECT EXISTS (
    SELECT 1 FROM public.group_members gm
    WHERE gm.group_id = _group_id AND gm.user_id = auth.uid()
  );
$$;

-- Replace existing SELECT policies with function-based ones to prevent recursion
DROP POLICY IF EXISTS "Users can view groups they created" ON groups;
DROP POLICY IF EXISTS "Users can view groups where they are members" ON groups;

CREATE POLICY "Users can view groups they created or joined"
ON public.groups
FOR SELECT
USING (
  public.is_group_creator(id) OR public.is_group_member(id)
);

-- Replace group_members SELECT policy
DROP POLICY IF EXISTS "Users can view group members" ON group_members;
CREATE POLICY "Users can view group members (self or creator)"
ON public.group_members
FOR SELECT
USING (
  user_id = auth.uid() OR public.is_group_creator(group_id)
);

-- Replace INSERT policy for group_members to use function (to avoid recursion)
DROP POLICY IF EXISTS "Group creators can add members" ON group_members;
CREATE POLICY "Group creators can add members"
ON public.group_members
FOR INSERT
WITH CHECK (
  public.is_group_creator(group_id)
);
```
---

### supabase\migrations\20250904221115_8d927066-53cd-4d11-97ea-cc53894ac1c6.sql

**Language:** sql  
**Size:** 1.32 KB  
**Last Modified:** 2025-09-05T14:35:38.508Z

```sql
-- Create investment_goals table
CREATE TABLE public.investment_goals (
  id UUID NOT NULL DEFAULT gen_random_uuid() PRIMARY KEY,
  user_id UUID NOT NULL,
  name TEXT NOT NULL,
  target_amount NUMERIC NOT NULL,
  current_amount NUMERIC NOT NULL DEFAULT 0,
  color TEXT DEFAULT 'blue',
  description TEXT,
  target_date DATE,
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now()
);

-- Enable Row Level Security
ALTER TABLE public.investment_goals ENABLE ROW LEVEL SECURITY;

-- Create RLS policies for investment_goals
CREATE POLICY "Users can view their own investment goals"
ON public.investment_goals
FOR SELECT
USING (auth.uid() = user_id);

CREATE POLICY "Users can create their own investment goals"
ON public.investment_goals
FOR INSERT
WITH CHECK (auth.uid() = user_id);

CREATE POLICY "Users can update their own investment goals"
ON public.investment_goals
FOR UPDATE
USING (auth.uid() = user_id);

CREATE POLICY "Users can delete their own investment goals"
ON public.investment_goals
FOR DELETE
USING (auth.uid() = user_id);

-- Create trigger for automatic timestamp updates
CREATE TRIGGER update_investment_goals_updated_at
BEFORE UPDATE ON public.investment_goals
FOR EACH ROW
EXECUTE FUNCTION public.update_updated_at_column();
```
---

### supabase\migrations\add_is_admin_to_group_members.sql

**Language:** sql  
**Size:** 362 Bytes  
**Last Modified:** 2025-10-09T12:04:59.018Z

```sql
ALTER TABLE group_members
ADD COLUMN IF NOT EXISTS is_admin BOOLEAN DEFAULT false;

COMMENT ON COLUMN group_members.is_admin IS 'Indica se o membro Ã© administrador do grupo e pode adicionar/remover membros';

UPDATE group_members
SET is_admin = true
WHERE user_id IN (
  SELECT created_by 
  FROM groups 
  WHERE groups.id = group_members.group_id
);
```
---

### supabase\migrations\add_recurrence_fields.sql

**Language:** sql  
**Size:** 920 Bytes  
**Last Modified:** 2025-10-09T12:04:59.028Z

```sql
-- Add recurrence fields to transactions table
ALTER TABLE transactions
ADD COLUMN IF NOT EXISTS is_recurring BOOLEAN DEFAULT false,
ADD COLUMN IF NOT EXISTS is_fixed BOOLEAN DEFAULT false,
ADD COLUMN IF NOT EXISTS recurrence_id UUID,
ADD COLUMN IF NOT EXISTS recurrence_count INTEGER;

-- Add comments
COMMENT ON COLUMN transactions.is_recurring IS 'Indica se a transaÃ§Ã£o Ã© recorrente';
COMMENT ON COLUMN transactions.is_fixed IS 'Indica se a transaÃ§Ã£o Ã© fixa mensal';
COMMENT ON COLUMN transactions.recurrence_id IS 'ID compartilhado entre transaÃ§Ãµes da mesma recorrÃªncia';
COMMENT ON COLUMN transactions.recurrence_count IS 'NÃºmero de vezes que a transaÃ§Ã£o deve se repetir';

-- Create index for better query performance
CREATE INDEX IF NOT EXISTS idx_transactions_recurrence_id ON transactions(recurrence_id);
CREATE INDEX IF NOT EXISTS idx_transactions_is_fixed ON transactions(is_fixed);
```
---

### tailwind.config.ts

**Language:** typescript  
**Size:** 3.33 KB  
**Last Modified:** 2025-09-02T14:20:28.403Z

```typescript
import type { Config } from "tailwindcss";

export default {
	darkMode: ["class"],
	content: [
		"./pages/**/*.{ts,tsx}",
		"./components/**/*.{ts,tsx}",
		"./app/**/*.{ts,tsx}",
		"./src/**/*.{ts,tsx}",
	],
	prefix: "",
	theme: {
		container: {
			center: true,
			padding: '2rem',
			screens: {
				'2xl': '1400px'
			}
		},
		extend: {
			colors: {
				border: 'hsl(var(--border))',
				input: 'hsl(var(--input))',
				ring: 'hsl(var(--ring))',
				background: 'hsl(var(--background))',
				foreground: 'hsl(var(--foreground))',
				primary: {
					DEFAULT: 'hsl(var(--primary))',
					foreground: 'hsl(var(--primary-foreground))'
				},
				secondary: {
					DEFAULT: 'hsl(var(--secondary))',
					foreground: 'hsl(var(--secondary-foreground))'
				},
				destructive: {
					DEFAULT: 'hsl(var(--destructive))',
					foreground: 'hsl(var(--destructive-foreground))'
				},
				muted: {
					DEFAULT: 'hsl(var(--muted))',
					foreground: 'hsl(var(--muted-foreground))'
				},
				accent: {
					DEFAULT: 'hsl(var(--accent))',
					foreground: 'hsl(var(--accent-foreground))'
				},
				success: {
					DEFAULT: 'hsl(var(--success))',
					foreground: 'hsl(var(--success-foreground))'
				},
				warning: {
					DEFAULT: 'hsl(var(--warning))',
					foreground: 'hsl(var(--warning-foreground))'
				},
				/* Financial specific colors */
				income: {
					DEFAULT: 'hsl(var(--income))',
					foreground: 'hsl(var(--income-foreground))'
				},
				expense: {
					DEFAULT: 'hsl(var(--expense))',
					foreground: 'hsl(var(--expense-foreground))'
				},
				investment: {
					DEFAULT: 'hsl(var(--investment))',
					foreground: 'hsl(var(--investment-foreground))'
				},
				popover: {
					DEFAULT: 'hsl(var(--popover))',
					foreground: 'hsl(var(--popover-foreground))'
				},
				card: {
					DEFAULT: 'hsl(var(--card))',
					foreground: 'hsl(var(--card-foreground))'
				},
				sidebar: {
					DEFAULT: 'hsl(var(--sidebar-background))',
					foreground: 'hsl(var(--sidebar-foreground))',
					primary: 'hsl(var(--sidebar-primary))',
					'primary-foreground': 'hsl(var(--sidebar-primary-foreground))',
					accent: 'hsl(var(--sidebar-accent))',
					'accent-foreground': 'hsl(var(--sidebar-accent-foreground))',
					border: 'hsl(var(--sidebar-border))',
					ring: 'hsl(var(--sidebar-ring))'
				}
			},
			backgroundImage: {
				'gradient-income': 'var(--gradient-income)',
				'gradient-expense': 'var(--gradient-expense)',
				'gradient-investment': 'var(--gradient-investment)',
				'gradient-card': 'var(--gradient-card)',
				'gradient-primary': 'var(--gradient-primary)'
			},
			boxShadow: {
				'financial': 'var(--shadow-financial)'
			},
			borderRadius: {
				lg: 'var(--radius)',
				md: 'calc(var(--radius) - 2px)',
				sm: 'calc(var(--radius) - 4px)'
			},
			keyframes: {
				'accordion-down': {
					from: {
						height: '0'
					},
					to: {
						height: 'var(--radix-accordion-content-height)'
					}
				},
				'accordion-up': {
					from: {
						height: 'var(--radix-accordion-content-height)'
					},
					to: {
						height: '0'
					}
				}
			},
			animation: {
				'accordion-down': 'accordion-down 0.2s ease-out',
				'accordion-up': 'accordion-up 0.2s ease-out'
			}
		}
	},
	plugins: [require("tailwindcss-animate")],
} satisfies Config;
```
---

### tsconfig.app.json

**Language:** json  
**Size:** 680 Bytes  
**Last Modified:** 2025-10-31T20:45:59.538Z

```json
{
  "compilerOptions": {
    "target": "ES2020",
    "useDefineForClassFields": true,
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "module": "ESNext",
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "isolatedModules": true,
    "moduleDetection": "force",
    "noEmit": true,
    "jsx": "react-jsx",

    /* Linting */
    "strict": true,
    "noUnusedLocals": false,
    "noUnusedParameters": false,
    "noImplicitAny": true,
    "noFallthroughCasesInSwitch": false,

    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    }
  },
  "include": ["src"]
}
```
---

### tsconfig.json

**Language:** json  
**Size:** 785 Bytes  
**Last Modified:** 2025-10-30T21:06:38.601Z

```json
{
  "files": [],
  "references": [{ "path": "./tsconfig.app.json" }, { "path": "./tsconfig.node.json" }],
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": ["./src/*"]
    },
    "noImplicitAny": true,
    "noUnusedParameters": false,
    "skipLibCheck": true,
    "allowJs": true,
    "noUnusedLocals": false,
    "strictNullChecks": true,
    "moduleResolution": "bundler",
    "module": "ESNext",
    "target": "ESNext",
    "lib": ["ESNext", "DOM", "DOM.Iterable"],
    "esModuleInterop": true,
    "isolatedModules": true,
    "resolveJsonModule": true,
    "removeComments": true,
    "declaration": false,
    "declarationMap": false,
    "sourceMap": false,
    "incremental": true,
    "tsBuildInfoFile": ".tsbuildinfo"
  }
}
```
---

### tsconfig.node.json

**Language:** json  
**Size:** 503 Bytes  
**Last Modified:** 2025-08-28T19:03:37.305Z

```json
{
  "compilerOptions": {
    "target": "ES2022",
    "lib": ["ES2023"],
    "module": "ESNext",
    "skipLibCheck": true,

    /* Bundler mode */
    "moduleResolution": "bundler",
    "allowImportingTsExtensions": true,
    "isolatedModules": true,
    "moduleDetection": "force",
    "noEmit": true,

    /* Linting */
    "strict": true,
    "noUnusedLocals": false,
    "noUnusedParameters": false,
    "noFallthroughCasesInSwitch": true
  },
  "include": ["vite.config.ts"]
}
```
---

### vercel.json

**Language:** json  
**Size:** 104 Bytes  
**Last Modified:** 2025-11-06T18:09:35.185Z

```json
{
  "rewrites": [
    {
      "source": "/(.*)",
      "destination": "/index.html"
    }
  ]
}
```
---

### vite.config.ts

**Language:** typescript  
**Size:** 1.56 KB  
**Last Modified:** 2025-11-26T13:21:17.030Z

```typescript
import { defineConfig } from "vite";
import react from "@vitejs/plugin-react-swc";
import path from "path";
import { VitePWA } from "vite-plugin-pwa";

export default defineConfig(() => ({
  server: {
    host: "::",
    port: 8080,
  },
  plugins: [
    react(),
    VitePWA({
      strategies: "injectManifest",
      srcDir: "src",
      filename: "sw.ts",

      registerType: "autoUpdate",
      injectRegister: "auto",

      includeAssets: ["pwa-192x192.png", "pwa-512x512.png"],

      manifest: {
        name: "Zeni Wallet - GestÃ£o Financeira Pessoal",
        short_name: "Zeni Wallet",
        description: "Gerenciamento financeiro pessoal e em grupo",
        theme_color: "#10b981",
        background_color: "#0f172a",
        display: "standalone",
        orientation: "portrait",
        scope: "/",
        start_url: "/",
        lang: "pt-BR",
        icons: [
          {
            src: "/pwa-192x192.png",
            sizes: "192x192",
            type: "image/png",
          },
          {
            src: "/pwa-512x512.png",
            sizes: "512x512",
            type: "image/png",
          },
          {
            src: "/pwa-512x512.png",
            sizes: "512x512",
            type: "image/png",
            purpose: "any maskable",
          },
        ],
      },

      devOptions: {
        enabled: true,
        type: "module",
        navigateFallback: "index.html",
      },
    }),
  ],
  resolve: {
    alias: {
      "@": path.resolve(__dirname, "./src"),
    },
  },
}));
```
---

